title: #StopRansomware: Royal Ransomware url: https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-061a SUMMARY Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors.These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware.Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources. Actions to take today to mitigate cyber threats from ransomware: Prioritize remediating known exploited vulnerabilities. Train users to recognize and report phishing attempts. Enable and enforce multifactor authentication. The Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint CSA to disseminate known Royal ransomware IOCs and TTPs identified through FBI threat response activities as recently as January 2023. Since approximately September 2022, cyber criminals have compromised U.S. and international organizations with a Royal ransomware variant.FBI and CISA believe this variant, which uses its own custom-made file encryption program, evolved from earlier iterations that used “Zeon” as a loader.After gaining access to victims’ networks, Royal actors disable antivirus software and exfiltrate large amounts of data before ultimately deploying the ransomware and encrypting the systems.Royal actors have made ransom demands ranging from approximately $1 million to $11 million USD in Bitcoin.In observed incidents, Royal actors do not include ransom amounts and payment instructions as part of the initial ransom note.Instead, the note, which appears after encryption, requires victims to directly interact with the threat actor via a .onion URL (reachable through the Tor browser).Royal actors have targeted numerous critical infrastructure sectors including, but not limited to, Manufacturing, Communications, Healthcare and Public Healthcare (HPH), and Education. FBI and CISA encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents. Download the PDF version of this report: #StopRansomware: Royal Ransomware (PDF, 586.96 KB ) For a downloadable copy of IOCs, see AA23-061A STIX XML (XML, 114.26 KB ) TECHNICAL DETAILS Note: This advisory uses the MITRE ATT&CK:registered: for Enterprise framework, version 12.See MITRE ATT&CK for Enterprise for all referenced tactics and techniques. Royal ransomware uses a unique partial encryption approach that allows the threat actor to choose a specific percentage of data in a file to encrypt.This approach allows the actor to lower the encryption percentage for larger files, which helps evade detection.[1]In addition to encrypting files, Royal actors also engage in double extortion tactics in which they threaten to publicly release the encrypted data if the victim does not pay the ransom. Initial Access Royal actors gain initial access to victim networks in a number of ways including: Phishing.According to third-party reporting, Royal actors most commonly (in 66.7% of incidents) gain initial access to victim networks via successful phishing emails [T1566]. According to open-source reporting, victims have unknowingly installed malware that delivers Royal ransomware after receiving phishing emails containing malicious PDF documents [T1566.001], and malvertising [T1566.002].[2] Remote Desktop Protocol (RDP).The second most common vector Royal actors use (in 13.3% of incidents) for initial access is RDP compromise. Public-facing applications.FBI has also observed Royal actors gain initial access through exploiting public-facing applications [T1190]. Brokers.Reports from trusted third-party sources indicate that Royal actors may leverage brokers to gain initial access and source traffic by harvesting virtual private network (VPN) credentials from stealer logs. Command and Control Once Royal actors gain access to the network, they communicate with command and control (C2) infrastructure and download multiple tools [T1105].Legitimate Windows software is repurposed by Royal operators to strengthen their foothold in the victim’s network.Ransomware operators often use open-source projects to aid their intrusion activities; Royal operators have recently been observed using Chisel, a tunneling tool transported over HTTP and secured via SSH [T1572], to communicate with their C2 infrastructure.FBI has observed multiple Qakbot C2s used in Royal ransomware attacks, but has not yet determined if Royal ransomware exclusively uses Qakbot C2s. Lateral Movement and Persistence Royal actors often use RDP to move laterally across the network[T1021.001].Microsoft Sysinternals tool PsExec has also been used to aid lateral movement.FBI has observed Royal actors using remote monitoring and management (RMM) software, such as AnyDesk, LogMeIn, and Atera, for persistence in the victim’s network[T1133].In some instances, the actors moved laterally to the domain controller.In one confirmed case, the actors used a legitimate admin account to remotely log on to the domain controller [T1078].Once on the domain controller, the threat actor deactivated antivirus protocols[T1562.001] by modifying Group Policy Objects[T1484.001]. Exfiltration Royal actors exfiltrate data from victim networks by repurposing legitimate cyber pentesting tools, such as Cobalt Strike, and malware tools and derivatives, such as Ursnif/Gozi, for data aggregation and exfiltration.According to third-party reporting, Royal actors’ first hop in exfiltration and other operations is usually a U.S. IP address. Note: In reference to Cobalt Strike and other tools mentioned above, a tool repository used by Royal was identified at IP: 94.232.41[.]105 in December 2022. Encryption Before starting the encryption process, Royal actors: Use Windows Restart Manager to determine whether targeted files are currently in use or blocked by other applications [T1486].[1] Use Windows Volume Shadow Copy service (vssadmin.exe) to delete shadow copies to prevent system recovery.[1] FBI has found numerous batch (.bat) files on impacted systems which are typically transferred as an encrypted 7zip file.Batch files create a new admin user [T1078.002], force a group policy update, set pertinent registry keys to auto-extract[T1119]and execute the ransomware, monitor the encryption process, and delete files upon completion—including Application, System, and Security event logs [T1070.001]. Malicious files have been found in victim networks in the following directories: C:\Temp\ C:\Users\ 